"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[8445],{14908:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAjpJREFUWEftmIFVwjAQhu0E4gTCBOoE1gmECewG4gTqBOIEwgY4gTiBbCAjyAT1/3kXX0jTNi0X7Xs27/UVaJL7+C93uSY56nhLqvjyPB/i+TUu3s+V/8sa821wvSZJwru3lQIC7hYjZspQZdNNAfnse+gFBNwDOt//Epwx8whI2t1rBUBx66fVa4HPdAcvzcYlw+vGmnTkutsHaKu3wIBMk8qdC4LMLciCij7AJQYwMNiuALiKDJhi/jexwYAZ2/Z8gAS6/CPAdwAS+Kf1gHXLA2vQdrGOgph0AFd8GeMS+ac1MFuMKWQCVUAB+QDIwAQQfmMyZ1IPaRtAjuyO2oBTTP4kBnYpAQaoylkInfS5sJXUBqRyczHE7WkDA0wLBA9pVDCLpmAIQdM+qgo2NR7SvwcMUamqj7qCmJABkZv6TVKPXZFU8TARr6IFCWAYgS9i4A7GZvjNLi5CBD1xknyKQaZYOGwncdzRPUDKI3mPW90uH3Lbw425cBgg39Ld7tTXYABEoy49YCO5PJ3/l4ISEEwJDIwJF7ykHr6ihgbJJGYe9JVbTLzmHSbE43uvlqoull3DVMVj7gqys5gasQ6wkIhVAeust3neA7ZRLVqQHArjG9/GxXZ1wlTC79GaUyEVzoK6cHjEvJqKAkGHR0y4TCXHMogKah+9GY+wCjInt1t+5pui7a6yA0w7IUdzrzPxrr50jVUdAWfozAFGyVigVC4rW+shh+jmJDQGIJfO2nVrrYtjkLSd8xsAF8o4yub23AAAAABJRU5ErkJggg=="},21310:function(e,l,a){a.d(l,{A:function(){return p}});var t=a(21929),i=(a(97042),a(98421),a(17851)),n=(a(68489),a(20709),a(15836)),o=(a(95815),a(32465),a(65546)),d=(a(51216),a(56768)),u=a(90144),r=a(45130),s=(0,d.pM)({__name:"index",props:{fieldName:{default:"rowGroupSetting"}},setup(e){const l=e,a=(0,d.WQ)("formConfig",()=>(console.error("PivotTableGroupSetting: formConfig not injected"),{})),s=(0,d.EW)(()=>a().currentWidget),m=(0,d.EW)(()=>{let e=(s.value||{}).props;return e?e[l.fieldName]:{}});return(e,l)=>{const a=o.rF,s=t.xE,p=n.B8,c=i.Zh,b=i.MQ,v=t.US;return(0,u.R1)(m)?((0,d.uX)(),(0,d.Wv)(v,{key:0,"label-position":"top",size:"default",style:{padding:"10px 16px 0"},onSubmit:l[5]||(l[5]=(0,r.D$)(()=>{},["prevent"]))},{default:(0,d.k6)(()=>[(0,d.bF)(s,{class:"view-attribute-item",label:"背景色"},{default:(0,d.k6)(()=>[(0,d.bF)(a,{modelValue:(0,u.R1)(m).backgroundColor,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,u.R1)(m).backgroundColor=e)},null,8,["modelValue"])]),_:1}),(0,d.bF)(s,{class:"view-attribute-item",label:"字体颜色"},{default:(0,d.k6)(()=>[(0,d.bF)(a,{modelValue:(0,u.R1)(m).fontColor,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,u.R1)(m).fontColor=e)},null,8,["modelValue"])]),_:1}),(0,d.bF)(s,{class:"view-attribute-item",label:"字体大小"},{default:(0,d.k6)(()=>[(0,d.bF)(p,{style:{width:"95%","margin-left":"5px"},modelValue:(0,u.R1)(m).fontSize,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,u.R1)(m).fontSize=e),min:10,max:40,size:"default"},null,8,["modelValue"])]),_:1}),null!=(0,u.R1)(m).headerRowHeight?((0,d.uX)(),(0,d.Wv)(s,{key:0,class:"view-attribute-item",label:"行高"},{default:(0,d.k6)(()=>[(0,d.bF)(p,{style:{width:"95%","margin-left":"5px"},modelValue:(0,u.R1)(m).headerRowHeight,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,u.R1)(m).headerRowHeight=e),min:10,max:100,size:"default"},null,8,["modelValue"])]),_:1})):(0,d.Q3)("",!0),(0,d.bF)(s,{class:"view-attribute-item",label:"对齐方式"},{default:(0,d.k6)(()=>[(0,d.bF)(b,{modelValue:(0,u.R1)(m).align,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,u.R1)(m).align=e)},{default:(0,d.k6)(()=>[(0,d.bF)(c,{value:"left"},{default:(0,d.k6)(()=>l[6]||(l[6]=[(0,d.eW)("居左")])),_:1,__:[6]}),(0,d.bF)(c,{value:"center"},{default:(0,d.k6)(()=>l[7]||(l[7]=[(0,d.eW)("居中")])),_:1,__:[7]}),(0,d.bF)(c,{value:"right"},{default:(0,d.k6)(()=>l[8]||(l[8]=[(0,d.eW)("居右")])),_:1,__:[8]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,d.Q3)("",!0)}}});const m=s;var p=m},21720:function(e,l,a){a.r(l),a.d(l,{default:function(){return g}});var t=a(25136),i=(a(97042),a(69957),a(21929)),n=(a(98421),a(65451)),o=(a(63390),a(76408)),d=(a(87535),a(32465),a(14022)),u=(a(72343),a(56768)),r=a(90144),s=a(45130),m=a(71066),p=a(82572);const c={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var b=(0,u.pM)({__name:"EditFormField",props:{rowData:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,p.l5)(),a=e,b=(0,u.EW)(()=>l.defaultFormItemSize||v.value.defaultFormItemSize?.value),{thirdParams:v,onCloseThirdDialog:g}=(0,m.P)(a),f=(0,r.KR)(),y=(0,r.KR)({fieldName:void 0}),R={fieldName:[{required:!0,message:"字段名称不能为空",trigger:"blur"}]},k=()=>{a.dialog?a.dialog.cancel():g(!1)},h=()=>{f.value.validate(e=>{e&&(a.dialog?a.dialog.submit(y.value.fieldName):g(!0,F.value.rowData,y.value.fieldName))})},F=(0,u.EW)(()=>({rowData:a.rowData||v.value.rowData}));return(0,u.sV)(()=>{F.value.rowData&&(y.value={...F.value.rowData})}),(e,l)=>{const a=d.WK,m=i.xE,p=o.uD,v=n.S2,g=i.US,F=t.S2;return(0,u.uX)(),(0,u.CE)("div",c,[(0,u.bF)(g,{ref_key:"form",ref:f,model:(0,r.R1)(y),class:"full-width-input form-box",rules:R,style:{width:"100%"},"label-width":"80px",size:(0,r.R1)(b),"label-position":"right",onSubmit:l[1]||(l[1]=(0,s.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(v,null,{default:(0,u.k6)(()=>[(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"字段名称",prop:"fieldName"},{default:(0,u.k6)(()=>[(0,u.bF)(a,{class:"input-item",modelValue:(0,r.R1)(y).fieldName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,r.R1)(y).fieldName=e),clearable:!0,placeholder:"表单自定义字段名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(v,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end"},{default:(0,u.k6)(()=>[(0,u.bF)(F,{size:(0,r.R1)(b),plain:!0,onClick:k},{default:(0,u.k6)(()=>l[2]||(l[2]=[(0,u.eW)(" 取消 ")])),_:1,__:[2]},8,["size"]),(0,u.bF)(F,{type:"primary",size:(0,r.R1)(b),onClick:h},{default:(0,u.k6)(()=>l[3]||(l[3]=[(0,u.eW)(" 保存 ")])),_:1,__:[3]},8,["size"])]),_:1})])}}});const v=b;var g=v},39204:function(e,l,a){a.d(l,{A:function(){return p}});var t=a(21929),i=(a(97042),a(98421),a(17851)),n=(a(68489),a(20709),a(85415)),o=(a(22243),a(7409),a(32465),a(3740)),d=(a(42899),a(56768)),u=a(90144),r=a(45130),s=(0,d.pM)({__name:"index",props:{fieldName:{default:"pagerSetting"}},setup(e){const l=e,a=(0,d.WQ)("formConfig",()=>(console.error("PivotTableTotalSetting: formConfig not injected"),{})),s=(0,d.EW)(()=>a().currentWidget),m=(0,d.EW)(()=>{let e=(s.value||{}).props;return e?e[l.fieldName]:{}});return(e,l)=>{const a=o.qi,s=t.xE,p=n.P9,c=n.AV,b=i.Zh,v=i.MQ,g=t.US;return(0,u.R1)(m)?((0,d.uX)(),(0,d.Wv)(g,{key:0,"label-position":"top",size:"default",style:{padding:"10px 16px 0"},onSubmit:l[4]||(l[4]=(0,r.D$)(()=>{},["prevent"]))},{default:(0,d.k6)(()=>[(0,d.bF)(s,{class:"view-attribute-item",label:"是否显示"},{default:(0,d.k6)(()=>[(0,d.bF)(a,{modelValue:(0,u.R1)(m).show,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,u.R1)(m).show=e)},null,8,["modelValue"])]),_:1}),(0,d.bF)(s,{class:"view-attribute-item",label:"尺寸"},{default:(0,d.k6)(()=>[(0,d.bF)(c,{modelValue:(0,u.R1)(m).size,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,u.R1)(m).size=e),placeholder:""},{default:(0,d.k6)(()=>[(0,d.bF)(p,{label:"默认",value:"default"}),(0,d.bF)(p,{label:"小",value:"small"})]),_:1},8,["modelValue"])]),_:1}),(0,d.bF)(s,{class:"view-attribute-item",label:"样式"},{default:(0,d.k6)(()=>[(0,d.bF)(c,{modelValue:(0,u.R1)(m).background,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,u.R1)(m).background=e),placeholder:""},{default:(0,d.k6)(()=>[(0,d.bF)(p,{label:"按钮",value:"1"}),(0,d.bF)(p,{label:"文字",value:"0"})]),_:1},8,["modelValue"])]),_:1}),(0,d.bF)(s,{class:"view-attribute-item",label:"对齐方式"},{default:(0,d.k6)(()=>[(0,d.bF)(v,{modelValue:(0,u.R1)(m).align,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,u.R1)(m).align=e)},{default:(0,d.k6)(()=>[(0,d.bF)(b,{value:"left"},{default:(0,d.k6)(()=>l[5]||(l[5]=[(0,d.eW)("居左")])),_:1,__:[5]}),(0,d.bF)(b,{value:"center"},{default:(0,d.k6)(()=>l[6]||(l[6]=[(0,d.eW)("居中")])),_:1,__:[6]}),(0,d.bF)(b,{value:"right"},{default:(0,d.k6)(()=>l[7]||(l[7]=[(0,d.eW)("居右")])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,d.Q3)("",!0)}}});const m=s;var p=m},41405:function(e,l,a){a.d(l,{A:function(){return p}});a(44114),a(18111),a(22489),a(61701);var t=a(56768),i=a(90144),n=a(164),o=a(21231),d=a(83430),u=a(31372),r=a(52279),s=(0,t.pM)({__name:"index",setup(e){const l=(0,t.WQ)("formConfig",()=>(console.error("editWidgetAttribute: formConfig not injected"),{})),a=(e,a)=>{null==e?(a=p(a),l().currentWidget.childWidgetList.push(a)):l().currentWidget.childWidgetList=l().currentWidget.childWidgetList.map(l=>l.variableName===e.variableName?a:l)},s=(e=null)=>{u.l.show(e?"编辑标签页":"添加标签页",r["default"],{area:"600px"},{rowData:e,tabPanelList:(l().currentWidget.childWidgetList||[]).filter(l=>null==e||l.variableName!==e.variableName).map(e=>e.variableName),path:"thirdEditOnlineTabPanel"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditOnlineTabPanel"}).then(l=>{a(e,l)}).catch(e=>{console.log(e)})},m=e=>{n.s.confirm("是否删除此标签页？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l().currentWidget.childWidgetList=l().currentWidget.childWidgetList.filter(l=>l.variableName!==e.variableName)}).catch(e=>{console.warn(e)})},p=e=>{let a=l().getWidgetObject(d.A);return a.showName=e.showName,a.variableName=e.variableName,a.relation=void 0,a.datasource=void 0,a.column=void 0,a};return(e,a)=>((0,t.uX)(),(0,t.Wv)(o.A,{data:((0,i.R1)(l)().currentWidget||{}).childWidgetList,addText:"添加标签页",onAdd:a[0]||(a[0]=e=>s()),onEdit:s,onDelete:m,prop:{label:"showName",value:"variableName"}},null,8,["data"]))}});const m=s;var p=m},42029:function(e,l,a){a.d(l,{A:function(){return m}});var t=a(21929),i=(a(97042),a(98421),a(14022)),n=(a(72343),a(32465),a(3740)),o=(a(42899),a(56768)),d=a(90144),u=a(45130),r=(0,o.pM)({__name:"index",props:{fieldName:{default:"rowTotalSetting"}},setup(e){const l=e,a=(0,o.WQ)("formConfig",()=>(console.error("PivotTableTotalSetting: formConfig not injected"),{})),r=(0,o.EW)(()=>a().currentWidget),s=(0,o.EW)(()=>{let e=(r.value||{}).props;return e?e[l.fieldName]:{}});return(e,l)=>{const a=n.qi,r=t.xE,m=i.WK,p=t.US;return(0,d.R1)(s)?((0,o.uX)(),(0,o.Wv)(p,{key:0,"label-position":"top",size:"default",style:{padding:"10px 16px 0"},onSubmit:l[2]||(l[2]=(0,u.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(r,{class:"view-attribute-item",label:"是否显示"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{modelValue:(0,d.R1)(s).show,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(s).show=e)},null,8,["modelValue"])]),_:1}),(0,o.bF)(r,{class:"view-attribute-item",label:"别名"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:(0,d.R1)(s).showName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(s).showName=e),disabled:!(0,d.R1)(s).show},null,8,["modelValue","disabled"])]),_:1})]),_:1})):(0,o.Q3)("",!0)}}});const s=r;var m=s},43144:function(e,l,a){a.r(l),a.d(l,{default:function(){return _}});var t=a(25136),i=(a(97042),a(69957),a(21929)),n=(a(98421),a(65451)),o=(a(63390),a(12687)),d=(a(31112),a(85415)),u=(a(22243),a(7409),a(76408)),r=(a(87535),a(32465),a(14022)),s=(a(72343),a(18111),a(22489),a(56768)),m=a(90144),p=a(45130),c=a(24232),b=a(26695),v=a(36525),g=a(21016),f=a(36947),y=a(46509),R=a(71066),k=a(82572);const h={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var F=(0,s.pM)({__name:"editOnlineForm",props:{pageId:{},pageType:{},datasourceTableList:{},datasourceId:{},form:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,k.l5)(),a=e,{getFormConfig:F}=(0,y.U)(),{thirdParams:T,onCloseThirdDialog:_}=(0,R.P)(a),C=(0,s.EW)(()=>l.defaultFormItemSize||T.value.defaultFormItemSize?.value),I=(0,m.KR)({formId:void 0,formCode:void 0,formName:void 0,formKind:v.SysOnlineFormKind.PAGE,formType:void 0,masterTableId:void 0,widgetJson:void 0}),S={formCode:[{required:!0,message:"表单编码不能为空",trigger:"blur"},{type:"string",pattern:/^[A-Za-z0-9]+$/,message:"表单编码只允许输入字母和数字",trigger:"blur"}],formName:[{required:!0,message:"表单名称不能为空",trigger:"blur"}],masterTableId:[{required:!0,message:"请选择表单数据",trigger:"blur"}]},w=(0,s.EW)(()=>g.SysOnlineFormType.getList().filter(e=>e.id===g.SysOnlineFormType.FLOW?O.value.pageType===v.SysOnlinePageType.FLOW:e.id===g.SysOnlineFormType.QUERY||e.id===g.SysOnlineFormType.ADVANCE_QUERY||e.id===g.SysOnlineFormType.GROUP_QUERY?O.value.pageType!==v.SysOnlinePageType.FLOW:e.id===g.SysOnlineFormType.WORK_ORDER?O.value.pageType===v.SysOnlinePageType.FLOW:e.id!==g.SysOnlineFormType.REPORT)),W=(0,s.EW)(()=>O.value.datasourceTableList.filter(e=>{switch(I.value.formType){case g.SysOnlineFormType.FLOW:case g.SysOnlineFormType.WORK_ORDER:return null==e.relationType;case g.SysOnlineFormType.FORM:return O.value.pageType===v.SysOnlinePageType.FLOW?e.relationType===v.SysOnlineRelationType.ONE_TO_MANY:null==e.relationType||e.relationType===v.SysOnlineRelationType.ONE_TO_MANY;case g.SysOnlineFormType.QUERY:case g.SysOnlineFormType.ADVANCE_QUERY:case g.SysOnlineFormType.GROUP_QUERY:return null==e.relationType||e.relationType===v.SysOnlineRelationType.ONE_TO_MANY;case g.SysOnlineFormType.ONE_TO_ONE_QUERY:return e.relationType===v.SysOnlineRelationType.ONE_TO_ONE;default:return!1}})),O=(0,s.EW)(()=>({pageId:a.pageId||T.value.pageId,pageType:a.pageType||T.value.pageType,datasourceTableList:a.datasourceTableList||T.value.datasourceTableList,datasourceId:a.datasourceId||T.value.datasourceId,form:a.form||T.value.form})),E=(0,s.EW)(()=>null!=O.value.form),V=()=>{a.dialog?a.dialog.cancel():_(!1)},L=()=>{let e={onlineFormDto:{...I.value,pageId:O.value.pageId,widgetJson:E.value?I.value.widgetJson:JSON.stringify(F(I.value.formType,a.pageType)),paramsJson:E.value?I.value.paramsJson:JSON.stringify([]),datasourceIdList:[O.value.datasourceId]}},l=E.value?f.k$.update(e):f.k$.add(e);l.then(e=>{b.nk.success("保存成功"),a.dialog?a.dialog.submit(e):_(!0)}).catch(e=>{console.warn(e)})},A=e=>{if(null==e)return"success";switch(e){case v.SysOnlineRelationType.ONE_TO_ONE:return"";case v.SysOnlineRelationType.ONE_TO_MANY:return"warning";default:return"info"}},x=e=>null==e?"数据主表":v.SysOnlineRelationType.getValue(e)||"未知类型",N=e=>{O.value.pageType===v.SysOnlinePageType.FLOW&&(I.value.formKind=e===g.SysOnlineFormType.FORM?v.SysOnlineFormKind.DIALOG:v.SysOnlineFormKind.PAGE)};return(0,s.sV)(()=>{E.value?I.value={...O.value.form}:I.value.formType=O.value.pageType===v.SysOnlinePageType.FLOW?g.SysOnlineFormType.FLOW:g.SysOnlineFormType.QUERY}),(e,l)=>{const a=r.WK,b=i.xE,v=u.uD,g=d.P9,f=d.AV,y=o.u,R=n.S2,k=i.US,F=t.S2;return(0,s.uX)(),(0,s.CE)("div",h,[(0,s.bF)(k,{ref:"form",model:(0,m.R1)(I),class:"full-width-input form-box",rules:S,style:{width:"100%"},"label-width":"100px",size:(0,m.R1)(C),"label-position":"right",onSubmit:l[4]||(l[4]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,s.bF)(R,{gutter:20},{default:(0,s.k6)(()=>[(0,s.bF)(v,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"表单编码",prop:"formCode"},{default:(0,s.k6)(()=>[(0,s.bF)(a,{class:"input-item",modelValue:(0,m.R1)(I).formCode,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,m.R1)(I).formCode=e),clearable:!0,placeholder:"表单编码"},null,8,["modelValue"])]),_:1})]),_:1}),(0,s.bF)(v,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"表单名称",prop:"formName"},{default:(0,s.k6)(()=>[(0,s.bF)(a,{class:"input-item",modelValue:(0,m.R1)(I).formName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,m.R1)(I).formName=e),clearable:!0,placeholder:"表单名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,s.bF)(v,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"表单类型",prop:"formType"},{default:(0,s.k6)(()=>[(0,s.bF)(f,{class:"input-item",modelValue:(0,m.R1)(I).formType,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,m.R1)(I).formType=e),placeholder:"表单类型",disabled:(0,m.R1)(E),onChange:N},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,m.R1)(w),e=>((0,s.uX)(),(0,s.Wv)(g,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,s.bF)(v,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"表单数据",prop:"masterTableId"},{default:(0,s.k6)(()=>[(0,s.bF)(f,{class:"input-item",modelValue:(0,m.R1)(I).masterTableId,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,m.R1)(I).masterTableId=e),clearable:!0,placeholder:"表单数据",disabled:(0,m.R1)(E)},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,m.R1)(W),e=>((0,s.uX)(),(0,s.Wv)(g,{key:e.tableId,value:e.tableId,label:e.tableName},{default:(0,s.k6)(()=>[(0,s.bF)(R,{type:"flex",justify:"space-between",align:"middle"},{default:(0,s.k6)(()=>[(0,s.Lk)("span",null,(0,c.v_)(e.tableName),1),(0,s.bF)(y,{size:(0,m.R1)(C),type:A(e.relationType),effect:"dark",style:{"margin-left":"30px"}},{default:(0,s.k6)(()=>[(0,s.eW)((0,c.v_)(x(e.relationType)),1)]),_:2},1032,["size","type"])]),_:2},1024)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,s.bF)(R,{class:"menu-box"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(R,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,s.k6)(()=>[(0,s.bF)(F,{size:(0,m.R1)(C),plain:!0,onClick:V},{default:(0,s.k6)(()=>l[6]||(l[6]=[(0,s.eW)(" 取消 ")])),_:1,__:[6]},8,["size"]),(0,s.bF)(F,{type:"primary",size:(0,m.R1)(C),onClick:l[5]||(l[5]=e=>L())},{default:(0,s.k6)(()=>l[7]||(l[7]=[(0,s.eW)(" 保存 ")])),_:1,__:[7]},8,["size"])]),_:1})]),_:1})]),_:1})])}}});const T=F;var _=T},50380:function(e,l,a){a.r(l),a.d(l,{default:function(){return h}});var t=a(25136),i=(a(97042),a(69957),a(21929)),n=(a(98421),a(65451)),o=(a(63390),a(14022)),d=(a(72343),a(18888)),u=(a(3172),a(76408)),r=(a(87535),a(32465),a(85415)),s=(a(22243),a(7409),a(18111),a(22489),a(61701),a(56768)),m=a(90144),p=a(45130),c=a(26695),b=a(78430),v=a(36525),g=a(71066),f=a(82572);const y={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var R=(0,s.pM)({__name:"editDictParamValue",props:{rowData:{},paramList:{},columnList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,f.l5)(),a={...b.A},R=e,k=(0,s.EW)(()=>l.defaultFormItemSize||h.value.defaultFormItemSize?.value),{thirdParams:h,onCloseThirdDialog:F}=(0,g.P)(R),T=(0,m.KR)(),_=(0,m.KR)({dictParamName:void 0,dictValue:void 0,dictValueType:void 0}),C={label:"name",value:"id"},I=(0,m.KR)([]),S={dictParamName:[{required:!0,message:"请选择参数",trigger:"blur"}],dictValueType:[{required:!0,message:"请选择参数值类型",trigger:"blur"}],dictValue:[{required:!0,message:"请选择参数值",trigger:"blur"}]},w=(0,s.EW)(()=>({rowData:R.rowData||h.value.rowData,paramList:R.paramList||h.value.paramList,columnList:R.columnList||h.value.columnList})),W=()=>{R.dialog?R.dialog.cancel():F(!1)},O=()=>{T.value.validate(e=>{e&&(_.value.dictValueType!==v.SysOnlineParamValueType.STATIC_DICT||2===_.value.dictValue.length?R.dialog?R.dialog.submit(_.value):F(!0,w.value.rowData,_.value):c.nk.error("静态字典类型的参数值必须选择静态字典的值！"))})},E=()=>{_.value.dictValue=void 0,T.value.clearValidate()},V=()=>{const e=a;I.value=Object.keys(e).map(l=>{if("DictionaryBase"===l)return;let a=e[l];return{id:l,name:a.showName,children:a.getList()}}).filter(e=>!!e)};return(0,s.sV)(()=>{_.value={..._.value,...w.value.rowData},V()}),(e,l)=>{const a=r.P9,c=r.AV,b=i.xE,g=u.uD,f=d._m,R=o.WK,h=n.S2,F=i.US,V=t.S2;return(0,s.uX)(),(0,s.CE)("div",y,[(0,s.bF)(F,{ref_key:"form",ref:T,model:(0,m.R1)(_),class:"full-width-input form-box",rules:S,"label-width":"100px",size:(0,m.R1)(k),"label-position":"right",onSubmit:l[5]||(l[5]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,s.bF)(h,null,{default:(0,s.k6)(()=>[(0,s.bF)(g,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"参数名称",prop:"dictParamName"},{default:(0,s.k6)(()=>[(0,s.bF)(c,{modelValue:(0,m.R1)(_).dictParamName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,m.R1)(_).dictParamName=e),placeholder:"",disabled:null!=e.rowData},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,m.R1)(w).paramList,e=>((0,s.uX)(),(0,s.Wv)(a,{key:e.dictParamName,label:e.dictParamName,value:e.dictParamName},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,s.bF)(g,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"参数值类型",prop:"dictValueType"},{default:(0,s.k6)(()=>[(0,s.bF)(c,{class:"input-item",modelValue:(0,m.R1)(_).dictValueType,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,m.R1)(_).dictValueType=e),clearable:!0,placeholder:"参数值类型",onChange:E},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,m.R1)(v.SysOnlineParamValueType).getList(),e=>((0,s.uX)(),(0,s.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,m.R1)(_).dictValueType===(0,m.R1)(v.SysOnlineParamValueType).TABLE_COLUMN?((0,s.uX)(),(0,s.Wv)(g,{key:0,span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"参数值",prop:"dictValue"},{default:(0,s.k6)(()=>[(0,s.bF)(c,{class:"input-item",modelValue:(0,m.R1)(_).dictValue,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,m.R1)(_).dictValue=e),key:"TABLE_COLUMN",clearable:!0,placeholder:"参数值"},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,m.R1)(w).columnList,e=>((0,s.uX)(),(0,s.Wv)(a,{key:e.columnId,label:e.objectFieldName,value:e.columnId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,s.Q3)("",!0),(0,m.R1)(_).dictValueType===(0,m.R1)(v.SysOnlineParamValueType).STATIC_DICT?((0,s.uX)(),(0,s.Wv)(g,{key:1,span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"参数值",prop:"dictValue"},{default:(0,s.k6)(()=>[(0,s.bF)(f,{modelValue:(0,m.R1)(_).dictValue,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,m.R1)(_).dictValue=e),options:(0,m.R1)(I),props:C},null,8,["modelValue","options"])]),_:1})]),_:1})):(0,s.Q3)("",!0),(0,m.R1)(_).dictValueType===(0,m.R1)(v.SysOnlineParamValueType).INPUT_VALUE?((0,s.uX)(),(0,s.Wv)(g,{key:2,span:24},{default:(0,s.k6)(()=>[(0,s.bF)(b,{label:"参数值",prop:"dictValue"},{default:(0,s.k6)(()=>[(0,s.bF)(R,{modelValue:(0,m.R1)(_).dictValue,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,m.R1)(_).dictValue=e),placeholder:"请输入参数值",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):(0,s.Q3)("",!0)]),_:1})]),_:1},8,["model","size"]),(0,s.bF)(h,{class:"no-scroll menu-box",type:"flex",justify:"end",style:{"margin-top":"15px"}},{default:(0,s.k6)(()=>[(0,s.bF)(V,{size:(0,m.R1)(k),plain:!0,onClick:W},{default:(0,s.k6)(()=>l[6]||(l[6]=[(0,s.eW)(" 取消 ")])),_:1,__:[6]},8,["size"]),(0,s.bF)(V,{type:"primary",size:(0,m.R1)(k),onClick:O},{default:(0,s.k6)(()=>l[7]||(l[7]=[(0,s.eW)(" 保存 ")])),_:1,__:[7]},8,["size"])]),_:1})])}}});const k=R;var h=k},50922:function(e,l,a){a.r(l),a.d(l,{default:function(){return C}});var t=a(65451),i=(a(97042),a(63390),a(25136)),n=(a(69957),a(21929)),o=(a(98421),a(77649)),d=(a(87603),a(17851)),u=(a(68489),a(20709),a(85415)),r=(a(22243),a(7409),a(14022)),s=(a(72343),a(3740)),m=(a(42899),a(32465),a(12687)),p=(a(31112),a(18111),a(22489),a(56768)),c=a(90144),b=a(45130),v=a(24232),g=a(26695),f=a(36947),y=a(36525),R=a(71066),k=a(82572);const h={class:"form-single-fragment third-party-dlg",style:{position:"relative"}},F=["title"];var T=(0,p.pM)({__name:"editTableColumn",props:{rowData:{},isMasterTable:{type:Boolean,default:!1},dictList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,k.l5)(),a=e,T=(0,p.EW)(()=>l.defaultFormItemSize||_.value.defaultFormItemSize?.value),{thirdParams:_,onCloseThirdDialog:C}=(0,R.P)(a),I=(0,c.KR)(!1),S=(0,c.KR)({}),w={},W=(0,p.EW)(()=>({rowData:a.rowData||_.value.rowData,isMasterTable:a.isMasterTable||_.value.isMasterTable,dictList:a.dictList||_.value.dictList})),O=(0,p.EW)(()=>y.SysOnlineFieldKind.getList().filter(e=>!!W.value.isMasterTable||e.id!==y.SysOnlineFieldKind.FLOW_STATUS)),E=()=>{a.dialog?a.dialog.cancel():C(!1)},V=()=>{if(S.value.encodedRule.calculateWhenView=S.value.fieldKind===y.SysOnlineFieldKind.AUTO_CODE,S.value.encodedRule.calculateWhenView){if(null==S.value.encodedRule.prefix||""===S.value.encodedRule.prefix)return g.nk.error("自动编码前缀不能为空！"),Promise.reject();if(null==S.value.encodedRule.precisionTo||""===S.value.encodedRule.precisionTo)return g.nk.error("自动编码精度类型！"),Promise.reject();if(null==S.value.encodedRule.idWidth||S.value.encodedRule.idWidth<=0)return g.nk.error("自动编码编号长度不能小于1！"),Promise.reject()}let e={onlineColumnDto:{...S.value,dictId:"Boolean"===S.value.objectFieldType?void 0:S.value.dictId,uploadFileSystemType:S.value.uploadFileSystemType||0,encodedRule:JSON.stringify(S.value.encodedRule),nullable:!S.value.required}};f.aq.update(e).then(()=>{I.value=!1,g.nk.success("保存成功！"),a.dialog?a.dialog.submit(e.onlineColumnDto):C(!0)}).catch(e=>{console.warn(e)})},L=e=>{switch(e.id){case y.SysOnlineFieldKind.CREATE_TIME:case y.SysOnlineFieldKind.UPDATE_TIME:return"Date"!==S.value.objectFieldType;case y.SysOnlineFieldKind.UPLOAD:case y.SysOnlineFieldKind.UPLOAD_IMAGE:case y.SysOnlineFieldKind.RICH_TEXT:case y.SysOnlineFieldKind.AUTO_CODE:return"String"!==S.value.objectFieldType;case y.SysOnlineFieldKind.LOGIC_DELETE:case y.SysOnlineFieldKind.FLOW_STATUS:return"Integer"!==S.value.objectFieldType;default:return!1}},A=e=>{null!=e&&""!==e||S.value.filterType!==y.SysOnlineColumnFilterType.MULTI_SELECT_FILTER||(S.value.filterType=y.SysOnlineColumnFilterType.NONE)};return(0,p.sV)(()=>{S.value={...W.value.rowData,encodedRule:W.value.rowData.encodedRule?JSON.parse(W.value.rowData.encodedRule):{}}}),(e,l)=>{const a=m.u,g=n.xE,f=s.qi,R=r.WK,k=u.P9,_=u.AV,C=d.Zh,x=d.MQ,N=o.lq,D=n.US,U=i.S2,P=t.S2;return(0,p.uX)(),(0,p.CE)("div",h,[(0,c.R1)(W).rowData?((0,p.uX)(),(0,p.Wv)(D,{key:0,ref:"form",model:(0,c.R1)(S),class:"full-width-input form-box",rules:w,style:{width:"100%",height:"450px"},"label-width":"120px",size:(0,c.R1)(T),"label-position":"right",onSubmit:l[18]||(l[18]=(0,b.D$)(()=>{},["prevent"]))},{default:(0,p.k6)(()=>[(0,p.bF)(g,{label:"字段名称"},{default:(0,p.k6)(()=>[(0,p.Lk)("span",{title:(0,c.R1)(S).columnComment},(0,v.v_)((0,c.R1)(S).columnName),9,F),(0,c.R1)(S).primaryKey?((0,p.uX)(),(0,p.Wv)(a,{key:0,size:(0,c.R1)(T),type:"warning",style:{"margin-left":"20px"}},{default:(0,p.k6)(()=>l[19]||(l[19]=[(0,p.eW)("主键")])),_:1,__:[19]},8,["size"])):(0,p.Q3)("",!0)]),_:1}),(0,p.bF)(g,{label:"字段类型"},{default:(0,p.k6)(()=>[(0,p.Lk)("span",null,(0,v.v_)((0,c.R1)(S).fullColumnType),1),(0,p.bF)(a,{size:(0,c.R1)(T),type:"success",effect:"dark",style:{"margin-left":"10px"}},{default:(0,p.k6)(()=>[(0,p.eW)((0,v.v_)((0,c.R1)(S).objectFieldType),1)]),_:1},8,["size"])]),_:1}),(0,p.bF)(g,{label:"是否必填"},{default:(0,p.k6)(()=>[(0,p.bF)(f,{modelValue:(0,c.R1)(S).required,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.R1)(S).required=e)},null,8,["modelValue"])]),_:1}),(0,p.bF)(g,{label:"显示名称"},{default:(0,p.k6)(()=>[(0,p.bF)(R,{modelValue:(0,c.R1)(S).columnComment,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.R1)(S).columnComment=e),style:{width:"100%"},onChange:l[2]||(l[2]=e=>I.value=!0),placeholder:"字段在表单上的显示名称"},null,8,["modelValue"])]),_:1}),(0,p.bF)(g,{label:"字典数据"},{default:(0,p.k6)(()=>[(0,p.bF)(_,{modelValue:(0,c.R1)(S).dictId,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,c.R1)(S).dictId=e),placeholder:"选择字段绑定的字典",style:{width:"100%"},clearable:"",filterable:"",disabled:"Boolean"===(0,c.R1)(S).objectFieldType,onChange:A},{default:(0,p.k6)(()=>[((0,p.uX)(!0),(0,p.CE)(p.FK,null,(0,p.pI)((0,c.R1)(W).dictList,e=>((0,p.uX)(),(0,p.Wv)(k,{key:e.dictId,value:e.dictId,label:e.dictName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),(0,p.bF)(g,{label:"过滤支持"},{default:(0,p.k6)(()=>[(0,p.bF)(x,{modelValue:(0,c.R1)(S).filterType,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,c.R1)(S).filterType=e),onChange:l[5]||(l[5]=e=>I.value=!0)},{default:(0,p.k6)(()=>[((0,p.uX)(!0),(0,p.CE)(p.FK,null,(0,p.pI)((0,c.R1)(y.SysOnlineColumnFilterType).getList(),e=>((0,p.uX)(),(0,p.Wv)(C,{key:e.id,value:e.id,disabled:e.id===(0,c.R1)(y.SysOnlineColumnFilterType).MULTI_SELECT_FILTER&&(null==(0,c.R1)(S).dictId||""===(0,c.R1)(S).dictId)},{default:(0,p.k6)(()=>[(0,p.eW)((0,v.v_)((0,c.R1)(y.SysOnlineColumnFilterType).getValue(e.id)),1)]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,p.bF)(g,{label:"字段类别"},{default:(0,p.k6)(()=>[(0,p.bF)(_,{modelValue:(0,c.R1)(S).fieldKind,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,c.R1)(S).fieldKind=e),clearable:"",placeholder:"字段的业务类别",onChange:l[7]||(l[7]=e=>I.value=!0),style:{width:"100%"}},{default:(0,p.k6)(()=>[((0,p.uX)(!0),(0,p.CE)(p.FK,null,(0,p.pI)((0,c.R1)(O),e=>((0,p.uX)(),(0,p.Wv)(k,{key:e.id,label:e.name,value:e.id,disabled:L(e)},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,c.R1)(S).fieldKind===(0,c.R1)(y.SysOnlineFieldKind).UPLOAD||(0,c.R1)(S).fieldKind===(0,c.R1)(y.SysOnlineFieldKind).UPLOAD_IMAGE?((0,p.uX)(),(0,p.Wv)(g,{key:0,label:"存储类型"},{default:(0,p.k6)(()=>[(0,p.bF)(_,{modelValue:(0,c.R1)(S).uploadFileSystemType,"onUpdate:modelValue":l[8]||(l[8]=e=>(0,c.R1)(S).uploadFileSystemType=e),clearable:"",placeholder:"字段的业务类别",onChange:l[9]||(l[9]=e=>I.value=!0),style:{width:"100%"}},{default:(0,p.k6)(()=>[(0,p.bF)(k,{label:"本地存储",value:0}),(0,p.bF)(k,{label:"分布式存储",value:100})]),_:1},8,["modelValue"])]),_:1})):(0,p.Q3)("",!0),(0,c.R1)(S).fieldKind===(0,c.R1)(y.SysOnlineFieldKind).AUTO_CODE?((0,p.uX)(),(0,p.Wv)(g,{key:1,label:"编码规则"},{default:(0,p.k6)(()=>[(0,p.bF)(R,{modelValue:(0,c.R1)(S).encodedRule.prefix,"onUpdate:modelValue":l[10]||(l[10]=e=>(0,c.R1)(S).encodedRule.prefix=e),style:{width:"80px","margin-right":"5px"},placeholder:"前缀",onChange:l[11]||(l[11]=e=>I.value=!0)},null,8,["modelValue"]),(0,p.bF)(_,{modelValue:(0,c.R1)(S).encodedRule.precisionTo,"onUpdate:modelValue":l[12]||(l[12]=e=>(0,c.R1)(S).encodedRule.precisionTo=e),clearable:"",placeholder:"",onChange:l[13]||(l[13]=e=>I.value=!0),style:{width:"160px","margin-right":"5px"}},{default:(0,p.k6)(()=>[((0,p.uX)(!0),(0,p.CE)(p.FK,null,(0,p.pI)((0,c.R1)(y.SysAutoCodeType).getList(),e=>((0,p.uX)(),(0,p.Wv)(k,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),(0,p.bF)(R,{modelValue:(0,c.R1)(S).encodedRule.middle,"onUpdate:modelValue":l[14]||(l[14]=e=>(0,c.R1)(S).encodedRule.middle=e),style:{width:"80px","margin-right":"5px"},placeholder:"后缀",onChange:l[15]||(l[15]=e=>I.value=!0)},null,8,["modelValue"]),(0,p.bF)(N,{modelValue:(0,c.R1)(S).encodedRule.idWidth,"onUpdate:modelValue":l[16]||(l[16]=e=>(0,c.R1)(S).encodedRule.idWidth=e),style:{width:"100px"},placeholder:"序号宽度",controls:!1,min:1,onChange:l[17]||(l[17]=e=>I.value=!0)},null,8,["modelValue"])]),_:1})):(0,p.Q3)("",!0)]),_:1},8,["model","size"])):(0,p.Q3)("",!0),(0,p.bF)(P,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end"},{default:(0,p.k6)(()=>[(0,p.bF)(U,{size:(0,c.R1)(T),plain:!0,onClick:E},{default:(0,p.k6)(()=>l[20]||(l[20]=[(0,p.eW)(" 取消 ")])),_:1,__:[20]},8,["size"]),(0,p.bF)(U,{type:"primary",size:(0,c.R1)(T),onClick:V},{default:(0,p.k6)(()=>l[21]||(l[21]=[(0,p.eW)(" 保存 ")])),_:1,__:[21]},8,["size"])]),_:1})])}}});const _=T;var C=_},51216:function(e,l,a){a(97042),a(72343),a(69957)},52279:function(e,l,a){a.r(l),a.d(l,{default:function(){return g}});var t=a(25136),i=(a(97042),a(69957),a(21929)),n=(a(98421),a(65451)),o=(a(63390),a(76408)),d=(a(87535),a(32465),a(14022)),u=(a(72343),a(56768)),r=a(90144),s=a(45130),m=a(71066),p=a(82572);const c={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var b=(0,u.pM)({__name:"editOnlineTabPanel",props:{rowData:{},tabPanelList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,p.l5)(),a=e,b=(0,u.EW)(()=>l.defaultFormItemSize||v.value.defaultFormItemSize?.value),{thirdParams:v,onCloseThirdDialog:g}=(0,m.P)(a),f=(0,r.KR)(),y=(0,r.KR)({showName:void 0,variableName:void 0});const R=(e,l,a)=>{Array.isArray(h.value.tabPanelList)&&-1!==h.value.tabPanelList.indexOf(l)?a(new Error("标签页标识不能重复")):a()},k={showName:[{required:!0,message:"标签页显示名不能为空",trigger:"blur"}],variableName:[{required:!0,message:"标签页标识不能为空",trigger:"blur"},{validator:R,trigger:"blur"}]},h=(0,u.EW)(()=>({rowData:a.rowData||v.value.rowData,tabPanelList:a.tabPanelList||v.value.tabPanelList})),F=()=>{a.dialog?a.dialog.cancel():g(!1)},T=()=>{f.value.validate(e=>{e&&(a.dialog?a.dialog.submit(y.value):g(!0,h.value.rowData,y.value))})};return(0,u.sV)(()=>{null!=h.value.rowData&&(y.value={...y.value,...h.value.rowData})}),(e,l)=>{const a=d.WK,m=i.xE,p=o.uD,v=n.S2,g=i.US,R=t.S2;return(0,u.uX)(),(0,u.CE)("div",c,[(0,u.bF)(g,{ref_key:"form",ref:f,model:(0,r.R1)(y),class:"full-width-input form-box",rules:k,style:{width:"100%"},"label-width":"100px",size:(0,r.R1)(b),"label-position":"right",onSubmit:l[2]||(l[2]=(0,s.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(v,null,{default:(0,u.k6)(()=>[(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"标签显示名",prop:"showName"},{default:(0,u.k6)(()=>[(0,u.bF)(a,{modelValue:(0,r.R1)(y).showName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,r.R1)(y).showName=e),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"标签标识",prop:"variableName"},{default:(0,u.k6)(()=>[(0,u.bF)(a,{modelValue:(0,r.R1)(y).variableName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,r.R1)(y).variableName=e),clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(v,{class:"no-scroll menu-box",type:"flex",justify:"end"},{default:(0,u.k6)(()=>[(0,u.bF)(R,{size:(0,r.R1)(b),plain:!0,onClick:F},{default:(0,u.k6)(()=>l[3]||(l[3]=[(0,u.eW)(" 取消 ")])),_:1,__:[3]},8,["size"]),(0,u.bF)(R,{type:"primary",size:(0,r.R1)(b),onClick:T},{default:(0,u.k6)(()=>l[4]||(l[4]=[(0,u.eW)(" 保存 ")])),_:1,__:[4]},8,["size"])]),_:1})])}}});const v=b;var g=v},57632:function(e,l,a){a.d(l,{A:function(){return u}});var t=a(56768),i=a(24232),n=(0,t.pM)({__name:"index",props:{value:{},backgroundColor:{default:"#F6F7F9"},textColor:{default:"#999999"}},emits:["update:value"],setup(e,{emit:l}){const a=l,n=e,o=(0,t.EW)(()=>({activeStep:n.value,backgroundColor:n.backgroundColor,textColor:n.textColor}));(0,t.Gt)("stepBarInfo",o);const d=e=>{a("update:value",e)};return(0,t.Gt)("setActiveStep",d),(e,l)=>((0,t.uX)(),(0,t.CE)("div",{class:"step-bar",style:(0,i.Tr)({background:e.backgroundColor})},[(0,t.RG)(e.$slots,"default")],4))}}),o=a(71241);const d=(0,o.A)(n,[["__scopeId","data-v-1f1ad451"]]);var u=d},67192:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAdJJREFUWEftmItRwkAQhrkOsAKxAqECSQl2ECsQK1ArUCuQEuxArEDoIHRAB/H/cc9ZkkzGe5hD5nbmJpPjsvexr8vGjI5czJHzjTJgqIdaFqzr+gpKpxjjUOWOz++wfm2M+dDP/QACjFCvAueoO+ryNbTdAJTX7xgUuM+o24QrmxHSAhKOFqRsMd4waPKhpcSG57Ip3T0zsN4cE+8WDpOToansfmBh3NO1FrIg4AITT7LoBYC8TybgecbmtwJwR8AH3NzLxCMAeZ9MWjyxACVUWAUYuwX+qFcM/yWg9gTLxNLHDUMBeodKMKC4soKFKm2hiKFymBMuihsZdqbjzEVPn+uDLIiHV1DOs5rCROD9XjLgb+rgyVpQjjDWyAnGdTPBepPNJXZ8LYjnSkAQkNJbgpIkiaMRgsqMVxZnQFXrsgVPPkn0227zLNalZN/wqNBgv2Obst5XsSALypk7x7X1NiO/EWTXVYixMYv0WIPrAq3+jH+Z6VIYe67Lgrpp8n7RjAXa1TTRZbbtpOsuYm3mqkfObMYqw4FS2MadAX0pkxWuKRt3C7eBsab/49OHysClsqSrh2Kt30BRefDxSGuWpijl57eV5slfWEP9ni0YasEvJ/jsUJWygIoAAAAASUVORK5CYII="},74097:function(e,l,a){a.r(l),a.d(l,{default:function(){return ut}});var t=a(54880),i=(a(97042),a(51582),a(60713),a(69225),a(65451)),n=(a(63390),a(25136)),o=(a(69957),a(44114),a(18111),a(7588),a(61701),a(56768)),d=a(90144),u=a(24232),r=a(26695),s=a(164),m=a(31372),p=a(36525),c=a(57632),b=a(85285),v=a(36947),g=a(46509),f=a(71066),y=a(82572),R=a(21929),k=(a(98421),a(14022)),h=(a(72343),a(76408)),F=(a(87535),a(32465),a(85415)),T=(a(22243),a(7409),a(45130)),_=(0,o.pM)({__name:"index",props:{modelValue:{}},setup(e,{expose:l}){const a=e,t=(0,d.KR)(),i=(0,d.KR)({pageId:void 0,pageCode:void 0,pageName:void 0,published:!1,pageType:p.SysOnlinePageType.BIZ,status:p.SysOnlinePageStatus.BASIC,extraJson:{extendClass:void 0}}),n=(0,d.KR)(!1),u={pageCode:[{required:!0,message:"页面编码不能为空！",trigger:"blur"},{type:"string",pattern:/^[A-Za-z0-9]+$/,message:"页面编码只允许输入字母和数字",trigger:"blur"}],pageName:[{required:!0,message:"页面名称不能为空！",trigger:"blur"}]},s=(0,o.EW)(()=>!!i.value.pageId);(0,o.wB)(()=>a.modelValue,(e,l)=>{e!=l&&(i.value={...i.value,...e})},{deep:!0});const m=e=>{let l={onlinePageDto:{...i.value,extraJson:JSON.stringify(i.value.extraJson||{}),status:e,published:!1}};return s.value?v.Pr.update(l):v.Pr.add(l)},c=()=>new Promise((e,l)=>{t.value.validate(a=>{a&&n.value?m(p.SysOnlinePageStatus.DATASOURCE).then(l=>{r.nk.success("保存页面基础信息成功！"),s.value||(i.value.pageId=l.data),n.value=!1,e(i.value)}).catch(e=>{l(e)}):a?e(i.value):l()})});return l({save:c}),(0,o.sV)(()=>{i.value={...i.value,...a.modelValue}}),(e,l)=>{const a=F.P9,r=F.AV,m=R.xE,c=h.uD,b=k.WK,v=R.US;return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(v,{ref_key:"form",ref:t,class:"full-width-input",size:"default",model:(0,d.R1)(i),rules:u,"label-position":"right","label-width":"90px",onSubmit:l[7]||(l[7]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(c,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"页面类型"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{modelValue:(0,d.R1)(i).pageType,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(i).pageType=e),disabled:(0,d.R1)(s)},{default:(0,o.k6)(()=>[(0,o.bF)(a,{value:(0,d.R1)(p.SysOnlinePageType).BIZ,label:(0,d.R1)(p.SysOnlinePageType).getValue((0,d.R1)(p.SysOnlinePageType).BIZ)},null,8,["value","label"]),(0,o.bF)(a,{value:(0,d.R1)(p.SysOnlinePageType).FLOW,label:(0,d.R1)(p.SysOnlinePageType).getValue((0,d.R1)(p.SysOnlinePageType).FLOW)},null,8,["value","label"])]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,o.bF)(c,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"页面编码",prop:"pageCode"},{default:(0,o.k6)(()=>[(0,o.bF)(b,{modelValue:(0,d.R1)(i).pageCode,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(i).pageCode=e),disabled:(0,d.R1)(s),onChange:l[2]||(l[2]=e=>n.value=!0)},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,o.bF)(c,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"页面名称",prop:"pageName"},{default:(0,o.k6)(()=>[(0,o.bF)(b,{modelValue:(0,d.R1)(i).pageName,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(i).pageName=e),onChange:l[4]||(l[4]=e=>n.value=!0)},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(c,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"后台扩展类"},{default:(0,o.k6)(()=>[(0,o.bF)(b,{modelValue:(0,d.R1)(i).extraJson.extendClass,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.R1)(i).extraJson.extendClass=e),placeholder:"请输入包含包名的完整类名称",onChange:l[6]||(l[6]=e=>n.value=!0)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])])}}});const C=_;var I=C,S=a(12687),w=(a(31112),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(61473)),W=a(57477),O=a(99540),E=a(27007),V=a(18888);a(3172);const L={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var A=(0,o.pM)({__name:"editOnlinePageDatasource",props:{pageId:{},datasourceId:{},dblinkInfo:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,y.l5)(),a=e,{thirdParams:t,onCloseThirdDialog:u}=(0,f.P)(a),s=(0,o.EW)(()=>l.defaultFormItemSize),m=(0,d.KR)(),p=(0,d.KR)({datasourceId:"",datasourceName:"",variableName:"",dblinkId:"",masterTableId:""}),c={datasourceName:[{required:!0,message:"数据源名称不能为空！",trigger:"blur"}],variableName:[{required:!0,message:"数据源标识不能为空！",trigger:"blur"},{type:"string",pattern:/^[a-z][a-zA-Z]+$/,message:"数据源标识必须是小驼峰命名",trigger:"blur"}],masterTableId:[{required:!0,message:"数据源主表不能为空！",trigger:"blur"}]},b=(0,d.KR)([]),g=(0,d.KR)({}),F=(0,o.EW)(()=>({pageId:a.pageId||t.value.pageId,datasourceId:a.datasourceId||t.value.datasourceId,dblinkInfo:a.dblinkInfo||t.value.dblinkInfo})),_=(0,o.EW)(()=>!!F.value.datasourceId),C=(e,l)=>{const{level:a}=e;0==a?(0,o.dY)(()=>{v.yu.list({}).then(e=>{console.log(e),l(e.data.dataList.map(e=>({value:e.dblinkId,label:e.dblinkName,leaf:!1})))}).catch(l=>{console.warn(l),e.loaded=!1,e.loading=!1})}):1==a&&v.yu.listDblinkTables({dblinkId:e.value}).then(e=>{l(e.data.map(e=>({value:e.tableName,label:e.tableName,leaf:!0})))}).catch(l=>{console.warn(l),e.loaded=!1,e.loading=!1})},I={lazy:!0,lazyLoad:C},S=e=>{console.log("change......",e),Array.isArray(e)&&e.length>0&&(p.value.dblinkId=e[0],p.value.masterTableId=e[1])},w=()=>{a.dialog?a.dialog.cancel():u(!1)},W=()=>{m.value.validate(e=>{if(!e)return;let l={pageId:F.value.pageId,onlineDatasourceDto:{datasourceId:p.value.datasourceId,datasourceName:p.value.datasourceName,variableName:p.value.variableName,dblinkId:p.value.dblinkId,masterTableName:p.value.masterTableId,masterTableId:_.value?p.value.masterTableId:void 0}},i=_.value?v.hp.update(l):v.hp.add(l);i.then(e=>{r.nk.success("保存成功"),a.dialog?a.dialog.submit(e):u(!0,t.value.rowData,e)}).catch(e=>{console.warn(e)})})};return(0,o.sV)(()=>{null!=F.value.datasourceId&&v.hp.view({datasourceId:F.value.datasourceId}).then(e=>{p.value.datasourceId=e.data.datasourceId,p.value.datasourceName=e.data.datasourceName,p.value.dblinkId=e.data.dblinkId,p.value.masterTableId=e.data.masterTableId,p.value.variableName=e.data.variableName,b.value=[p.value.dblinkId,p.value.masterTableId],g.value=e.data.masterTableIdDictMap}).catch(e=>{console.warn(e)})}),(e,l)=>{const a=k.WK,t=R.xE,u=h.uD,r=V._m,v=i.S2,f=R.US,y=n.S2;return(0,o.uX)(),(0,o.CE)("div",L,[(0,o.bF)(f,{ref_key:"form",ref:m,model:(0,d.R1)(p),class:"full-width-input form-box",rules:c,style:{width:"100%"},"label-width":"100px",size:s.value,"label-position":"right",onSubmit:l[4]||(l[4]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(v,{gutter:20},{default:(0,o.k6)(()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(t,{label:"数据源名称",prop:"datasourceName"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{class:"input-item",modelValue:(0,d.R1)(p).datasourceName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(p).datasourceName=e),clearable:!0,placeholder:"数据源名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(u,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(t,{label:"数据源标识",prop:"variableName"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{class:"input-item",modelValue:(0,d.R1)(p).variableName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(p).variableName=e),clearable:!0,placeholder:"数据源标识"},null,8,["modelValue"])]),_:1})]),_:1}),_.value?((0,o.uX)(),(0,o.Wv)(u,{key:1,span:24},{default:(0,o.k6)(()=>[(0,o.bF)(t,{label:"数据源主表"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{class:"input-item",modelValue:(0,d.R1)(g).name,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(g).name=e),disabled:!0},null,8,["modelValue"])]),_:1})]),_:1})):((0,o.uX)(),(0,o.Wv)(u,{key:0,span:24},{default:(0,o.k6)(()=>[(0,o.bF)(t,{label:"数据源主表",prop:"masterTableId"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{modelValue:(0,d.R1)(b),"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.i9)(b)?b.value=e:null),filterable:"",disabled:_.value,props:I,onChange:S},null,8,["modelValue","disabled"])]),_:1})]),_:1}))]),_:1})]),_:1},8,["model","size"]),(0,o.bF)(v,{class:"menu-box"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{size:s.value,plain:!0,onClick:w},{default:(0,o.k6)(()=>l[6]||(l[6]=[(0,o.eW)(" 取消 ")])),_:1,__:[6]},8,["size"]),(0,o.bF)(y,{type:"primary",size:s.value,onClick:l[5]||(l[5]=e=>W())},{default:(0,o.k6)(()=>l[7]||(l[7]=[(0,o.eW)(" 保存 ")])),_:1,__:[7]},8,["size"])]),_:1})]),_:1})]),_:1})])}}});const x=A;var N=x,D=a(3740),U=(a(42899),a(22489),a(99080));const P={class:"form-single-fragment third-party-dlg",style:{position:"relative"}},K={style:{"margin-left":"30px"}},X={key:0,class:"warning-text",style:{"margin-left":"16px"}};var z=(0,o.pM)({__name:"editOnlinePageDatasourceRelation",props:{relationId:{},datasource:{},dblinkInfo:{},usedTableNameList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,y.l5)(),a=e,t=(0,o.EW)(()=>l.defaultFormItemSize),{thirdParams:s,onCloseThirdDialog:m}=(0,f.P)(a),c=(0,d.KR)(),b={relationName:[{required:!0,message:"请输入关联名称",trigger:"blur"}],variableName:[{required:!0,message:"请输入关联标识",trigger:"blur"},{type:"string",pattern:/^[a-z][a-zA-Z_]+$/,message:"数据源标识必须是小驼峰或者下划线命名",trigger:"blur"}]},g=(0,d.KR)(),_=(0,d.KR)({relationId:void 0,relationName:void 0,relationType:p.SysOnlineRelationType.ONE_TO_ONE,variableName:void 0,masterColumnId:void 0,slaveTableId:void 0,slaveColumnId:void 0,relationFilterSql:void 0,cascadeDelete:!1,leftJoin:!1}),C=(0,o.EW)(()=>({datasource:a.datasource||s.value.datasource,relationId:a.relationId||s.value.relationId,dblinkInfo:a.dblinkInfo||s.value.dblinkInfo,usedTableNameList:a.usedTableNameList||s.value.usedTableNameList})),I=(0,o.EW)(()=>!!C.value.relationId),S=(0,o.EW)(()=>C.value.datasource.validTableList),w=e=>new Promise((l,a)=>{if(null==e)return void l([]);let t={onlineColumnDtoFilter:{tableId:e}};v.aq.list(t).then(e=>{console.log("OnlineColumnController",e),l(e.data.dataList)}).catch(e=>{a(e)})}),W=()=>new Promise((e,l)=>{w(C.value.datasource.masterTableId).then(l=>{e({dataList:l})}).catch(e=>{l(e)})}),O={loadData:W},V=(0,d.Kh)((0,U.B)(O)),L=()=>Promise.resolve({dataList:S.value.filter(e=>null!=g.value&&g.value===e.name||e.name!==C.value.datasource.masterTableIdDictMap.name&&(null==C.value.usedTableNameList||-1===C.value.usedTableNameList.indexOf(e.name)))}),A={loadData:L},x=(0,d.Kh)((0,U.B)(A)),N=(e,l)=>new Promise((a,t)=>{let i={dblinkId:e,tableName:l};v.yu.listDblinkTableColumns(i).then(e=>{a(e.data)}).catch(e=>{t(e)})}),z=()=>new Promise((e,l)=>{let a=(0,E.PH)(C.value.datasource.validTableList,_.value.slaveTableId,"id");console.log("从表关联字段列表请求数据",a),null!=a?a.status===p.SysOnlinePageDatasourceFieldStatus.USED?w(a.id).then(l=>{e({dataList:l})}).catch(e=>{l(e)}):N(C.value.datasource.dblinkId,a.id).then(l=>{l.forEach(e=>{e.columnId=e.columnName}),e({dataList:l})}).catch(e=>{l(e)}):l()}),Q={loadData:z},B=(0,d.Kh)((0,U.B)(Q));(0,o.sV)(()=>{I.value&&v.PC.view({relationId:C.value.relationId}).then(e=>{g.value=e.data.slaveTable.tableName,_.value={...e.data},V.onVisibleChange(!0),x.onVisibleChange(!0),B.onVisibleChange(!0)}).catch(e=>{console.warn(e)})});const M=()=>{a.dialog?a.dialog.cancel():m(!1)},j=()=>{c.value.validate(e=>{if(!e)return;let l={onlineDatasourceRelationDto:{datasourceId:C.value.datasource.datasourceId,relationId:_.value.relationId,relationName:_.value.relationName,relationType:_.value.relationType,variableName:_.value.variableName,masterColumnId:_.value.masterColumnId,slaveTableId:I.value?_.value.slaveTableId:void 0,slaveTableName:I.value?void 0:_.value.slaveTableId,slaveColumnId:I.value?_.value.slaveColumnId:void 0,slaveColumnName:I.value?void 0:_.value.slaveColumnId,relationFilterSql:_.value.relationFilterSql,cascadeDelete:_.value.cascadeDelete,leftJoin:_.value.leftJoin}},t=I.value?v.PC.update(l):v.PC.add(l);t.then(e=>{r.nk.success("保存成功"),a.dialog?a.dialog.submit(e):m(!0)}).catch(e=>{console.warn(e)})})},Y=()=>{},q=()=>{_.value.slaveColumnId=null,_.value.relationFilterSql=void 0,_.value.leftJoin=!1,_.value.cascadeDelete=!1,B.refresh(!1)},J=()=>{if(!_.value.variableName){let e=(0,E.PH)(V.dropdownList,_.value.masterColumnId,"columnId"),l=(0,E.PH)(x.dropdownList,_.value.slaveTableId,"id"),a=(0,E.PH)(B.dropdownList,_.value.slaveColumnId,"columnId");e&&l&&a&&(_.value.variableName=e.columnName+"_"+l.name+"_"+a.columnName)}};return(0,o.wB)(()=>_.value.slaveColumnId,()=>{J()}),(e,l)=>{const a=k.WK,r=R.xE,s=h.uD,m=F.P9,v=F.AV,g=i.S2,f=D.qi,y=R.US,S=n.S2;return(0,o.uX)(),(0,o.CE)("div",P,[(0,o.bF)(y,{ref_key:"form",ref:c,model:(0,d.R1)(_),class:"full-width-input form-box",rules:b,style:{width:"100%"},"label-width":"100px",size:t.value,"label-position":"right",onSubmit:l[9]||(l[9]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(g,{gutter:20},{default:(0,o.k6)(()=>[(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"关联名称",prop:"relationName"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{class:"input-item",modelValue:(0,d.R1)(_).relationName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(_).relationName=e),clearable:!0},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"关联标识",prop:"variableName"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{class:"input-item",modelValue:(0,d.R1)(_).variableName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(_).variableName=e),clearable:!0},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"关联类型"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{class:"input-item",modelValue:(0,d.R1)(_).relationType,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(_).relationType=e),placeholder:"关联类型",disabled:I.value},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(p.SysOnlineRelationType).getList(),e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"关联主表"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{value:C.value.dblinkInfo.dblinkName+" / "+C.value.datasource.masterTableIdDictMap.name,readonly:""},null,8,["value"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"主表关联字段",prop:"masterColumnId"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{class:"input-item",modelValue:(0,d.R1)(_).masterColumnId,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(_).masterColumnId=e),clearable:!0,filterable:"",placeholder:"主表关联字段",loading:(0,d.R1)(V).loading,onVisibleChange:(0,d.R1)(V).onVisibleChange,onChange:Y},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(V).dropdownList,e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.columnId,value:e.columnId,label:e.columnName},{default:(0,o.k6)(()=>[(0,o.bF)(g,{type:"flex",justify:"space-between"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.columnName),1),(0,o.Lk)("span",K,(0,u.v_)(e.columnComment),1)]),_:2},1024)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"关联从表",prop:"slaveTableId"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{class:"input-item",modelValue:(0,d.R1)(_).slaveTableId,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.R1)(_).slaveTableId=e),clearable:!0,filterable:"",placeholder:"关联从表",loading:(0,d.R1)(x).loading,disabled:I.value,onVisibleChange:(0,d.R1)(x).onVisibleChange,onChange:q},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(x).dropdownList,e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.id,value:e.id,label:e.name},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","loading","disabled","onVisibleChange"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"从表关联字段",prop:"slaveColumnId"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{class:"input-item",modelValue:(0,d.R1)(_).slaveColumnId,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.R1)(_).slaveColumnId=e),clearable:!0,filterable:"",placeholder:"关联从表",loading:(0,d.R1)(B).loading,onVisibleChange:(0,d.R1)(B).onVisibleChange},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(B).dropdownList,e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.columnId,value:e.columnId,label:e.columnName},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.columnName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"是否级联删除"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:(0,d.R1)(_).cascadeDelete,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,d.R1)(_).cascadeDelete=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"是否左连接"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:(0,d.R1)(_).leftJoin,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,d.R1)(_).leftJoin=e),disabled:(0,d.R1)(_).relationType===(0,d.R1)(p.SysOnlineRelationType).ONE_TO_MANY},null,8,["modelValue","disabled"]),(0,d.R1)(_).relationType===(0,d.R1)(p.SysOnlineRelationType).ONE_TO_MANY?((0,o.uX)(),(0,o.CE)("span",X," 一对多关联只能为左链接 ")):(0,o.Q3)("",!0)]),_:1})]),_:1}),(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"关联过滤SQL"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{class:"input-item",modelValue:(0,d.R1)(_).relationFilterSql,"onUpdate:modelValue":l[8]||(l[8]=e=>(0,d.R1)(_).relationFilterSql=e),type:"textarea",style:{height:"80px"},clearable:!0,placeholder:"表关联过滤SQL"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,o.bF)(g,{class:"menu-box"},{default:(0,o.k6)(()=>[(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(g,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,o.k6)(()=>[(0,o.bF)(S,{size:t.value,plain:!0,onClick:M},{default:(0,o.k6)(()=>l[10]||(l[10]=[(0,o.eW)(" 取消 ")])),_:1,__:[10]},8,["size"]),(0,o.bF)(S,{type:"primary",size:t.value,onClick:j},{default:(0,o.k6)(()=>l[11]||(l[11]=[(0,o.eW)(" 保存 ")])),_:1,__:[11]},8,["size"])]),_:1})]),_:1})]),_:1})])}}}),Q=a(71241);const B=(0,Q.A)(z,[["__scopeId","data-v-d7d54cf4"]]);var M=B,j=a(68368),Y=(a(81208),a(47001),a(77649)),q=(a(87603),a(17851)),J=(a(68489),a(20709),a(2403)),G=(a(63266),a(72855)),H=(a(64491),a(72153),a(31328),a(21016));const Z={class:"form-single-fragment third-party-dlg",style:{position:"relative"}},$={style:{width:"100%"}};var ee=(0,o.pM)({__name:"setOnlineTableColumnRule",props:{column:{},columnRule:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,y.l5)(),a=e,t=(0,o.EW)(()=>l.defaultFormItemSize||m.value.defaultFormItemSize?.value),{thirdParams:m,onCloseThirdDialog:p}=(0,f.P)(a),c=(0,d.KR)(),b=(0,d.KR)(),g=(0,d.KR)(!1),_=(0,d.KR)(!1),C=(0,d.KR)({ruleId:void 0,message:void 0,min:void 0,max:void 0}),I=(0,d.KR)({ruleName:void 0,ruleType:H.SysOnlineRuleType.CUSTOM,pattern:void 0,builtin:!1}),S={ruleId:[{required:!0,message:"请选择验证规则",trigger:"blur"}],message:[{required:!0,message:"请输入校验错误信息",trigger:"blur"}],ruleName:[{required:!0,message:"规则名称不能为空",trigger:"blur"}],pattern:[{required:!0,message:"正则表达式不能为空",trigger:"blur"}]},w=(0,o.EW)(()=>({column:a.column||m.value.column,columnRule:a.columnRule||m.value.columnRule})),O=(0,o.EW)(()=>null!=w.value.columnRule),V=(0,o.EW)(()=>(0,E.PH)(x.dropdownList,C.value.ruleId,"ruleId")),L=()=>new Promise((e,l)=>{let a={columnId:w.value.column.columnId},t=O.value?v.aq.listOnlineColumnRule(a):v.aq.listNotInOnlineColumnRule(a);t.then(l=>{e({dataList:l.data.dataList})}).catch(e=>{l(e)})}),A={loadData:L},x=(0,d.Kh)((0,U.B)(A)),N=()=>{b.value?.clearValidate(),c.value?.clearValidate()},D=()=>{a.dialog?a.dialog.cancel():p(!1)},P=()=>{C.value.message=void 0},K=()=>{g.value||D(),g.value=_.value=!1,N()},X=()=>{g.value=!0,_.value=!1,I.value={ruleName:void 0,pattern:void 0,ruleType:H.SysOnlineRuleType.CUSTOM,builtin:!1},N()},z=e=>{g.value=!0,_.value=!0,I.value={...e},N()},Q=e=>{s.s.confirm("是否删除此规则？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={ruleId:e.ruleId};return v.Uz.delete(l)}).then(()=>{C.value.ruleId===e.ruleId&&(C.value.ruleId=void 0),x.refresh()}).catch(e=>{console.warn(e)})},B=()=>{b.value.validate(e=>{if(!e)return;let l={onlineRuleDto:{...I.value}},a=_.value?v.Uz.update(l):v.Uz.add(l);a.then(e=>{_.value||(C.value.ruleId=e.data),x.refresh(),g.value=!1}).catch(e=>{console.warn(e)})})},M=()=>{let e={columnId:w.value.column.columnId,onlineColumnRuleDtoList:[{columnId:w.value.column.columnId,ruleId:C.value.ruleId,propDataJson:JSON.stringify({message:C.value.message,min:C.value.min,max:C.value.max})}]};v.aq.addOnlineColumnRule(e).then(e=>{r.nk.success("添加成功！"),a.dialog?a.dialog.submit(e):p(!0,e)}).catch(e=>{console.warn(e)})},j=()=>{let e={onlineColumnRuleDto:{columnId:w.value.column.columnId,ruleId:C.value.ruleId,propDataJson:JSON.stringify({message:C.value.message,min:C.value.min,max:C.value.max})}};v.aq.updateOnlineColumnRule(e).then(e=>{r.nk.success("保存成功！"),a.dialog&&a.dialog.submit(e)}).catch(e=>{console.warn(e)})},q=()=>{O.value?j():g.value?B():M()};return(0,o.sV)(()=>{null!=w.value.columnRule&&(C.value={ruleId:w.value.columnRule.ruleId,message:w.value.columnRule.columnRuleInfo.message,max:w.value.columnRule.columnRuleInfo.max,min:w.value.columnRule.columnRuleInfo.min},x.refresh())}),(e,l)=>{const a=n.S2,r=i.S2,s=F.P9,m=F.AV,p=h.uD,v=R.xE,f=k.WK,y=Y.lq,_=R.US;return(0,o.uX)(),(0,o.CE)("div",Z,[(0,d.R1)(g)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(_,{key:0,class:"full-width-input form-box",ref_key:"form",ref:c,rules:S,model:(0,d.R1)(C),"label-width":"80px",size:(0,d.R1)(t),"label-position":"right",onSubmit:l[4]||(l[4]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(r,{gutter:20},{default:(0,o.k6)(()=>[(0,o.bF)(p,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{label:"验证规则",prop:"ruleId",key:"ruleId"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{gutter:3,justify:"space-between",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(p,{span:20},{default:(0,o.k6)(()=>[(0,o.bF)(m,{class:"input-item",modelValue:(0,d.R1)(C).ruleId,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(C).ruleId=e),placeholder:"选择验证规则",clearable:"",disabled:(0,d.R1)(O),loading:(0,d.R1)(x).loading,onVisibleChange:(0,d.R1)(x).onVisibleChange,onChange:P},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(x).dropdownList,e=>((0,o.uX)(),(0,o.Wv)(s,{key:e.ruleId,value:e.ruleId,label:e.ruleName},{default:(0,o.k6)(()=>[(0,o.bF)(r,{type:"flex",justify:"end",align:"middle",class:"rule-item"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",$,(0,u.v_)(e.ruleName),1),e.builtin?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(a,{key:0,link:"",icon:(0,d.R1)(W.Edit),style:{"margin-left":"30px"},onClick:(0,T.D$)(l=>z(e),["stop"])},null,8,["icon","onClick"])),e.builtin?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(a,{key:1,link:"",icon:(0,d.R1)(W.CircleClose),onClick:(0,T.D$)(l=>Q(e),["stop"])},null,8,["icon","onClick"]))]),_:2},1024)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","disabled","loading","onVisibleChange"])]),_:1}),(0,o.bF)(p,{span:4},{default:(0,o.k6)(()=>[(0,d.R1)(O)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(a,{key:0,type:"warning",onClick:X},{default:(0,o.k6)(()=>l[8]||(l[8]=[(0,o.eW)("新建规则")])),_:1,__:[8]}))]),_:1})]),_:1})]),_:1})]),_:1}),(0,o.bF)(p,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{label:"错误信息",prop:"message",key:"message"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:(0,d.R1)(C).message,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(C).message=e),placeholder:"输入校验错误信息"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(p,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{label:"最小值"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{modelValue:(0,d.R1)(C).min,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(C).min=e),placeholder:"输入最小值",disabled:!(0,d.R1)(V)||(0,d.R1)(V).ruleType!==(0,d.R1)(H.SysOnlineRuleType).RANGE},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,o.bF)(p,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{label:"最大值"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{modelValue:(0,d.R1)(C).max,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(C).max=e),placeholder:"输入最大值",disabled:!(0,d.R1)(V)||(0,d.R1)(V).ruleType!==(0,d.R1)(H.SysOnlineRuleType).RANGE},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])),(0,d.R1)(g)?((0,o.uX)(),(0,o.Wv)(_,{key:1,class:"full-width-input form-box",ref_key:"ruleForm",ref:b,rules:S,model:(0,d.R1)(I),"label-width":"100px",size:(0,d.R1)(t),"label-position":"right",onSubmit:l[7]||(l[7]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(r,{gutter:20},{default:(0,o.k6)(()=>[(0,o.bF)(p,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{label:"规则类型",prop:"ruleType"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{"model-value":(0,d.R1)(H.SysOnlineRuleType).getValue((0,d.R1)(I).ruleType),disabled:""},null,8,["model-value"])]),_:1})]),_:1}),(0,o.bF)(p,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{label:"规则名称",prop:"ruleName",key:"ruleName"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:(0,d.R1)(I).ruleName,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.R1)(I).ruleName=e),placeholder:"规则名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(p,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(v,{label:"正则表达式",prop:"pattern",key:"pattern"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{type:"textarea",modelValue:(0,d.R1)(I).pattern,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,d.R1)(I).pattern=e),placeholder:"规则正则表达式"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])):(0,o.Q3)("",!0),(0,o.bF)(r,{class:"menu-box",type:"flex",justify:"end"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{size:(0,d.R1)(t),plain:!0,onClick:K},{default:(0,o.k6)(()=>l[9]||(l[9]=[(0,o.eW)("取消")])),_:1,__:[9]},8,["size"]),(0,o.bF)(a,{type:"primary",size:(0,d.R1)(t),onClick:q},{default:(0,o.k6)(()=>l[10]||(l[10]=[(0,o.eW)("保存")])),_:1,__:[10]},8,["size"])]),_:1})])}}});const le=(0,Q.A)(ee,[["__scopeId","data-v-5f2adbb0"]]);var ae=le;const te={class:"table-column-list"},ie={class:"title"},ne=["title","onClick"],oe={style:{"margin-right":"10px"}},de={class:"refresh",style:{"margin-left":"10px"}},ue={class:"column-attributes"},re={key:0,style:{padding:"20px"},class:"attibute-box"},se=["title"],me={class:"column-rules"};var pe=(0,o.pM)({__name:"onlinePageTableColumnRule",props:{isMasterTable:{type:Boolean,default:!1},tableId:{},dblinkId:{},tableName:{},dictList:{},height:{}},setup(e,{expose:l}){const a=(0,y.l5)(),t=e,c=(0,o.EW)(()=>a.defaultFormItemSize),b=(0,d.KR)(!1),g=(0,d.KR)(),f=(0,d.KR)(),_=(0,d.KR)([]),C=(0,d.KR)(),I=(0,d.KR)(),O=(0,d.KR)(),E=(0,o.EW)(()=>p.SysOnlineFieldKind.getList().filter(e=>!!t.isMasterTable||e.id!==p.SysOnlineFieldKind.FLOW_STATUS)),V=(0,o.EW)(()=>{let e=[];return O.value&&O.value.forEach(l=>{if(f.value){let e=f.value.get(l.columnName);l.deletedFlag=null==e}else l.deletedFlag=!1;e.push(l)}),e}),L=(0,o.EW)(()=>{let e=[];return f.value&&O.value&&f.value.forEach(l=>{let a=O.value?.get(l.columnName);null==a&&e.push(l)}),e}),A=()=>{let e={onlineColumnDtoFilter:{tableId:t.tableId}};v.aq.list(e).then(e=>{O.value=new Map,e.data.dataList.forEach(e=>{let l={columnId:e.columnId,columnName:e.columnName,columnComment:e.columnComment,fullColumnType:e.fullColumnType,primaryKey:e.primaryKey,required:!e.nullable,fieldKind:e.fieldKind,fileType:e.fileType?e.fileType.split(",").map(e=>Number.parseInt(e)):[],maxFileCount:e.maxFileCount,uploadFileSystemType:e.uploadFileSystemType||0,filterType:e.filterType,dictId:e.dictId,maskFieldType:e.maskFieldType,encodedRule:e.encodedRule?JSON.parse(e.encodedRule):{calculateWhenView:!1,prefix:void 0,precisionTo:p.SysAutoCodeType.DAYS,middle:void 0,idWidth:void 0},tag:e};O.value?.set(l.columnName,l)}),C.value&&(0,o.dY)(()=>{C.value=O.value?O.value.get(C.value.columnName):void 0})}).catch(e=>{console.warn(e)})},x=e=>{let l={tableId:t.tableId,dblinkId:t.dblinkId,tableName:t.tableName,columnName:e.columnName};v.aq.add(l).then(()=>{r.nk.success("添加成功！"),b.value=!1,A()}).catch(e=>{console.warn(e)})},N=()=>{if(null==C.value)return Promise.reject();if(C.value.encodedRule.calculateWhenView=C.value.fieldKind===p.SysOnlineFieldKind.AUTO_CODE,C.value.encodedRule.calculateWhenView){if(!C.value.encodedRule.prefix)return r.nk.error("自动编码前缀不能为空！"),Promise.reject();if(!C.value.encodedRule.precisionTo)return r.nk.error("自动编码精度类型！"),Promise.reject();if(null==C.value.encodedRule.idWidth||C.value.encodedRule.idWidth<=0)return r.nk.error("自动编码编号长度不能小于1！"),Promise.reject()}return new Promise((e,l)=>{let a={onlineColumnDto:{...C.value.tag,dictId:"Boolean"===C.value.tag.objectFieldType?void 0:C.value.dictId,fieldKind:C.value.fieldKind,filterType:C.value.filterType,maxFileCount:C.value.maxFileCount,uploadFileSystemType:C.value.uploadFileSystemType||0,columnComment:C.value.columnComment,userFilter:g.value===p.SysOnlineDataPermFilterType.USER_FILTER,deptFilter:g.value===p.SysOnlineDataPermFilterType.DEPT_FILTER,encodedRule:JSON.stringify(C.value.encodedRule),nullable:!C.value.required,maskFieldType:C.value.maskFieldType,fileType:Array.isArray(C.value.fileType)?C.value.fileType.join(","):C.value.fileType}};v.aq.update(a).then(l=>{b.value=!1,r.nk.success("保存成功！"),A(),e(l)}).catch(e=>{l(e)})})},U=e=>{_.value=[],v.aq.listOnlineColumnRule({columnId:e}).then(e=>{e.data.dataList.forEach(e=>{e.columnRuleInfo={...JSON.parse(e.onlineColumnRule.propDataJson)}}),_.value=e.data.dataList}).catch(e=>{console.warn(e)})},P=e=>{null==e.maskFieldType&&(e.maskFieldType=H.SysMaskFieldType.CUSTOM),C.value=e,g.value=void 0,C.value.tag.userFilter&&(g.value=p.SysOnlineDataPermFilterType.USER_FILTER),C.value.tag.deptFilter&&(g.value=p.SysOnlineDataPermFilterType.DEPT_FILTER),I.value={...e},U(C.value.columnId)},K=e=>{b.value?s.s.confirm("字段信息已修改，是否保存？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(()=>{N().then(()=>{P(e)}).catch(e=>{console.warn(e)})}).catch(()=>{b.value=!1,I.value&&(C.value.maxFileCount=I.value.maxFileCount,C.value.uploadFileSystemType=I.value.uploadFileSystemType||0,C.value.fieldKind=I.value.fieldKind,C.value.filterType=I.value.filterType),P(e)}):(b.value=!1,P(e))},X=e=>{e||C.value.filterType!==p.SysOnlineColumnFilterType.MULTI_SELECT_FILTER||(C.value.filterType=p.SysOnlineColumnFilterType.NONE)},z=(e,l)=>{s.s.confirm("刷新字段将替换现有字段有所的属性，是否继续？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let a={columnId:e.columnId,dblinkId:t.dblinkId,tableName:t.tableName,columnName:l.columnName};return v.aq.refreshColumn(a)}).then(()=>{r.nk.success("刷新成功！"),b.value=!1,A()}).catch(e=>{console.warn(e)})},Q=e=>{z(e.column,e.newColumn)},B=e=>{s.s.confirm("是否删除字段？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={columnId:e.columnId};return v.aq.delete(l)}).then(()=>{r.nk.success("删除成功!"),A()}).catch(e=>{console.warn(e)})},M=e=>{s.s.confirm("是否从当前字段中删除此规则？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={columnId:C.value.columnId,ruleId:e.ruleId};return v.aq.deleteOnlineColumnRule(l)}).then(()=>{r.nk.success("删除成功！"),U(C.value.columnId)}).catch(e=>{console.warn(e)})},Z=e=>{m.l.show("编辑字段验证规则",ae,{area:"600px"},{column:C.value,columnRule:e},{width:"600px",height:"500px",pathName:"/thirdParty/thirdSetOnlineTableColumnRule"}).then(()=>{U(C.value.columnId)}).catch(e=>{console.warn(e)})},$=()=>{m.l.show("设置字段验证规则",ae,{area:"600px"},{column:C.value},{width:"600px",height:"500px",pathName:"/thirdParty/thirdSetOnlineTableColumnRule"}).then(()=>{U(C.value.columnId)}).catch(e=>{console.warn(e)})},ee=()=>{let e={dblinkId:t.dblinkId,tableName:t.tableName};v.yu.listDblinkTableColumns(e).then(e=>{f.value=new Map,e.data.forEach(e=>{f.value.set(e.columnName,e)})}).catch(e=>{console.warn(e)})},le=e=>{switch(e.id){case p.SysOnlineFieldKind.CREATE_TIME:case p.SysOnlineFieldKind.UPDATE_TIME:return"Date"!==C.value.tag.objectFieldType;case p.SysOnlineFieldKind.UPLOAD:case p.SysOnlineFieldKind.UPLOAD_IMAGE:case p.SysOnlineFieldKind.RICH_TEXT:case p.SysOnlineFieldKind.AUTO_CODE:case p.SysOnlineFieldKind.FIELD_MASK:return"String"!==C.value.tag.objectFieldType;case p.SysOnlineFieldKind.LOGIC_DELETE:case p.SysOnlineFieldKind.FLOW_STATUS:return"Integer"!==C.value.tag.objectFieldType;default:return!1}};return(0,o.wB)(()=>V.value,()=>{null==C.value&&Array.isArray(V.value)&&V.value.length>0&&P(V.value[0])},{deep:!0,immediate:!0}),l({saveColumn:N}),(0,o.sV)(()=>{A(),ee()}),(e,l)=>{const a=n.S2,t=G.c6,r=G.Iy,s=G.dW,m=S.u,v=J.kA,f=i.S2,y=R.xE,I=h.uD,O=D.qi,A=k.WK,N=F.P9,U=F.AV,P=q.Zh,ee=q.MQ,ae=Y.lq,pe=R.US,ce=j.o8,be=j.Up;return(0,o.uX)(),(0,o.Wv)(f,{style:(0,u.Tr)([{"flex-wrap":"nowrap",width:"100%"},{height:e.height+"px"}])},{default:(0,o.k6)(()=>[(0,o.Lk)("div",te,[(0,o.Lk)("div",ie,[(0,o.Lk)("span",null,(0,u.v_)(e.tableName),1),(0,o.bF)(s,{trigger:"click",onCommand:x},{dropdown:(0,o.k6)(()=>[(0,o.bF)(r,null,{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(L),e=>((0,o.uX)(),(0,o.Wv)(t,{key:e.columnName,command:e},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.columnName),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(a,{size:(0,d.R1)(c),link:"",icon:(0,d.R1)(W.CirclePlus),disabled:(0,d.R1)(L).length<=0},{default:(0,o.k6)(()=>l[28]||(l[28]=[(0,o.eW)(" 新增 ")])),_:1,__:[28]},8,["size","icon","disabled"])]),_:1})]),(0,o.bF)(v,{style:(0,u.Tr)({height:e.height-51+"px"})},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(V),e=>((0,o.uX)(),(0,o.CE)("div",{key:e.columnId,class:(0,u.C4)(["table-column-item",{"active-column":(0,d.R1)(C)===e}]),title:e.columnComment,onClick:(0,T.D$)(l=>K(e),["stop"])},[(0,o.Lk)("div",null,[(0,o.Lk)("span",oe,(0,u.v_)(e.columnName),1),e.deletedFlag?((0,o.uX)(),(0,o.Wv)(m,{key:0,size:(0,d.R1)(c),type:"danger"},{default:(0,o.k6)(()=>l[29]||(l[29]=[(0,o.eW)("已删除")])),_:1,__:[29]},8,["size"])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",de,[(0,d.R1)(L).length<=0?((0,o.uX)(),(0,o.Wv)(a,{key:0,size:(0,d.R1)(c),type:"primary",link:"",onClick:(0,T.D$)(l=>z(e,e),["stop"])},{default:(0,o.k6)(()=>l[30]||(l[30]=[(0,o.eW)(" 刷新 ")])),_:2,__:[30]},1032,["size","onClick"])):((0,o.uX)(),(0,o.Wv)(s,{key:1,trigger:"click",onCommand:Q},{dropdown:(0,o.k6)(()=>[(0,o.bF)(r,null,{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(L),l=>((0,o.uX)(),(0,o.Wv)(t,{key:l.columnName,command:{column:e,newColumn:l}},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(l.columnName),1)]),_:2},1032,["command"]))),128))]),_:2},1024)]),default:(0,o.k6)(()=>[(0,o.bF)(a,{size:(0,d.R1)(c),type:"primary",link:"",onClick:l[0]||(l[0]=(0,T.D$)(()=>{console.log("empty function")},["stop"]))},{default:(0,o.k6)(()=>l[31]||(l[31]=[(0,o.eW)(" 刷新 ")])),_:1,__:[31]},8,["size"])]),_:2},1024)),e.deletedFlag?((0,o.uX)(),(0,o.Wv)(a,{key:2,size:(0,d.R1)(c),type:"danger",link:"",style:{"margin-left":"10px"},onClick:(0,T.D$)(l=>B(e),["stop"])},{default:(0,o.k6)(()=>l[32]||(l[32]=[(0,o.eW)(" 删除 ")])),_:2,__:[32]},1032,["size","onClick"])):(0,o.Q3)("",!0)])],10,ne))),128))]),_:1},8,["style"])]),(0,o.Lk)("div",ue,[(0,o.bF)(f,{type:"flex",justify:"end",align:"middle",style:{height:"40px","padding-right":"10px","border-bottom":"1px dashed #dcdfe6"}},{default:(0,o.k6)(()=>l[33]||(l[33]=[(0,o.Lk)("div",{class:"attribute-title",style:{"margin-left":"0"}},[(0,o.Lk)("span",null,"字段属性")],-1)])),_:1,__:[33]}),(0,o.bF)(pe,{ref:"columnAttribute",model:(0,d.R1)(C),class:"full-width-input",style:{width:"100%"},"label-width":"120px","label-position":"right",onSubmit:l[27]||(l[27]=(0,T.D$)(()=>{},["prevent"])),size:"default"},{default:(0,o.k6)(()=>[null!=(0,d.R1)(C)?((0,o.uX)(),(0,o.CE)("div",re,[(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"字段名称"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",{title:(0,d.R1)(C).columnComment},(0,u.v_)((0,d.R1)(C).columnName),9,se),(0,d.R1)(C).primaryKey?((0,o.uX)(),(0,o.Wv)(m,{key:0,size:(0,d.R1)(c),type:"warning",style:{"margin-left":"20px"}},{default:(0,o.k6)(()=>l[34]||(l[34]=[(0,o.eW)("主键")])),_:1,__:[34]},8,["size"])):(0,o.Q3)("",!0)]),_:1})]),_:1}),(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"字段类型"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)((0,d.R1)(C).fullColumnType),1),(0,o.bF)(m,{size:(0,d.R1)(c),type:"success",effect:"dark",style:{"margin-left":"10px"}},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)((0,d.R1)(C).tag.objectFieldType),1)]),_:1},8,["size"])]),_:1})]),_:1}),(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"是否必填"},{default:(0,o.k6)(()=>[(0,o.bF)(O,{modelValue:(0,d.R1)(C).required,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(C).required=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"显示名称"},{default:(0,o.k6)(()=>[(0,o.bF)(A,{modelValue:(0,d.R1)(C).columnComment,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(C).columnComment=e),style:{width:"278px"},onChange:l[3]||(l[3]=e=>b.value=!0),placeholder:"字段在表单上的显示名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"字典数据"},{default:(0,o.k6)(()=>[(0,o.bF)(U,{modelValue:(0,d.R1)(C).dictId,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.R1)(C).dictId=e),placeholder:"选择字段绑定的字典",style:{width:"278px"},clearable:"",filterable:"",disabled:"Boolean"===(0,d.R1)(C).tag.objectFieldType,onChange:X},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.dictList,e=>((0,o.uX)(),(0,o.Wv)(N,{key:e.dictId,value:e.dictId,label:e.dictName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"过滤支持"},{default:(0,o.k6)(()=>[(0,o.bF)(ee,{modelValue:(0,d.R1)(C).filterType,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.R1)(C).filterType=e),onChange:l[6]||(l[6]=e=>b.value=!0)},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(p.SysOnlineColumnFilterType).getList(),e=>((0,o.uX)(),(0,o.Wv)(P,{key:e.id,value:e.id,disabled:e.id===(0,d.R1)(p.SysOnlineColumnFilterType).MULTI_SELECT_FILTER&&(null==(0,d.R1)(C).dictId||""===(0,d.R1)(C).dictId)},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)((0,d.R1)(p.SysOnlineColumnFilterType).getValue(e.id)),1)]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"数据权限"},{default:(0,o.k6)(()=>[(0,o.bF)(U,{modelValue:(0,d.R1)(g),"onUpdate:modelValue":l[7]||(l[7]=e=>(0,d.i9)(g)?g.value=e:null),placeholder:"字段用于数据权限过滤规则",style:{width:"278px"},clearable:"",onChange:l[8]||(l[8]=e=>b.value=!0)},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(p.SysOnlineDataPermFilterType).getList(),e=>((0,o.uX)(),(0,o.Wv)(N,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(I,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"字段类别"},{default:(0,o.k6)(()=>[(0,o.bF)(U,{modelValue:(0,d.R1)(C).fieldKind,"onUpdate:modelValue":l[9]||(l[9]=e=>(0,d.R1)(C).fieldKind=e),clearable:"",placeholder:"字段的业务类别",onChange:l[10]||(l[10]=e=>b.value=!0),style:{width:"278px"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(E),e=>((0,o.uX)(),(0,o.Wv)(N,{key:e.id,label:e.name,value:e.id,disabled:le(e)},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,d.R1)(C).fieldKind===(0,d.R1)(p.SysOnlineFieldKind).UPLOAD||(0,d.R1)(C).fieldKind===(0,d.R1)(p.SysOnlineFieldKind).UPLOAD_IMAGE?((0,o.uX)(),(0,o.Wv)(I,{key:0,class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"存储类型"},{default:(0,o.k6)(()=>[(0,o.bF)(U,{modelValue:(0,d.R1)(C).uploadFileSystemType,"onUpdate:modelValue":l[11]||(l[11]=e=>(0,d.R1)(C).uploadFileSystemType=e),clearable:"",placeholder:"字段的业务类别",onChange:l[12]||(l[12]=e=>b.value=!0),style:{width:"278px"}},{default:(0,o.k6)(()=>[(0,o.bF)(N,{label:"本地存储",value:0}),(0,o.bF)(N,{label:"分布式存储",value:100})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(C).fieldKind===(0,d.R1)(p.SysOnlineFieldKind).UPLOAD?((0,o.uX)(),(0,o.Wv)(I,{key:1,class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"文件类型"},{default:(0,o.k6)(()=>[(0,o.bF)(U,{modelValue:(0,d.R1)(C).fileType,"onUpdate:modelValue":l[13]||(l[13]=e=>(0,d.R1)(C).fileType=e),clearable:"",placeholder:"上传文件的类型（允许多选）",multiple:!0,"collapse-tags":!0,onChange:l[14]||(l[14]=e=>b.value=!0),style:{width:"278px"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(H.EnumFileType).getList(),e=>((0,o.uX)(),(0,o.Wv)(N,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(C).fieldKind===(0,d.R1)(p.SysOnlineFieldKind).UPLOAD||(0,d.R1)(C).fieldKind===(0,d.R1)(p.SysOnlineFieldKind).UPLOAD_IMAGE?((0,o.uX)(),(0,o.Wv)(I,{key:2,class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"上传文件数量"},{default:(0,o.k6)(()=>[(0,o.bF)(ae,{modelValue:(0,d.R1)(C).maxFileCount,"onUpdate:modelValue":l[15]||(l[15]=e=>(0,d.R1)(C).maxFileCount=e),style:{width:"278px"},placeholder:"不填或者0则代表无限制",onChange:l[16]||(l[16]=e=>b.value=!0)},null,8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(C).fieldKind===(0,d.R1)(p.SysOnlineFieldKind).AUTO_CODE?((0,o.uX)(),(0,o.Wv)(I,{key:3,class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"编码规则"},{default:(0,o.k6)(()=>[(0,o.bF)(A,{modelValue:(0,d.R1)(C).encodedRule.prefix,"onUpdate:modelValue":l[17]||(l[17]=e=>(0,d.R1)(C).encodedRule.prefix=e),style:{width:"80px","margin-right":"5px"},placeholder:"前缀",onChange:l[18]||(l[18]=e=>b.value=!0)},null,8,["modelValue"]),(0,o.bF)(U,{modelValue:(0,d.R1)(C).encodedRule.precisionTo,"onUpdate:modelValue":l[19]||(l[19]=e=>(0,d.R1)(C).encodedRule.precisionTo=e),clearable:"",placeholder:"",onChange:l[20]||(l[20]=e=>b.value=!0),style:{width:"160px","margin-right":"5px"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(p.SysAutoCodeType).getList(),e=>((0,o.uX)(),(0,o.Wv)(N,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),(0,o.bF)(A,{modelValue:(0,d.R1)(C).encodedRule.middle,"onUpdate:modelValue":l[21]||(l[21]=e=>(0,d.R1)(C).encodedRule.middle=e),style:{width:"80px","margin-right":"5px"},placeholder:"后缀",onChange:l[22]||(l[22]=e=>b.value=!0)},null,8,["modelValue"]),(0,o.bF)(ae,{modelValue:(0,d.R1)(C).encodedRule.idWidth,"onUpdate:modelValue":l[23]||(l[23]=e=>(0,d.R1)(C).encodedRule.idWidth=e),style:{width:"100px"},placeholder:"序号宽度",controls:!1,min:1,onChange:l[24]||(l[24]=e=>b.value=!0)},null,8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(C).fieldKind===(0,d.R1)(p.SysOnlineFieldKind).FIELD_MASK?((0,o.uX)(),(0,o.Wv)(I,{key:4,class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"字段脱敏规则"},{default:(0,o.k6)(()=>[(0,o.bF)(U,{modelValue:(0,d.R1)(C).maskFieldType,"onUpdate:modelValue":l[25]||(l[25]=e=>(0,d.R1)(C).maskFieldType=e),placeholder:"字段脱敏规则",onChange:l[26]||(l[26]=e=>b.value=!0),style:{width:"278px"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(H.SysMaskFieldType).getList(),e=>((0,o.uX)(),(0,o.Wv)(N,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)]),_:1},8,["model"])]),(0,o.Lk)("div",me,[(0,o.bF)(f,{type:"flex",align:"middle",style:{"border-bottom":"1px dashed #dcdfe6",height:"40px"}},{default:(0,o.k6)(()=>l[35]||(l[35]=[(0,o.Lk)("span",{style:{color:"#043254","font-weight":"700"}},"验证规则",-1)])),_:1,__:[35]}),(0,o.bF)(f,{style:{"margin-top":"15px"}},{default:(0,o.k6)(()=>[(0,o.bF)(I,{span:24,style:{"border-top":"1px solid #ebeef5"}},{default:(0,o.k6)(()=>[(0,o.bF)(be,{size:(0,d.R1)(c),data:(0,d.R1)(_),"show-header":!1,"empty-text":"请添加验证规则"},{empty:(0,o.k6)(()=>l[38]||(l[38]=[(0,o.Lk)("div",{class:"table-empty unified-font"},[(0,o.Lk)("img",{src:w}),(0,o.Lk)("span",null,"暂无数据")],-1)])),default:(0,o.k6)(()=>[(0,o.bF)(ce,{type:"index",width:"30px"}),(0,o.bF)(ce,{label:"规则名称",prop:"ruleName",width:"120"}),(0,o.bF)(ce,{label:"校验错误信息",prop:"columnRuleInfo.message"}),(0,o.bF)(ce,{label:"操作",width:"110px"},{default:(0,o.k6)(e=>[(0,o.bF)(a,{link:"",type:"primary",onClick:l=>Z(e.row),size:(0,d.R1)(c),style:{padding:"0"}},{default:(0,o.k6)(()=>l[36]||(l[36]=[(0,o.eW)("编辑")])),_:2,__:[36]},1032,["onClick","size"]),(0,o.bF)(a,{link:"",type:"danger",onClick:l=>M(e.row),size:(0,d.R1)(c),style:{padding:"0"}},{default:(0,o.k6)(()=>l[37]||(l[37]=[(0,o.eW)("删除")])),_:2,__:[37]},1032,["onClick","size"])]),_:1})]),_:1},8,["size","data"]),(0,o.bF)(a,{style:{width:"100%","margin-top":"10px",border:"1px dashed #ebeef5"},disabled:null==(0,d.R1)(C),icon:(0,d.R1)(W.Plus),onClick:$,size:(0,d.R1)(c)},{default:(0,o.k6)(()=>l[39]||(l[39]=[(0,o.eW)(" 添加验证规则 ")])),_:1,__:[39]},8,["disabled","icon","size"])]),_:1})]),_:1})])]),_:1},8,["style"])}}});const ce=(0,Q.A)(pe,[["__scopeId","data-v-2afe3281"]]);var be=ce,ve=a(46954);const ge={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var fe=(0,o.pM)({__name:"editVirtualColumnFilter",props:{rowData:{},tableList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,y.l5)(),a=e,t=(0,o.EW)(()=>l.defaultFormItemSize),{thirdParams:u,onCloseThirdDialog:r}=(0,f.P)(a),s=(0,d.KR)(),m=(0,d.KR)({tableId:void 0,columnId:void 0,operatorType:p.SysOnlineFilterOperationType.EQUAL,value:void 0,dictValueName:void 0}),c=(0,d.KR)([]),b=(0,d.KR)([]),g={},_=(0,o.EW)(()=>{let e=[p.SysOnlineFilterOperationType.NOT_NULL,p.SysOnlineFilterOperationType.IS_NULL];return null!=m.value.operatorType&&-1===e.indexOf(m.value.operatorType)}),C=(0,o.EW)(()=>({tableList:a.tableList||u.value.tableList,rowData:a.rowData||u.value.rowData})),I=(0,o.EW)(()=>(0,E.PH)(C.value.tableList,m.value.tableId,"tableId")),S=(0,o.EW)(()=>(0,E.PH)(c.value,m.value.columnId,"columnId")),{getDictDataList:w}=(0,ve.o)(),W=()=>{a.dialog?a.dialog.cancel():r(!1)},O=()=>{s.value.validate(e=>{if(!e)return;let l=(0,E.PH)(b.value,m.value.value,"id");m.value.dictValueName=l?l.name:void 0;let t={...m.value,table:I.value,column:S.value};a.dialog?a.dialog.submit(t):r(!0,C.value.rowData,m.value)})},V=e=>{if(!e)return;let l={onlineColumnDtoFilter:{tableId:e}};v.aq.list(l).then(e=>{c.value=e.data.dataList,I.value&&(I.value.columnList=e.data.dataList)}).catch(e=>{console.warn(e)})},L=e=>{null!=e&&w(e,{}).then(e=>{b.value=e}).catch(e=>{console.warn(e)})},A=e=>{let l=[p.SysOnlineFilterOperationType.NOT_NULL,p.SysOnlineFilterOperationType.IS_NULL];null!=e&&-1===l.indexOf(e)||(m.value.value=void 0)};return(0,o.wB)(()=>I.value,e=>{c.value=[],null!=e&&(Array.isArray(e.columnList)?c.value=e.columnList:V(e.tableId))},{deep:!0}),(0,o.wB)(()=>S.value,e=>{b.value=[],m.value.dictValueName=void 0,null!=e&&null!=e.dictInfo&&L(e.dictInfo)},{deep:!0}),(0,o.sV)(()=>{C.value.rowData&&(m.value={...C.value.rowData})}),(e,l)=>{const a=F.P9,u=F.AV,r=R.xE,v=h.uD,f=D.qi,y=Y.lq,I=k.WK,w=i.S2,E=R.US,V=n.S2;return(0,o.uX)(),(0,o.CE)("div",ge,[(0,o.bF)(E,{ref_key:"form",ref:s,model:(0,d.R1)(m),class:"full-width-input form-box",rules:g,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(t),"label-position":"right",onSubmit:l[7]||(l[7]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(w,{gutter:20},{default:(0,o.k6)(()=>[(0,o.bF)(v,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"数据表",prop:"tableId"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"input-item",modelValue:(0,d.R1)(m).tableId,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(m).tableId=e),clearable:!0,filterable:"",placeholder:"数据表"},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(C).tableList,e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.tableId,value:e.tableId,label:e.tableName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(v,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"过滤字段",prop:"columnId"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"input-item",modelValue:(0,d.R1)(m).columnId,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(m).columnId=e),clearable:!0,filterable:"",placeholder:"过滤字段"},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(c),e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.columnId,value:e.columnId,label:e.columnName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(v,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"过滤类型",prop:"operatorType"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"input-item",modelValue:(0,d.R1)(m).operatorType,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(m).operatorType=e),clearable:!0,filterable:"",placeholder:"过滤类型",onChange:A},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(p.SysOnlineFilterOperationType).getList(),e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(v,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(r,{label:"过滤参数值",prop:"value"},{default:(0,o.k6)(()=>[null!=(0,d.R1)(S)&&null!=(0,d.R1)(S).dictInfo?((0,o.uX)(),(0,o.Wv)(u,{key:0,modelValue:(0,d.R1)(m).value,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(m).value=e),disabled:!(0,d.R1)(_),placeholder:""},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(b),e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"])):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[null!=(0,d.R1)(S)&&"Boolean"===(0,d.R1)(S).objectFieldType?((0,o.uX)(),(0,o.Wv)(f,{key:0,disabled:!(0,d.R1)(_),modelValue:(0,d.R1)(m).value,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.R1)(m).value=e)},null,8,["disabled","modelValue"])):(0,o.Q3)("",!0),null!=(0,d.R1)(S)&&-1!==["Integer","Long","BigDecimal","Double"].indexOf((0,d.R1)(S).objectFieldType)?((0,o.uX)(),(0,o.Wv)(y,{key:1,disabled:!(0,d.R1)(_),modelValue:(0,d.R1)(m).value,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.R1)(m).value=e),controls:!1},null,8,["disabled","modelValue"])):((0,o.uX)(),(0,o.Wv)(I,{key:2,disabled:null==(0,d.R1)(S)||!(0,d.R1)(_),modelValue:(0,d.R1)(m).value,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,d.R1)(m).value=e),clearable:""},null,8,["disabled","modelValue"]))],64))]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,o.bF)(w,{class:"menu-box"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(w,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,o.k6)(()=>[(0,o.bF)(V,{size:(0,d.R1)(t),plain:!0,onClick:W},{default:(0,o.k6)(()=>l[9]||(l[9]=[(0,o.eW)(" 取消 ")])),_:1,__:[9]},8,["size"]),(0,o.bF)(V,{type:"primary",size:(0,d.R1)(t),onClick:l[8]||(l[8]=e=>O())},{default:(0,o.k6)(()=>l[10]||(l[10]=[(0,o.eW)(" 保存 ")])),_:1,__:[10]},8,["size"])]),_:1})]),_:1})]),_:1})])}}});const ye=fe;var Re=ye;const ke={class:"table-column-list"},he={class:"title"},Fe=["title","onClick"],Te={style:{"margin-right":"10px"}},_e={class:"column-attributes"},Ce={key:0,style:{padding:"20px"},class:"attibute-box"},Ie={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Se={class:"column-filter"},we={key:0},We={key:1};var Oe=(0,o.pM)({__name:"onlinePageVirtualColumn",props:{datasource:{},relationList:{},height:{}},setup(e,{expose:l}){const a=(0,y.l5)(),t={virtualColumnId:void 0,datasourceId:void 0,objectFieldName:void 0,columnPrompt:void 0,objectFieldType:void 0,relationId:void 0,aggregationType:void 0,aggregationTableId:void 0,aggregationColumnId:void 0,virtualType:0,whereClauseJson:void 0},c=e,b=(0,o.EW)(()=>a.defaultFormItemSize),g=(0,d.KR)(),f=(0,d.KR)([]),_=(0,d.KR)(),C=(0,d.KR)([]),I=(0,d.KR)([]),O=(0,d.KR)([]),V={objectFieldName:[{required:!0,message:"结果字段列名不能为空",trigger:"blur"}],objectFieldType:[{required:!0,message:"结果字段类型不能为空",trigger:"blur"}],columnPrompt:[{required:!0,message:"结果字段显示名不能为空",trigger:"blur"}],relationId:[{required:!0,message:"必须选则聚合字段关联",trigger:"blur"}],aggregationType:[{required:!0,message:"必须选则聚合计算规则",trigger:"blur"}],aggregationTableId:[{required:!0,message:"聚合计算表不能为空",trigger:"blur"}],aggregationColumnId:[{required:!0,message:"聚合计算字段不能为空",trigger:"blur"}]},L=(0,o.EW)(()=>_.value&&_.value.aggregationColumnId?(0,E.PH)(I.value,_.value.aggregationColumnId,"columnId"):null),A=(0,o.EW)(()=>{if(!L.value)return[];if(_.value&&_.value.aggregationType===p.SysOnlineAggregationType.GROUP_CONCAT)return["String"];switch(L.value.objectFieldType){case"String":case"Boolean":return["Integer"];case"Integer":case"Long":case"BigDecimal":case"Double":return["Integer","Long","Double"];case"Date":return["Integer","Date"];default:return["Integer","Long","Double","Date"]}}),x=(0,o.EW)(()=>L.value?p.SysOnlineAggregationType.getList().filter(e=>{switch(e.id){case p.SysOnlineAggregationType.SUM:return _.value&&"Date"!==_.value.objectFieldType&&-1===["Date","Boolean","String"].indexOf(L.value?.objectFieldType);case p.SysOnlineAggregationType.COUNT:return!0;case p.SysOnlineAggregationType.AVG:case p.SysOnlineAggregationType.MIN:case p.SysOnlineAggregationType.MAX:return"Date"===L.value?.objectFieldType?_.value&&"Date"===_.value.objectFieldType:-1!==["Integer","Long","BigDecimal","Double"].indexOf(L.value?.objectFieldType);case p.SysOnlineAggregationType.GROUP_CONCAT:return!0;default:return!1}}):[]),N=(0,o.EW)(()=>_.value&&_.value.relationId?(0,E.PH)(c.relationList,_.value.relationId,"relationId"):null),D=(0,o.EW)(()=>null==_.value.aggregationTableId?null:(0,E.PH)(C.value,_.value.aggregationTableId,"tableId")),U=e=>{if(null==e)return"success";switch(e){case p.SysOnlineRelationType.ONE_TO_ONE:return"";case p.SysOnlineRelationType.ONE_TO_MANY:return"warning";default:return"info"}},P=e=>{C.value=[],I.value=[],_.value&&(_.value.aggregationColumnId=void 0,_.value.aggregationTableId=void 0,_.value.aggregationType=void 0,_.value.objectFieldType=void 0);let l=(0,E.PH)(c.relationList,e,"relationId");null!=l&&(C.value=[l.slaveTable])},K=()=>{I.value=[],_.value&&(_.value.aggregationColumnId=void 0,_.value.aggregationType=void 0,_.value.objectFieldType=void 0),null!=D.value&&(Array.isArray(D.value.columnList)&&D.value.columnList.length>0?I.value=D.value.columnList:Y(D.value.tableId).catch(e=>{console.warn(e)}))},X=()=>{_.value&&(_.value.aggregationType=void 0,_.value.objectFieldType=void 0)},z=()=>{_.value={...t}},Q=e=>{_.value=e},B=e=>{s.s.confirm("是否删除此虚拟字段？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={virtualColumnId:e.virtualColumnId};v.jk.delete(l).then(()=>{_.value&&e.virtualColumnId===_.value.virtualColumnId&&(_.value={...t}),r.nk.success("删除成功！"),M()}).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},M=()=>{let e={onlineVirtualColumnDtoFilter:{datasourceId:c.datasource.datasourceId}};v.jk.list(e).then(e=>{f.value=e.data.dataList,!_.value&&f.value.length>0&&(_.value=f.value[0])}).catch(e=>{console.warn(e)})},Y=e=>new Promise((l,a)=>{null!=e&&""!==e||l(!1);let t={onlineColumnDtoFilter:{tableId:e}};v.aq.list(t).then(e=>{null!=N.value&&(N.value.columnList=e.data.dataList),D.value.columnList=e.data.dataList,I.value=e.data.dataList,G(),l(!0)}).catch(e=>{console.warn(e),a()})}),{getDictDataList:q}=(0,ve.o)(),G=()=>{let e=_.value&&_.value.whereClauseJson?JSON.parse(_.value.whereClauseJson):[];e=e.map(e=>({...e,table:D.value,column:(0,E.PH)(D.value?.columnList,e.columnId,"columnId")}));let l=e.map(e=>new Promise(l=>{if(null==e.column||null==e.column.dictInfo)return void l(!1);let a=e.column.dictInfo;q(a,{}).then(a=>{let t=(0,E.PH)(a,e.value,"id");t?e.dictValueName=t.name:e.value=void 0,l(!0)}).catch(a=>{console.warn(a),e.value=void 0,l(!1)})}));Promise.all(l).then(()=>{O.value=e}).catch(e=>{console.warn(e)})};(0,o.wB)(()=>_.value,(e,l)=>{null==e?Array.isArray(f.value)&&f.value.length>0&&(_.value=f.value[0]):e!=l&&(N.value&&(C.value=[N.value.slaveTable]),D.value&&(Y(D.value.tableId).catch(e=>{console.warn(e)}),Array.isArray(D.value.columnList)&&D.value.columnList.length>0?G():Y(D.value.tableId).then(e=>{G()}).catch(e=>{console.warn(e)})))},{deep:!0,immediate:!0});const H=(e,l)=>{null==e?(l.id=(new Date).getTime(),O.value.push(l)):O.value=O.value.map(a=>a.id===e.id?l:a)},Z=e=>{m.l.show(e?"编辑过滤":"添加过滤",Re,{area:"500px"},{rowData:e,tableList:C.value},{width:"500px",height:"500px",pathName:"/thirdParty/thirdEditVirtualColumnFilter"}).then(l=>{H(e,l)}).catch(e=>{console.warn(e)})},$=e=>{s.s.confirm("是否删除此过滤条件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{O.value=O.value.filter(l=>l!==e)}).catch(e=>{console.warn(e)})},ee=()=>{g.value.validate(e=>{if(e){let e=O.value.map(e=>({tableId:e.tableId,columnId:e.columnId,operatorType:e.operatorType,value:e.value})),l={onlineVirtualColumnDto:{..._.value,datasourceId:c.datasource.datasourceId,whereClauseJson:JSON.stringify(e)}},a=_.value&&_.value.virtualColumnId?v.jk.update(l):v.jk.add(l);a.then(e=>{_.value&&!_.value.virtualColumnId&&(_.value.virtualColumnId=e.data),r.nk.success("保存成功！"),M()}).catch(e=>{console.warn(e)})}})};return l({saveColumn:ee}),(0,o.sV)(()=>{M()}),(e,l)=>{const a=n.S2,t=J.kA,r=i.S2,s=k.WK,m=R.xE,c=h.uD,v=S.u,y=F.P9,E=F.AV,L=R.US,D=j.o8,M=j.Up;return(0,o.uX)(),(0,o.Wv)(r,{style:(0,u.Tr)([{"flex-wrap":"nowrap",width:"100%"},{height:e.height+"px"}])},{default:(0,o.k6)(()=>[(0,o.Lk)("div",ke,[(0,o.Lk)("div",he,[l[11]||(l[11]=(0,o.Lk)("span",{class:"unified-font",style:{"font-weight":"bold"}},"虚拟字段列表",-1)),(0,o.bF)(a,{size:(0,d.R1)(b),type:"primary",link:"",icon:(0,d.R1)(W.CirclePlus),onClick:(0,T.D$)(z,["stop"])},{default:(0,o.k6)(()=>l[10]||(l[10]=[(0,o.eW)("新增")])),_:1,__:[10]},8,["size","icon"])]),(0,o.bF)(t,{style:(0,u.Tr)({height:e.height-51+"px"})},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(f),e=>((0,o.uX)(),(0,o.CE)("div",{key:e.columnId,class:(0,u.C4)(["table-column-item",{"active-column":(0,d.R1)(_)?.virtualColumnId===e.virtualColumnId}]),title:e.columnComment,onClick:(0,T.D$)(l=>Q(e),["stop"])},[(0,o.Lk)("span",Te,(0,u.v_)(e.columnPrompt),1),(0,o.bF)(a,{size:(0,d.R1)(b),link:"",style:{"margin-left":"10px"},onClick:(0,T.D$)(l=>B(e),["stop"])},{default:(0,o.k6)(()=>l[12]||(l[12]=[(0,o.eW)(" 删除 ")])),_:2,__:[12]},1032,["size","onClick"])],10,Fe))),128))]),_:1},8,["style"])]),(0,o.Lk)("div",_e,[(0,o.bF)(r,{type:"flex",justify:"end",align:"middle",style:{height:"40px","padding-right":"10px","border-bottom":"1px dashed #dcdfe6"}},{default:(0,o.k6)(()=>l[13]||(l[13]=[(0,o.Lk)("div",{class:"attribute-title",style:{"margin-left":"0"}},[(0,o.Lk)("span",null,"字段属性")],-1)])),_:1,__:[13]}),(0,o.bF)(L,{class:"full-width-input",ref_key:"form",ref:g,model:(0,d.R1)(_),style:{width:"100%"},"label-width":"120px","label-position":"right",onSubmit:l[8]||(l[8]=(0,T.D$)(()=>{},["prevent"])),size:"default",rules:V},{default:(0,o.k6)(()=>[(0,d.R1)(_)?((0,o.uX)(),(0,o.CE)("div",Ce,[(0,o.bF)(c,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"结果字段列名",prop:"objectFieldName"},{default:(0,o.k6)(()=>[(0,o.bF)(s,{modelValue:(0,d.R1)(_).objectFieldName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(_).objectFieldName=e),placeholder:"结果字段列名"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(c,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"结果字段显示名",prop:"columnPrompt"},{default:(0,o.k6)(()=>[(0,o.bF)(s,{modelValue:(0,d.R1)(_).columnPrompt,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(_).columnPrompt=e),placeholder:"结果字段显示名"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(c,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"聚合关联",prop:"relationId"},{default:(0,o.k6)(()=>[(0,o.bF)(E,{modelValue:(0,d.R1)(_).relationId,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(_).relationId=e),placeholder:"聚合关联选择",onChange:P},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.relationList,e=>((0,o.uX)(),(0,o.Wv)(y,{key:e.relationId,value:e.relationId,label:e.relationName},{default:(0,o.k6)(()=>[(0,o.Lk)("div",Ie,[(0,o.Lk)("span",null,(0,u.v_)(e.relationName),1),(0,o.bF)(v,{style:{"margin-left":"30px"},size:(0,d.R1)(b),type:U(e.relationType)},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)((0,d.R1)(p.SysOnlineRelationType).getValue(e.relationType)),1)]),_:2},1032,["size","type"])])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(c,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"聚合计算表",prop:"aggregationTableId"},{default:(0,o.k6)(()=>[(0,o.bF)(E,{modelValue:(0,d.R1)(_).aggregationTableId,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(_).aggregationTableId=e),placeholder:"聚合计算表",onChange:K},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(C),e=>((0,o.uX)(),(0,o.Wv)(y,{key:e.relationId,value:e.tableId,label:e.tableName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(c,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"聚合计算字段",prop:"aggregationColumnId"},{default:(0,o.k6)(()=>[(0,o.bF)(E,{modelValue:(0,d.R1)(_).aggregationColumnId,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.R1)(_).aggregationColumnId=e),placeholder:"聚合计算表",onChange:X},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(I),e=>((0,o.uX)(),(0,o.Wv)(y,{key:e.relationId,value:e.columnId,label:e.columnName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(c,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"聚合计算规则",prop:"relationId"},{default:(0,o.k6)(()=>[(0,o.bF)(E,{modelValue:(0,d.R1)(_).aggregationType,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.R1)(_).aggregationType=e),placeholder:"聚合字段计算规则",onChange:l[6]||(l[6]=e=>(0,d.R1)(_).objectFieldType=void 0)},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(x),e=>((0,o.uX)(),(0,o.Wv)(y,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(c,{class:"attribute-item"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"结果字段类型",prop:"objectFieldType"},{default:(0,o.k6)(()=>[(0,o.bF)(E,{modelValue:(0,d.R1)(_).objectFieldType,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,d.R1)(_).objectFieldType=e),placeholder:"结果字段类型"},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(A),e=>((0,o.uX)(),(0,o.Wv)(y,{key:e,value:e,label:e},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])):(0,o.Q3)("",!0)]),_:1},8,["model"])]),(0,o.Lk)("div",Se,[(0,o.bF)(r,{type:"flex",align:"middle",style:{"border-bottom":"1px dashed #dcdfe6",height:"40px"}},{default:(0,o.k6)(()=>l[14]||(l[14]=[(0,o.Lk)("span",{style:{color:"#043254","font-weight":"700"}},"过滤条件",-1)])),_:1,__:[14]}),(0,o.bF)(r,{style:{"margin-top":"15px"}},{default:(0,o.k6)(()=>[(0,o.bF)(c,{span:24,style:{"border-top":"1px solid #ebeef5"}},{default:(0,o.k6)(()=>[(0,o.bF)(M,{size:(0,d.R1)(b),data:(0,d.R1)(O),"show-header":!1,"empty-text":"请添加过滤条件"},{empty:(0,o.k6)(()=>l[16]||(l[16]=[(0,o.Lk)("div",{class:"table-empty unified-font"},[(0,o.Lk)("img",{src:w}),(0,o.Lk)("span",null,"暂无数据")],-1)])),default:(0,o.k6)(()=>[(0,o.bF)(D,{label:"操作",width:"45px"},{default:(0,o.k6)(e=>[(0,o.bF)(a,{link:"",icon:(0,d.R1)(W.Remove),onClick:l=>$(e.row)},null,8,["icon","onClick"])]),_:1}),(0,o.bF)(D,{label:"参数名称"},{default:(0,o.k6)(e=>[(0,o.bF)(a,{type:"primary",link:"",style:{"text-decoration":"underline"},onClick:l=>Z(e.row)},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)((e.row.column||{}).columnName||"未知字段"),1)]),_:2},1032,["onClick"])]),_:1}),(0,o.bF)(D,{label:"所属表",width:"100px"},{default:(0,o.k6)(()=>[(0,o.Lk)("template",null,[(0,o.bF)(v,{size:(0,d.R1)(b),type:"success"},{default:(0,o.k6)(()=>l[15]||(l[15]=[(0,o.eW)("关联从表")])),_:1,__:[15]},8,["size"])])]),_:1}),(0,o.bF)(D,{label:"过滤类型",width:"100px"},{default:(0,o.k6)(e=>[(0,o.Lk)("span",null,(0,u.v_)((0,d.R1)(p.SysOnlineFilterOperationType).getValue(e.row.operatorType)),1)]),_:1}),(0,o.bF)(D,{label:"参数值",prop:"value"},{default:(0,o.k6)(e=>[null==(e.row.column||{}).dictInfo?((0,o.uX)(),(0,o.CE)("span",we,(0,u.v_)(e.row.value),1)):((0,o.uX)(),(0,o.CE)("span",We,(0,u.v_)(e.row.column.dictInfo.dictName+" / "+e.row.dictValueName),1))]),_:1})]),_:1},8,["size","data"]),(0,o.bF)(a,{style:{width:"100%","margin-top":"10px",border:"1px dashed #ebeef5"},size:(0,d.R1)(b),disabled:null==(0,d.R1)(_)||null==(0,d.R1)(N),icon:(0,d.R1)(W.Plus),onClick:l[9]||(l[9]=e=>Z(null))},{default:(0,o.k6)(()=>l[17]||(l[17]=[(0,o.eW)(" 添加过滤条件 ")])),_:1,__:[17]},8,["size","disabled","icon"])]),_:1})]),_:1})])]),_:1},8,["style"])}}});const Ee=(0,Q.A)(Oe,[["__scopeId","data-v-3dd50ef8"]]);var Ve=Ee,Le=(0,o.pM)({__name:"index",props:{pageId:{},dblinkInfo:{},data:{},dataSource:{},dictList:{},clientHeight:{}},emits:["change","un-saved"],setup(e,{expose:l,emit:a}){const t=(0,y.l5)(),i=a,r=e,c=(0,o.EW)(()=>t.defaultFormItemSize),b=((0,o.EW)(()=>r.clientHeight.value),(0,d.KR)()),g=(0,d.KR)(),f=(0,d.KR)(),R=(0,d.KR)(!1),k=(0,d.KR)(!1),F=e=>new Promise((l,a)=>{let t={datasourceId:e};v.hp.view(t).then(e=>{l(e.data.tableList||[])}).catch(e=>{a(e)})}),T=e=>new Promise((l,a)=>{Array.isArray(r.dblinkInfo[e].tableList)&&r.dblinkInfo[e].tableList.length>0?l(r.dblinkInfo[e].tableList):v.yu.listDblinkTables({dblinkId:e}).then(e=>{l(e.data)}).catch(e=>{a(e)})}),_=e=>{if(!e)return Promise.reject();if(Array.isArray(e.validTableList)&&e.validTableList.length>0)return Promise.resolve();let l=[F(e.datasourceId),T(e.dblinkId)];return new Promise((a,t)=>{Promise.all(l).then(l=>{console.log("loadDatasourceValidTableList >>>",l);let t=l[0],i=l[1],n=new Set;e.validTableList=i.map(e=>{n?.add(e.tableName);let l=(0,E.PH)(t,e.tableName,"tableName");return{id:l?l.tableId:e.tableName,name:e.tableName,desc:l?l.tableComment:e.tableComment,status:l?p.SysOnlinePageDatasourceFieldStatus.USED:p.SysOnlinePageDatasourceFieldStatus.UNUSED,dblinkTable:null==l,tag:l||e}}),t.forEach(l=>{n?.has(l.tableName)||e.validTableList.push({id:l.tableId,name:l.tableName,desc:l.tableComment,status:p.SysOnlinePageDatasourceFieldStatus.DELETED,dblinkTable:!1,tag:l})}),n=null,a(!0)}).catch(e=>{t(e)})})},C=()=>{r.dataSource?_(r.dataSource).then(()=>{m.l.show("添加关联",M,{area:"600px"},{datasource:r.dataSource,dblinkInfo:r.dataSource?r.dblinkInfo[r.dataSource.dblinkId]:null,usedTableNameList:r.data.map(e=>e.tableName)},{width:"600px",pathName:"/thirdParty/thirdEditPageRelation"}).then(()=>{i("change",r.pageId)}).catch(e=>{console.log(e)})}).catch(e=>{console.log(e)}):m.l.show("新建数据源",N,{area:"500px"},{pageId:r.pageId,dblinkInfo:r.dblinkInfo},{width:"500px",height:"500px",pathName:"/thirdParty/thirdEditPageDatasource"}).then(()=>{i("change",r.pageId)}).catch(e=>{console.warn(e)})},I=e=>{if(null==e)return"success";switch(e){case p.SysOnlineRelationType.ONE_TO_ONE:return"primary";case p.SysOnlineRelationType.ONE_TO_MANY:return"warning";default:return"info"}},V=e=>null==e?"数据主表":p.SysOnlineRelationType.getValue(e)||"未知类型",L=e=>{_(r.dataSource).then(()=>{null==e.relationType?m.l.show("编辑数据源",N,{area:"500px"},{pageId:r.pageId,dblinkInfo:r.dblinkInfo,datasourceId:e.tag.datasourceId},{width:"500px",height:"500px",pathName:"/thirdParty/thirdEditPageDatasource"}).then(()=>{i("change",r.pageId)}).catch(e=>{console.warn(e)}):m.l.show("编辑关联",M,{area:"600px"},{relationId:e.id,datasource:r.dataSource,dblinkInfo:r.dataSource?r.dblinkInfo[r.dataSource.dblinkId]:null,usedTableNameList:r.data.map(e=>e.tableName)},{width:"600px",pathName:"/thirdParty/thirdEditPageRelation"}).then(()=>{i("change",r.pageId)}).catch(e=>{console.log(e)})}).catch(e=>{console.warn(e)})},A=e=>{f.value=e,R.value=!0,i("un-saved",!0)},x=e=>{f.value=e,k.value=!0,i("un-saved",!0)},D=()=>(i("un-saved",!1),f.value=void 0,R.value=!1,k.value=!1,!0),U=e=>{if(null==e.relationType){let l="是否删除此数据模型？";Array.isArray(e.relationList)&&e.relationList.length>0&&(l="此数据模型下还存在关联，如果删除关联数据也将同时删除，是否继续？"),s.s.confirm(l,"",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={datasourceId:e.id};return v.hp.delete(l)}).then(()=>{i("change",r.pageId)}).catch(e=>{console.warn(e)})}else s.s.confirm("是否删除此关联数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={relationId:e.id};return v.PC.delete(l)}).then(()=>{i("change",r.pageId)}).catch(e=>{console.warn(e)})},P=()=>{f.value&&(R.value&&b.value.saveColumn(),k.value&&g.value.saveColumn())};return l({save:P,cancel:D}),(e,l)=>{const a=S.u,i=n.S2,r=h.uD;return(0,d.R1)(f)?(0,d.R1)(f)&&(0,d.R1)(R)?((0,o.uX)(),(0,o.Wv)(r,{key:1,span:24},{default:(0,o.k6)(()=>[(0,o.bF)(be,{ref_key:"tableColumnRuleForm",ref:b,isMasterTable:!(0,d.R1)(f).relationType,tableId:(0,d.R1)(f).tableId,dblinkId:e.dataSource?.dblinkId,tableName:(0,d.R1)(f).tableName,dictList:e.dictList,defaultFormItemSize:(0,d.R1)(t).defaultFormItemSize,height:(0,d.R1)(t).documentClientHeight-80},null,8,["isMasterTable","tableId","dblinkId","tableName","dictList","defaultFormItemSize","height"])]),_:1})):(0,d.R1)(f)&&(0,d.R1)(k)?((0,o.uX)(),(0,o.Wv)(r,{key:2,span:24},{default:(0,o.k6)(()=>[(0,o.bF)(Ve,{ref_key:"virtualColumnForm",ref:g,datasource:(0,d.R1)(f).tag,relationList:(0,d.R1)(f).tag.relationList,defaultFormItemSize:(0,d.R1)(t).defaultFormItemSize,height:(0,d.R1)(t).documentClientHeight-80},null,8,["datasource","relationList","defaultFormItemSize","height"])]),_:1})):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(r,{key:0,span:24,class:"main-box",style:{"min-width":"1100px"}},{default:(0,o.k6)(()=>[(0,o.bF)((0,d.R1)(O.CP),{data:e.data,"row-config":{isHover:!0},size:(0,d.R1)(c),"header-cell-class-name":"table-header-gray"},{empty:(0,o.k6)(()=>l[4]||(l[4]=[(0,o.Lk)("div",{class:"table-empty unified-font"},[(0,o.Lk)("img",{src:w}),(0,o.Lk)("span",null,"暂无数据")],-1)])),default:(0,o.k6)(()=>[(0,o.bF)((0,d.R1)(O.Wq),{title:"序号",type:"seq",width:"55px"}),(0,o.bF)((0,d.R1)(O.Wq),{title:"数据表名",field:"tableName"}),(0,o.bF)((0,d.R1)(O.Wq),{title:"关联类型",field:"relationType"},{default:(0,o.k6)(e=>[(0,o.bF)(a,{size:(0,d.R1)(c),type:I(e.row.relationType),effect:"dark"},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(V(e.row.relationType)),1)]),_:2},1032,["size","type"])]),_:1}),(0,o.bF)((0,d.R1)(O.Wq),{title:"主表关联字段",field:"masterColumnName"}),(0,o.bF)((0,d.R1)(O.Wq),{title:"从表关联字段",field:"slaveColumnName"}),(0,o.bF)((0,d.R1)(O.Wq),{title:"级联删除",field:"cascadeDelete"},{default:(0,o.k6)(e=>[null!=e.row.relationType?((0,o.uX)(),(0,o.Wv)(a,{key:0,size:(0,d.R1)(c),type:e.row.cascadeDelete?"success":"danger",effect:"dark"},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.row.cascadeDelete?"是":"否"),1)]),_:2},1032,["size","type"])):(0,o.Q3)("",!0)]),_:1}),(0,o.bF)((0,d.R1)(O.Wq),{title:"是否左连接",field:"leftJoin"},{default:(0,o.k6)(e=>[null!=e.row.relationType?((0,o.uX)(),(0,o.Wv)(a,{key:0,size:(0,d.R1)(c),type:e.row.leftJoin?"success":"danger",effect:"dark"},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.row.leftJoin?"是":"否"),1)]),_:2},1032,["size","type"])):(0,o.Q3)("",!0)]),_:1}),(0,o.bF)((0,d.R1)(O.Wq),{title:"操作",width:"250px",fixed:"right"},{default:(0,o.k6)(e=>[(0,o.bF)(i,{size:(0,d.R1)(c),type:"primary",link:"",onClick:l=>L(e.row),disabled:null==e.row.relationType&&Array.isArray(e.row.relationList)&&e.row.relationList.length>0},{default:(0,o.k6)(()=>l[0]||(l[0]=[(0,o.eW)(" 编辑 ")])),_:2,__:[0]},1032,["size","onClick","disabled"]),(0,o.bF)(i,{size:(0,d.R1)(c),type:"primary",link:"",onClick:l=>A(e.row)},{default:(0,o.k6)(()=>l[1]||(l[1]=[(0,o.eW)(" 字段管理 ")])),_:2,__:[1]},1032,["size","onClick"]),(0,o.bF)(i,{size:(0,d.R1)(c),type:"primary",link:"",disabled:null!=e.row.relationType,onClick:l=>x(e.row)},{default:(0,o.k6)(()=>l[2]||(l[2]=[(0,o.eW)(" 聚合计算 ")])),_:2,__:[2]},1032,["size","disabled","onClick"]),(0,o.bF)(i,{size:(0,d.R1)(c),type:"danger",link:"",disabled:null==e.row.relationType&&(!Array.isArray(e.row.relationList)||e.row.relationList.length<=0),onClick:l=>U(e.row)},{default:(0,o.k6)(()=>l[3]||(l[3]=[(0,o.eW)(" 删除 ")])),_:2,__:[3]},1032,["size","disabled","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,o.bF)(i,{style:{width:"100%","margin-top":"10px",border:"1px dashed #ebeef5"},icon:(0,d.R1)(W.Plus),onClick:C},{default:(0,o.k6)(()=>l[5]||(l[5]=[(0,o.eW)("新增数据表")])),_:1,__:[5]},8,["icon"])]),_:1}))}}});const Ae=Le;var xe=Ae,Ne=a(77195),De=(a(38389),a(61688),a(3155)),Ue=(a(87199),a(80434),a(54620)),Pe=(a(53086),a(38840)),Ke=(a(95304),a(20116),a(14908)),Xe=a(87351),ze=a(67192),Qe=a(80427),Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAVZJREFUWEftV7txg0AU1BFAaJVgVSC5AksV2OrAJDCErsB2Bw6BBLkDd2C5A9TBqQM54zOA981IMwwjBe9Oc6cAIoIbdt++fXsPMbH8CMv4Ey0CWZZN67qeN02zj6JIqhSjTCBN00XXdT8AnR6BP8IwfOeSUCYQx3EuhJj3Adu2nXGVUCaQJEk3rBYEViCw5aigTAAKfEOBpx7Yn+u6977vH4wQIAOWZbkhEvDCznGclyAIcg44nVVWgAt06fxIYFRASwFkwTPM9YgpkJ7nfXFHUGsKAE6x+9Zzd44ofuBOh7ICIECBczeIYnNJeAsEhi34RQuWxlpAQGRCGHCJOJa4BzZGTcitdIziUYGrK0ALSVVVGT5MkyCxkKyNLiRnVrIDRnHGHUWdKLa+lNpdy48/JrSCny6kV0TxJzeglFtAQGTEoigWeJXcH5ITUS0C3GrPnbdO4B8BNJMhXeBhfQAAAABJRU5ErkJggg==",Me=a(37972),je=a(8588),Ye=a(40235),qe=a(42933),Je=a(91324),Ge=a(54607),He=a(27652),Ze=a(81387),$e=a(2878),el=a(11051),ll=(0,o.pM)({__name:"index",props:{formConfig:{},height:{},isEdit:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},currentWidget:{},fullscreen:{type:Boolean,default:!1},mode:{default:"mobile"}},emits:["widgetClick","listClick"],setup(e,{emit:l}){const a=(0,Ze.rd)(),t=((0,y.i1)(),l),i=e,{getDictDataList:n}=(0,ve.o)(),{isReady:r,dialogParams:s,form:m,formData:p,getWidgetValue:c,getWidgetProp:b,getWidgetVisible:v,onValueChange:g,onWidgetValueChange:f,getDropdownParams:R,checkOperationPermCode:k,checkOperationDisabled:h,checkOperationVisible:F,cloneWidget:_,handlerOperation:C,loadOnlineFormConfig:I,initPage:S,initFormWidgetList:w,initWidgetLinkage:W,showDialog:O,showOnlineDialog:E,instanceData:V}=(0,el.m)({props:i,router:a});(0,o.Gt)("form",()=>({...m.value,mode:i.mode||"pc",isEdit:s.value.isEdit,readOnly:s.value.readOnly,formData:p,getWidgetValue:c,getWidgetProp:b,getWidgetVisible:v,onValueChange:g,onWidgetValueChange:f,getDropdownParams:R,checkOperationPermCode:k,checkOperationDisabled:h,checkOperationVisible:F,cloneWidget:_,handlerOperation:C,getDictDataList:n,loadOnlineFormConfig:I,isActive:e=>i.currentWidget===e,getWidgetObject:qe.A.getWidgetObject,instanceData:()=>()=>V}));const L=(0,o.EW)(()=>m.value.tableWidget),A=(0,o.EW)(()=>m.value.leftWidget),x=e=>{t("widgetClick",e)};return(0,o.sV)(()=>{r.value=!1,s.value.isEdit||(m.value.eventInfo&&"function"===typeof m.value.eventInfo[H.OnlineFormEventType.AFTER_CREATE_FORM]&&m.value.eventInfo[H.OnlineFormEventType.AFTER_CREATE_FORM](V),W()),r.value=!0}),(e,l)=>(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{class:"online-query-form",style:(0,u.Tr)({height:e.height?e.height:"100%"})},[(0,o.bF)((0,d.R1)(He.lV),{ref:"form",class:"full-width-input",style:{width:"100%",height:"100%"},"label-width":((0,d.R1)(m).labelWidth||100)+"px",onSubmit:l[0]||(l[0]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)($e.A,{widget:(0,d.R1)(L),isEdit:e.isEdit,isTree:i.formConfig.advanceQuery,leftWidget:(0,d.R1)(A),onWidgetClick:x},null,8,["widget","isEdit","isTree","leftWidget"])]),_:1},8,["label-width"])],4)),[[T.aG,(0,d.R1)(r)]])}});const al=ll;var tl=al,il=a(86555),nl=a(45352),ol=a(49825),dl=a(77783),ul=a(28181),rl=a(91542),sl=(a(37985),a(54442)),ml=a(89001),pl=a(37157);const cl={class:"online-custom-work-order-list",style:{height:"100%"}},bl={style:{"flex-grow":"1"}},vl={class:"filter-dlg"},gl={class:"filter"},fl={class:"filter-dlg-header"};var yl=(0,o.pM)({__name:"OnlineMobileWorkOrderList",props:{widget:{},isEdit:{type:Boolean,default:!1},isTree:{type:Boolean,default:!1},leftWidget:{},customFilter:{type:Boolean,default:!0},customCard:{type:Boolean,default:!0}},emits:["widgetClick"],setup(e,{emit:l}){const a=l,t=e,r=(0,o.WQ)("form",()=>(console.error("OnlineMobileWorkOrderList: form not injected"),{isEdit:!1})),s=(0,d.KR)(!1),m=(0,d.KR)([]),p=(0,o.EW)(()=>Array.isArray(t.widget.childWidgetList)&&t.widget.childWidgetList.length>0?t.widget.childWidgetList[0]:{}),c=(e=null)=>{a("widgetClick",e)},b=()=>{let e,l;switch(t.widget.props.card){case H.SysCustomWidgetType.ImageCard:e=pl.A;break}return e&&(l=r().getWidgetObject(e),l.showName="listCard",l.variableName="listCard"+(new Date).getTime(),l["relation"]=void 0,l["datasource"]=void 0,l["column"]=void 0),l};return(0,o.sV)(()=>{if(!Array.isArray(t.widget.childWidgetList)||0===t.widget.childWidgetList.length){let e=b();if(e){let l=t.widget;l.childWidgetList=[e]}}m.value=t.widget.childWidgetList.slice(1)}),(0,o.wB)(m,e=>{let l=t.widget;l.childWidgetList=[p.value,...e]},{deep:!0}),(0,o.wB)(()=>t.widget?.props?.card,()=>{let e=t.widget,l=b();e.childWidgetList=[l,...m.value]},{deep:!0}),(e,l)=>{const a=i.S2,t=h.uD,b=n.S2,v=rl.tk,g=J.kA;return(0,o.uX)(),(0,o.CE)("div",cl,[(0,o.bF)(a,{class:"header",align:"middle"},{default:(0,o.k6)(()=>[l[4]||(l[4]=(0,o.Lk)("div",{class:"order-box"},null,-1)),(0,o.Lk)("div",{class:"filter-btn",onClick:l[0]||(l[0]=(0,T.D$)(e=>s.value=!0,["stop"]))},l[3]||(l[3]=[(0,o.Lk)("span",null,"筛选",-1),(0,o.Lk)("i",{class:"online-icon icon-filter"},null,-1)]))]),_:1,__:[4]}),(0,o.bF)(a,{class:"list-box",style:{"border-top":"2px solid #f6f6f6"}},{default:(0,o.k6)(()=>[(0,o.bF)(a,{type:"flex",style:{height:"100%"}},{default:(0,o.k6)(()=>[(0,o.Lk)("div",bl,[(0,o.bF)(sl.A,{class:(0,u.C4)(["widget-item",{active:e.isEdit&&(0,d.R1)(r)().isActive((0,d.R1)(p))}]),style:{background:"white"},isEdit:e.isEdit,supportContent:!1,widget:(0,d.R1)(p),onWidgetClick:c},{content:(0,o.k6)(()=>[(0,o.bF)(a,null,{default:(0,o.k6)(()=>[(0,o.bF)(t,{span:24},{default:(0,o.k6)(()=>l[5]||(l[5]=[(0,o.Lk)("span",{class:"text-item"},"工单编号：L938485757352727",-1)])),_:1,__:[5]}),(0,o.bF)(t,{span:24},{default:(0,o.k6)(()=>l[6]||(l[6]=[(0,o.Lk)("span",{class:"text-item"},"发起人：Admin",-1)])),_:1,__:[6]}),(0,o.bF)(t,{span:24},{default:(0,o.k6)(()=>l[7]||(l[7]=[(0,o.Lk)("span",{class:"text-item"},"当前任务：录入系统",-1)])),_:1,__:[7]}),(0,o.bF)(t,{span:24},{default:(0,o.k6)(()=>l[8]||(l[8]=[(0,o.Lk)("span",{class:"text-item"},"创建时间：2023-03-23 12:00:09",-1)])),_:1,__:[8]})]),_:1})]),menu:(0,o.k6)(()=>[(0,o.bF)(a,{type:"flex",align:"middle",class:"menu-box",style:{margin:"0 15px"}},{default:(0,o.k6)(()=>[l[12]||(l[12]=(0,o.Lk)("span",{class:"status",style:{"flex-grow":"1"}},"已提交",-1)),(0,o.bF)(b,{type:"danger",size:"default",plain:!0},{default:(0,o.k6)(()=>l[9]||(l[9]=[(0,o.eW)("撤销")])),_:1,__:[9]}),(0,o.bF)(b,{type:"primary",size:"default",plain:!0},{default:(0,o.k6)(()=>l[10]||(l[10]=[(0,o.eW)("催办")])),_:1,__:[10]}),(0,o.bF)(b,{type:"primary",size:"default"},{default:(0,o.k6)(()=>l[11]||(l[11]=[(0,o.eW)("办理")])),_:1,__:[11]})]),_:1,__:[12]})]),_:1},8,["class","isEdit","widget"])])]),_:1})]),_:1}),(0,o.bo)((0,o.Lk)("div",vl,[(0,o.Lk)("div",gl,[(0,o.Lk)("div",fl,[l[13]||(l[13]=(0,o.Lk)("div",{style:{"font-size":"14px",color:"#333"}},"筛选",-1)),(0,o.bF)(v,{class:"close",onClick:l[1]||(l[1]=e=>s.value=!1)},{default:(0,o.k6)(()=>[(0,o.bF)((0,d.R1)(W.Close))]),_:1})]),(0,o.bF)(g,{class:"filter-content"},{default:(0,o.k6)(()=>[e.customFilter?((0,o.uX)(),(0,o.Wv)(ml.A,{key:0,value:(0,d.R1)(m),"onUpdate:value":l[2]||(l[2]=e=>(0,d.i9)(m)?m.value=e:null),isEdit:e.isEdit,onWidgetClick:c},null,8,["value","isEdit"])):(0,o.Q3)("",!0)]),_:1}),(0,o.bF)(a,{class:"filter-btn-box",type:"flex",align:"bottom"},{default:(0,o.k6)(()=>[(0,o.bF)(b,{type:"default",size:"default",style:{width:"100px"}},{default:(0,o.k6)(()=>l[14]||(l[14]=[(0,o.eW)("重置")])),_:1,__:[14]}),(0,o.bF)(b,{type:"primary",size:"default",style:{"flex-grow":"1"}},{default:(0,o.k6)(()=>l[15]||(l[15]=[(0,o.eW)("确定")])),_:1,__:[15]})]),_:1})])],512),[[T.aG,(0,d.R1)(s)]])])}}});const Rl=(0,Q.A)(yl,[["__scopeId","data-v-3175b64a"]]);var kl=Rl,hl=(0,o.pM)({__name:"index",props:{formConfig:{},height:{},isEdit:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},currentWidget:{},fullscreen:{type:Boolean,default:!1},mode:{default:"mobile"}},emits:["widgetClick","listClick"],setup(e,{emit:l}){const a=l,t=e,{getDictDataList:i}=(0,ve.o)(),{isReady:n,form:r,formData:s,getWidgetValue:m,getWidgetVisible:p,onValueChange:c,onWidgetValueChange:b,getWidgetProp:v,getDropdownParams:g,checkOperationPermCode:f,checkOperationDisabled:y,checkOperationVisible:R,cloneWidget:k,handlerOperation:h,loadOnlineFormConfig:F,initPage:_,initFormWidgetList:C,initWidgetLinkage:I,instanceData:S}=(0,el.m)({props:t});(0,o.Gt)("form",()=>({...r.value,mode:t.mode||"pc",gutter:0,isEdit:t.isEdit,readOnly:t.readOnly,formData:s,getWidgetValue:m,getWidgetVisible:p,getWidgetProp:v,onValueChange:c,onWidgetValueChange:b,getDropdownParams:g,checkOperationPermCode:f,checkOperationDisabled:y,checkOperationVisible:R,cloneWidget:k,handlerOperation:h,getDictDataList:i,loadOnlineFormConfig:F,isActive:e=>t.currentWidget===e,getWidgetObject:qe.A.getWidgetObject,instanceData:()=>S}));const w=(0,o.EW)(()=>r.value.tableWidget),W=e=>{console.log("OnlineMobileWorkOrderForm onWidgetClick",e),a("widgetClick",e)};return(0,o.sV)(()=>{n.value=!1,t.isEdit||(r.value.eventInfo&&"function"===typeof r.value.eventInfo[H.OnlineFormEventType.AFTER_CREATE_FORM]&&r.value.eventInfo[H.OnlineFormEventType.AFTER_CREATE_FORM](S),I()),n.value=!0}),(e,l)=>(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{class:"online-query-form",style:(0,u.Tr)({height:e.height?e.height:"100%"})},[(0,o.bF)((0,d.R1)(He.lV),{ref:"form",class:"full-width-input",style:{width:"100%",height:"100%"},"label-width":((0,d.R1)(r).labelWidth||100)+"px",onSubmit:l[0]||(l[0]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(kl,{widget:(0,d.R1)(w),isEdit:e.isEdit,onWidgetClick:W},null,8,["widget","isEdit"])]),_:1},8,["label-width"])],4)),[[T.aG,(0,d.R1)(n)]])}});const Fl=hl;var Tl=Fl,_l=a(50922),Cl=(a(62436),a(43723)),Il=a.n(Cl),Sl=a(63019),wl=a(21720),Wl=(0,o.pM)({__name:"CustomFormSetting",setup(e){const l=(0,o.WQ)("formConfig",()=>(console.error("CustomFormSetting: formConfig not injected"),{})),a=(0,y.l5)(),t=(e,a)=>{if(Array.isArray(l().form.customFieldList)){if(null==e){let e=(0,E.PH)(l().form.customFieldList,a,"fieldName");null!=e?r.nk.error("此字段已存在！"):l().form.customFieldList.push({fieldName:a})}else if(e.fieldName!==a){let t=(0,E.PH)(l().form.customFieldList,a,"fieldName");null!=t?r.nk.error("此字段已存在！"):l().form.customFieldList=l().form.customFieldList.map(l=>l.fieldName===e.fieldName?{fieldName:a}:{...l})}}else l().form.customFieldList=[{fieldName:a}]},u=e=>{m.l.show(e?"编辑字段":"添加字段",wl["default"],{area:"600px"},{rowData:e},{height:"200px",width:"600px",pathName:"/thirdParty/thirdEditFormField"}).then(l=>{t(e,l)}).catch(e=>{console.warn(e)})},c=e=>{s.s.confirm("是否移除此字段？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l().form.customFieldList=l().form.customFieldList.filter(l=>l!==e)}).catch(e=>{console.warn(e)})},b=(0,o.EW)(()=>{let e={url:window.location.origin+"/#/thirdParty/thirdOnlineForm?formId="+l().form.formId,datasourceVariableName:null==l().getMasterTable?void 0:l().getMasterTable.tag.variableName};return JSON.stringify(e)}),v=()=>{let e=new(Il())(".formShareBtn");e.on("success",()=>{r.nk.success("接入信息复制成功！"),e.destroy()}),e.on("error",()=>{r.nk.error("浏览器不支持复制，请手动复制接入信息："+b.value),e.destroy()})},g=(0,o.EW)(()=>l().form.formType===H.SysOnlineFormType.FORM||l().form.formType===H.SysOnlineFormType.QUERY&&l().getMasterTable&&null!=l().getMasterTable.relationType),f=(0,o.EW)(()=>l().form.formType===H.SysOnlineFormType.FORM?l().getAllTableList.filter(e=>null==l().getMasterTable.relationType||e.tableId===l().getMasterTable.tableId):l().getValidTableList),h=(0,o.EW)(()=>(console.log("getMaskTableList",f),f.value.map(e=>{let l=e.columnList.filter(e=>e.fieldKind===p.SysOnlineFieldKind.FIELD_MASK).map(e=>({id:e.columnId,name:e.columnName}));return l.length>0?{id:e.tableId,name:e.tableName,children:l}:null}).filter(e=>null!=e)));return(e,t)=>{const r=k.WK,s=n.S2,m=i.S2,p=R.xE,f=q.Zh,y=q.MQ,F=Y.lq,_=q.ll,C=V._m,I=D.qi,S=R.US;return(0,o.uX)(),(0,o.Wv)(S,{"label-position":"top",size:(0,d.R1)(a).defaultFormItemSize,onSubmit:t[14]||(t[14]=(0,T.D$)(()=>{},["prevent"])),style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(p,{label:"表单 ID"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{justify:"space-between",align:"middle",style:{"flex-wrap":"nowrap",width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(r,{readonly:"","model-value":(0,d.R1)(l)().form.formId},null,8,["model-value"]),(0,o.bF)(s,{class:"formShareBtn",link:"",icon:(0,d.R1)(W.Share),style:{"margin-left":"8px"},title:(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).QUERY&&(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).ADVANCE_QUERY&&(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).GROUP_QUERY?"只允许接入查询表单":"复制接入信息",disabled:(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).QUERY&&(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).ADVANCE_QUERY&&(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).GROUP_QUERY,"data-clipboard-text":b.value,onClick:v},null,8,["icon","title","disabled","data-clipboard-text"])]),_:1})]),_:1}),(0,o.bF)(p,{label:"表单类型"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{modelValue:((0,d.R1)(l)().form.formTypeDictMap||{}).name,"onUpdate:modelValue":t[0]||(t[0]=e=>((0,d.R1)(l)().form.formTypeDictMap||{}).name=e),placeholder:"",disabled:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(p,{label:"表单名称"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{modelValue:(0,d.R1)(l)().form.formName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,d.R1)(l)().form.formName=e),placeholder:"",clearable:"",filterable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(p,{label:"表单编码"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{modelValue:(0,d.R1)(l)().form.formCode,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,d.R1)(l)().form.formCode=e),placeholder:"",clearable:"",filterable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(p,{label:"标签位置"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",align:"middle",style:{width:"100%",height:"40px"}},{default:(0,o.k6)(()=>[(0,o.bF)(y,{modelValue:(0,d.R1)(l)().form.labelPosition,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,d.R1)(l)().form.labelPosition=e),size:"default"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{value:"left"},{default:(0,o.k6)(()=>t[15]||(t[15]=[(0,o.eW)("居左")])),_:1,__:[15]}),(0,o.bF)(f,{value:"right"},{default:(0,o.k6)(()=>t[16]||(t[16]=[(0,o.eW)("居右")])),_:1,__:[16]}),(0,o.bF)(f,{value:"top"},{default:(0,o.k6)(()=>t[17]||(t[17]=[(0,o.eW)("顶部")])),_:1,__:[17]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(p,{label:"标签宽度"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(F,{modelValue:(0,d.R1)(l)().form.labelWidth,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,d.R1)(l)().form.labelWidth=e),style:{width:"100%"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(p,{label:"栅格间距"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(F,{modelValue:(0,d.R1)(l)().form.gutter,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,d.R1)(l)().form.gutter=e),style:{width:"100%"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1}),(0,d.R1)(l)().form.formType===(0,d.R1)(H.SysOnlineFormType).QUERY||(0,d.R1)(l)().form.formType===(0,d.R1)(H.SysOnlineFormType).ADVANCE_QUERY||(0,d.R1)(l)().form.formType===(0,d.R1)(H.SysOnlineFormType).GROUP_QUERY?((0,o.uX)(),(0,o.Wv)(p,{key:0,label:"过滤组件宽度"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(F,{modelValue:(0,d.R1)(l)().form.filterItemWidth,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,d.R1)(l)().form.filterItemWidth=e),style:{width:"100%"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),g.value?((0,o.uX)(),(0,o.Wv)(p,{key:1,label:"是否全屏"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",align:"middle",style:{width:"100%",height:"40px"}},{default:(0,o.k6)(()=>[(0,o.bF)(y,{modelValue:(0,d.R1)(l)().form.fullscreen,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,d.R1)(l)().form.fullscreen=e),size:"default"},{default:(0,o.k6)(()=>[(0,o.bF)(_,{value:!0},{default:(0,o.k6)(()=>t[18]||(t[18]=[(0,o.eW)("全屏")])),_:1,__:[18]}),(0,o.bF)(_,{value:!1},{default:(0,o.k6)(()=>t[19]||(t[19]=[(0,o.eW)("弹窗")])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),g.value&&!(0,d.R1)(l)().form.fullscreen?((0,o.uX)(),(0,o.Wv)(p,{key:2,label:"弹窗宽度"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(F,{modelValue:(0,d.R1)(l)().form.width,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,d.R1)(l)().form.width=e),style:{width:"100%"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),g.value&&!(0,d.R1)(l)().form.fullscreen?((0,o.uX)(),(0,o.Wv)(p,{key:3,label:"弹窗高度"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(F,{modelValue:(0,d.R1)(l)().form.height,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,d.R1)(l)().form.height=e),style:{width:"100%"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).FLOW&&(0,d.R1)(l)().form.formType!==(0,d.R1)(H.SysOnlineFormType).FORM?((0,o.uX)(),(0,o.Wv)(p,{key:4,label:"脱敏字段"},{default:(0,o.k6)(()=>[(0,o.bF)(C,{style:{width:"100%"},modelValue:(0,d.R1)(l)().form.maskFieldList,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,d.R1)(l)().form.maskFieldList=e),placeholder:"选择表单脱敏字段","show-all-levels":!1,"collapse-tags":!0,options:h.value,props:{multiple:!0,label:"name",value:"id"}},null,8,["modelValue","options"])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(Sl.A,{data:(0,d.R1)(l)().form.customFieldList,"onUpdate:data":t[11]||(t[11]=e=>(0,d.R1)(l)().form.customFieldList=e),label:"自定义字段",supportSort:!0,onAdd:t[12]||(t[12]=e=>u(null)),onEdit:u,onDelete:c,prop:{label:"fieldName",value:"fieldName"}},null,8,["data"]),(0,d.R1)(l)().form.formType===(0,d.R1)(H.SysOnlineFormType).ONE_TO_ONE_QUERY?((0,o.uX)(),(0,o.Wv)(p,{key:5,label:"左树右表"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{type:"flex",align:"middle",style:{width:"100%",height:"40px"}},{default:(0,o.k6)(()=>[(0,o.bF)(I,{modelValue:(0,d.R1)(l)().form.leftTreeRightTable,"onUpdate:modelValue":t[13]||(t[13]=e=>(0,d.R1)(l)().form.leftTreeRightTable=e)},null,8,["modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0)]),_:1},8,["size"])}}});const Ol=Wl;var El=Ol,Vl=a(618),Ll=(0,o.pM)({__name:"CustomFormOperateSetting",props:{value:{default:()=>[]},formList:{default:()=>[]},tableList:{default:()=>[]}},emits:["update:value"],setup(e,{emit:l}){const a=l,t=(0,y.l5)(),n=(0,o.WQ)("formConfig",()=>(console.error("CustomFormOperateSetting: formConfig not injected"),{})),r=e,p=((0,o.EW)({get(){return r.value},set(e){a("update:value",e)}}),(0,o.EW)(()=>({mode:n().activeMode,form:{formType:n().form.formType,customFieldList:n().form.customFieldList},currentWidget:{widgetType:(n().currentWidget||{}).widgetType,widgetId:(n().currentWidget||{}).widgetId,widgetName:(n().currentWidget||{}).widgetName},getMasterTable:{relationType:n().getMasterTable.relationType,tag:{datasourceName:n().getMasterTable.tag.datasourceName,relationName:n().getMasterTable.tag.relationName,variableName:n().getMasterTable.tag.variableName},columnList:n().getMasterTable.columnList.map(e=>({filterType:e.filterType,columnComment:e.columnComment,columnName:e.columnName,columnId:e.columnId,objectFieldType:e.objectFieldType}))},getAllTableList:n().getAllTableList.map(e=>({relationType:e.relationType,tag:{datasourceName:e.tag.datasourceName,relationName:e.tag.relationName,variableName:e.tag.variableName},columnList:e.columnList.map(e=>({filterType:e.filterType,columnComment:e.columnComment,columnName:e.columnName,columnId:e.columnId}))}))}))),c=(0,o.EW)(()=>n().form.formType===H.SysOnlineFormType.WORK_ORDER?r.value.filter(e=>!e.builtin):r.value),b=e=>{s.s.confirm("是否删除此操作？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a("update:value",r.value.filter(l=>l.id!==e.id))}).catch(e=>{console.warn(e)})},v=(e,l)=>{let t=[];null==e?(l.id=(new Date).getTime(),t=r.value.concat(l)):t=r.value.map(e=>e.id===l.id?l:e),a("update:value",t)},g=e=>{m.l.show(null==e?"添加操作":"编辑操作",Vl["default"],{area:!e||e.type!==H.SysCustomWidgetOperationType.EXPORT&&e.type!==H.SysCustomWidgetOperationType.IMPORT?"600px":"900px",offset:"50px"},{rowData:e,formList:r.formList.map(e=>({formId:e.formId,formType:e.formType,formName:e.formName})),tableList:r.tableList,formConfig:p.value},{height:!e||e.type!==H.SysCustomWidgetOperationType.EXPORT&&e.type!==H.SysCustomWidgetOperationType.IMPORT?"600px":"80vh",width:!e||e.type!==H.SysCustomWidgetOperationType.EXPORT&&e.type!==H.SysCustomWidgetOperationType.IMPORT?"600px":"900px",pathName:"/thirdParty/thirdEditCustomFormOperate"}).then(l=>{v(e,l)}).catch(e=>{console.warn(e)})};return(e,l)=>{const a=S.u,n=R.US,r=i.S2;return(0,o.uX)(),(0,o.Wv)(r,{style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(n,{style:{width:"100%"},size:(0,d.R1)(t).defaultFormItemSize,"label-position":"top",onSubmit:l[2]||(l[2]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(Sl.A,{label:"操作",data:(0,d.R1)(c),"onUpdate:data":l[0]||(l[0]=e=>(0,d.i9)(c)?c.value=e:null),addText:"添加",onAdd:l[1]||(l[1]=e=>g(null)),onEdit:g,onDelete:b,prop:{label:"name",value:"id",disabled:function(e){return e.builtin}}},{right:(0,o.k6)(e=>[(0,o.bF)(a,{size:"default",type:e.data.enabled?"success":"danger"},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.data.enabled?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1},8,["data","prop"])]),_:1},8,["size"])]),_:1})}}});const Al=(0,Q.A)(Ll,[["__scopeId","data-v-bbc947b2"]]);var xl=Al;const Nl=()=>{function e(e){switch(e.objectFieldType){case"String":case"Long":return"String";case"Date":return"Date";case"Boolean":return"Boolean";case"Integer":case"Float":case"Double":case"BigDecimal":return"Number";default:return}}function l(l,a,t){if(null==l)return{disabled:!0,warningMsg:"错误的字段数据"};const i=e(l);let n=!1,o=null;if(l.fieldKind===p.SysOnlineFieldKind.UPLOAD)n=a!==H.SysCustomWidgetType.Upload&&a!==H.SysCustomWidgetType.Video,o=p.SysOnlineFieldKind.getValue(l.fieldKind);else if(l.fieldKind===p.SysOnlineFieldKind.UPLOAD_IMAGE)n=a!==H.SysCustomWidgetType.Upload&&a!==H.SysCustomWidgetType.Image,o=p.SysOnlineFieldKind.getValue(l.fieldKind);else if(l.fieldKind===p.SysOnlineFieldKind.RICH_TEXT)n=a!==H.SysCustomWidgetType.RichEditor&&a!==H.SysCustomWidgetType.Label,o=p.SysOnlineFieldKind.getValue(l.fieldKind);else if(l.fieldKind===p.SysOnlineFieldKind.CREATE_TIME||l.fieldKind===p.SysOnlineFieldKind.CREATE_USER_ID||l.fieldKind===p.SysOnlineFieldKind.UPDATE_TIME||l.fieldKind===p.SysOnlineFieldKind.UPDATE_USER_ID||l.fieldKind===p.SysOnlineFieldKind.AUTO_CODE||l.fieldKind===p.SysOnlineFieldKind.LOGIC_DELETE)n=a!==H.SysCustomWidgetType.Label&&a!==H.SysCustomWidgetType.Text&&-1===[H.SysOnlineFormType.QUERY,H.SysOnlineFormType.ADVANCE_QUERY,H.SysOnlineFormType.GROUP_QUERY,H.SysOnlineFormType.ONE_TO_ONE_QUERY].indexOf(t),o=p.SysOnlineFieldKind.getValue(l.fieldKind);else switch(a){case H.SysCustomWidgetType.Label:case H.SysCustomWidgetType.MobileInputFilter:n=!1;break;case H.SysCustomWidgetType.Text:n=l.fieldKind===p.SysOnlineFieldKind.UPLOAD_IMAGE;break;case H.SysCustomWidgetType.Image:n=l.fieldKind!==p.SysOnlineFieldKind.UPLOAD_IMAGE;break;case H.SysCustomWidgetType.Input:n="String"!==i&&"Number"!==i;break;case H.SysCustomWidgetType.Signature:n="String"!==i;break;case H.SysCustomWidgetType.NumberInput:case H.SysCustomWidgetType.NumberRange:case H.SysCustomWidgetType.MobileNumberRangeFilter:n="Number"!==i;break;case H.SysCustomWidgetType.Switch:case H.SysCustomWidgetType.MobileSwitchFilter:n="Boolean"!==i&&"Number"!==i;break;case H.SysCustomWidgetType.Slider:case H.SysCustomWidgetType.Stepper:case H.SysCustomWidgetType.Rate:n="Number"!==i;break;case H.SysCustomWidgetType.Radio:case H.SysCustomWidgetType.Select:case H.SysCustomWidgetType.DictSelect:case H.SysCustomWidgetType.Cascader:case H.SysCustomWidgetType.CheckBox:case H.SysCustomWidgetType.Tree:case H.SysCustomWidgetType.RadioButtonGroup:case H.SysCustomWidgetType.MobileRadioFilter:case H.SysCustomWidgetType.MobileCheckBoxFilter:n="String"!==i&&"Number"!==i||null==l.dictId,null==l.dictId&&(o="未绑定字典"),a===H.SysCustomWidgetType.DictSelect&&l.dictInfo&&l.dictInfo.dictType!==H.SysOnlineDictType.TABLE&&(n=!0,o="字典类型必须为表字典");break;case H.SysCustomWidgetType.Date:case H.SysCustomWidgetType.DateRange:case H.SysCustomWidgetType.Calendar:case H.SysCustomWidgetType.MobileDateRangeFilter:n="Date"!==i;break;case H.SysCustomWidgetType.Upload:n=l.fieldKind!==p.SysOnlineFieldKind.UPLOAD;break;case H.SysCustomWidgetType.RichEditor:n=l.fieldKind!==p.SysOnlineFieldKind.RICH_TEXT;break;case H.SysCustomWidgetType.UserSelect:case H.SysCustomWidgetType.DeptSelect:n="String"!==i&&"Number"!==i;break;case H.SysCustomWidgetType.DataSelect:n=!l.oneToOnyRelationColumn;break;case H.SysCustomWidgetType.BARCODE:case H.SysCustomWidgetType.QRCODE:case H.SysCustomWidgetType.MAP:n="String"!==i;break;default:n=!0;break}return n&&null==o&&(o=a===H.SysCustomWidgetType.DataSelect?"不是一对一关联字段":"字段类型不匹配"),{disabled:n,warningMsg:o}}return{columnIsValidByWidgetType:l,getColumnDataType:e}};var Dl=(0,o.pM)({__name:"CustomWidgetBindData",props:{value:{}},emits:["update:value"],setup(e,{emit:l}){const a=l,t=e,n=(0,o.WQ)("formConfig",()=>(console.error("CustomWidgetBindData: formConfig not injected"),{})),{columnIsValidByWidgetType:r}=Nl(),s=(0,o.EW)({get(){return console.log("widgetBindData >>>>>>>>>>",t.value),t.value},set(e){console.log("widget bindData change",e),a("update:value",e)}}),m=(0,o.EW)(()=>qe.A.supportBindTable(s.value)),c=(0,o.EW)(()=>qe.A.supportBindColumn(s.value)),b=(0,o.EW)(()=>H.SysCustomWidgetBindDataType.getList().filter(e=>{switch(e.id){case H.SysCustomWidgetBindDataType.Column:return!0;case H.SysCustomWidgetBindDataType.Custom:return!0;case H.SysCustomWidgetBindDataType.SYSTEM_VARIABLE:return s.value.widgetType===H.SysCustomWidgetType.Label;case H.SysCustomWidgetBindDataType.Fixed:return s.value.widgetType===H.SysCustomWidgetType.Image||s.value.widgetType===H.SysCustomWidgetType.Text;default:return!1}})),v=(0,o.EW)(()=>n().form.formType),g=(0,o.EW)(()=>v.value===H.SysOnlineFormType.QUERY||v.value===H.SysOnlineFormType.ADVANCE_QUERY||v.value===H.SysOnlineFormType.GROUP_QUERY||v.value===H.SysOnlineFormType.ONE_TO_ONE_QUERY||v.value===H.SysOnlineFormType.WORK_ORDER),f=(0,o.EW)(()=>s.value.isTableExpand||s.value.hasParent?n().getTableWidgetTableList:s.value.widgetType===H.SysCustomWidgetType.Table||s.value.widgetType===H.SysCustomWidgetType.List?n().getTableWidgetTableList.filter(e=>v.value!==H.SysOnlineFormType.QUERY&&v.value!==H.SysOnlineFormType.ONE_TO_ONE_QUERY||e.tableId===n().getMasterTable.tableId):s.value.widgetType===H.SysCustomWidgetType.DataSelect?n().getValidTableList.filter(e=>e.tableId===n().getMasterTable.tableId):n().getValidTableList),y=(0,o.EW)(()=>(0,E.PH)(f.value,s.value.bindData.tableId,"tableId")),_=(0,o.EW)(()=>{let e=y.value?y.value.columnList.map(e=>{let{disabled:l,warningMsg:a}=r(e,s.value.widgetType,v.value);return l||e.filterType!==p.SysOnlineColumnFilterType.NONE||"mobile"===n().activeMode||-1===[H.SysOnlineFormType.QUERY,H.SysOnlineFormType.ADVANCE_QUERY,H.SysOnlineFormType.GROUP_QUERY,H.SysOnlineFormType.ONE_TO_ONE_QUERY,H.SysOnlineFormType.WORK_ORDER].indexOf(v.value)||(l=!0,a="未支持过滤"),{...e,disabled:l,warningMsg:a}}).sort((e,l)=>(e.disabled?1:0)-(l.disabled?1:0)):[];return e}),C=(0,o.EW)(()=>(n().getWidgetAttribute(s.value.widgetType)||{}).attribute),I=()=>{s.value.props.dictInfo={dictId:void 0,paramList:[]}},w=()=>{I(),s.value.widgetType===H.SysCustomWidgetType.Table&&(s.value.props.likeQueryColumn=[],s.value.props.groupColumn=void 0,s.value.props.orderColumn="",s.value.props.parentIdColumn="",s.value.props.supportExpand=!1,s.value.props.tableColumnList=[],s.value.operationList=s.value.operationList.filter(e=>(e.builtin&&(e.enabled=!1,e.eventList=[],e.formId=void 0),e.builtin)))},W=(e=null)=>{I(),e&&(console.log("## onBindColumnChange",s.value),s.value.bindData.column=(0,E.PH)(_.value,e,"columnId"),s.value.column=s.value.bindData.column,s.value.column&&(s.value.showName=s.value.column.columnComment,s.value.variableName=s.value.column.objectFieldName||s.value.column.columnName,null!=s.value.props.required&&(null==s.value.column.required?s.value.props.required=!s.value.column.nullable:s.value.props.required=s.value.column.required)),s.value.widgetType===H.SysCustomWidgetType.Text&&(s.value.props.text=(s.value.column||{}).columnComment||"文本组件"))},O=()=>{let e={};null!=C.value&&Object.keys(C.value).forEach(l=>{let a=C.value[l];"function"===typeof a.value&&(e[l]=a.value(n()))}),s.value.props={...s.value.props,...e}},V=()=>{if(s.value.bindData.table=y.value,y.value)if(null==y.value.relationType)s.value.datasource=y.value.tag;else{s.value.relation=y.value.tag;let e=(0,E.PH)(n().getAllTableList,s.value.relation.datasourceId,"id");s.value.datasource=e?e.tag:void 0}null==s.value.datasource&&console.error("没有找到组件绑定的数据源！"),s.value.bindData.columnId=void 0,W(),O()};return(0,o.wB)(()=>f.value,()=>{null==s.value.bindData?.tableId&&f.value&&1===f.value.length&&(s.value.bindData.tableId=f.value[0].tableId,V())},{deep:!0,immediate:!0}),(e,l)=>{const a=k.WK,t=R.xE,r=F.P9,p=F.AV,v=S.u,y=i.S2,C=h.uD,I=R.US;return(0,o.uX)(),(0,o.Wv)(y,{style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(I,{"label-position":"top",size:"default",style:{width:"100%"},onSubmit:l[7]||(l[7]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(C,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(t,{label:"组件类型"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{"model-value":(0,d.R1)(H.SysCustomWidgetType).getValue((0,d.R1)(s).widgetType),disabled:!0},null,8,["model-value"])]),_:1}),!(0,d.R1)(m)&&!(0,d.R1)(c)||(0,d.R1)(g)?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(t,{key:0,label:"绑定类型"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{modelValue:(0,d.R1)(s).bindData.dataType,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(s).bindData.dataType=e),onChange:w,style:{width:"100%"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(b),e=>((0,o.uX)(),(0,o.Wv)(r,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})),(0,d.R1)(s).bindData?.dataType===(0,d.R1)(H.SysCustomWidgetBindDataType).Column&&(0,d.R1)(m)?((0,o.uX)(),(0,o.Wv)(t,{key:1,label:"绑定表"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{style:{width:"100%"},modelValue:(0,d.R1)(s).bindData.tableId,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(s).bindData.tableId=e),placeholder:"",filterable:"",onChange:V},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(f),e=>((0,o.uX)(),(0,o.Wv)(r,{key:e.tableId,value:e.tableId,label:e.tableName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(s).bindData?.dataType===(0,d.R1)(H.SysCustomWidgetBindDataType).Column&&(0,d.R1)(c)?((0,o.uX)(),(0,o.Wv)(t,{key:2,label:"绑定字段"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{style:{width:"100%"},modelValue:(0,d.R1)(s).bindData.columnId,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(s).bindData.columnId=e),placeholder:"",clearable:"",filterable:"","popper-options":{placement:"bottom-end"},onChange:W},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(_),e=>((0,o.uX)(),(0,o.Wv)(r,{key:e.columnName,value:e.columnId,label:e.columnName,disabled:e.disabled},{default:(0,o.k6)(()=>[(0,o.bF)(y,{type:"flex",justify:"space-between",align:"middle"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.columnName),1),e.disabled?((0,o.uX)(),(0,o.Wv)(v,{key:0,style:{"margin-left":"40px"},size:"default",type:"info"},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.warningMsg),1)]),_:2},1024)):((0,o.uX)(),(0,o.Wv)(v,{key:1,style:{"margin-left":"40px"},size:"default",type:"success"},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.objectFieldType),1)]),_:2},1024))]),_:2},1024)]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(s).bindData?.dataType===(0,d.R1)(H.SysCustomWidgetBindDataType).SYSTEM_VARIABLE?((0,o.uX)(),(0,o.Wv)(t,{key:3,label:"系统变量"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{style:{width:"100%"},modelValue:(0,d.R1)(s).bindData.systemVariableType,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(s).bindData.systemVariableType=e),placeholder:"",filterable:""},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(H.OnlineSystemVariableType).getList(),e=>((0,o.uX)(),(0,o.Wv)(r,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(s).bindData?.dataType===(0,d.R1)(H.SysCustomWidgetBindDataType).Custom?((0,o.uX)(),(0,o.Wv)(t,{key:4,label:"自定义字段"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{style:{width:"100%"},modelValue:(0,d.R1)(s).bindData.formFieldName,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.R1)(s).bindData.formFieldName=e),placeholder:"",filterable:""},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(n)().form.customFieldList,e=>((0,o.uX)(),(0,o.Wv)(r,{key:e.fieldName,label:e.fieldName,value:e.fieldName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(t,{label:"组件名称"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{modelValue:(0,d.R1)(s).showName,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.R1)(s).showName=e),placeholder:"",clearable:"",filterable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(t,{label:"组件标识"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{modelValue:(0,d.R1)(s).variableName,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,d.R1)(s).variableName=e),placeholder:"",clearable:"",filterable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}});const Ul=(0,Q.A)(Dl,[["__scopeId","data-v-1618d390"]]);var Pl=Ul,Kl=(a(18237),a(65546)),Xl=(a(51216),a(15836)),zl=(a(95815),a(97024)),Ql=a(95757),Bl=a(21310),Ml=a(42029),jl=a(41405),Yl=a(85676),ql=a(39204),Jl=a(76105),Gl=a(33739),Hl=a(21231);const Zl={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var $l=(0,o.pM)({__name:"editCustomListOrder",props:{rowData:{},tableList:{},usedColumnList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,y.l5)(),a=e,t=(0,o.EW)(()=>l.defaultFormItemSize||r.value.defaultFormItemSize?.value),{thirdParams:r,onCloseThirdDialog:s}=(0,f.P)(a),m=(0,d.KR)(),p=(0,d.KR)({id:void 0,tableId:void 0,columnId:void 0,showName:void 0}),c=(0,d.KR)(),b={showName:[{required:!0,message:"显示名不能为空",trigger:"blur"}],tableId:[{required:!0,message:"数据表不能为空",trigger:"blur"}],columnId:[{required:!0,message:"绑定字段不能为空",trigger:"blur"}]},v=(0,o.EW)(()=>({rowData:a.rowData||r.value.rowData,tableList:a.tableList||r.value.tableList,usedColumnList:a.usedColumnList||r.value.usedColumnList||[]})),g=(0,o.EW)(()=>(0,E.PH)(v.value.tableList,p.value.tableId,"tableId")),_=(0,o.EW)(()=>null!=g.value?g.value.columnList.filter(e=>-1===v.value.usedColumnList.indexOf(e.columnId)||c.value===e.columnId):[]),C=()=>{a.dialog?a.dialog.cancel():s(!1)},I=()=>{m.value.validate(e=>{e&&e&&(null==p.value.id&&(p.value.id=(new Date).getTime()),p.value.relationId=null==(g.value||{}).relationType?void 0:g.value?.id,a.dialog?a.dialog?.submit(p.value):s(!0,v.value.rowData,p.value))})},w=()=>{p.value.columnId=void 0},W=()=>{let e=(0,E.PH)(_.value,p.value.columnId,"columnId");p.value.showName=e?e.columnComment:void 0};return(0,o.sV)(()=>{null!=v.value.rowData&&(p.value={...p.value,...v.value.rowData},c.value=p.value.columnId)}),(e,l)=>{const a=S.u,r=i.S2,s=F.P9,c=F.AV,g=R.xE,f=h.uD,y=k.WK,O=R.US,E=n.S2;return(0,o.uX)(),(0,o.CE)("div",Zl,[(0,o.bF)(O,{ref_key:"form",ref:m,model:(0,d.R1)(p),class:"full-width-input form-box",rules:b,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(t),"label-position":"right",onSubmit:l[3]||(l[3]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(r,null,{default:(0,o.k6)(()=>[(0,o.bF)(f,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(g,{label:"字段数据表",prop:"tableId"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{class:"input-item",modelValue:(0,d.R1)(p).tableId,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.R1)(p).tableId=e),disabled:null!=(0,d.R1)(v).rowData,clearable:!0,placeholder:"字段数据表",onChange:w},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(v).tableList,(e,l)=>((0,o.uX)(),(0,o.Wv)(s,{key:e.tableId,label:e.tableName,value:e.tableId},{default:(0,o.k6)(()=>[(0,o.bF)(r,{type:"flex",justify:"space-between",align:"middle"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.tableName),1),(0,o.bF)(a,{type:null==e.relationType?"success":"primary",style:{"margin-left":"30px"},size:(0,d.R1)(t),effect:"dark"},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(null==e.relationType||0===l?"主表":"一对一关联"),1)]),_:2},1032,["type","size"])]),_:2},1024)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,o.bF)(f,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(g,{label:"绑定字段",prop:"columnId"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{class:"input-item",modelValue:(0,d.R1)(p).columnId,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.R1)(p).columnId=e),disabled:null!=(0,d.R1)(v).rowData,clearable:!0,placeholder:"绑定字段",onChange:W},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(_),e=>((0,o.uX)(),(0,o.Wv)(s,{key:e.columnId,label:e.columnName,value:e.columnId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,o.bF)(f,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(g,{label:"显示名",prop:"showName"},{default:(0,o.k6)(()=>[(0,o.bF)(y,{modelValue:(0,d.R1)(p).showName,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(p).showName=e),clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,o.bF)(r,{class:"no-scroll menu-box",type:"flex",justify:"end"},{default:(0,o.k6)(()=>[(0,o.bF)(E,{type:"primary",size:(0,d.R1)(t),plain:!0,onClick:C},{default:(0,o.k6)(()=>l[4]||(l[4]=[(0,o.eW)(" 取消 ")])),_:1,__:[4]},8,["size"]),(0,o.bF)(E,{type:"primary",size:(0,d.R1)(t),onClick:I},{default:(0,o.k6)(()=>l[5]||(l[5]=[(0,o.eW)(" 保存 ")])),_:1,__:[5]},8,["size"])]),_:1})])}}});const ea=$l;var la=ea,aa=(0,o.pM)({__name:"index",props:{value:{}},emits:["update:value"],setup(e,{emit:l}){const a=l,t=e,i=(0,o.WQ)("formConfig",()=>(console.error("OnlineCustomListOrderSetting: formConfig not injected"),{})),n=e=>{a("update:value",e)},d=(e,l)=>{let i=[];null==e?(i=t.value||[],i.push(l)):i=(t.value||[]).map(e=>e.columnId===l.id?l:e),a("update:value",i)},u=(e=null)=>{let l=i().getTableWidgetTableList;i().form.formType!==H.SysOnlineFormType.QUERY&&(l=(l||[]).filter(e=>e.tableId===i().currentWidget.bindData.tableId)),m.l.show(e?"编辑排序字段":"添加排序字段",la,{area:"500px"},{rowData:e,tableList:l,usedColumnList:t.value.map(e=>e.columnId),path:"thirdEditOnlineListOrder"},{width:"500px",height:"500px",pathName:"/thirdParty/thirdEditOnlineListOrder"}).then(l=>{d(e,l)}).catch(e=>{console.warn(e)})},r=e=>{s.s.confirm("是否删除此排序字段？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a("update:value",(t.value||[]).filter(l=>l!==e))}).catch(e=>{console.warn(e)})};return(e,l)=>((0,o.uX)(),(0,o.Wv)(Hl.A,{data:e.value,addText:"添加排序字段",supportSort:!0,onAdd:l[0]||(l[0]=e=>u()),onEdit:u,onDelete:r,"onUpdate:data":n,prop:{label:"showName",value:"id"}},null,8,["data"]))}});const ta=aa;var ia=ta,na=a(50942);a(8696);const oa={class:"item",style:{padding:"0px 15px 0px 5px",width:"100%"}},da={key:1},ua={class:"right",style:{"line-height":"20px","font-size":"12px"}};var ra=(0,o.pM)({__name:"index",props:{label:{},data:{},disabled:{type:Boolean,default:!1},maxCount:{},supportSort:{type:Boolean,default:!1},supportAdd:{type:Boolean,default:!0},dragGroup:{default:"componentsGroup"},prop:{default:()=>({label:"name",value:"id",disabled:void 0})},addText:{},nodeAllowDrop:{type:Function,default:()=>(e,l,a)=>!0}},emits:["add","edit","delete","dragEnd","update:data"],setup(e,{emit:l}){const a=e,t=l,n=(0,o.EW)(()=>(0,o.nI)()?.slots.default),r=(0,o.EW)({get:()=>{if(null==a.data)return[];let e=Array.isArray(a.data)?a.data:[a.data];return e},set:e=>{t("update:data",e)}}),s=e=>{let l=!1;return null!=e&&null!=a.prop.disabled&&(l="function"===typeof a.prop.disabled?a.prop.disabled(e):e[a.prop.disabled]),a.disabled||null==e||l},m=e=>{a.disabled||(null==e?t("add"):t("edit",e))},p=e=>{s(e)||t("delete",e)},c=e=>"function"===typeof a.prop.label?a.prop.label(e):e[a.prop.label],b=(e,l,i)=>{a.disabled||t("dragEnd",e,l,i)};return(e,l)=>{const a=(0,o.g2)("right-add-btn"),t=i.S2,v=Ue.C4,g=rl.tk,f=na.qk,y=R.xE;return(0,o.uX)(),(0,o.Wv)(y,{class:(0,u.C4)(["tree-item-list",{empty:((0,d.R1)(r)||[]).length<=0}])},{label:(0,o.k6)(()=>[(0,o.bF)(t,{type:"flex",justify:"space-between",align:"middle",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.label),1),(0,o.bF)(a,{class:"add-btn",type:"text",icon:"el-icon-circle-plus",disabled:e.disabled||!e.supportAdd||e.maxCount<=((0,d.R1)(r)||[]).length,onClick:l[0]||(l[0]=(0,T.D$)(e=>m(),["prevent","stop"]))},{default:(0,o.k6)(()=>l[1]||(l[1]=[(0,o.eW)("添加")])),_:1,__:[1]},8,["disabled"])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(t,{style:{overflow:"hidden",height:"100%",display:"inline-block",width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(f,{class:"list-item",data:(0,d.R1)(r),"node-key":e.prop.id,draggable:e.supportSort,props:e.prop,"allow-drop":e.nodeAllowDrop,onNodeDragEnd:b},{default:(0,o.k6)(({data:l})=>[(0,o.Lk)("div",oa,[(0,o.bF)(t,{type:"flex",align:"middle",justify:"space-between",style:{padding:"6px 0px","min-height":"32px"}},{default:(0,o.k6)(()=>[(0,o.bF)(v,{style:{"line-height":"20px",color:"#333333","font-size":"12px"},disabled:e.disabled,onClick:(0,T.D$)(e=>m(l),["stop"])},{default:(0,o.k6)(()=>[(0,d.R1)(n)?(0,o.RG)(e.$slots,"default",{key:0,data:l}):((0,o.uX)(),(0,o.CE)("span",da,(0,u.v_)(c(l)),1))]),_:2},1032,["disabled","onClick"]),(0,o.Lk)("div",ua,[(0,o.RG)(e.$slots,"right",{data:l})])]),_:2},1024),(0,o.bF)(g,{style:{"margin-left":"8px",color:"#333"},class:(0,u.C4)(["close-btn",{disabled:s(l)}]),onClick:(0,T.D$)(e=>p(l),["stop"])},{default:(0,o.k6)(()=>[(0,o.bF)((0,d.R1)(W.Remove))]),_:2},1032,["class","onClick"])])]),_:3},8,["data","node-key","draggable","props","allow-drop"])]),_:3})]),_:3},8,["class"])}}});const sa=(0,Q.A)(ra,[["__scopeId","data-v-1626a886"]]);var ma=sa,pa=a(72569),ca=(0,o.pM)({__name:"index",props:{value:{}},emits:["update:value"],setup(e,{emit:l}){const a=e,t=((0,y.l5)(),(0,o.WQ)("formConfig",()=>(console.error("OnlineTableColumnSetting: formConfig not injected"),{}))),i=l,n=(0,o.EW)(()=>a.value.filter(e=>e.isGroup)),d=e=>{i("update:value",e)},r=(e,l)=>null==e||null==e.parentId?null:(0,E.Ee)(l||a.value||[],e.parentId,"columnId"),p=(e,l)=>{let t=JSON.parse(JSON.stringify(a.value||[])),i=r(l,t);if(l.isGroup&&null==l.columnId&&(l.columnId=(new Date).getTime()+"_column"),null==e)i?(i.children=i.children||[],i.children.push(l)):t.push(l);else{let a=r(e,t);if(e.parentId!==l.parentId)a?a.children=(a.children||[]).filter(l=>l.columnId!==e.columnId):t=t.filter(l=>l.columnId!==e.columnId),null!=i?(i.children=i.children||[],i.children.push(l)):t.push(l);else{let e=i?i.children:t;e=(e||[]).map(e=>0===l.fieldType?e.columnId===l.columnId?l:e:e.id===l.id?l:e),i?i.children=e:t=e}}d(t)},c=(e=null)=>{let l=t().getTableWidgetTableList;t().form.formType!==H.SysOnlineFormType.QUERY&&t().form.formType!==H.SysOnlineFormType.ADVANCE_QUERY&&t().form.formType!==H.SysOnlineFormType.GROUP_QUERY&&(l=(l||[]).filter(e=>e.tableId===t().currentWidget.bindData.tableId)),m.l.show(e?"编辑字段":"添加字段",pa["default"],{area:"600px"},{rowData:e,tableList:l,usedColumnList:a.value.map(e=>e.columnId),formConfig:t(),supportGroup:t().form.formType!==H.SysOnlineFormType.WORK_ORDER,groupColumnList:n.value}).then(l=>{p(e,l)}).catch(e=>{console.warn(e)})},b=e=>{s.s.confirm("是否删除此表格列？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l=r(e),t=l?l.children:a.value;t=(t||[]).filter(l=>l.columnId!==e.columnId),l&&(l.children=t);let i=l?a.value:t;i=JSON.parse(JSON.stringify(i||[])),d(i)}).catch(e=>{console.warn(e)})},v=(e,l,a)=>"inner"!==a||l.data.isGroup,g=(e,l,t)=>{e.data.parentId="inner"===t?l.data.columnId:l.data.parentId,d(JSON.parse(JSON.stringify(a.value||[])))};return(e,l)=>{const a=S.u;return(0,o.uX)(),(0,o.Wv)(ma,{data:e.value,label:"表格字段",supportSort:!0,nodeAllowDrop:v,onAdd:l[0]||(l[0]=e=>c()),onEdit:c,onDelete:b,"onUpdate:data":d,onDragEnd:g,prop:{label:"showName",value:"columnId"}},{default:(0,o.k6)(e=>[(0,o.Lk)("div",null,[(0,o.Lk)("span",null,(0,u.v_)(e.data.showName),1),(0,o.bF)(a,{size:"mini",type:e.data.isGroup?"warning":"success",style:{"margin-left":"8px"}},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.data.isGroup?"分组":"数据"),1)]),_:2},1032,["type"])])]),_:1},8,["data"])}}});const ba=ca;var va=ba;const ga={class:"col-list",style:{width:"100%"}},fa=["onClick"],ya={style:{"margin-right":"5px","font-size":"12px"}},Ra={class:"col-attribute",style:{padding:"20px",background:"#fafbfc"}},ka=["onClick"],ha=["onClick"],Fa=["onClick"];var Ta=(0,o.pM)({__name:"CustomTableContainerSetting",setup(e){const l=(0,o.WQ)("formConfig",()=>(console.error("CustomTableContainerSetting: formConfig not injected"),{})),a=(0,d.KR)([]),t=(0,o.EW)(()=>l().currentWidget.props.actions),n=(0,o.EW)(()=>Array.isArray(t.value.indexData)?t.value.indexData:[]),r=(0,o.EW)(()=>{if(!Array.isArray(n.value)||0===n.value.length)return[];let e=n.value[0];return e.map((e,l)=>(a.value[l]=null==a.value[l]||a.value[l],{colIndex:l,width:e.width,valign:e.valign,bgColor:e.bgColor,colName:`第 ${l+1} 列`}))}),m=(e,l)=>{t.value[e]&&t.value[e](l)},p=()=>{m("setSource",{rowIndex:0,colIndex:n.value[0].length-1}),m("insertColumns")},c=e=>{s.s.confirm(`是否删除 ${e.colName} ?`,"",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a.value.splice(e.colIndex,1),m("deleteColumns",e.colIndex)}).catch(e=>{console.warn(e)})},b=(e,l)=>{e.width=l,f(e)},v=(e,l)=>{e.bgColor=l,f(e)},g=(e,l)=>{e.valign=l,f(e)},f=e=>{t.value.setColumn(e.colIndex,{...e})},y=e=>{a.value[e.colIndex]=!a.value[e.colIndex],a.value=[...a.value]};return(e,l)=>{const t=rl.tk,n=i.S2,s=k.WK,m=Kl.rF,f=R.xE,h=R.US;return(0,o.uX)(),(0,o.Wv)(h,{class:"custom-widget-attribute custom-table-container-setting","label-position":"top","label-width":"115px",size:"default",onSubmit:l[0]||(l[0]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(f,{label:"列管理",style:{width:"100%"}},{label:(0,o.k6)(()=>[(0,o.bF)(n,{justify:"space-between",align:"middle",style:{width:"100%"}},{default:(0,o.k6)(()=>[l[1]||(l[1]=(0,o.Lk)("span",null,"列管理",-1)),(0,o.bF)(t,{style:{cursor:"pointer","font-size":"14px"},onClick:p},{default:(0,o.k6)(()=>[(0,o.bF)((0,d.R1)(W.CirclePlus))]),_:1})]),_:1,__:[1]})]),default:(0,o.k6)(()=>[(0,o.Lk)("div",ga,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(r),e=>((0,o.uX)(),(0,o.CE)("div",{class:"col-item",key:e.colIndex},[(0,o.bF)(n,{type:"flex",justify:"space-between",align:"middle",style:{width:"100%",height:"40px","line-height":"40px","font-size":"14px"}},{default:(0,o.k6)(()=>[(0,o.Lk)("div",{onClick:l=>y(e),style:{display:"flex","align-items":"center",cursor:"pointer"}},[(0,o.Lk)("span",ya,(0,u.v_)(e.colName),1),(0,o.bF)(t,null,{default:(0,o.k6)(()=>[(0,d.R1)(a)[e.colIndex]?((0,o.uX)(),(0,o.Wv)((0,d.R1)(W.CaretTop),{key:0})):((0,o.uX)(),(0,o.Wv)((0,d.R1)(W.CaretBottom),{key:1}))]),_:2},1024)],8,fa),(0,o.bF)(t,{style:{cursor:"pointer"},onClick:l=>c(e)},{default:(0,o.k6)(()=>[(0,o.bF)((0,d.R1)(W.Remove))]),_:2},1032,["onClick"])]),_:2},1024),(0,o.bo)((0,o.Lk)("div",Ra,[(0,o.bF)(n,{class:"col-attribute-item",justify:"space-between",align:"middle"},{default:(0,o.k6)(()=>[l[2]||(l[2]=(0,o.Lk)("span",{class:"label"},"列宽设置",-1)),(0,o.bF)(s,{size:"default","model-value":e.width,style:{width:"130px"},"onUpdate:modelValue":l=>b(e,l)},null,8,["model-value","onUpdate:modelValue"])]),_:2,__:[2]},1024),(0,o.bF)(n,{class:"col-attribute-item",type:"flex",justify:"space-between",align:"middle"},{default:(0,o.k6)(()=>[l[3]||(l[3]=(0,o.Lk)("span",{class:"label"},"背景颜色",-1)),(0,o.bF)(m,{size:"small","model-value":e.bgColor,"onUpdate:modelValue":l=>v(e,l)},null,8,["model-value","onUpdate:modelValue"])]),_:2,__:[3]},1024),(0,o.bF)(n,{class:"col-attribute-item",type:"flex",justify:"space-between",align:"middle",style:{"margin-top":"10px"}},{default:(0,o.k6)(()=>[l[4]||(l[4]=(0,o.Lk)("span",{class:"label"},"对齐方式",-1)),(0,o.Lk)("div",null,[(0,o.Lk)("i",{class:(0,u.C4)(["online-icon icon-align-top align-item",{active:"top"===e.valign}]),onClick:l=>g(e,"top")},null,10,ka),(0,o.Lk)("i",{class:(0,u.C4)(["online-icon icon-align-middle align-item",{active:"middle"===e.valign}]),onClick:l=>g(e,"middle")},null,10,ha),(0,o.Lk)("i",{class:(0,u.C4)(["online-icon icon-align-bottom align-item",{active:"bottom"===e.valign}]),onClick:l=>g(e,"bottom")},null,10,Fa)])]),_:2,__:[4]},1024)],512),[[T.aG,(0,d.R1)(a)[e.colIndex]]])]))),128))])]),_:1})]),_:1})}}});const _a=(0,Q.A)(Ta,[["__scopeId","data-v-8fb2d9d6"]]);var Ca=_a,Ia=(0,o.pM)({__name:"EditWidgetAttribute",props:{value:{},valueKey:{},attributeItem:{default:()=>({})},allFormList:{default:()=>[]}},emits:["update:value"],setup(e,{emit:l}){const a={OnlineTableColumnSetting:va,CustomWidgetDictSetting:Yl.A,OnlineTabPanelSetting:jl.A,OnlineImageUrlInput:Jl.A,ChartTooltipSetting:zl.A,PivotTableBasicSetting:Ql.A,PivotTableGroupSetting:Bl.A,PivotTableTotalSetting:Ml.A,DateViewTablePagerSetting:ql.A,CustomWidgetRelativeTableSetting:Gl.A,OnlineCustomListOrderSetting:ia,CustomTableContainerSetting:Ca},t=l,n=e,r=(0,o.WQ)("formConfig",()=>(console.error("CustomWidgetAttributeSetting: formConfig not injected"),{})),s=(0,d.KR)({}),m=(0,d.KR)([]),p=(0,o.EW)({get(){return n.value[n.valueKey]},set(e){const l={...n.value};l[n.valueKey]=e,console.log("value change >>>",e,l),t("update:value",l)}}),c=(0,o.EW)(()=>n.attributeItem.widgetType),b=(0,o.EW)(()=>r().currentWidget),v=(0,o.EW)(()=>{if(null==b.value)return!1;let e=-1!==[H.SysCustomWidgetType.Select,H.SysCustomWidgetType.Cascader,H.SysCustomWidgetType.Radio,H.SysCustomWidgetType.CheckBox].indexOf(b.value.widgetType);return e&&b.value&&"dictId"===n.attributeItem.attributeKey}),g=e=>{console.log("onValueChange 》",e),v.value&&(b.value.dictInfo=e?(0,E.PH)(r().dictList,e.toString(),"id"):{})},f=()=>{m.value=[],"function"===typeof n.attributeItem.dropdownList?m.value=n.attributeItem.dropdownList(r()):m.value=Array.isArray(n.attributeItem.dropdownList)?n.attributeItem.dropdownList:[],1===(m.value||[]).length&&g(m.value[0].id)},y=()=>{let e={};e=n.attributeItem.customComponent?n.attributeItem.customComponent.props||{}:n.attributeItem.props||{},e.disabled=n.attributeItem.disabled||e.disabled,s.value=Object.keys(e).reduce((l,a)=>{let t=e[a];return"function"===typeof t&&(t=t(r())),l[a]=t,l},{})};return(0,o.wB)(()=>n.attributeItem.dropdownList,()=>{f()},{immediate:!0}),(0,o.wB)(()=>b.value?.bindData.dataType,()=>{f(),y()},{deep:!0,immediate:!0}),(0,o.wB)(()=>n.attributeItem,()=>{y()},{immediate:!0,deep:!0}),(e,l)=>{const t=k.WK,n=Y.lq,b=i.S2,v=q.ll,f=q.MQ,y=Xl.B8,h=D.qi,T=F.P9,_=F.AV,C=Kl.rF,I=V._m,S=R.xE;return(0,o.uX)(),(0,o.Wv)(S,{style:{width:"100%"},class:"widget-attribute-item",label:!1!==e.attributeItem.showLabel?e.attributeItem.name:void 0,"label-width":!1!==e.attributeItem.showLabel?void 0:"0px"},{default:(0,o.k6)(()=>[(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).Input?((0,o.uX)(),(0,o.Wv)(t,(0,o.v6)({key:0,style:{width:"100%"},clearable:"",modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.i9)(p)?p.value=e:null)},(0,d.R1)(s)),null,16,["modelValue"])):(0,o.Q3)("",!0),(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).NumberInput?((0,o.uX)(),(0,o.Wv)(b,{key:1,type:"flex",style:{width:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(n,(0,o.v6)({style:{width:"100%"},clearable:"","controls-position":"right",min:e.attributeItem.min,max:e.attributeItem.max,modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[1]||(l[1]=e=>(0,d.i9)(p)?p.value=e:null)},(0,d.R1)(s)),null,16,["min","max","modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).Radio?((0,o.uX)(),(0,o.Wv)(b,{key:2,type:"flex",align:"middle",style:{width:"100%",height:"32px"}},{default:(0,o.k6)(()=>[(0,o.bF)(f,(0,o.v6)({size:"default",modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.i9)(p)?p.value=e:null)},(0,d.R1)(s)),{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(m),e=>((0,o.uX)(),(0,o.Wv)(v,{key:e.id,value:e.id},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},16,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).Slider?((0,o.uX)(),(0,o.Wv)(y,(0,o.v6)({key:3,style:{display:"inline-block",width:"95%","margin-left":"5px"},min:e.attributeItem.min,max:e.attributeItem.max,modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.i9)(p)?p.value=e:null)},(0,d.R1)(s)),null,16,["min","max","modelValue"])):(0,o.Q3)("",!0),(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).Switch?((0,o.uX)(),(0,o.Wv)(b,{key:4,type:"flex",align:"middle",style:{width:"100%",height:"32px"}},{default:(0,o.k6)(()=>[(0,o.bF)(h,(0,o.v6)({modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.i9)(p)?p.value=e:null)},(0,d.R1)(s)),null,16,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).Select?((0,o.uX)(),(0,o.Wv)(_,(0,o.v6)({key:5,style:{width:"100%"},modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.i9)(p)?p.value=e:null)},(0,d.R1)(s),{placeholder:""}),{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(m),e=>((0,o.uX)(),(0,o.Wv)(T,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},16,["modelValue"])):(0,o.Q3)("",!0),(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).ColorPicker?((0,o.uX)(),(0,o.Wv)(b,{key:6,type:"flex",align:"middle",style:{width:"100%",height:"32px"}},{default:(0,o.k6)(()=>[(0,o.bF)(C,(0,o.v6)({size:"default",modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[6]||(l[6]=e=>(0,d.i9)(p)?p.value=e:null)},(0,d.R1)(s)),null,16,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,d.R1)(c)===(0,d.R1)(H.SysCustomWidgetType).Cascader?((0,o.uX)(),(0,o.Wv)(I,(0,o.v6)({key:7,style:{width:"100%"},modelValue:(0,d.R1)(p),"onUpdate:modelValue":l[7]||(l[7]=e=>(0,d.i9)(p)?p.value=e:null),onInput:g},(0,d.R1)(s),{onChange:l[8]||(l[8]=l=>e.$emit("change")),options:(0,d.R1)(m)}),null,16,["modelValue","options"])):(0,o.Q3)("",!0),e.attributeItem.customComponent?((0,o.uX)(),(0,o.Wv)((0,o.$y)(a[e.attributeItem.customComponent.component]),(0,o.v6)({key:8,style:{width:"100%"}},(0,d.R1)(s),{value:(0,d.R1)(p),"onUpdate:value":l[9]||(l[9]=e=>(0,d.i9)(p)?p.value=e:null),allFormList:e.allFormList,formConfig:(0,d.R1)(r)()}),null,16,["value","allFormList","formConfig"])):(0,o.Q3)("",!0)]),_:1},8,["label","label-width"])}}});const Sa=(0,Q.A)(Ia,[["__scopeId","data-v-53688582"]]);var wa=Sa,Wa=(0,o.pM)({__name:"CustomWidgetAttributeSetting",props:{value:{},widget:{},allFormList:{default:()=>[]}},emits:["update:value"],setup(e,{emit:l}){const a=l,t=e,i=(0,o.WQ)("formConfig",()=>(console.error("CustomWidgetAttributeSetting: formConfig not injected"),{})),n=(0,d.KR)([]),u=(0,o.EW)({get(){return console.log("wdiget attribute data",t.value),t.value},set(e){console.log("widget attribute change ==========",e),a("update:value",e)}}),r=(0,o.EW)(()=>i().currentWidget),s=(0,o.EW)(()=>(console.log("getWidgetAttributeConfig",t.widget.widgetType,i().getWidgetAttribute(t.widget.widgetType)),(i().getWidgetAttribute(t.widget.widgetType)||{}).attribute)),m=e=>"function"===typeof e?e(i()):e,p=()=>{n.value=[],null!=s.value&&Object.keys(s.value).forEach(e=>{let l=s.value[e];if(null!=l){let a=Object.keys(l).reduce((e,a)=>(e[a]=m(l[a]),e),{attributeKey:e});a.disabled="function"===typeof a.disabled?a.disabled(i()):a.disabled,(null==a.visible||a.visible)&&n.value.push(a)}}),console.log("widget attribute list",n.value)};return(0,o.wB)(()=>r.value,()=>{p()},{immediate:!0,deep:!0}),(0,o.wB)(()=>t.widget,()=>{p()},{deep:!0,immediate:!0}),(e,l)=>{const a=R.US;return(0,o.uX)(),(0,o.Wv)(a,{class:"custom-widget-attribute","label-position":"top",style:{width:"100%"},size:"default",onSubmit:l[1]||(l[1]=(0,T.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(n),a=>((0,o.uX)(),(0,o.Wv)(wa,{key:a.attributeKey,value:(0,d.R1)(u),"onUpdate:value":l[0]||(l[0]=e=>(0,d.i9)(u)?u.value=e:null),valueKey:a.attributeKey,attributeItem:a,allFormList:e.allFormList},null,8,["value","valueKey","attributeItem","allFormList"]))),128))]),_:1})}}});const Oa=Wa;var Ea=Oa;const Va={class:"left-menu"},La={class:"img-box"},Aa={key:0,src:Ke,alt:"",style:{width:"20px"}},xa={key:1,src:Xe,alt:"",style:{width:"20px"}},Na={class:"img-box"},Da={key:0,src:ze,alt:"",style:{width:"20px"}},Ua={key:1,src:Qe,alt:"",style:{width:"20px"}},Pa={class:"left-panel"},Ka={class:"base-card-header"},Xa={class:"base-card-operation"},za={class:"tag"},Qa={class:"base-card-header"},Ba={class:"base-card-operation"},Ma={class:"group-title"},ja=["onClick"],Ya=["title"],qa={class:"name"},Ja={class:"base-card-header"},Ga={class:"base-card-operation"},Ha=["title"],Za=["title"],$a={class:"design-panel"},et={style:{"font-size":"18px"}},lt={class:"attribute-panel"};var at=(0,o.pM)({__name:"index",props:{pageType:{},allFormList:{default:()=>[]},tableList:{default:()=>[]},dictList:{default:()=>[]},height:{}},emits:["createForm","updateForm","cloneForm","deleteForm"],setup(e,{expose:l,emit:a}){const{Plus:t,Search:r,Refresh:c}=(0,je.x)(),{getFormConfig:b}=(0,g.U)(),f=a,R=((0,y.l5)(),e),F=(0,o.EW)(()=>R.height.value),_=(0,d.KR)("form"),C=(0,d.KR)({formName:void 0,widgetName:void 0,fieldName:void 0}),I=(0,d.KR)(""),w=(0,d.KR)(null),W=(0,d.KR)("props"),O=(0,o.EW)(()=>R.allFormList.filter(e=>!C.value.formName||e.formName.indexOf(C.value.formName)>=0)),V=(0,d.KR)("pc"),L=(0,o.EW)(()=>qe.A.formWidgetGroupList),A=(0,o.EW)(()=>(0,E.PH)(R.allFormList,I.value,"formId")),x=(0,o.EW)(()=>{let e=JSON.parse(JSON.stringify(L.value[V.value]||[])),l=(e||[]).filter(e=>{if(null==A.value)return!0;if(A.value?.formType===H.SysOnlineFormType.QUERY||A.value?.formType===H.SysOnlineFormType.ADVANCE_QUERY||A.value?.formType===H.SysOnlineFormType.GROUP_QUERY||A.value?.formType===H.SysOnlineFormType.ONE_TO_ONE_QUERY||A.value?.formType===H.SysOnlineFormType.WORK_ORDER){"base"===e.id&&(e.widgetList=e.widgetList.filter(e=>e.widgetType!==H.SysCustomWidgetType.List));let l="filter"===e.id||"mobile"===V.value;return A.value.formType!==H.SysOnlineFormType.WORK_ORDER&&(l=l||"tableExpand"===e.id),l}return"filter"!==e.id});return l.map(e=>({...e,widgetList:e.widgetList.filter(e=>{if(null==A.value)return!0;let l=!0;return C.value.widgetName&&(l=-1!==H.SysCustomWidgetType.getValue(e.widgetType).indexOf(C.value.widgetName)),l})}))}),N=e=>{let l=qe.A.getWidgetObject(e);return"mobile"===V.value&&(l.props.span=24),l["relation"]=void 0,l["datasource"]=void 0,l["column"]=void 0,l},D=e=>{console.log("add widget",e),null==w.value||w.value.widgetType!==H.SysCustomWidgetType.Block&&w.value.widgetType!==H.SysCustomWidgetType.Card?A.value&&A.value[V.value]&&A.value[V.value].widgetList.push(N(e)):w.value.childWidgetList.push(N(e))},U=(0,d.KR)(""),P=(0,o.EW)(()=>(R.tableList||[]).map(e=>({...e,showName:e.tag.variableName,isTable:!0,children:e.columnList.map(e=>({...e,id:e.columnId,showName:e.objectFieldName}))}))),K=(0,o.EW)(()=>P.value.map(e=>({...e,columnList:e.columnList.filter(e=>!C.value.fieldName||-1!==e.columnName.indexOf(C.value.fieldName))}))),X=e=>{switch(e){case p.SysOnlineRelationType.ONE_TO_ONE:return"";case p.SysOnlineRelationType.ONE_TO_MANY:return"warning";default:return"success"}},z=(0,o.EW)(()=>null!=A.value?(0,E.PH)(P.value,A.value?.masterTableId,"tableId"):null),Q=e=>{let l=P.value.filter(e=>null!=e.relationType);Array.isArray(e.columnList)&&e.columnList.forEach(a=>{a.oneToOnyRelationColumn=!1,a.oneToManyRelationColumn=!1,null==e.relationType&&l.forEach(e=>{let l=e.tag;l&&l.masterColumnId===a.columnId&&(a.oneToOnyRelationColumn=a.oneToOnyRelationColumn||l.relationType===p.SysOnlineRelationType.ONE_TO_ONE,a.oneToManyRelationColumn=a.oneToManyRelationColumn||l.relationType===p.SysOnlineRelationType.ONE_TO_MANY)})})},B=(0,d.KR)(),M=(e,l)=>{m.l.show("编辑字段",_l["default"],{area:["650px"]},{rowData:l,dictList:R.dictList,isMasterTable:null==z.value?.relation,path:"thirdEditTableColumn"},{width:"650px",height:"600px",pathName:"/thirdParty/thirdEditTableColumn"}).then(e=>{Object.keys(e).forEach(a=>{l[a]=e[a]}),B.value&&(0,o.dY)(()=>{B.value.$forceUpdate()})}).catch(e=>{console.log(e)})},j=e=>(0,E.PH)(R.dictList,e,"dictId"),Y=e=>{let l=j(e);return l?l.dictName:"未绑定字典"},q=e=>{("pc"===e||A.value?.formType!==H.SysOnlineFormType.ADVANCE_QUERY&&A.value?.formType!==H.SysOnlineFormType.GROUP_QUERY)&&(V.value=e,Z())},Z=()=>{w.value=null,A.value&&(A.value?.formType!==H.SysOnlineFormType.ADVANCE_QUERY&&A.value?.formType!==H.SysOnlineFormType.GROUP_QUERY||(V.value="pc"),V.value&&Array.isArray(A.value[V.value].widgetList)&&(A.value[V.value].tableWidget&&($(A.value[V.value].tableWidget),A.value[V.value].tableWidget["supportOperation"]=!0),A.value[V.value].leftWidget&&$(A.value[V.value].leftWidget),A.value[V.value].groupWidget&&$(A.value[V.value].groupWidget),A.value[V.value].widgetList.forEach(e=>{$(e)})))},$=e=>{null!=e&&(e["datasource"]=void 0,e["relation"]=void 0,e["column"]=void 0,e.bindData&&null!=e.bindData.tableId&&(e.bindData.table=(0,E.PH)(P.value,e.bindData.tableId,"tableId"),e.bindData.table&&(null==e.bindData.table.relationType?e.datasource=e.bindData.table.tag:(e.relation=e.bindData.table.tag,e.datasource=(0,E.PH)(P.value,e.relation.datasourceId,"id"))),e.bindData.table&&e.bindData.columnId&&(e.bindData.column=(0,E.PH)(e.bindData.table.columnList,e.bindData.columnId,"columnId"),e.column=e.bindData.column)),e.props&&e.props.dictInfo&&e.props.dictInfo.dictId&&(e.props.dictInfo.dict=(0,E.PH)(R.dictList,e.props.dictInfo.dictId,"dictId")),e.props&&Array.isArray(e.props.tableColumnList)&&e.props.tableColumnList.forEach(e=>{e.table=(0,E.PH)(P.value,e.tableId,"tableId"),e.table&&Array.isArray(e.table.columnList)&&(e.column=(0,E.PH)(e.table.columnList,e.columnId,"columnId"))}),Array.isArray(e.childWidgetList)&&e.childWidgetList.forEach(e=>{$(e)}))},ee=()=>{s.s.confirm("是否重置表单？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{A.value&&A.value[V.value]&&(A.value[V.value].widgetList=[])}).catch(e=>{console.warn(e)})},le=(0,o.EW)(()=>{let e,l,a,t=(A.value||{})[V.value]||{};return"pc"===V.value?(e=null==A.value||t.fullscreen?"100%":(t.width||600)+"px",l=-1!==[H.SysOnlineFormType.ADVANCE_QUERY,H.SysOnlineFormType.QUERY,H.SysOnlineFormType.GROUP_QUERY,H.SysOnlineFormType.ONE_TO_ONE_QUERY,H.SysOnlineFormType.WORK_ORDER].indexOf((A.value||{}).formType)?"0px":"25px",a=-1!==[H.SysOnlineFormType.ADVANCE_QUERY,H.SysOnlineFormType.GROUP_QUERY,H.SysOnlineFormType.QUERY,H.SysOnlineFormType.ONE_TO_ONE_QUERY,H.SysOnlineFormType.WORK_ORDER].indexOf((A.value||{}).formType)?void 0:"white"):(e="375px",l="0px",a=void 0),{width:e,padding:l,background:a,border:"pc"===V.value?void 0:"1px solid #E8E8E8"}}),ae=()=>{W.value="props",w.value=null},te=e=>{W.value="props",w.value=e},ie=(0,o.EW)(()=>w.value?w.value.widgetType===H.SysCustomWidgetType.Table?A.value?.formType!==H.SysOnlineFormType.ONE_TO_ONE_QUERY:w.value.supportOperation:!(!A.value||!A.value[V.value])&&A.value[V.value].supportOperation),ne=(0,o.EW)(()=>null==z.value?[]:null==z.value.relationType?P.value.filter(e=>null==e.relationType||e.relationType===p.SysOnlineRelationType.ONE_TO_ONE):P.value.filter(e=>e.tableId===z.value?.tableId)),oe=(0,o.EW)(()=>null==z.value?[]:null==z.value.relationType?P.value.filter(e=>w.value&&w.value.widgetType===H.SysCustomWidgetType.Table&&w.value.isTableExpand?e.relationType===p.SysOnlineRelationType.ONE_TO_MANY:A.value?.formType===H.SysOnlineFormType.QUERY||A.value?.formType===H.SysOnlineFormType.ADVANCE_QUERY||A.value?.formType===H.SysOnlineFormType.GROUP_QUERY?null==e.relationType||e.relationType===p.SysOnlineRelationType.ONE_TO_ONE:A.value?.formType===H.SysOnlineFormType.WORK_ORDER?null==e.relationType:e.relationType===p.SysOnlineRelationType.ONE_TO_MANY):A.value?.formType===H.SysOnlineFormType.QUERY||A.value?.formType===H.SysOnlineFormType.ONE_TO_ONE_QUERY||A.value?.formType===H.SysOnlineFormType.ADVANCE_QUERY||A.value?.formType===H.SysOnlineFormType.GROUP_QUERY?P.value.filter(e=>e.id===z.value?.id):[]),de=(0,o.EW)(()=>({form:A.value?A.value[V.value]:null,activeMode:V.value,currentWidget:w.value,getMasterTable:z.value,getAllTableList:P.value,getValidTableList:ne.value,getTableWidgetTableList:oe.value,getWidgetAttribute:qe.A.getWidgetAttribute,getWidgetObject:qe.A.getWidgetObject,dictList:R.dictList,allFormList:R.allFormList}));(0,o.Gt)("formConfig",()=>de.value);const ue=(0,o.EW)(()=>({form:{formType:de.value.form.formType,customFieldList:de.value.form.customFieldList},getMasterTable:{relationType:de.value.getMasterTable?.relationType,tag:{datasourceName:de.value.getMasterTable?.tag.datasourceName,relationName:de.value.getMasterTable?.tag.relationName,variableName:de.value.getMasterTable?.tag.variableName},columnList:de.value.getMasterTable?.columnList.map(e=>({filterType:e.filterType,columnComment:e.columnComment,columnName:e.columnName,columnId:e.columnId}))},getAllTableList:de.value.getAllTableList.map(e=>({relationType:e.relationType,tag:{datasourceName:e.tag.datasourceName,relationName:e.tag.relationName,variableName:e.tag.variableName},columnList:e.columnList.map(e=>({filterType:e.filterType,columnComment:e.columnComment,columnName:e.columnName,columnId:e.columnId}))}))})),re=(0,o.EW)(()=>null==w.value?[]:(qe.A.getWidgetAttribute(w.value.widgetType)||{}).allowEventList||[]),se=(0,o.EW)(()=>{if(null==A.value)return[];let e=(b(A.value?.formType,R.pageType)||{})[V.value];return e?e.allowEventList:[]});(0,o.wB)(()=>A.value,()=>{Z()}),(0,o.wB)(()=>R.allFormList,()=>{Array.isArray(R.allFormList)&&R.allFormList.length>0&&null==A.value&&(I.value=R.allFormList[0].formId)},{deep:!0,immediate:!0}),(0,o.wB)(()=>P.value,()=>{if(Array.isArray(P.value)&&P.value.length>0){P.value.forEach(e=>{Q(e)});let e=(0,E.PH)(P.value,U.value,"id");null==e&&(U.value=P.value[0].id)}else U.value=""},{deep:!0,immediate:!0}),(0,o.wB)(()=>ie.value,e=>{e||"operate"!=W.value||(W.value="props")});const me=()=>{f("createForm")},pe=()=>{f("updateForm",A.value)},ce=(e,l)=>{console.log(e,l),"copy"===l?f("cloneForm",e):"delete"===l&&f("deleteForm",e)},be=()=>{let e=P.value.find(e=>{if(null==e.relationType)return e});if(null==e)return;let l={onlineVirtualColumnDtoFilter:{datasourceId:e.id}};v.jk.list(l).then(l=>{e.columnList=e.columnList.filter(e=>!e.aggregationColumn),e.columnList.push(...l.data.dataList.map(l=>({aggregationColumn:!0,autoIncrement:!1,columnComment:l.columnPrompt,columnId:l.virtualColumnId,virtualColumnId:l.virtualColumnId,columnName:l.objectFieldName,columnType:l.objectFieldType,deptFilter:!1,userFilter:!1,filterType:0,fullColumnType:l.objectFieldType,nullable:!0,numericPrecision:19,objectFieldName:l.objectFieldName,objectFieldType:l.objectFieldType,parentKey:!1,primaryKey:!1,tableId:e.tableId,tag:l})))}).catch(e=>{console.error(e)})};return(0,o.sV)(()=>{be()}),l({saveForm:pe}),(e,l)=>{const a=k.WK,s=n.S2,m=i.S2,b=G.c6,v=G.Iy,g=G.dW,f=h.uD,y=J.kA,R=Pe.Ik,E=S.u,L=Ue.C4,P=De.SS,z=De.Vl,Q=Ne.v$,j=Ne.q;return(0,o.uX)(),(0,o.CE)("div",{class:"form-design",onDrop:l[15]||(l[15]=(0,T.D$)(()=>{},["prevent","stop"]))},[(0,o.Lk)("div",Va,[(0,o.Lk)("div",{class:(0,u.C4)(["left-menu-item",{active:"form"===(0,d.R1)(_)}]),onClick:l[0]||(l[0]=e=>_.value="form")},[(0,o.Lk)("div",La,["form"===(0,d.R1)(_)?((0,o.uX)(),(0,o.CE)("img",Aa)):((0,o.uX)(),(0,o.CE)("img",xa))]),l[16]||(l[16]=(0,o.Lk)("span",{style:{"margin-top":"4px"}},"表单",-1))],2),(0,o.Lk)("div",{class:(0,u.C4)(["left-menu-item",{active:"data"===(0,d.R1)(_)}]),style:{"margin-top":"40px"},onClick:l[1]||(l[1]=e=>_.value="data")},[(0,o.Lk)("div",Na,["data"===(0,d.R1)(_)?((0,o.uX)(),(0,o.CE)("img",Da)):((0,o.uX)(),(0,o.CE)("img",Ua))]),l[17]||(l[17]=(0,o.Lk)("span",{style:{"margin-top":"4px"}},"数据",-1))],2)]),(0,o.Lk)("div",Pa,["form"===(0,d.R1)(_)?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.bF)(R,{class:"form-card base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none"}},{header:(0,o.k6)(()=>[(0,o.Lk)("div",Ka,[l[18]||(l[18]=(0,o.Lk)("i",{class:"online-icon"},[(0,o.Lk)("span",null,"表单")],-1)),(0,o.Lk)("div",Xa,[(0,o.bF)(a,{class:"round-search","prefix-icon":(0,d.R1)(r),modelValue:(0,d.R1)(C).formName,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,d.R1)(C).formName=e),clearable:"",placeholder:"表单名称查询",style:{width:"140px","margin-right":"10px"}},null,8,["prefix-icon","modelValue"]),(0,o.bF)(s,{link:"",icon:(0,d.R1)(t),style:{"font-size":"18px",color:"#999"},onClick:(0,T.D$)(me,["stop"])},null,8,["icon"])])])]),default:(0,o.k6)(()=>[(0,o.bF)(m,{style:{height:"calc(100% - 65px)"}},{default:(0,o.k6)(()=>[(0,o.bF)(y,{style:{width:"100%",height:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(f,{span:24,style:{padding:"0 16px"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(O),e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.formId,class:(0,u.C4)([{active:e.formId===(0,d.R1)(I)},"form-item"]),type:"flex",align:"middle",justify:"space-between"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{class:"form-item-title",type:"flex",align:"middle",onClick:(0,T.D$)(l=>I.value=e.formId,["stop"])},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.formName),1),(0,o.Lk)("div",za,(0,u.v_)((0,d.R1)(H.SysOnlineFormType).getValue(e.formType)),1)]),_:2},1032,["onClick"]),(0,o.bF)(g,{onCommand:l=>ce(e,l)},{dropdown:(0,o.k6)(()=>[(0,o.bF)(v,null,{default:(0,o.k6)(()=>[(0,o.bF)(b,{command:"copy"},{default:(0,o.k6)(()=>l[20]||(l[20]=[(0,o.eW)("复制")])),_:1,__:[20]}),(0,o.bF)(b,{command:"delete"},{default:(0,o.k6)(()=>l[21]||(l[21]=[(0,o.eW)("删除")])),_:1,__:[21]})]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(s,{class:"font-item-menu",link:"",size:"default",style:{padding:"0"}},{default:(0,o.k6)(()=>l[19]||(l[19]=[(0,o.Lk)("img",{class:"font-item-menu",src:Be,alt:"",style:{width:"16px",height:"16px","vertical-align":"middle"}},null,-1)])),_:1,__:[19]})]),_:2},1032,["onCommand"])]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),(0,o.bF)(R,{class:"base-card",shadow:"never","body-style":{padding:"0px"},style:{"margin-top":"10px",border:"none","flex-grow":"1"}},{header:(0,o.k6)(()=>[(0,o.Lk)("div",Qa,[l[22]||(l[22]=(0,o.Lk)("i",{class:"online-icon"},[(0,o.Lk)("span",null,"组件")],-1)),(0,o.Lk)("div",Ba,[(0,o.bF)(a,{class:"round-search","prefix-icon":(0,d.R1)(r),modelValue:(0,d.R1)(C).widgetName,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,d.R1)(C).widgetName=e),clearable:"",placeholder:"组件名称查询",style:{width:"140px"}},null,8,["prefix-icon","modelValue"])])])]),default:(0,o.k6)(()=>[(0,o.bF)(m,{style:{height:"calc(100% - 65px)"}},{default:(0,o.k6)(()=>[(0,o.bF)(y,{style:{width:"100%",height:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(f,{span:24,style:{padding:"0 16px"}},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(x),e=>((0,o.uX)(),(0,o.CE)("div",{class:"widget-group",key:e.id},[(0,o.Lk)("div",Ma,(0,u.v_)(e.groupName),1),(0,o.bF)((0,d.R1)(Me.MA),{class:"group-widget-list",modelValue:e.widgetList,"onUpdate:modelValue":l=>e.widgetList=l,group:{name:"componentsGroup",pull:"clone",put:!1},clone:N,sort:!1},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.widgetList,e=>((0,o.uX)(),(0,o.CE)("div",{class:"group-widget-item",key:e.id,onClick:l=>D(e)},[(0,o.Lk)("div",{class:"icon",title:(0,d.R1)(H.SysCustomWidgetType).getValue(e.widgetType)},[(0,o.Lk)("i",{class:(0,u.C4)(["",e.icon||""])},null,2)],8,Ya),(0,o.Lk)("div",qa,(0,u.v_)((0,d.R1)(H.SysCustomWidgetType).getValue(e.widgetType)),1)],8,ja))),128)),l[23]||(l[23]=(0,o.Lk)("div",{style:{width:"64px"}},null,-1))]),_:2,__:[23]},1032,["modelValue","onUpdate:modelValue"])]))),128))]),_:1})]),_:1})]),_:1})]),_:1})],64)):((0,o.uX)(),(0,o.Wv)(R,{key:1,class:"data-card base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none","flex-grow":"1"}},{header:(0,o.k6)(()=>[(0,o.Lk)("div",Ja,[l[24]||(l[24]=(0,o.Lk)("i",{class:"online-icon"},[(0,o.Lk)("span",null,"数据")],-1)),(0,o.Lk)("div",Ga,[(0,o.bF)(a,{class:"round-search","prefix-icon":(0,d.R1)(r),modelValue:(0,d.R1)(C).fieldName,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,d.R1)(C).fieldName=e),clearable:"",placeholder:"字段名称查询",size:"default",style:{width:"140px"}},null,8,["prefix-icon","modelValue"])])])]),default:(0,o.k6)(()=>[(0,o.bF)(m,{style:{height:"calc(100% - 65px)"}},{default:(0,o.k6)(()=>[(0,o.bF)(y,{style:{width:"100%",height:"100%"}},{default:(0,o.k6)(()=>[(0,o.bF)(z,{ref_key:"panelTableList",ref:B,modelValue:(0,d.R1)(U),"onUpdate:modelValue":l[5]||(l[5]=e=>(0,d.i9)(U)?U.value=e:null),accordion:!0},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(K),e=>((0,o.uX)(),(0,o.Wv)(P,{key:e.id,title:e.tableName,name:e.id},{title:(0,o.k6)(()=>[(0,o.bF)(m,{class:"data-column-title",type:"flex",align:"middle"},{default:(0,o.k6)(()=>[(0,o.Lk)("span",null,(0,u.v_)(e.tableName),1),(0,o.bF)(E,{type:X(e.relationType),size:"default",style:{"margin-top":"5px"}},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)((0,d.R1)(p.SysOnlineRelationType).getValue(e.relationType)||"数据主表"),1)]),_:2},1032,["type"])]),_:2},1024)]),default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.columnList,l=>((0,o.uX)(),(0,o.Wv)(m,{class:"table-column-item",key:l.columnId,type:"flex",justify:"space-between",align:"middle"},{default:(0,o.k6)(()=>[(0,o.bF)(L,{disabled:l.aggregationColumn,style:{"max-width":"130px"},onClick:a=>M(e,l)},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(l.columnName),1)]),_:2},1032,["disabled","onClick"]),(0,o.Lk)("div",null,[(0,o.Lk)("i",{class:(0,u.C4)(["flag online-icon icon-filter",{active:l.filterType!==(0,d.R1)(p.SysOnlineColumnFilterType).NONE}]),title:(0,d.R1)(p.SysOnlineColumnFilterType).getValue(l.filterType)},null,10,Ha),(0,o.Lk)("i",{class:(0,u.C4)(["flag online-icon icon-relation",{active:null!=l.dictId}]),style:{"margin-left":"5px"},title:Y(l.dictId)},null,10,Za)])]),_:2},1024))),128))]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))]),(0,o.Lk)("div",$a,[(0,o.bF)(m,{type:"flex",justify:"space-between",align:"middle",style:{height:"48px"}},{default:(0,o.k6)(()=>[(0,o.Lk)("div",et,[(0,o.Lk)("i",{class:(0,u.C4)(["device-item online-icon icon-phone",{active:"mobile"===(0,d.R1)(V),disabled:((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).ADVANCE_QUERY}]),title:"手机端",onClick:l[6]||(l[6]=e=>q("mobile"))},null,2),(0,o.Lk)("i",{class:(0,u.C4)(["device-item online-icon icon-pc",{active:"pc"===(0,d.R1)(V)}]),title:"PC 端",onClick:l[7]||(l[7]=e=>q("pc"))},null,2)]),(0,o.bF)(s,{link:"",size:"default",icon:(0,d.R1)(c),style:{"font-size":"14px",color:"#999","font-weight":"normal"},onClick:ee},{default:(0,o.k6)(()=>l[25]||(l[25]=[(0,o.eW)("重置表单")])),_:1,__:[25]},8,["icon"])]),_:1}),((0,o.uX)(),(0,o.CE)("div",{class:"design-box",key:(0,d.R1)(I)},[(0,o.Lk)("div",{style:(0,u.Tr)([{"max-width":"100%"},(0,d.R1)(le)]),onClick:ae},[((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).QUERY&&"pc"===(0,d.R1)(V)?((0,o.uX)(),(0,o.Wv)(Je.A,{key:0,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).QUERY&&"mobile"===(0,d.R1)(V)?((0,o.uX)(),(0,o.Wv)(tl,{key:1,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).ADVANCE_QUERY?((0,o.uX)(),(0,o.Wv)(il.A,{key:2,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).GROUP_QUERY?((0,o.uX)(),(0,o.Wv)(nl.A,{key:3,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:(0,d.R1)(A)[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).ONE_TO_ONE_QUERY&&"pc"===(0,d.R1)(V)?((0,o.uX)(),(0,o.Wv)(Ge.A,{key:4,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).ONE_TO_ONE_QUERY&&"mobile"===(0,d.R1)(V)?((0,o.uX)(),(0,o.Wv)(tl,{key:5,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).FORM?((0,o.uX)(),(0,o.Wv)(ol["default"],{key:6,height:(0,d.R1)(F)-235+"px",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onWidgetClick:te},null,8,["height","mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).FLOW?((0,o.uX)(),(0,o.Wv)(dl.A,{key:7,height:(0,d.R1)(F)-235+"px",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onWidgetClick:te},null,8,["height","mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).WORK_ORDER&&"pc"===(0,d.R1)(V)?((0,o.uX)(),(0,o.Wv)(ul.A,{key:8,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0),((0,d.R1)(A)||{}).formType===(0,d.R1)(H.SysOnlineFormType).WORK_ORDER&&"mobile"===(0,d.R1)(V)?((0,o.uX)(),(0,o.Wv)(Tl,{key:9,height:"100%",isEdit:!0,mode:(0,d.R1)(V),formConfig:((0,d.R1)(A)||{})[(0,d.R1)(V)],currentWidget:(0,d.R1)(w),onTableClick:te,onWidgetClick:te},null,8,["mode","formConfig","currentWidget"])):(0,o.Q3)("",!0)],4)]))]),(0,o.Lk)("div",lt,[(0,o.bF)(j,{modelValue:(0,d.R1)(W),"onUpdate:modelValue":l[14]||(l[14]=e=>(0,d.i9)(W)?W.value=e:null)},{default:(0,o.k6)(()=>[(0,o.bF)(Q,{label:"属性",name:"props"},{label:(0,o.k6)(()=>l[26]||(l[26]=[(0,o.Lk)("span",null,"属性",-1)])),default:(0,o.k6)(()=>[(0,o.bF)(y,{style:(0,u.Tr)({height:(0,d.R1)(F)-138+"px"})},{default:(0,o.k6)(()=>[(0,o.bF)(m,{style:{padding:"16px"}},{default:(0,o.k6)(()=>[null!=(0,d.R1)(w)?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.bF)(Pl,{value:(0,d.R1)(w),"onUpdate:value":l[8]||(l[8]=e=>(0,d.i9)(w)?w.value=e:null)},null,8,["value"]),(0,o.bF)(Ea,{class:"attribute-setting",value:(0,d.R1)(w).props,"onUpdate:value":l[9]||(l[9]=e=>(0,d.R1)(w).props=e),widget:(0,d.R1)(w),allFormList:e.allFormList},null,8,["value","widget","allFormList"])],64)):null!=(0,d.R1)(A)&&(0,d.R1)(A)[(0,d.R1)(V)]?((0,o.uX)(),(0,o.Wv)(El,{key:1})):(0,o.Q3)("",!0)]),_:1})]),_:1},8,["style"])]),_:1}),(0,d.R1)(ie)?((0,o.uX)(),(0,o.Wv)(Q,{key:0,label:"操作",name:"operate"},{label:(0,o.k6)(()=>l[27]||(l[27]=[(0,o.Lk)("span",null,"操作",-1)])),default:(0,o.k6)(()=>[(0,o.bF)(y,{style:(0,u.Tr)({height:(0,d.R1)(F)-138+"px"})},{default:(0,o.k6)(()=>[(0,o.bF)(m,{style:{width:"100%",padding:"16px"}},{default:(0,o.k6)(()=>[null!=(0,d.R1)(w)&&(0,d.R1)(A).formType!==(0,d.R1)(H.SysOnlineFormType).QUERY&&(0,d.R1)(A).formType!==(0,d.R1)(H.SysOnlineFormType).ADVANCE_QUERY&&(0,d.R1)(A).formType!==(0,d.R1)(H.SysOnlineFormType).GROUP_QUERY||null!=(0,d.R1)(w)&&(0,d.R1)(w).isTableExpand?((0,o.uX)(),(0,o.Wv)(xl,{key:0,formList:e.allFormList,tableList:(0,d.R1)(ne),value:(0,d.R1)(w).operationList,"onUpdate:value":l[10]||(l[10]=e=>(0,d.R1)(w).operationList=e)},null,8,["formList","tableList","value"])):null==(0,d.R1)(A)||null!=(0,d.R1)(w)&&(0,d.R1)(A).formType!==(0,d.R1)(H.SysOnlineFormType).QUERY&&(0,d.R1)(A).formType!==(0,d.R1)(H.SysOnlineFormType).ADVANCE_QUERY&&(0,d.R1)(A).formType!==(0,d.R1)(H.SysOnlineFormType).GROUP_QUERY?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(xl,{key:1,formList:e.allFormList,tableList:(0,d.R1)(ne),value:(0,d.R1)(A)[(0,d.R1)(V)].operationList,"onUpdate:value":l[11]||(l[11]=e=>(0,d.R1)(A)[(0,d.R1)(V)].operationList=e)},null,8,["formList","tableList","value"]))]),_:1})]),_:1},8,["style"])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(Q,{label:"脚本",name:"script"},{label:(0,o.k6)(()=>l[28]||(l[28]=[(0,o.Lk)("span",null,"脚本",-1)])),default:(0,o.k6)(()=>[(0,o.bF)(y,{style:(0,u.Tr)({height:(0,d.R1)(F)-138+"px"})},{default:(0,o.k6)(()=>[(0,o.bF)(m,{style:{width:"100%",padding:"16px"}},{default:(0,o.k6)(()=>[null!=(0,d.R1)(w)?((0,o.uX)(),(0,o.Wv)(Ye.A,{key:0,value:(0,d.R1)(w).eventList,"onUpdate:value":l[12]||(l[12]=e=>(0,d.R1)(w).eventList=e),allowEventList:(0,d.R1)(re),formConfig:(0,d.R1)(ue),mode:(0,d.R1)(V)},null,8,["value","allowEventList","formConfig","mode"])):null!=(0,d.R1)(A)?((0,o.uX)(),(0,o.Wv)(Ye.A,{key:1,value:(0,d.R1)(A)[(0,d.R1)(V)].formEventList,"onUpdate:value":l[13]||(l[13]=e=>(0,d.R1)(A)[(0,d.R1)(V)].formEventList=e),allowEventList:(0,d.R1)(se),formConfig:(0,d.R1)(ue),mode:(0,d.R1)(V)},null,8,["value","allowEventList","formConfig","mode"])):(0,o.Q3)("",!0)]),_:1})]),_:1},8,["style"])]),_:1})]),_:1},8,["modelValue"])])],32)}}});const tt=(0,Q.A)(at,[["__scopeId","data-v-18d1fb25"]]);var it=tt,nt=a(43144),ot=(0,o.pM)({__name:"index",props:{pageId:{},clientHeight:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,y.l5)(),a=e,R=(0,o.EW)(()=>l.defaultFormItemSize||k.value.defaultFormItemSize?.value),{thirdParams:k,onCloseThirdDialog:h}=(0,f.P)(a);(0,o.Gt)("clientHeight",a.clientHeight||k.value.clientHeight);const F=(0,d.KR)(),T=(0,d.KR)(),_=(0,d.KR)(),C=(0,d.KR)(p.SysOnlinePageSettingStep.BASIC),S=(0,d.KR)({published:!1}),w=(0,d.KR)([]),W=(0,d.KR)([]),O=(0,d.KR)(),E=(0,d.KR)(!1),V=(0,o.EW)(()=>C.value==p.SysOnlinePageSettingStep.FORM_DESIGN||E.value),L=e=>{E.value=e},A=(0,d.KR)([]),x=()=>{switch(C.value){case p.SysOnlinePageSettingStep.DATASOURCE:C.value=p.SysOnlinePageSettingStep.BASIC;break;case p.SysOnlinePageSettingStep.FORM_DESIGN:C.value=p.SysOnlinePageSettingStep.DATASOURCE;break}},N=()=>{switch(C.value){case p.SysOnlinePageSettingStep.BASIC:F.value.save().then(e=>(e&&(S.value={...e}),S.value.pageId&&H(S.value.pageId),e)).then(()=>{C.value=p.SysOnlinePageSettingStep.DATASOURCE}).catch(e=>{console.warn(e)});break;case p.SysOnlinePageSettingStep.DATASOURCE:M(!1).then(()=>{let e=[];return console.log("获取数据源所有用到的数据表的字段列表",G.value.length),G.value.forEach(l=>{e.push(D(l.tableId))}),Promise.all(e)}).then(e=>(e.forEach((e,l)=>(G.value[l].columnList=e,G.value[l])),X(S.value.pageId))).then(()=>{C.value=p.SysOnlinePageSettingStep.FORM_DESIGN}).catch(e=>{console.warn(e)});break}},D=e=>null==e||""===e?Promise.reject():new Promise((l,a)=>{let t={onlineColumnDtoFilter:{tableId:e}};v.aq.list(t).then(e=>{l(e.data.dataList)}).catch(e=>{a(e)})}),{getFormConfig:U,mergeWidget:P,mergeArray:K}=(0,g.U)(),X=e=>e?new Promise((l,a)=>{v.k$.list({onlineFormDtoFilter:{pageId:e},orderParam:[{fieldName:"createTime",asc:!0}]}).then(e=>{console.log("editOnlinePage form list",e.data.dataList),W.value=(e.data.dataList||[]).map(e=>{let l=e.widgetJson?JSON.parse(e.widgetJson):{},a=e.paramsJson?JSON.parse(e.paramsJson):[],t=U(e.formType,S.value.pageType),i=["pc","mobile"];return i.forEach(a=>{l[a]={...t[a],...l[a]},l[a].formId=e.formId,l[a].formCode=e.formCode,l[a].formName=e.formName,l[a].formKind=e.formKind,l[a].formType=e.formType,l[a].formTypeDictMap=e.formTypeDictMap,l[a].masterTableId=e.masterTableId,l[a].operationList=K(l[a].operationList,t[a].operationList,"id"),Array.isArray(l[a].widgetList)&&l[a].widgetList.forEach(e=>{P(e)}),P(l[a].tableWidget),P(l[a].leftWidget),P(l[a].groupWidget,a)}),{...e,...l,paramList:a}}),l(e)}).catch(e=>{a(e)})}):Promise.resolve(),z=()=>{C.value==p.SysOnlinePageSettingStep.FORM_DESIGN?_.value.saveForm():C.value==p.SysOnlinePageSettingStep.DATASOURCE&&T.value.save()},Q=()=>{V.value?C.value==p.SysOnlinePageSettingStep.DATASOURCE?T.value.cancel():C.value=p.SysOnlinePageSettingStep.DATASOURCE:a.dialog?a.dialog.cancel():h(!0)},B=e=>{let l={onlinePageDto:{...S.value,status:e,published:!1}};return v.Pr.update(l)},M=(e=!1)=>e?Promise.resolve():null==J.value?(r.nk.error("请设置页面数据模型！"),S.value.status!==p.SysOnlinePageStatus.DATASOURCE&&B(p.SysOnlinePageStatus.DATASOURCE).catch(e=>{console.warn(e)}),Promise.reject()):S.value.status===p.SysOnlinePageStatus.DESIGNING?Promise.resolve():B(p.SysOnlinePageStatus.DESIGNING),j=()=>{v.S1.list({}).then(e=>{e.data.dataList.forEach(e=>{e.id=e.dictId,e.name=e.dictName,e.dictData=e.dictDataJson?JSON.parse(e.dictDataJson):void 0}),w.value=e.data.dataList}).catch(e=>{console.warn(e)})},Y=()=>new Promise((e,l)=>{O.value={},v.yu.list({}).then(l=>{l.data.dataList.forEach(e=>{e.dblinkId&&(O.value[e.dblinkId]={...e,tableList:void 0})}),e(l)}).catch(e=>{l(e)})}),q=()=>{S.value={pageId:void 0,pageCode:void 0,pageName:void 0,published:!1,pageType:p.SysOnlinePageType.BIZ,status:p.SysOnlinePageStatus.BASIC,extraJson:{extendClass:void 0}},C.value=p.SysOnlinePageSettingStep.BASIC;let e=a.pageId||k.value.pageId;if(null!=e||null!=S.value.pageId){let l={pageId:e||S.value.pageId};return v.Pr.view(l)}return Promise.reject()},J=(0,o.EW)(()=>A.value[0]),G=(0,o.EW)(()=>{if(null==J.value)return[];let e=[];return e.push({id:J.value.datasourceId,tableName:J.value.masterTableIdDictMap.name,tableId:J.value.masterTableId,relationType:void 0,masterColumnName:void 0,slaveColumnName:void 0,cascadeDelete:!1,leftJoin:!1,showName:J.value.datasourceName,tag:J.value}),Array.isArray(J.value.relationList)&&J.value.relationList.forEach(l=>{e.push({id:l.relationId,tableName:l.slaveTable.tableName,tableId:l.slaveTableId,relationType:l.relationType,masterColumnName:(l.masterColumn||{}).columnName||"未知字段",slaveColumnName:(l.slaveColumn||{}).columnName||"未知字段",cascadeDelete:l.cascadeDelete,leftJoin:l.leftJoin,showName:l.relationName,tag:l})}),e}),H=e=>new Promise((l,a)=>{v.Pr.listOnlinePageDatasource({pageId:e}).then(e=>(A.value=e.data.dataList,Z())).then(e=>{A.value=A.value.map(l=>(l.datasourceId===J.value.datasourceId&&(l.relationList=e.data.dataList||[]),l)),l(e)}).catch(e=>{a(e)})}),Z=()=>null==J.value?Promise.resolve({data:{dataList:[],totalCount:0},success:!1,errorCode:null,errorMessage:null}):v.PC.list({onlineDatasourceRelationDtoFilter:{datasourceId:J.value.datasourceId}}),$=()=>{m.l.show("新建表单",nt["default"],{area:["600px"]},{pageId:S.value.pageId,pageType:S.value.pageType,datasourceId:J.value.datasourceId,datasourceTableList:G.value,defaultFormItemSize:R.value},{width:"600px",height:"400px",pathName:"/thirdParty/thirdEditOnlineForm"}).then(()=>{X(S.value.pageId)}).catch(e=>{console.warn(e)})},ee=e=>{if(null==e)return e;let l=e.widgetImpl,a=e.childWidgetList,t=e.parent;e.widgetImpl=void 0,e.parent=void 0,e.childWidgetList=[];let i=e.props.actions;e.props.actions={};let n=JSON.parse(JSON.stringify(e));return e.widgetImpl=l,e.parent=t,e.childWidgetList=a,e.props.actions=i,n.column=void 0,n.datasource=void 0,n.relation=void 0,n.bindData.column=void 0,n.bindData.table=void 0,n.widgetImpl=void 0,n.props&&n.props.dictInfo&&(n.props.dictInfo.dict=void 0),n.props&&Array.isArray(n.props.tableColumnList)&&n.props.tableColumnList.forEach(e=>{e.table=void 0,e.column=void 0}),Array.isArray(e.childWidgetList)&&(n.childWidgetList=e.childWidgetList.map(e=>ee(e))),n},le=e=>{if(!e)return void console.warn("currentForm is null or undefined");let l=["pc","mobile"],a=l.reduce((l,a)=>{console.log("reduce",l,a);let t=e[a];return l[a]={gutter:t.gutter,filterItemWidth:t.filterItemWidth,labelWidth:t.labelWidth,labelPosition:t.labelPosition,tableWidget:ee(t.tableWidget),leftWidget:ee(t.leftWidget),groupWidget:ee(t.groupWidget),operationList:t.operationList,customFieldList:t.customFieldList,widgetList:t.widgetList.map(e=>ee(e)),formEventList:t.formEventList,maskFieldList:t.maskFieldList,width:t.width,height:t.height,fullscreen:t.fullscreen,advanceQuery:t.advanceQuery,groupQuery:t.groupQuery,leftTreeRightTable:t.leftTreeRightTable},l},{}),t={onlineFormDto:{pageId:e.pageId,formId:e.formId,formCode:e.pc.formCode,formName:e.pc.formName,formKind:p.SysOnlineFormKind.PAGE,formType:e.formType,masterTableId:e.masterTableId,widgetJson:JSON.stringify(a),datasourceIdList:[J.value.datasourceId]}},i=v.k$.update(t);i.then(()=>{r.nk.success("保存成功"),X(S.value.pageId).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},ae=e=>{s.s.confirm("是否复制此表单？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={formId:e.formId};return v.k$.clone(l)}).then(()=>{r.nk.success("复制成功！"),X(S.value.pageId).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},te=e=>{s.s.confirm("是否删除此表单？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let l={formId:e.formId};return v.k$.delete(l)}).then(()=>{r.nk.success("删除成功！"),X(S.value.pageId).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})};return(0,o.sV)(()=>{j(),Y().then(()=>(console.log("dblinkInfo",O.value),q())).then(e=>{let l=JSON.parse(e.data.extraJson||"{}");S.value={...e.data,extraJson:{extendClass:l.extendClass}}}).catch(e=>{console.warn(e)})}),(e,l)=>{const a=n.S2,r=i.S2,s=t.bZ,m=t.ZO,v=t.lX;return(0,o.uX)(),(0,o.Wv)(v,{class:"edit-online-page"},{default:(0,o.k6)(()=>[(0,o.bF)(s,{class:"step-header",style:{overflow:"hidden",height:"72px",background:"white","border-bottom":"1px solid #ebeef5"}},{default:(0,o.k6)(()=>[(0,o.bF)(r,{type:"flex",justify:"space-between",align:"middle",style:{height:"100%"}},{default:(0,o.k6)(()=>[l[7]||(l[7]=(0,o.Lk)("div",{class:"title",style:{display:"flex",width:"200px",height:"40px","line-height":"40px"}},[(0,o.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"BIQS在线表单")],-1)),(0,o.bF)(c.A,{class:"step",value:C.value},{default:(0,o.k6)(()=>[(0,o.bF)(b.A,{icon:"online-icon icon-basic-info",name:(0,d.R1)(p.SysOnlinePageSettingStep).BASIC},{default:(0,o.k6)(()=>l[1]||(l[1]=[(0,o.eW)("基础信息")])),_:1,__:[1]},8,["name"]),(0,o.bF)(b.A,{icon:"online-icon icon-data",name:(0,d.R1)(p.SysOnlinePageSettingStep).DATASOURCE},{default:(0,o.k6)(()=>l[2]||(l[2]=[(0,o.eW)("数据模型")])),_:1,__:[2]},8,["name"]),(0,o.bF)(b.A,{icon:"online-icon icon-form-design",name:(0,d.R1)(p.SysOnlinePageSettingStep).FORM_DESIGN},{default:(0,o.k6)(()=>l[3]||(l[3]=[(0,o.eW)("表单设计")])),_:1,__:[3]},8,["name"])]),_:1},8,["value"]),(0,o.bF)(r,{class:"operation",type:"flex",justify:"end",style:{width:"200px"}},{default:(0,o.k6)(()=>[V.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(a,{key:0,size:R.value,disabled:C.value==(0,d.R1)(p.SysOnlinePageSettingStep).BASIC,onClick:x},{default:(0,o.k6)(()=>l[4]||(l[4]=[(0,o.eW)(" 上一步 ")])),_:1,__:[4]},8,["size","disabled"])),V.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(a,{key:1,disabled:C.value==(0,d.R1)(p.SysOnlinePageSettingStep).FORM_DESIGN,size:R.value,type:"primary",onClick:N},{default:(0,o.k6)(()=>l[5]||(l[5]=[(0,o.eW)(" 下一步 ")])),_:1,__:[5]},8,["disabled","size"])),V.value?((0,o.uX)(),(0,o.Wv)(a,{key:2,size:R.value,type:"primary",onClick:z},{default:(0,o.k6)(()=>l[6]||(l[6]=[(0,o.eW)(" 保存 ")])),_:1,__:[6]},8,["size"])):(0,o.Q3)("",!0),(0,o.bF)(a,{onClick:Q,size:R.value},{default:(0,o.k6)(()=>[(0,o.eW)((0,u.v_)(V.value?"返回":"退出"),1)]),_:1},8,["size"])]),_:1})]),_:1,__:[7]})]),_:1}),(0,o.bF)(m,{style:(0,u.Tr)({padding:C.value==(0,d.R1)(p.SysOnlinePageSettingStep).FORM_DESIGN?"0px":"15px"})},{default:(0,o.k6)(()=>[(0,o.bF)(r,{type:"flex",justify:"center",style:{height:"100%"}},{default:(0,o.k6)(()=>[C.value==(0,d.R1)(p.SysOnlinePageSettingStep).BASIC?((0,o.uX)(),(0,o.Wv)(I,{key:0,ref_key:"basicForm",ref:F,class:"main-box",style:{width:"600px"},modelValue:S.value,"onUpdate:modelValue":l[0]||(l[0]=e=>S.value=e)},null,8,["modelValue"])):(0,o.Q3)("",!0),C.value==(0,d.R1)(p.SysOnlinePageSettingStep).DATASOURCE&&S.value.pageId?((0,o.uX)(),(0,o.Wv)(xe,{key:1,ref_key:"modelForm",ref:T,data:G.value,defaultFormItemSize:R.value,pageId:S.value.pageId,dataSource:J.value,dblinkInfo:O.value,dictList:w.value,clientHeight:e.clientHeight||(0,d.R1)(k).clientHeight,onChange:H,onUnSaved:L},null,8,["data","defaultFormItemSize","pageId","dataSource","dblinkInfo","dictList","clientHeight"])):(0,o.Q3)("",!0),C.value==(0,d.R1)(p.SysOnlinePageSettingStep).FORM_DESIGN?((0,o.uX)(),(0,o.Wv)(it,{key:2,ref_key:"designForm",ref:_,pageType:S.value.pageType,tableList:G.value,allFormList:W.value,dictList:w.value,height:e.clientHeight||(0,d.R1)(k).clientHeight,class:"design-box",style:{width:"100%",height:"100%"},onCreateForm:$,onUpdateForm:le,onCloneForm:ae,onDeleteForm:te},null,8,["pageType","tableList","allFormList","dictList","height"])):(0,o.Q3)("",!0)]),_:1})]),_:1},8,["style"])]),_:1})}}});const dt=(0,Q.A)(ot,[["__scopeId","data-v-61af9a04"]]);var ut=dt},76105:function(e,l,a){a.d(l,{A:function(){return c}});var t=a(14022),i=(a(97042),a(72343),a(25136)),n=(a(69957),a(56768)),o=a(90144),d=a(45130),u=a(57477),r=a(31932),s=a(18384),m=(0,n.pM)({__name:"OnlineImageUrlInput",props:{value:{},size:{default:"small"},disabled:{type:Boolean,default:!1}},emits:["update:value"],setup(e,{emit:l}){const{getUploadActionUrl:a,fetchUpload:m}=(0,r.v)(),p=(0,o.KR)(),c=()=>{p.value.click()},b=e=>{const l=e.target;if(l&&l.files){console.log("files",l.files);let e=l.files[0];if(null!=e){let l=a(s.x+"/commonext/util/uploadImage");m(l,{uploadFile:e}).then(e=>{g(JSON.stringify(e))}).catch(e=>{console.warn(e)})}}},v=l,g=e=>{v("update:value",e)};return(e,l)=>{const a=i.S2,r=t.WK;return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(r,{value:e.value,size:e.size,disabled:e.disabled},{append:(0,n.k6)(()=>[(0,n.bF)(a,{icon:(0,o.R1)(u.Upload),onClick:c,disabled:e.disabled},null,8,["icon","disabled"])]),_:1},8,["value","size","disabled"]),(0,n.bo)((0,n.Lk)("input",{type:"file",ref_key:"fileSelect",ref:p,accept:"image/*",onChange:(0,d.D$)(b,["stop"])},null,544),[[d.aG,!1]])])}}});const p=m;var c=p},80427:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAjdJREFUWEftWMFR6zAQ3RWB+dxCBYQKMBUAJXC0Hc8kFQAVABXwfwVhxrF9hA6ACjAdhA58g4FByyqOgxLIJ5ZMJjDOLYp29fJ292lXCEv+wSXHBzVA2wh9YDCO491XEo4Aato6L2MvAbMVlKnnebe63RhgFEUOAfYA0CnjuPq9lCJQ1/f9VPkeAszBibvqDzP3iCB3FMghwH4UM7iCOXoggCv+npm7N7Nk5jp87mZuTWnb93YwDJM9FHA9WnzgxZaZe3urXu+yubr2yKHNQZKEfez34yNAPB8uAP0LfO/I/ihzD2EU/0XAw5xEOsYwSk45zic5QDgLfPfU3L295TSeygCOUoVVgLKX5/X9bvfAKIe/D6AWCY4Iy4R7YcLnQgDapIo1QBXKRgMGrusOdIaqymUrgHqFvTz/2dDzbFkA3rAE7BYaFQTuTcFiDXAeHeQQ/04G1RXWWHvssfy0VgQeTBfY/4qtlFCbMhhFSYelh0X869vKtoqNQlymgGqAn4WxZvBdjM1kpmZQY3Dc7U7fxbqUFANPYacPZV+1YlZVrA6c1c2o3xQQIUT2mRAnSdKSUjaLcXJWr2gN0KQJLWPzAeDk0LQMM8n00DQxdsKg7btbZf5xlXvzsfNJPSC0ipZuOLiH/SRFhO3RYQMe964QFz+4833dGYMjuA/arvMznj6KCpQkLjQmq4ze3L6ImRMoOxOPRxP9mMpJJIcQF/r8hkQZEab6GKFw1S+sc8d2xsaaQVsG3wAJWmMJ0+LAtQAAAABJRU5ErkJggg=="},80434:function(e,l,a){a(97042)},85285:function(e,l,a){a.d(l,{A:function(){return s}});var t=a(56768),i=a(24232),n=a(90144);const o={name:"StepBarItem"};var d=(0,t.pM)({...o,props:{name:{},icon:{}},setup(e){const l=e,a=(0,t.WQ)("stepBarInfo",(0,n.KR)({backgroundColor:"#F6F7F9",textColor:"#999999",activeStep:""})),o=(0,t.WQ)("setActiveStep",e=>e),d=()=>{o(l.name)},u=(0,t.EW)(()=>a.value.activeStep==l.name);return(e,l)=>((0,t.uX)(),(0,t.CE)("div",{class:(0,i.C4)(["step-bar-item",{active:u.value}]),style:(0,i.Tr)({background:u.value?void 0:(0,n.R1)(a).backgroundColor,color:u.value?void 0:(0,n.R1)(a).textColor}),onClick:d},[e.icon?((0,t.uX)(),(0,t.CE)("i",{key:0,class:(0,i.C4)(e.icon),style:{"margin-right":"3px"}},null,2)):(0,t.Q3)("",!0),(0,t.RG)(e.$slots,"default")],6))}}),u=a(71241);const r=(0,u.A)(d,[["__scopeId","data-v-35e87c20"]]);var s=r},85676:function(e,l,a){a.d(l,{A:function(){return f}});var t=a(65451),i=(a(97042),a(63390),a(76408)),n=(a(87535),a(85415)),o=(a(22243),a(7409),a(18111),a(22489),a(61701),a(56768)),d=a(90144),u=a(164),r=a(21231),s=a(27007),m=a(31372),p=a(21016),c=a(36525),b=a(50380),v=(0,o.pM)({__name:"index",props:{value:{default:()=>({})}},emits:["update:value"],setup(e,{emit:l}){const a=e,v=(0,o.WQ)("formConfig",()=>(console.error("CustomWidgetDictSetting: formConfig not injected"),{}));console.log(">>> >>> dictSetting",v());const g=(0,d.KR)([]),f=(0,o.EW)(()=>v().currentWidget),y=(0,o.EW)(()=>v().dictList),R=(0,o.EW)(()=>(0,s.PH)(y.value,a.value.dictId,"id")),k=(0,o.EW)(()=>R.value?(R.value.dictData||{}).paramList:void 0),h=(0,o.EW)({get(){return a.value.dictId},set(e){F(e)}}),F=e=>{C({dictId:e,paramList:[]})},T=()=>{g.value=[],null!=f.value&&Array.isArray(y.value)&&(f.value.bindData.dataType===p.SysCustomWidgetBindDataType.Column?null!=f.value.bindData.column&&null!=f.value.bindData.column.dictId&&(g.value=(y.value||[]).filter(e=>e.id===f.value.bindData.column.dictId)):f.value.bindData.dataType===p.SysCustomWidgetBindDataType.Custom&&(g.value=y.value))},_=l,C=e=>{(0,o.dY)(()=>{_("update:value",{...e,dict:(0,s.PH)(y.value,(e||{}).dictId,"id")})})},I=(e,l)=>{null!=l&&C(e?{dictId:a.value.dictId,paramList:a.value.paramList.map(a=>a.dictParamName===e.dictParamName?l:a)}:{dictId:a.value.dictId,paramList:[...a.value.paramList,l]})},S=(e=null)=>{let l=(k.value||[]).filter(e=>{let l=a.value.paramList,t=(0,s.PH)(l,e.dictParamName,"dictParamName");return null==t}),t=[];if(null!=v().form.pageCode)t=(v().allWidgetList||[]).map(e=>({columnId:e.widgetId,objectFieldName:e.showName}));else{let e=v().getMasterTable;v().currentWidget&&v().currentWidget.bindData&&v().currentWidget.bindData.table&&(e=v().currentWidget.bindData.table),t=e.columnList.filter(e=>v().form.formType!==p.SysOnlineFormType.QUERY||e.filterType!==c.SysOnlineColumnFilterType.NONE)}m.l.show(e?"编辑参数":"添加参数",b["default"],{area:"600px"},{rowData:e,paramList:l,columnList:t,path:"thirdEditDictParamValue"},{width:"600px",height:"400px",pathName:"/thirdParty/thirdEditDictParamValue"}).then(l=>{I(e,l)}).catch(e=>{console.warn(e)})},w=e=>{u.s.confirm("是否删除此参数？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{C({dictId:a.value.dictId,paramList:a.value.paramList.filter(l=>l.dictParamName!==e.dictParamName)})}).catch(e=>{console.warn(e)})};return(0,o.wB)(()=>f.value,()=>{T()},{deep:!0,immediate:!0}),(0,o.wB)(()=>g.value,()=>{1!==g.value.length||a.value.dictId||C({dictId:g.value[0].id,paramList:[]})},{immediate:!0}),(e,l)=>{const a=n.P9,u=n.AV,s=i.uD,m=t.S2;return(0,o.uX)(),(0,o.Wv)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(s,{span:24},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:(0,d.R1)(h),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,d.i9)(h)?h.value=e:null),clearable:"",placeholder:"",style:{width:"100%"},onChange:F},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,d.R1)(g),e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,d.R1)(k)&&(0,d.R1)(k).length>0?((0,o.uX)(),(0,o.Wv)(s,{key:0,span:24,style:{"margin-top":"10px"}},{default:(0,o.k6)(()=>[(0,o.bF)(r.A,{data:(e.value||{}).paramList,addText:"添加字典过滤参数",maxCount:(0,d.R1)(k)?(0,d.R1)(k).length:0,onAdd:l[1]||(l[1]=e=>S()),onEdit:S,onDelete:w,prop:{label:"dictParamName",value:"dictParamName"}},null,8,["data","maxCount"])]),_:1})):(0,o.Q3)("",!0)]),_:1})}}});const g=v;var f=g},87199:function(e,l,a){a(97042)},87351:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAqZJREFUWEftmNt100AQhmdE8OENUwFOBYQKMBXEfkOWdXAqiKmAUAGmAoejG284FSSpAHWAS8BP5ASiYVaRElkX65IR+Bys113Nfvpn99fsIGz5g5v4PM/r/Q7wECnoAeCB7LeQT6gt9zQ603V9WRS7ENByvhwj0EwWKj8aAU5N482nvNFcQMvxTnjg/d+Ai9cggA+moZ+k18wAqrTeBPD9biLBZwBOB6EvCYxIvGV42yC8jeM+0mA/ne4M4Jp6DDce6xNJsHQs2/ZOY8g8FTOAtuMtOMihCkQBvDZN/aJNQMvy+qjBebTG2djQB8n1chR0LxDw1b8AJKBL0xj1d4B1tkQyxWIKzudfu0dHwx8xiDr5RPR8ExiPrwzDyDiBKGD4Z7mhb4jYjQ+Q5bgz3rPHFVVb8iHYT84VBbRtdwqIH8MDFBmrZXs+IryoCMiOErxMKikKqFL7uHN1qmDYVKfKVC3XHTDttAogEi7TvioKWAWi7pwdYF3F0vP/PwXVSeZCk+L6TVlPENxXJJsU5XmX6X+7qIKO403YXuYhBNG78Xg0SxYXVdL96/rJs6TJiwKuVR7bCKgUUr6nEXYNQw/9UHljp3M1CAB6ZQpqECzSvztRBcsAmozvAJuo1lqx8FCYvPdFU3xbLPzk+wN2uSoZqg0fWY+6opYeEi5IF1zSD1tTMLfccu7vMFUUTl8tRRWM7sxhVcwF60D9FZLQZYB5Jb0oYBlAk/EdYBPVWjskD4URsZm11gfS0ByNVCuktWe9Qsr2graheXTOV71+6Aw5Lbii9puykqe3L9FCA9nWW5wOjs2NorvO7Yo98qC0/aZeruNtYrmP6st0vMIWcLQ3VAs4VLLFZ0VIk6K9Xt5EJ+6EknQDPfpcJH8P0W/URG9RsVqh/wBsq4tHP+1QrwAAAABJRU5ErkJggg=="},95757:function(e,l,a){a.d(l,{A:function(){return g}});var t=a(21929),i=(a(97042),a(98421),a(85415)),n=(a(22243),a(7409),a(17851)),o=(a(68489),a(20709),a(65546)),d=(a(51216),a(77649)),u=(a(87603),a(14022)),r=(a(72343),a(32465),a(15836)),s=(a(95815),a(56768)),m=a(90144),p=a(45130),c=a(21016),b=(0,s.pM)({__name:"index",setup(e){const l=(0,s.WQ)("formConfig",()=>(console.error("PivotTableBasicSetting: formConfig not injected"),{})),a=(0,s.EW)(()=>l().currentWidget),b=(0,s.EW)(()=>a.value?(a.value.props||{}).basicInfo:void 0);return(e,l)=>{const v=r.B8,g=t.xE,f=u.WK,y=d.lq,R=o.rF,k=n.Zh,h=n.MQ,F=i.P9,T=i.AV,_=t.US;return(0,m.R1)(b)?((0,s.uX)(),(0,s.Wv)(_,{key:0,"label-position":"top",size:"default",style:{padding:"10px 16px 0"},onSubmit:l[11]||(l[11]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,s.bF)(g,{class:"view-attribute-item",label:"组件宽度"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{style:{width:"95%","margin-left":"5px"},min:1,max:24,modelValue:(0,m.R1)(b).span,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,m.R1)(b).span=e)},null,8,["modelValue"])]),_:1}),(0,m.R1)(a).widgetType!==(0,m.R1)(c.SysCustomWidgetType).RichText?((0,s.uX)(),(0,s.Wv)(g,{key:0,class:"view-attribute-item",label:"组件高度"},{default:(0,s.k6)(()=>[(0,s.bF)(f,{clearable:"",modelValue:(0,m.R1)(b).height,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,m.R1)(b).height=e)},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).paddingBottom?((0,s.uX)(),(0,s.Wv)(g,{key:1,class:"view-attribute-item",label:"底部距离"},{default:(0,s.k6)(()=>[(0,s.bF)(y,{"controls-position":"right",clearable:"",style:{width:"100%"},modelValue:(0,m.R1)(b).paddingBottom,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,m.R1)(b).paddingBottom=e)},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).borderColor?((0,s.uX)(),(0,s.Wv)(g,{key:2,class:"view-attribute-item",label:"边框颜色"},{default:(0,s.k6)(()=>[(0,s.bF)(R,{modelValue:(0,m.R1)(b).borderColor,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,m.R1)(b).borderColor=e)},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).cellBackgroundColor?((0,s.uX)(),(0,s.Wv)(g,{key:3,class:"view-attribute-item",label:"背景色"},{default:(0,s.k6)(()=>[(0,s.bF)(R,{modelValue:(0,m.R1)(b).cellBackgroundColor,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,m.R1)(b).cellBackgroundColor=e)},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).cellFontColor?((0,s.uX)(),(0,s.Wv)(g,{key:4,class:"view-attribute-item",label:"字体颜色"},{default:(0,s.k6)(()=>[(0,s.bF)(R,{modelValue:(0,m.R1)(b).cellFontColor,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,m.R1)(b).cellFontColor=e)},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).cellFontSize?((0,s.uX)(),(0,s.Wv)(g,{key:5,class:"view-attribute-item",label:"字体大小"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{style:{width:"95%","margin-left":"5px"},modelValue:(0,m.R1)(b).cellFontSize,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,m.R1)(b).cellFontSize=e),min:10,max:40,size:"default"},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).cellRowHeight?((0,s.uX)(),(0,s.Wv)(g,{key:6,class:"view-attribute-item",label:"行高"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{style:{width:"95%","margin-left":"5px"},modelValue:(0,m.R1)(b).cellRowHeight,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,m.R1)(b).cellRowHeight=e),min:10,max:100,size:"default"},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).cellRowMaxHeight?((0,s.uX)(),(0,s.Wv)(g,{key:7,class:"view-attribute-item",label:"高度"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{style:{width:"95%","margin-left":"5px"},modelValue:(0,m.R1)(b).cellRowMaxHeight,"onUpdate:modelValue":l[8]||(l[8]=e=>(0,m.R1)(b).cellRowMaxHeight=e),min:10,max:100,size:"default"},null,8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).cellAlign?((0,s.uX)(),(0,s.Wv)(g,{key:8,class:"view-attribute-item",label:"对齐方式"},{default:(0,s.k6)(()=>[(0,s.bF)(h,{modelValue:(0,m.R1)(b).cellAlign,"onUpdate:modelValue":l[9]||(l[9]=e=>(0,m.R1)(b).cellAlign=e)},{default:(0,s.k6)(()=>[(0,s.bF)(k,{value:"left"},{default:(0,s.k6)(()=>l[12]||(l[12]=[(0,s.eW)("居左")])),_:1,__:[12]}),(0,s.bF)(k,{value:"center"},{default:(0,s.k6)(()=>l[13]||(l[13]=[(0,s.eW)("居中")])),_:1,__:[13]}),(0,s.bF)(k,{value:"right"},{default:(0,s.k6)(()=>l[14]||(l[14]=[(0,s.eW)("居右")])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1})):(0,s.Q3)("",!0),null!=(0,m.R1)(b).indicatorPosition?((0,s.uX)(),(0,s.Wv)(g,{key:9,class:"view-attribute-item",label:"指示器位置"},{default:(0,s.k6)(()=>[(0,s.bF)(T,{modelValue:(0,m.R1)(b).indicatorPosition,"onUpdate:modelValue":l[10]||(l[10]=e=>(0,m.R1)(b).indicatorPosition=e),placeholder:""},{default:(0,s.k6)(()=>[(0,s.bF)(F,{label:"外部",value:"outside"}),(0,s.bF)(F,{label:"不显示",value:"none"})]),_:1},8,["modelValue"])]),_:1})):(0,s.Q3)("",!0)]),_:1})):(0,s.Q3)("",!0)}}});const v=b;var g=v},95815:function(e,l,a){a(97042),a(87603),a(15936)},97024:function(e,l,a){a.d(l,{A:function(){return R}});var t=a(21929),i=(a(97042),a(98421),a(14022)),n=(a(72343),a(97456)),o=(a(15936),a(91542)),d=(a(37985),a(85415)),u=(a(22243),a(7409),a(65546)),r=(a(51216),a(15836)),s=(a(95815),a(32465),a(3740)),m=(a(42899),a(56768)),p=a(90144),c=a(45130),b=a(57477),v=a(21016),g=a(92380),f=(0,m.pM)({__name:"index",setup(e){const l=(0,m.WQ)("formConfig",()=>(console.error("ChartTooltipSetting: formConfig not injected"),{})),a=(0,m.EW)(()=>l().currentWidget),f=(0,m.EW)(()=>a.value?(a.value.props||{}).tooltipSetting:void 0),y=(0,m.EW)(()=>![v.SysCustomWidgetType.FunnelChart,v.SysCustomWidgetType.RadarChart,v.SysCustomWidgetType.GaugeChart].find(e=>e===a.value.widgetType));return(e,l)=>{const a=s.qi,v=t.xE,R=r.B8,k=u.rF,h=d.P9,F=d.AV,T=o.tk,_=n.R7,C=i.WK,I=t.US;return(0,p.R1)(f)?((0,m.uX)(),(0,m.Wv)(I,{key:0,"label-position":"top",size:"default",style:{padding:"10px 16px 0"},onSubmit:l[5]||(l[5]=(0,c.D$)(()=>{},["prevent"]))},{default:(0,m.k6)(()=>[(0,m.bF)(v,{label:"是否显示"},{default:(0,m.k6)(()=>[(0,m.bF)(a,{modelValue:(0,p.R1)(f).show,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,p.R1)(f).show=e)},null,8,["modelValue"])]),_:1}),(0,m.bo)((0,m.bF)(v,{label:"字体大小"},{default:(0,m.k6)(()=>[(0,m.bF)(R,{modelValue:(0,p.R1)(f).textStyle.fontSize,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,p.R1)(f).textStyle.fontSize=e),min:10,max:40,size:"default"},null,8,["modelValue"])]),_:1},512),[[c.aG,(0,p.R1)(f).show]]),(0,m.bo)((0,m.bF)(v,{label:"字体颜色"},{default:(0,m.k6)(()=>[(0,m.bF)(k,{modelValue:(0,p.R1)(f).textStyle.color,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,p.R1)(f).textStyle.color=e)},null,8,["modelValue"])]),_:1},512),[[c.aG,(0,p.R1)(f).show]]),(0,p.R1)(y)?(0,m.bo)(((0,m.uX)(),(0,m.Wv)(v,{key:0,label:"触发位置"},{default:(0,m.k6)(()=>[(0,m.bF)(F,{modelValue:(0,p.R1)(f).trigger,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,p.R1)(f).trigger=e),placeholder:"",style:{width:"100%"}},{default:(0,m.k6)(()=>[((0,m.uX)(!0),(0,m.CE)(m.FK,null,(0,m.pI)((0,p.R1)(g.TipsTriggerType).getList(),e=>((0,m.uX)(),(0,m.Wv)(h,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},512)),[[c.aG,(0,p.R1)(f).show]]):(0,m.Q3)("",!0),(0,m.bo)((0,m.bF)(v,{label:"内容格式"},{label:(0,m.k6)(()=>[l[7]||(l[7]=(0,m.Lk)("span",null,"内容格式",-1)),(0,m.bF)(_,{class:"item",effect:"dark",placement:"right-start"},{content:(0,m.k6)(()=>l[6]||(l[6]=[(0,m.Lk)("div",null,[(0,m.eW)(" 模版变量有 {a}, {b}，{c}，{d}，分别表示系列名，数据名，数据值等。"),(0,m.Lk)("br"),(0,m.eW)(" 在 触发位置 为 '坐标轴' 的时候，会有多个系列的数据，此时可以通过 {a0}, {a1}, {a2} 这种后面加索引的方式表示系列的索引。"),(0,m.Lk)("br"),(0,m.eW)(" 不同图表类型下的 {a}，{b}，{c}，{d} 含义不一样。 其中变量{a}, {b}, {c}, {d}在不同图表类型下代表数据含义为："),(0,m.Lk)("br"),(0,m.eW)(" 折线（区域）图、柱状（条形）图、仪表盘 : {a}（系列名称），{b}（类目值），{c}（数值）"),(0,m.Lk)("br"),(0,m.eW)(" 饼图、漏斗图: {a}（系列名称），{b}（数据项名称），{c}（数值）, {d}（百分比） ")],-1)])),default:(0,m.k6)(()=>[(0,m.bF)(T,null,{default:(0,m.k6)(()=>[(0,m.bF)((0,p.R1)(b.InfoFilled))]),_:1})]),_:1})]),default:(0,m.k6)(()=>[(0,m.bF)(C,{modelValue:(0,p.R1)(f).formatter,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,p.R1)(f).formatter=e),type:"textarea",rows:4},null,8,["modelValue"])]),_:1},512),[[c.aG,(0,p.R1)(f).show]])]),_:1})):(0,m.Q3)("",!0)}}});const y=f;var R=y}}]);