"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,9585],{34436:function(e,t,a){a.d(t,{wc:function(){return u}});var l=a(24232);const n=100,r=600,u={beforeMount(e,t){const a=t.value,{interval:u=n,delay:i=r}=(0,l.Tn)(a)?{}:a;let o,s;const d=()=>(0,l.Tn)(a)?a():a.handler(),c=()=>{s&&(clearTimeout(s),s=void 0),o&&(clearInterval(o),o=void 0)};e.addEventListener("mousedown",e=>{0===e.button&&(c(),d(),document.addEventListener("mouseup",()=>c(),{once:!0}),s=setTimeout(()=>{o=setInterval(()=>{d()},u)},i))})}}},39585:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var l=a(21929),n=(a(97042),a(98421),a(65451)),r=(a(63390),a(25136)),u=(a(69957),a(77649)),i=(a(87603),a(76408)),o=(a(87535),a(32465),a(14022)),s=(a(72343),a(44114),a(18111),a(61701),a(56768)),d=a(90144),c=a(45130),m=a(26695),p=a(61617),v=a(71066),b=a(82572);const f={class:"form-single-fragment",style:{position:"relative"}};var g=(0,s.pM)({__name:"formEditFlowEntryStatus",props:{flowEntry:{},rowData:{},usedVariableList:{default:()=>[]},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,b.l5)(),a=e,{thirdParams:g,onCloseThirdDialog:y}=(0,v.P)(a),h=(0,s.EW)(()=>t.defaultFormItemSize||g.value.defaultFormItemSize?.value),E=(0,d.KR)(),w=(0,d.KR)({name:void 0,id:void 0}),R={id:[{required:!0,message:"状态标识不能为空！",trigger:"blur"}],name:[{required:!0,message:"状态显示名不能为空！",trigger:"blur"}]},N=(0,s.EW)(()=>({flowEntry:a.flowEntry||g.value.flowEntry,usedVariableList:a.usedVariableList||g.value.usedVariableList,rowData:a.rowData||g.value.rowData})),V=(0,s.EW)(()=>null!=a.rowData),k=()=>{a.dialog?a.dialog.cancel():y(!1)},x=()=>{E.value.validate(e=>{if(!e)return;if(-1!==N.value.usedVariableList.indexOf(w.value.id))return void m.nk.error("状态标识已存在！");let t=[];V.value?t=N.value.flowEntry.extensionData.approvalStatusDict.map(e=>e.name===a.rowData?.name?w.value:e):(t=[...N.value.flowEntry.extensionData.approvalStatusDict],t.push(w.value));let l={flowEntryDto:{...N.value.flowEntry,extensionData:JSON.stringify({approvalStatusDict:t,notifyTypes:N.value.flowEntry.notifyTypes})}};p.Dy.update(l).then(()=>{m.nk.success("保存成功！"),a.dialog?a.dialog.submit(t):y(!0,void 0,t)}).catch(e=>{console.warn(e)})})};return(0,s.sV)(()=>{N.value.rowData&&(w.value={...w.value,...N.value.rowData})}),(e,t)=>{const a=o.WK,m=l.xE,p=i.uD,v=u.lq,b=r.S2,g=n.S2,y=l.US;return(0,s.uX)(),(0,s.CE)("div",f,[(0,s.bF)(y,{ref_key:"form",ref:E,model:(0,d.R1)(w),class:"full-width-input",rules:R,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(h),"label-position":"right",onSubmit:t[2]||(t[2]=(0,c.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,s.bF)(g,{gutter:20},{default:(0,s.k6)(()=>[(0,s.bF)(p,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(m,{label:"状态显示名",prop:"name"},{default:(0,s.k6)(()=>[(0,s.bF)(a,{class:"input-item",modelValue:(0,d.R1)(w).name,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,d.R1)(w).name=e),clearable:!0,placeholder:"状态显示名"},null,8,["modelValue"])]),_:1})]),_:1}),(0,s.bF)(p,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(m,{label:"状态标识",prop:"id"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{class:"input-item",modelValue:(0,d.R1)(w).id,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,d.R1)(w).id=e),clearable:"",controls:!1,"step-strictly":!0,placeholder:"状态标识"},null,8,["modelValue"])]),_:1})]),_:1}),(0,s.bF)(p,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(g,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,s.k6)(()=>[(0,s.bF)(b,{size:(0,d.R1)(h),plain:!0,onClick:k},{default:(0,s.k6)(()=>t[3]||(t[3]=[(0,s.eW)(" 取消 ")])),_:1,__:[3]},8,["size"]),(0,s.bF)(b,{type:"primary",size:(0,d.R1)(h),onClick:x},{default:(0,s.k6)(()=>t[4]||(t[4]=[(0,s.eW)(" 保存 ")])),_:1,__:[4]},8,["size"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])])}}});const y=g;var h=y},53629:function(e,t,a){a.d(t,{W:function(){return s},c:function(){return d}});var l=a(16032),n=a(47378),r=a(53845),u=a(12235),i=a(58501),o=a(92056);const s=(0,n.b_)({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.MAX_SAFE_INTEGER},min:{type:Number,default:Number.MIN_SAFE_INTEGER},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:r.mU,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||(0,u.Et)(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...(0,i.l)(["ariaLabel"]),inputmode:{type:(0,n.jq)(String),default:void 0}}),d={[o.YU]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[o.qs]:e=>(0,u.Et)(e)||(0,l.A)(e),[o.l4]:e=>(0,u.Et)(e)||(0,l.A)(e)}},71066:function(e,t,a){a.d(t,{P:function(){return i},i:function(){return o}});var l=a(81387),n=a(27007),r=a(56768),u=a(90144);const i=e=>{console.log("接收到的第三方参数",e);const t=(0,u.KR)(0),a=(0,r.EW)(()=>{let t={};try{e.thirdParamsString&&(t=JSON.parse(e.thirdParamsString))}catch(a){console.log(a),t={}}return t});console.log("thirdParams",a);const l=(l,n,r)=>{console.log("onCloseThirdDialog",n,r),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:t.value,dialogKey:e.dialogKey,path:a.value.path,rowData:n?JSON.parse(JSON.stringify(n)):void 0,data:r?JSON.parse(JSON.stringify(r)):void 0,isSuccess:l}},"*")},i=(e,a)=>{switch(e){case"setToken":a.token&&(0,n.WG)(a.token);break;case"dialogIndex":t.value=a;break;case"refreshData":break;case"message":break}},o=e=>{i(e.data.type,e.data.data)};return(0,r.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",o,!1)}),(0,r.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",o)}),{thirdParams:a,onCloseThirdDialog:l}},o=()=>{let e;const t=(0,l.lq)(),a=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==t.path.indexOf("/thirdParty/")&&((0,r.sV)(()=>{(0,n.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),a()},18e4))}),(0,r.hi)(()=>{e&&clearInterval(e)}))}},77649:function(e,t,a){a.d(t,{lq:function(){return k}});var l=a(56768),n=a(90144),r=a(24232),u=a(45130),i=a(16032),o=a(14022),s=a(91542),d=a(57477),c=a(53629),m=a(99077),p=a(34436),v=a(36268),b=a(93513),f=a(44216),g=a(12235),y=a(86894),h=a(37207),E=a(92056);const w=(0,l.pM)({name:"ElInputNumber"}),R=(0,l.pM)({...w,props:c.W,emits:c.c,setup(e,{expose:t,emit:a}){const c=e,{t:m}=(0,v.Ym)(),w=(0,b.DU)("input-number"),R=(0,n.KR)(),N=(0,n.Kh)({currentValue:c.modelValue,userInput:null}),{formItem:V}=(0,f.j)(),k=(0,l.EW)(()=>(0,g.Et)(c.modelValue)&&c.modelValue<=c.min),x=(0,l.EW)(()=>(0,g.Et)(c.modelValue)&&c.modelValue>=c.max),S=(0,l.EW)(()=>{const e=W(c.step);return(0,g.b0)(c.precision)?Math.max(W(c.modelValue),e):(e>c.precision&&(0,y.U)("InputNumber","precision should not be less than the decimal places of step"),c.precision)}),D=(0,l.EW)(()=>c.controls&&"right"===c.controlsPosition),_=(0,h.NV)(),F=(0,h.CB)(),I=(0,l.EW)(()=>{if(null!==N.userInput)return N.userInput;let e=N.currentValue;if((0,i.A)(e))return"";if((0,g.Et)(e)){if(Number.isNaN(e))return"";(0,g.b0)(c.precision)||(e=e.toFixed(c.precision))}return e}),A=(e,t)=>{if((0,g.b0)(t)&&(t=S.value),0===t)return Math.round(e);let a=String(e);const l=a.indexOf(".");if(-1===l)return e;const n=a.replace(".","").split(""),r=n[l+t];if(!r)return e;const u=a.length;return"5"===a.charAt(u-1)&&(a=`${a.slice(0,Math.max(0,u-1))}6`),Number.parseFloat(Number(a).toFixed(t))},W=e=>{if((0,i.A)(e))return 0;const t=e.toString(),a=t.indexOf(".");let l=0;return-1!==a&&(l=t.length-a-1),l},C=(e,t=1)=>(0,g.Et)(e)?e>=Number.MAX_SAFE_INTEGER&&1===t?((0,y.U)("InputNumber","The value has reached the maximum safe integer limit."),e):e<=Number.MIN_SAFE_INTEGER&&-1===t?((0,y.U)("InputNumber","The value has reached the minimum safe integer limit."),e):A(e+c.step*t):N.currentValue,T=()=>{if(c.readonly||F.value||x.value)return;const e=Number(I.value)||0,t=C(e);U(t),a(E.qs,N.currentValue),q()},K=()=>{if(c.readonly||F.value||k.value)return;const e=Number(I.value)||0,t=C(e,-1);U(t),a(E.qs,N.currentValue),q()},M=(e,t)=>{const{max:l,min:n,step:u,precision:o,stepStrictly:s,valueOnClear:d}=c;l<n&&(0,y.$)("InputNumber","min should not be greater than max.");let m=Number(e);if((0,i.A)(e)||Number.isNaN(m))return null;if(""===e){if(null===d)return null;m=(0,r.Kg)(d)?{min:n,max:l}[d]:d}return s&&(m=A(Math.round(m/u)*u,o),m!==e&&t&&a(E.l4,m)),(0,g.b0)(o)||(m=A(m,o)),(m>l||m<n)&&(m=m>l?l:n,t&&a(E.l4,m)),m},U=(e,t=!0)=>{var l;const n=N.currentValue,r=M(e);t?n===r&&e||(N.userInput=null,a(E.l4,r),n!==r&&a(E.YU,r,n),c.validateEvent&&(null==(l=null==V?void 0:V.validate)||l.call(V,"change").catch(e=>(0,y.U)(e))),N.currentValue=r):a(E.l4,r)},$=e=>{N.userInput=e;const t=""===e?null:Number(e);a(E.qs,t),U(t,!1)},P=e=>{const t=""!==e?Number(e):"";((0,g.Et)(t)&&!Number.isNaN(t)||""===e)&&U(t),q(),N.userInput=null},L=()=>{var e,t;null==(t=null==(e=R.value)?void 0:e.focus)||t.call(e)},O=()=>{var e,t;null==(t=null==(e=R.value)?void 0:e.blur)||t.call(e)},z=e=>{a("focus",e)},X=e=>{var t,l;N.userInput=null,null===N.currentValue&&(null==(t=R.value)?void 0:t.input)&&(R.value.input.value=""),a("blur",e),c.validateEvent&&(null==(l=null==V?void 0:V.validate)||l.call(V,"blur").catch(e=>(0,y.U)(e)))},q=()=>{N.currentValue!==c.modelValue&&(N.currentValue=c.modelValue)},G=e=>{document.activeElement===e.target&&e.preventDefault()};return(0,l.wB)(()=>c.modelValue,(e,t)=>{const a=M(e,!0);null===N.userInput&&a!==t&&(N.currentValue=a)},{immediate:!0}),(0,l.sV)(()=>{var e;const{min:t,max:l,modelValue:n}=c,r=null==(e=R.value)?void 0:e.input;if(r.setAttribute("role","spinbutton"),Number.isFinite(l)?r.setAttribute("aria-valuemax",String(l)):r.removeAttribute("aria-valuemax"),Number.isFinite(t)?r.setAttribute("aria-valuemin",String(t)):r.removeAttribute("aria-valuemin"),r.setAttribute("aria-valuenow",N.currentValue||0===N.currentValue?String(N.currentValue):""),r.setAttribute("aria-disabled",String(F.value)),!(0,g.Et)(n)&&null!=n){let e=Number(n);Number.isNaN(e)&&(e=null),a(E.l4,e)}r.addEventListener("wheel",G,{passive:!1})}),(0,l.$u)(()=>{var e,t;const a=null==(e=R.value)?void 0:e.input;null==a||a.setAttribute("aria-valuenow",`${null!=(t=N.currentValue)?t:""}`)}),t({focus:L,blur:O}),(e,t)=>((0,l.uX)(),(0,l.CE)("div",{class:(0,r.C4)([(0,n.R1)(w).b(),(0,n.R1)(w).m((0,n.R1)(_)),(0,n.R1)(w).is("disabled",(0,n.R1)(F)),(0,n.R1)(w).is("without-controls",!e.controls),(0,n.R1)(w).is("controls-right",(0,n.R1)(D))]),onDragstart:(0,u.D$)(()=>{},["prevent"])},[e.controls?(0,l.bo)(((0,l.uX)(),(0,l.CE)("span",{key:0,role:"button","aria-label":(0,n.R1)(m)("el.inputNumber.decrease"),class:(0,r.C4)([(0,n.R1)(w).e("decrease"),(0,n.R1)(w).is("disabled",(0,n.R1)(k))]),onKeydown:(0,u.jR)(K,["enter"])},[(0,l.RG)(e.$slots,"decrease-icon",{},()=>[(0,l.bF)((0,n.R1)(s.tk),null,{default:(0,l.k6)(()=>[(0,n.R1)(D)?((0,l.uX)(),(0,l.Wv)((0,n.R1)(d.ArrowDown),{key:0})):((0,l.uX)(),(0,l.Wv)((0,n.R1)(d.Minus),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[(0,n.R1)(p.wc),K]]):(0,l.Q3)("v-if",!0),e.controls?(0,l.bo)(((0,l.uX)(),(0,l.CE)("span",{key:1,role:"button","aria-label":(0,n.R1)(m)("el.inputNumber.increase"),class:(0,r.C4)([(0,n.R1)(w).e("increase"),(0,n.R1)(w).is("disabled",(0,n.R1)(x))]),onKeydown:(0,u.jR)(T,["enter"])},[(0,l.RG)(e.$slots,"increase-icon",{},()=>[(0,l.bF)((0,n.R1)(s.tk),null,{default:(0,l.k6)(()=>[(0,n.R1)(D)?((0,l.uX)(),(0,l.Wv)((0,n.R1)(d.ArrowUp),{key:0})):((0,l.uX)(),(0,l.Wv)((0,n.R1)(d.Plus),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[(0,n.R1)(p.wc),T]]):(0,l.Q3)("v-if",!0),(0,l.bF)((0,n.R1)(o.WK),{id:e.id,ref_key:"input",ref:R,type:"number",step:e.step,"model-value":(0,n.R1)(I),placeholder:e.placeholder,readonly:e.readonly,disabled:(0,n.R1)(F),size:(0,n.R1)(_),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,inputmode:e.inputmode,onKeydown:[(0,u.jR)((0,u.D$)(T,["prevent"]),["up"]),(0,u.jR)((0,u.D$)(K,["prevent"]),["down"])],onBlur:X,onFocus:z,onInput:$,onChange:P},(0,l.eX)({_:2},[e.$slots.prefix?{name:"prefix",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","inputmode","onKeydown"])],42,["onDragstart"]))}});var N=(0,m.A)(R,[["__file","input-number.vue"]]),V=a(25376);const k=(0,V.GU)(N)},87603:function(e,t,a){a(97042),a(72343)}}]);