"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[5257],{692:function(e,t,a){a.d(t,{A:function(){return b}});var l=a(97456),i=(a(97042),a(15936),a(91542)),o=(a(37985),a(4311)),n=(a(25393),a(18111),a(61701),a(56768)),r=a(24232),s=a(90144),d=a(45130),u=a(57477),p=a(89277),c=a(21016),m=a(27007),g=a(96027);const y=["onClick"],f={key:1,class:"card-item-text"},v={key:2,class:"priview-btn"};var h=(0,n.pM)({__name:"index",props:{fileList:{default:()=>[]},type:{default:"text"},direction:{default:"vertical"},supportPreview:{type:Boolean,default:!0},supportDownload:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},supportAdd:{type:Boolean,default:!0}},emits:["remove","add","preview"],setup(e,{emit:t}){const{downloadFile:a}=(0,p.m)(),h=e,w=t,C=(0,n.EW)(()=>h.fileList.map(e=>({...e,type:E(e),error:!1}))),b=(0,n.EW)(()=>({"flex-direction":"vertical"===h.direction&&"card"!==h.type?"column":"row"})),T=(0,s.KR)(!1),k=(0,s.KR)(0),E=e=>e&&e.type?e.type:(0,m.ti)(e.name),R=(e,t)=>{const a=t.findIndex(t=>t.url===e.url);t.splice(a,1),w("remove",e,t)},S=(e,t)=>{h.supportPreview&&(h.supportPreview?(k.value=t.findIndex(t=>t.url===e.url),(0,n.dY)(()=>{T.value=!0,w("preview",e,t)})):h.supportDownload&&a(e.url,e.name))},D=()=>{w("add")};return(e,t)=>{const a=o.Zq,p=i.tk,m=l.R7;return(0,n.uX)(),(0,n.CE)("div",{class:"file-list",style:(0,r.Tr)((0,s.R1)(b))},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,s.R1)(C),t=>((0,n.uX)(),(0,n.Wv)(m,{effect:"dark",content:t.name,placement:"top",disabled:"text"===e.type,key:t.url},{default:(0,n.k6)(()=>[(0,n.Lk)("div",{class:(0,r.C4)(["file-item",e.type]),style:(0,r.Tr)({width:"text"===e.type&&"vertical"===e.direction?"100%":void 0,border:"card"!==e.type||e.readonly?"none":"1px dashed #999999"}),onClick:(0,d.D$)(a=>S(t,e.fileList),["stop"])},["card"===e.type?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[t.type===(0,s.R1)(c.EnumFileType).IMAGE?((0,n.uX)(),(0,n.Wv)(a,{key:0,src:t.url,fit:"cover",style:{width:"100%",height:"100%"}},null,8,["src"])):((0,n.uX)(),(0,n.CE)("div",f,[(0,n.bF)(p,{style:{"font-size":"24px"}},{default:(0,n.k6)(()=>[(0,n.bF)((0,s.R1)(u.Document))]),_:1})])),e.supportPreview?((0,n.uX)(),(0,n.CE)("div",v,"预览")):(0,n.Q3)("",!0),e.readonly?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(p,{key:3,class:"close-btn",onClick:(0,d.D$)(a=>R(t,e.fileList),["stop"])},{default:(0,n.k6)(()=>[(0,n.bF)((0,s.R1)(u.CircleCloseFilled))]),_:2},1032,["onClick"]))],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.Lk)("span",{style:(0,r.Tr)({"flex-grow":"vertical"===e.direction?1:0,width:"vertical"===e.direction?"100px":void 0,"margin-right":"vertical"===e.direction?void 0:"8px"})},(0,r.v_)(t.name),5),e.readonly?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(p,{key:0,class:"close-btn",style:{"margin-left":"6px"},onClick:(0,d.D$)(a=>R(t,e.fileList),["stop"])},{default:(0,n.k6)(()=>[(0,n.bF)((0,s.R1)(u.CircleCloseFilled))]),_:2},1032,["onClick"]))],64))],14,y)]),_:2},1032,["content","disabled"]))),128)),e.supportAdd&&e.$slots.default?((0,n.uX)(),(0,n.CE)("div",{key:0,class:(0,r.C4)(["file-item",e.type]),onClick:D},[(0,n.RG)(e.$slots,"default")],2)):(0,n.Q3)("",!0),(0,s.R1)(T)?((0,n.uX)(),(0,n.Wv)((0,s.R1)(g.A),{key:1,visible:(0,s.R1)(T),"file-list":e.fileList,defaultIndex:(0,s.R1)(k),readonly:!e.supportDownload,onClose:t[0]||(t[0]=e=>T.value=!1)},null,8,["visible","file-list","defaultIndex","readonly"])):(0,n.Q3)("",!0)],4)}}}),w=a(71241);const C=(0,w.A)(h,[["__scopeId","data-v-becf84ae"]]);var b=C},2878:function(e,t,a){a.d(t,{A:function(){return I}});var l=a(25136),i=(a(97042),a(69957),a(2403)),o=(a(63266),a(85983)),n=(a(32337),a(65451)),r=(a(63390),a(91542)),s=(a(37985),a(56768)),d=a(45130),u=a(90144),p=a(24232),c=a(38688),m=a(57477),g=a(21016),y=a(89001),f=a(37157),v=a(70483),h=a(54442);const w={class:"online-custom-query-list",style:{height:"100%"}},C={class:"order-box"},b={style:{"flex-grow":"1"}},T={class:"filter-dlg"},k={class:"filter"},E={class:"filter-dlg-header"};var R=(0,s.pM)({__name:"OnlineCustomQueryList",props:{leftWidget:{},isTree:{type:Boolean,default:!1},customFilter:{type:Boolean,default:!0},customCard:{type:Boolean,default:!0},widget:{},isEdit:{type:Boolean,default:!1},masterTableData:{}},emits:["widgetClick","update:widget"],setup(e,{emit:t}){const a=t,R=e,S=(0,s.WQ)("form",()=>(console.error("OnlineCustomQueryList: form not injected"),{isEdit:!1})),D=(0,u.KR)(!1),I=(0,u.KR)([]),{childWidgetList:A,onWidgetClick:W}=(0,v.Q)(R,a),L=(0,s.EW)(()=>Array.isArray(R.widget.childWidgetList)&&R.widget.childWidgetList.length>0?R.widget.childWidgetList[0]:void 0),x=(0,s.EW)(()=>{switch((L.value||{}).widgetType){case g.SysCustomWidgetType.ImageCard:return h.A;default:return""}}),_=()=>{let e,t;switch(R.widget.props.card){case g.SysCustomWidgetType.ImageCard:e=f.A;break}return e&&(t=S().getWidgetObject(e),t.showName="listCard",t.variableName="listCard"+(new Date).getTime(),t["relation"]=void 0,t["datasource"]=void 0,t["column"]=void 0),t};return(0,s.wB)(I,e=>{A.value=[L.value,...e]},{deep:!0}),(0,s.wB)(()=>R.widget.props.card,()=>{let e=_();A.value=[e,...I.value]}),(0,s.sV)(()=>{if(!Array.isArray(R.widget.childWidgetList)||0===R.widget.childWidgetList.length){let e=_();e&&(A.value=[e])}I.value=R.widget.childWidgetList.slice(1)}),(e,t)=>{const a=r.tk,g=n.S2,f=(0,s.g2)("van-sidebar"),v=o.x0,h=i.kA,R=l.S2;return(0,s.uX)(),(0,s.CE)("div",w,[(0,s.bF)(g,{class:"header",align:"middle",onClick:t[1]||(t[1]=(0,d.D$)(t=>(0,u.R1)(W)(e.widget),["stop"]))},{default:(0,s.k6)(()=>[(0,s.Lk)("div",C,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.widget.props.orderList,e=>((0,s.uX)(),(0,s.CE)("div",{class:"order-item",key:e.columnId},[(0,s.Lk)("span",null,(0,p.v_)(e.showName),1),(0,s.bF)(a,null,{default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(m.CaretBottom))]),_:1})]))),128))]),(0,s.Lk)("div",{class:"filter-btn",onClick:t[0]||(t[0]=(0,d.D$)(e=>D.value=!0,["stop"]))},t[5]||(t[5]=[(0,s.Lk)("span",null,"筛选",-1),(0,s.Lk)("i",{class:"online-icon icon-filter"},null,-1)]))]),_:1}),(0,s.bF)(g,{class:"list-box",style:(0,p.Tr)([{"border-top":"2px solid #f6f6f6"},{padding:e.isTree?"0px":void 0,background:e.isTree?"white":void 0}])},{default:(0,s.k6)(()=>[(0,s.bF)(g,{style:{width:"100%",height:"100%"}},{default:(0,s.k6)(()=>[e.isTree?((0,s.uX)(),(0,s.Wv)(f,{key:0,style:{width:"100px",height:"100%",background:"#f7f8fa"},onClick:t[2]||(t[2]=(0,d.D$)(t=>(0,u.R1)(W)(e.leftWidget),["stop"]))},{default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(c.uk),{title:"标签A"}),(0,s.bF)((0,u.R1)(c.uk),{title:"标签B"}),(0,s.bF)((0,u.R1)(c.uk),{title:"标签C"})]),_:1})):(0,s.Q3)("",!0),(0,s.Lk)("div",b,[(0,s.RG)(e.$slots,"card"),(0,u.R1)(L)&&e.customCard?((0,s.uX)(),(0,s.Wv)((0,s.$y)((0,u.R1)(x)),{key:0,class:(0,p.C4)(["widget-item",{active:e.isEdit&&(0,u.R1)(S)().isActive((0,u.R1)(L))}]),style:{background:"white"},isEdit:e.isEdit,widget:(0,u.R1)(L),onWidgetClick:(0,u.R1)(W)},null,40,["class","isEdit","widget","onWidgetClick"])):e.customCard?((0,s.uX)(),(0,s.Wv)(v,{key:1,description:"请选择列表使用的卡片"})):(0,s.Q3)("",!0)])]),_:3})]),_:3},8,["style"]),(0,s.bo)((0,s.Lk)("div",T,[(0,s.Lk)("div",k,[(0,s.Lk)("div",E,[t[6]||(t[6]=(0,s.Lk)("div",{style:{"font-size":"14px",color:"#333"}},"筛选",-1)),(0,s.bF)(a,{class:"close",onClick:t[3]||(t[3]=(0,d.D$)(e=>D.value=!1,["stop"]))},{default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(m.Close))]),_:1})]),(0,s.bF)(h,{class:"filter-content"},{default:(0,s.k6)(()=>[(0,s.RG)(e.$slots,"filter"),e.customFilter?((0,s.uX)(),(0,s.Wv)(y.A,{key:0,value:(0,u.R1)(I),"onUpdate:value":t[4]||(t[4]=e=>(0,u.i9)(I)?I.value=e:null),isEdit:e.isEdit,onWidgetClick:(0,u.R1)(W)},null,8,["value","isEdit","onWidgetClick"])):(0,s.Q3)("",!0)]),_:3}),(0,s.bF)(g,{class:"filter-btn-box",type:"flex",align:"bottom"},{default:(0,s.k6)(()=>[(0,s.bF)(R,{type:"default",size:"default",style:{width:"100px"}},{default:(0,s.k6)(()=>t[7]||(t[7]=[(0,s.eW)("重置")])),_:1,__:[7]}),(0,s.bF)(R,{type:"primary",size:"default",style:{"flex-grow":"1"}},{default:(0,s.k6)(()=>t[8]||(t[8]=[(0,s.eW)("确定")])),_:1,__:[8]})]),_:1})])],512),[[d.aG,(0,u.R1)(D)]])])}}}),S=a(71241);const D=(0,S.A)(R,[["__scopeId","data-v-1499a03f"]]);var I=D},5833:function(e,t,a){a.d(t,{A:function(){return g}});var l=a(85415),i=(a(97042),a(22243),a(7409),a(44114),a(18111),a(22489),a(61701),a(56768)),o=a(90144),n=a(27007),r=a(54428),s=a(31372),d=a(60760);const u={class:"user-select"};var p=(0,i.pM)({__name:"index",props:{modelValue:{},size:{default:"default"},placeholder:{},props:{default:()=>({label:"showName",value:"userId"})},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0}},emits:["update:modelValue","change","blur","focus"],setup(e,{emit:t}){const a=t,p=e,c=(0,o.KR)((0,n.yk)()),m=(0,o.KR)([]),g=e=>{m.value=[],p.multiple?Array.isArray(e)&&(m.value=e):null!=e&&m.value.push(e),w()&&h()},y=e=>{e&&s.l.show("用户选择",d["default"],{area:["900px","650px"],offset:"100px"},{value:m.value,props:p.props,path:"thirdSelectUser/"+c.value,multiple:p.multiple},{width:"900px",height:"650px",pathName:"/thirdParty/thirdSelectUser"}).then(e=>{g(e)}).catch(e=>{console.warn(e)})},f=e=>{m.value=m.value.filter(t=>t[p.props.value]!==e),h()},v=()=>{m.value=[],h()},h=()=>{let e;if(p.multiple){let t;e=m.value.map(e=>(null==t&&(t=[]),t.push({id:e[p.props.value],name:e[p.props.label]}),e)),a("update:modelValue",e.map(e=>e[p.props.value])),a("change",e.map(e=>e[p.props.value]),e,t)}else{e=m.value[0]||{};let t={id:e[p.props.value],name:e[p.props.label]};a("update:modelValue",e[p.props.value]),a("change",e[p.props.value],m.value,t)}},w=()=>{let e=p.multiple?(p.modelValue||[]).sort((e,t)=>e===t?0:e<t?-1:1).join(","):p.modelValue||"",t=m.value.sort((e,t)=>e[p.props.value]===t[p.props.value]?0:e[p.props.value]<t[p.props.value]?-1:1).map(e=>e[p.props.value]).join(",");return e!==t},C=()=>{let e={widgetType:"upms_user"};(null==p.modelValue||""===p.modelValue||Array.isArray(p.modelValue)&&p.modelValue.length<=0)&&(m.value=[]),p.multiple?e.fieldValues=Array.isArray(p.modelValue)?p.modelValue:[]:(e.fieldValues=Array.isArray(p.modelValue)?p.modelValue[0]:p.modelValue,e.fieldValues=null==e.fieldValues?[]:[e.fieldValues]),Array.isArray(e.fieldValues)&&e.fieldValues.length>0&&(e.fieldValues=e.fieldValues.join(","),r.If.viewByIds(e,{showMask:!1}).then(e=>{Array.isArray(e.data)&&(m.value=e.data)}).catch(e=>{console.warn(e)}))};return(0,i.wB)(()=>p.modelValue,()=>{p.modelValue&&C()},{immediate:!0}),(e,t)=>{const n=l.P9,r=l.AV;return(0,i.uX)(),(0,i.CE)("div",u,[(0,i.bF)(r,{"model-value":e.modelValue,style:{width:"100%"},multiple:e.multiple,disabled:e.disabled,size:e.size,clearable:e.clearable,"collapse-tags":e.collapseTags,placeholder:e.placeholder,teleported:!1,"popper-class":"user-select-popper",onVisibleChange:y,onRemoveTag:f,onClear:v,onBlur:t[0]||(t[0]=()=>a("blur")),onFocus:t[1]||(t[1]=()=>a("focus"))},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,o.R1)(m),t=>((0,i.uX)(),(0,i.Wv)(n,{key:t[e.props.value],label:t[e.props.label],value:t[e.props.value]},null,8,["label","value"]))),128))]),_:1},8,["model-value","multiple","disabled","size","clearable","collapse-tags","placeholder"])])}}}),c=a(71241);const m=(0,c.A)(p,[["__scopeId","data-v-fc984574"]]);var g=m},9202:function(e,t,a){a.d(t,{A:function(){return f}});var l=a(85415),i=(a(97042),a(22243),a(7409),a(44114),a(56768)),o=a(90144),n=a(26695),r=a(27007),s=a(31372),d=a(53155),u=a(18384),p=a(79745);const c={class:"data-select"};var m=(0,i.pM)({__name:"index",props:{value:{},relativeTable:{},size:{default:"default"},placeholder:{},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0},extraData:{}},emits:["update:value","change","input","blur","focus"],setup(e,{emit:t}){const a=t,m=e,g=(0,o.KR)((0,r.yk)()),y=(0,o.KR)({label:"",value:""}),f=(0,o.KR)(""),v=(0,i.WQ)("form",()=>(console.error("OnlineCustomDataSelect: form not injected"),{isEdit:!1})),h=()=>{y.value={label:"",value:""},f.value="",w(null)},w=e=>{a("update:value",f.value),a("change",f.value,e),a("input",f.value)},C=e=>{y.value={label:e[m.relativeTable?.displayField],value:e[m.relativeTable?.relativeColumn]},f.value=e[m.relativeTable?.relativeColumn],w(e)},b=()=>new Promise((e,t)=>{let a={},l=null;a.datasourceId=m.relativeTable?.datasourceId,a.filterDtoList=[],a.filterDtoList.push({columnName:m.relativeTable?.relativeColumn,columnValue:f.value,filterType:1,tableName:m.relativeTable?.relativeTableName}),a.relationId=m.relativeTable?.relationId,l=(0,d.bE)(u.x+`/online/onlineOperation/listByOneToManyRelationId/${m.relativeTable?.variableName}`,a),l.then(t=>{t.data.dataList.length>0&&(y.value={label:t.data.dataList[0][m.relativeTable?.displayField],value:f.value}),e({dataList:t.data.dataList,totalCount:t.data.totalCount})}).catch(e=>{t(e)})}),T=e=>new Promise((t,a)=>{v().loadOnlineFormConfig(e).then(e=>{t(e)}).catch(e=>{console.log(e),a(e)})}),k=e=>{e&&T(m.relativeTable?.relativeFormId).then(e=>{s.l.show("关联数据选择",p["default"],{area:["1200px","650px"],offset:"100px",skin:"one_to_one_query"},{value:f.value,relativeTable:m.relativeTable,formConfig:e,extraData:m.extraData,path:"thirdSelectData/"+g.value},{width:"1200px",height:"650px",pathName:"/thirdParty/thirdSelectData"}).then(e=>{C(e)}).catch(()=>{})}).catch(e=>{console.log(e),n.nk.error("获取弹窗信息失败！")})};return(0,i.sV)(()=>{f.value=m.value,f.value&&b()}),(0,i.wB)(()=>m.value,()=>{f.value=m.value,f.value&&b()},{deep:!0,immediate:!0}),(e,t)=>{const n=l.P9,r=l.AV;return(0,i.uX)(),(0,i.CE)("div",c,[(0,i.bF)(r,{"model-value":(0,o.R1)(f),style:{width:"100%"},multiple:e.multiple,disabled:e.disabled||null==(e.relativeTable||{}).relativeFormId,size:e.size,clearable:e.clearable,placeholder:e.placeholder,teleported:!1,"popper-class":"data-select-popper",onVisibleChange:k,onClear:h,onBlur:t[0]||(t[0]=()=>a("blur")),onFocus:t[1]||(t[1]=()=>a("focus"))},{default:(0,i.k6)(()=>[(0,i.bF)(n,{label:(0,o.R1)(y).label,value:(0,o.R1)(y).value},null,8,["label","value"])]),_:1},8,["model-value","multiple","disabled","size","clearable","placeholder"])])}}}),g=a(71241);const y=(0,g.A)(m,[["__scopeId","data-v-10894bf2"]]);var f=y},11051:function(e,t,a){a.d(t,{m:function(){return x}});a(44114),a(18111),a(22489),a(7588),a(61701),a(18237);var l=a(26695),i=a(164),o=a(36947),n=a(54898),r=a(21016),s=a(36525),d=a(27007),u=a(31372),p=a(82572),c=a(91324),m=a(86555),g=a(45352),y=a(49825),f=a(84325),v=a(46509),h=a(42933),w=a(69106),C=a(78430),b=a(53155),T=a(18384),k=a(71066),E=a(88279),R=a(56768);const S=(e,t,a,i)=>{const o=(0,p.i1)(),n=(0,p.l5)(),r=(0,R.nI)();return{formData:e,props:r?.props,formProps:t,loginStore:o,layoutStore:n,ElMessage:l.nk,router:a,Dialog:u.l,showDialog:i?.showDialog,showOnlineDialog:i?.showOnlineDialog,showDictSelectDlg:i?.showDictSelectDlg,showSelectDialog:i?.showSelectDialog,getFormWidget:()=>i?.formRef?.value,showMessage:(e,t)=>{l.nk[e](t)},close:i?.close,refresh:i?.refresh,axios:{post:b.bE,get:b.Jt},tableInstance:i?.tableInstance}},D={},I=e=>null==e||""===e?null:D[e];var A=a(43393),W=a(90144);const L={...C.A},x=e=>{const{props:t,router:a,formRef:C,close:D,refresh:x}=e,{buildFormConfig:_}=(0,v.U)(),{thirdParams:F}=(0,k.P)(t),N=(0,W.KR)(!1),O=(0,R.EW)(()=>({formConfig:t.formConfig||F.value.formConfig,rowData:t.rowData||F.value.rowData,masterTableData:t.masterTableData||F.value.masterTableData,isEdit:t.isEdit||F.value.isEdit||!1,isCopy:t.isCopy||F.value.isCopy||!1,isUpdate:t.isUpdate||F.value.isUpdate||!1,updateIdList:t.updateIdList||F.value.updateIdList||[],readOnly:t.readOnly||F.value.readOnly||!1,fullscreen:t.fullscreen||F.value.fullscreen||!1,saveData:null==(F.value||{}).saveData?t.saveData:F.value.saveData})),B=(0,p.i1)(),M=(0,R.EW)(()=>t.readOnly||!1),{checkPermCodeExist:X}=(0,n.S)(),V=(0,R.EW)(()=>O.value.formConfig.tableMap.get(O.value.formConfig.masterTableId)),P=(0,R.EW)(()=>null!=V.value?.relation),U=(0,W.Kh)({customField:{}}),K=(0,W.KR)(null),z=(e,t,a,i,o)=>{if(null==t)return void l.nk.error("错误的弹窗组件！！！");const n=I(t);null!=n?u.l.show(e,n,a,i).then(e=>{o&&o(e)}).catch(()=>{console.log("cancel")}):l.nk.error("错误的弹窗组件！！！")},Q=(e,t,a)=>{const l={formId:e,readOnly:t};ye(l,a)},G=(e,t,a,i,o)=>{if(!e)return void l.nk.error("请设置关联表单！");const{dialogWidth:n,dialogHeight:s,multiSelect:d}=a||{};me(e).then(e=>{const a={area:[(n||900)+"px",(s||600)+"px"]};let o=null;switch(e.formType){case r.SysOnlineFormType.QUERY:o=c.A;break;case r.SysOnlineFormType.ADVANCE_QUERY:o=m.A;break}if(null!=o)return u.l.show(e.formName||"选择弹窗",o,a,{formConfig:e,formList:O.value.formConfig.formList,tableList:O.value.formConfig.tableList,readOnly:!1,fullscreen:!1,isSelect:!0,multiple:d,filterBox:!1,openEvent:i,dialogData:t});l.nk.error("错误的弹窗组件！！！")}).then(e=>{o&&o(e,J)}).catch(e=>{console.error(e)})},Y=(e,t,a=!0,l)=>(null!=t&&""!==t||Promise.reject(new Error("字典ID不能为空！")),new Promise((i,n)=>{const r={dictId:t};o.S1.view(r).then(t=>{const o=t.data;if(null!=o&&"string"===typeof o.dictDataJson)try{const e=JSON.parse(o.dictDataJson);o.dialogSetting=e.dialogSetting}catch(s){console.error("JSON parse error:",s)}const r={dictId:o.dictId,dictName:o.dictName,valueColumnName:o.valueColumnName,keyColumnName:o.keyColumnName,parentKeyColumnName:o.parentKeyColumnName,treeFlag:o.treeFlag,dialogSetting:o.dialogSetting};u.l.show(e||"字典数据选择",f["default"],{area:["1000px","650px"],offset:"100px"},{value:[],dictInfo:r,multiple:a,igoreDictKeys:l,props:{label:(r||{}).valueColumnName,value:(r||{}).keyColumnName}}).then(e=>{i(e)}).catch(e=>{n(e)})}).catch(e=>{n(e)})})),j=(0,W.KR)({}),H={showDialog:z,showOnlineDialog:Q,showDictSelectDlg:Y,tableInstance:j,showSelectDialog:G,formRef:C,close:D,refresh:x},J=S(U,t,a,H),q=e=>{switch(e){case r.OnlineSystemVariableType.CURRENT_USER:return B.userInfo?.showName;case r.OnlineSystemVariableType.CURRENT_DEPT:return B.userInfo?.deptName;case r.OnlineSystemVariableType.CURRENT_DATE:return(0,d.Yq)(new Date,"YYYY-MM-DD");case r.OnlineSystemVariableType.CURRENT_TIME:return(0,d.Yq)(new Date,"YYYY-MM-DD HH:mm:ss");case r.OnlineSystemVariableType.FLOW_CREATE_USER:return(t.flowInfo||{}).processInstanceInitiator||B.userInfo?.showName}},$=e=>{if(!t.isEdit||e.bindData.dataType===r.SysCustomWidgetBindDataType.SYSTEM_VARIABLE)if(e.bindData.dataType===r.SysCustomWidgetBindDataType.Column&&e.column){if(e.relation&&U[e.relation.variableName]){if(M.value||e.widgetType===r.SysCustomWidgetType.Label){const t=U[e.relation.variableName][e.column.columnName+"DictMap"];if(null!=t&&t.name)return t.name;const a=U[e.relation.variableName][e.column.columnName+"DictMapList"];if(Array.isArray(a)&&a.length>0)return a.map(e=>e.name).join(",")}return U[e.relation.variableName][e.column.columnName]}if(e.datasource&&U[e.datasource.variableName]){if(M.value||e.widgetType===r.SysCustomWidgetType.Label){const t=U[e.datasource.variableName][e.column.columnName+"DictMap"];if(null!=t&&t.name)return t.name;const a=U[e.datasource.variableName][e.column.columnName+"DictMapList"];if(Array.isArray(a)&&a.length>0){const e=a.map(e=>e.name).join(",");return e}}return U[e.datasource.variableName][e.column.columnName]}}else{if(e.bindData.dataType===r.SysCustomWidgetBindDataType.Custom&&e.bindData.formFieldName)return U.customField[e.bindData.formFieldName];if(e.bindData.dataType===r.SysCustomWidgetBindDataType.SYSTEM_VARIABLE&&null!=e.bindData.systemVariableType)return q(e.bindData.systemVariableType)}},Z=e=>{const t=Xe.value&&Xe.value.pc?Xe.value.pc[e.variableName]:null;if(t&&t.hide)return!1;const a=te(e.eventInfo,r.OnlineFormEventType.VISIBLE);return!a||a(J)},ee=(e,a)=>{if(!t.isEdit&&N.value)if(e.bindData.dataType===r.SysCustomWidgetBindDataType.Column&&e.column){if(e.relation)return void(U[e.relation.variableName][e.column.columnName]=a);e.datasource&&(U[e.datasource.variableName][e.column.columnName]=a)}else e.bindData.dataType===r.SysCustomWidgetBindDataType.Custom&&e.bindData.formFieldName&&(U.customField[e.bindData.formFieldName]=a)},te=(e,t)=>e&&"function"===typeof e[t]?e[t]:null,ae=(e,a,l)=>{if(t.isEdit||!N.value)return;const i=(l||{}).dictData;if(e.bindData.dataType===r.SysCustomWidgetBindDataType.Column&&e.column){if(e.relation){null==a&&(U[e.relation.variableName][e.column.columnName+"DictMapList"]=void 0,U[e.relation.variableName][e.column.columnName+"DictMap"]=void 0),Array.isArray(i)?U[e.relation.variableName][e.column.columnName+"DictMapList"]=i:U[e.relation.variableName][e.column.columnName+"DictMap"]=i;const t=te(e.eventInfo,r.OnlineFormEventType.CHANGE);return void(t&&t(a,l,J))}e.datasource&&(null==a&&(U[e.datasource.variableName][e.column.columnName+"DictMapList"]=void 0,U[e.datasource.variableName][e.column.columnName+"DictMap"]=void 0),Array.isArray(i)?U[e.datasource.variableName][e.column.columnName+"DictMapList"]=i:U[e.datasource.variableName][e.column.columnName+"DictMap"]=i)}else e.bindData.dataType===r.SysCustomWidgetBindDataType.Custom&&e.bindData.formFieldName&&(null==a?(U.customField[e.bindData.formFieldName+"DictMapList"]=void 0,U.customField[e.bindData.formFieldName+"DictMap"]=void 0):Array.isArray(i)?U.customField[e.bindData.formFieldName+"DictMapList"]=i:U.customField[e.bindData.formFieldName+"DictMap"]=i);if(e.widgetType===r.SysCustomWidgetType.DataSelect&&(O.value.formConfig.formType===r.SysOnlineFormType.FORM||O.value.formConfig.formType===r.SysOnlineFormType.FLOW)){const t=(l||{}).selectRow,a=(e.props.relativeTable||{}).relationId,i=O.value.formConfig.relationMap.get(a);null!=i&&(null!=t?Object.keys(t).forEach(e=>{U[i.variableName][e]=t[e]}):U[i.variableName]=Object.create({}))}const o=te(e.eventInfo,r.OnlineFormEventType.CHANGE);o&&o(a,l,J)},le=e=>{let t;if(e&&e.table&&Array.isArray(e.table.columnList)&&e.table.columnList.forEach(e=>{e.primaryKey&&(t=e.columnName)}),e&&null!=t){if(null!=e.relation)return U[e.relation.variableName][t];if(null!=e.datasource)return U[e.datasource.variableName][t]}},ie=e=>{if(null==e)return;const t=e?O.value.formConfig.tableMap.get(e.tableId):void 0;return null!=t&&null!=t.datasource?null==t.relation?U[t.datasource.variableName][e.columnName]:U[t.relation.variableName][e.columnName]:void 0},oe=(e,t)=>{switch(e){case s.SysOnlineParamValueType.TABLE_COLUMN:{const e=O.value.formConfig.columnMap?O.value.formConfig.columnMap.get(t):null;return e?ie(e):void 0}case s.SysOnlineParamValueType.STATIC_DICT:return Array.isArray(t)?t[1]:void 0;case s.SysOnlineParamValueType.INPUT_VALUE:return t}},ne=e=>{if(Array.isArray(e.props.dictInfo.paramList)){const t={};for(let a=0;a<e.props.dictInfo.paramList.length;a++){const l=e.props.dictInfo.paramList[a];null!=l.dictValue&&null!=l.dictValueType&&(t[l.dictParamName]=oe(l.dictValueType,l.dictValue))}return t}return{}},re=e=>{let t="view";switch(e?.type){case r.SysCustomWidgetOperationType.ADD:case r.SysCustomWidgetOperationType.EDIT:case r.SysCustomWidgetOperationType.DELETE:case r.SysCustomWidgetOperationType.BATCH_DELETE:case r.SysCustomWidgetOperationType.UPDATE:case r.SysCustomWidgetOperationType.UPDATE_DIALOG:t="edit";break;default:t="view"}return V.value&&V.value.datasource?"online:"+V.value.datasource.variableName+":"+t:""},se=e=>!(O.value.formConfig.formType===r.SysOnlineFormType.QUERY&&!t.isEdit)||X(re(e)),de=(e,a=null)=>{if(t.isEdit)return!1;if(null==e)return!0;const l=te(e.eventInfo,r.OnlineFormEventType.OPERATION_DISABLED);return!!l&&l(a,J)},ue=(e,a=null)=>{if(t.isEdit)return!0;if(null==e)return!1;const l=te(e.eventInfo,r.OnlineFormEventType.OPERATION_VISIBLE);return!l||l(a,J)},pe=(e,t)=>{const a=te(e.eventInfo,r.OnlineFormEventType.OPERATION_CLICK);return null==a?Promise.resolve():new Promise((e,l)=>{setTimeout(async()=>{try{const l=await a(t,J);e(l)}catch(i){l(i)}},30)})},ce=e=>{const t=h.A.getWidgetAttribute(e.widgetType);if(null==t)return null;const a=h.A.getWidgetObject(t);return a.showName=e.showName,a.props={...e.props},a},me=e=>new Promise((t,a)=>{o.k$.render({formId:e}).then(e=>{const a=e.data.onlineForm;let l=JSON.parse(a.widgetJson);l=l.pc;const i={rawData:e.data,formName:a.formName,formType:a.formType,formKind:a.formKind,masterTableId:a.masterTableId,labelWidth:l.labelWidth,labelPosition:l.labelPosition,filterItemWidth:l.filterItemWidth,gutter:l.gutter,height:l.height,width:l.width,fullscreen:l.fullscreen,advanceQuery:l.advanceQuery,groupQuery:l.groupQuery,widgetList:l.widgetList,operationList:(l.operationList||[]).sort((e,t)=>(e.showOrder||0)-(t.showOrder||0)),tableWidget:l.tableWidget,leftWidget:l.leftWidget,groupWidget:l.groupWidget,customFieldList:l.customFieldList,formEventList:l.formEventList,maskFieldList:l.maskFieldList,mode:"pc",leftTreeRightTable:l.leftTreeRightTable};t(i)}).catch(e=>{a(e)})}),ge=(e,t)=>null!=t&&t.widgetType===r.SysCustomWidgetType.Table?y["default"]:e.formType===r.SysOnlineFormType.QUERY?c.A:e.formKind===r.SysOnlineFormType.ADVANCE_QUERY?m.A:e.formKind===r.SysOnlineFormType.GROUP_QUERY?g.A:y["default"],ye=(e,t)=>{const{isEdit:a,saveData:l,widget:i,rowData:o,masterTableData:n,callback:s}=t;me(e.formId).then(d=>{let p;p=d.fullscreen?{area:["100vw","100vh"],skin:"fullscreen-dialog"}:{area:[(d.width?d.width:600)+"px",(d.height?d.height:500)+"px"]};const c=ge(d,i);if(null==c)return Promise.reject(new Error("错误的操作组件！！！"));{const m="thirdOnlineEditForm"+(null==i?"":"/"+i.variableName);return K.value=s,u.l.show(d.formName,c,p,{formConfig:d,rowData:o,formData:U,masterTableData:n||O.value.masterTableData,isEdit:a,isCopy:e.type===r.SysCustomWidgetOperationType.COPY,isUpdate:t.isUpdate,updateIdList:t.updateIdList,readOnly:e.readOnly,fullscreen:d.fullscreen,saveData:l,processDefinitionKey:e.processDefinitionKey,taskVariableList:e.taskVariableList,path:m},{fullscreen:d.fullscreen,width:p.area[0],height:p.area[1],pathName:"/thirdParty/thirdOnlineEditForm"})}}).then(e=>{s&&"function"===typeof s&&s(e),K.value=null}).catch(e=>{console.log(e)})},fe=e=>e.relation&&e.bindData.dataType!==r.SysCustomWidgetBindDataType.Custom?U[e.relation.variableName]:$(e),ve=(e,t)=>{null!=e&&e.relation&&(U[e.relation.variableName]=t)},he=()=>{O.value.formConfig.tableMap.forEach(e=>{if(null==e.relation){const t=Array.isArray(e.columnList)?e.columnList.reduce((e,t)=>(e[t.columnName]="Boolean"!==t.objectFieldType&&void 0,e),{}):{};U[e.datasource.variableName]=t}else if(e.relation.relationType===s.SysOnlineRelationType.ONE_TO_ONE){const t=Array.isArray(e.columnList)?e.columnList.reduce((e,t)=>(e[t.columnName]="Boolean"!==t.objectFieldType&&void 0,e),{}):{};U[e.relation.variableName]=t}else if(e.relation.relationType===s.SysOnlineRelationType.ONE_TO_MANY)if(V.value&&null!=V.value.relation&&V.value.relation.relationId===e.relation.relationId){const t=Array.isArray(e.columnList)?e.columnList.reduce((e,t)=>(e[t.columnName]=void 0,e),{}):{};U[e.relation.variableName]=t}else U[e.relation.variableName]=[]}),Array.isArray(O.value.formConfig.customFieldList)&&O.value.formConfig.customFieldList.forEach(e=>{U.customField[e.fieldName]=void 0})};let we=[];const Ce=(0,W.Kh)([]),be=(0,W.Kh)([]),Te=(0,W.Kh)([]),ke=e=>{if(e.bindData.dataType===r.SysCustomWidgetBindDataType.Column&&e.column){if(e.relation&&U[e.relation.variableName])return e.relation.variableName+"."+e.column.columnName;if(e.datasource&&U[e.datasource.variableName])return e.datasource.variableName+"."+e.column.columnName}else if(e.bindData.dataType===r.SysCustomWidgetBindDataType.Custom&&e.bindData.formFieldName)return"customField."+e.bindData.formFieldName},Ee=e=>{if(null!=e){if(e.bindData.tableId&&(e.table=O.value.formConfig.tableMap.get(e.bindData.tableId)),e.bindData.columnId&&(e.column=O.value.formConfig.columnMap.get(e.bindData.columnId)),e.bindData.dataType===r.SysCustomWidgetBindDataType.Custom&&(null!=e.props.dictId?e.dictInfo=O.value.formConfig.dictMap.get(e.props.dictId):e.dictInfo=(e.column||{}).dictInfo),e.table&&(e.table.datasource&&(e.datasource=e.table.datasource),e.table.relation&&(e.relation=e.table.relation)),e.widgetType===r.SysCustomWidgetType.RichEditor&&Ce.push(e),e.propString=ke(e),e.props.dictInfo&&Array.isArray(e.props.dictInfo.paramList)&&e.props.dictInfo.paramList.forEach(t=>{if(t.dictValueType===s.SysOnlineParamValueType.STATIC_DICT){let a=null;if(Array.isArray(t.dictValue)&&2===t.dictValue.length){const l=L,i=l[t.dictValue[0]];null==i?a={widget:e,message:"组件字典参数"+t.dictParamName+"绑定的静态字典 ["+t.dictValue[0]+"] 并不存在！"}:null==i.getValue(t.dictValue[1])&&(a={widget:e,message:"组件字典参数"+t.dictParamName+"绑定的静态字典值并不属于静态字段 ["+t.dictValue[0]+"] ！"})}else a={widget:e,message:"组件字典参数"+t.dictParamName+"绑定的静态字典错误！"};null!=a&&we.push(a)}}),e.props.dictInfo&&e.props.dictInfo.dictId&&(e.props.dictInfo.dict=O.value.formConfig.dictMap.get(e.props.dictInfo.dictId)),e.column&&null!=e.column.dictInfo&&be.push(e),e.widgetType===r.SysCustomWidgetType.Table){if(e.primaryColumnName=void 0,e.table&&Array.isArray(e.table.columnList))for(let t=0;t<e.table.columnList.length;t++)if(e.table.columnList[t].primaryKey){e.primaryColumnName=e.table.columnList[t].columnName;break}Array.isArray(e.props.tableColumnList)&&(0,d.DS)(e.props.tableColumnList,t=>(t.isGroup||(t.table=O.value.formConfig.tableMap.get(t.tableId),t.column=O.value.formConfig.columnMap.get(t.columnId),t.relation=O.value.formConfig.relationMap.get(t.relationId),t.eventInfo=(t.eventList||[]).reduce((e,t)=>{const a=(0,w.tp)(t);return a&&(e[t.eventType]=a.bind(J)),e},{}),null!=t.table&&null!=t.column||we.push({widget:e,message:"表格列 ["+t.showName+"] 绑定的字段不存在！"})),!1)),Array.isArray(e.operationList)&&(e.operationList=(e.operationList||[]).sort((e,t)=>(e.showOrder||0)-(t.showOrder||0)),e.operationList.forEach(e=>{e.eventInfo=(e.eventList||[]).reduce((e,t)=>{const a=(0,w.tp)(t);return a&&(e[t.eventType]=a.bind(J)),e},{})})),Te.push(e)}Array.isArray(e.childWidgetList)&&e.childWidgetList.forEach(e=>{Ee(e)}),e.props&&e.props.dictInfo&&Array.isArray(e.props.dictInfo.paramList)&&e.props.dictInfo.paramList.forEach(t=>{if(t.dictValueType===s.SysOnlineParamValueType.TABLE_COLUMN){let a=O.value.formConfig.linkageMap.get(t.dictValue);null==a&&(a=[],O.value.formConfig.linkageMap.set(t.dictValue,a)),-1===a.indexOf(e)&&a.push(e)}}),Array.isArray(e.eventList)?e.eventInfo=e.eventList.reduce((e,t)=>{const a=(0,w.tp)(t);return a&&(e[t.eventType]=a.bind(J)),e},{}):e.eventInfo={}}},Re=()=>{Array.isArray(O.value.formConfig.operationList)&&O.value.formConfig.operationList.forEach(e=>{e.eventInfo=(e.eventList||[]).reduce((e,t)=>{const a=(0,w.tp)(t);return a&&(e[t.eventType]=a.bind(J)),e},{})}),Array.isArray(O.value.formConfig.formEventList)?O.value.formConfig.eventInfo=O.value.formConfig.formEventList.reduce((e,t)=>{const a=(0,w.tp)(t);return a&&(e[t.eventType]=a.bind(J)),e},{}):O.value.formConfig.eventInfo={},Array.isArray(O.value.formConfig.widgetList)&&O.value.formConfig.widgetList.forEach(e=>{Ee(e)}),we=[],O.value.formConfig.tableWidget&&Ee(O.value.formConfig.tableWidget),O.value.formConfig.leftWidget&&Ee(O.value.formConfig.leftWidget),O.value.formConfig.groupWidget&&Ee(O.value.formConfig.groupWidget),we.length>0&&console.error(we)},Se=(e,t)=>{if(null!=e){let a="";e.bindData.dataType===r.SysCustomWidgetBindDataType.Custom?a="customField."+e.bindData.formFieldName:e.bindData.dataType===r.SysCustomWidgetBindDataType.Column&&e.column&&(a=(e.relation?e.relation.variableName:e.datasource.variableName)+"."+e.column.columnName),a&&(e.props.required||e.column&&Array.isArray(e.column.ruleList))&&t&&(t[a]=[],e.props.required&&t[a].push({required:!0,message:e.showName+"不能为空！",trigger:"change"}),e.column&&Array.isArray(e.column.ruleList)&&e.column.ruleList.forEach(l=>{const i=(0,E.a)(e.column,l,"change");i&&t[a].push(i)})),Array.isArray(e.childWidgetList)&&e.childWidgetList.forEach(e=>{Se(e,t)})}},De=(0,W.KR)({}),Ie=()=>{De.value||(De.value={}),O.value.formConfig.widgetList.forEach(e=>{Se(e,De.value)}),(0,R.dY)(()=>{C&&C.value.clearValidate()})},Ae=(e,t=[])=>{null!=e&&Array.isArray(e.columnList)&&e.columnList.length>0&&e.columnList.forEach(a=>{a.supportMaskField||a.fieldKind!==s.SysOnlineFieldKind.FIELD_MASK||t.push(e.tableName+"."+a.columnName)})},We=(e=null)=>{const t=[];return null==e?O.value.formConfig.tableMap.forEach(e=>{Ae(e,t)}):null==e.relation?(Ae(e.datasource.masterTable,t),e.datasource&&Array.isArray(e.datasource.relationList)&&e.datasource.relationList.forEach(e=>{e.relationType===s.SysOnlineRelationType.ONE_TO_ONE&&Ae(e.slaveTable,t)})):Ae(e.relation.slaveTable,t),t.length>0?t.join(","):void 0},Le=e=>{e&&e.widgetImpl&&"function"===typeof e.widgetImpl.reset&&e.widgetImpl.reset()},xe=()=>{O.value.formConfig.linkageMap.forEach((e,t)=>{const a=O.value.formConfig.columnMap.get(t),l=a?O.value.formConfig.tableMap.get(a.tableId):void 0;(0,R.wB)(()=>null==l.relation?U[l.datasource.variableName][a.columnName]:U[l.relation.variableName][a.columnName],t=>{Array.isArray(e)&&e.forEach(e=>{Le(e)})})})},_e=(e,t)=>{let a;return Array.isArray(t)&&(a=t.map(t=>{const a=t.paramValue;if(null!=a){const l=O.value.formConfig.columnMap.get(a),i=e?(e||{})[l.columnName]:ie(l);if(null!=t.paramName&&null!=i)return{paramName:t.paramName,paramValue:i}}return null}).filter(e=>null!=e)),a},Fe=(e,t,a,i)=>{if(null==e)return;let o;if(null!=t){const a=_e(t,e.printParamList);o=Array.isArray(a)?a:[]}else{if(null==a||a?.length<=0)return void l.nk.error("请选择要打印的数据！");o=a.map(t=>_e(t,e.printParamList)).filter(e=>null!=e)}(0,A.Lv)(e.printTemplateId,e.printTemplateType,o,i)},Ne=(0,R.EW)(()=>{if(null==V.value)return null;if(Array.isArray(V.value.columnList))for(let e=0;e<V.value.columnList.length;e++)if(V.value.columnList[e].primaryKey)return V.value.columnList[e].columnName;return null}),Oe=(e,t,a)=>{const l={id:a[Ne.value],processDefinitionKey:e,taskVariableData:{}};return l.taskVariableData=(t||[]).reduce((e,t)=>(0===t.variableType?e[t.variableName]=t.variableValue:1===t.variableType&&(e[t.variableName]=a[t.variableValue]),e),{}),(0,b.bE)(T.x+"/flow/flowOnlineOperation/startWithBusinessKey",l)},Be=(e,t)=>{i.s.confirm("是否要启动流程？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(()=>{null!=e&&null!=e.processDefinitionKey&&null!=Ne.value&&null!=t&&null!=t[Ne.value]?Oe(e.processDefinitionKey,e.taskVariableList,t).then(()=>{l.nk.success("启动成功！")}).catch(e=>{console.error(e)}):l.nk.error("启动流程失败，缺少必要参数！")}).catch(e=>{console.error(e)})},Me=()=>new Promise((e,t)=>{o.S1.list({}).then(t=>{t.data.dataList.forEach(e=>{e.id=e.dictId,e.name=e.dictName,e.dictData=e.dictDataJson?JSON.parse(e.dictDataJson):void 0}),e(t.data.dataList)}).catch(e=>{t(e)})}),Xe=(0,W.KR)(),Ve=(0,W.KR)();return(0,R.wB)(()=>O.value.formConfig,()=>{_(O.value.formConfig),O.value.isEdit||(he(),Re()),Ve.value=O.value.formConfig},{immediate:!0}),{rules:De,isReady:N,dialogParams:O,form:Ve,formData:U,instanceData:J,formAuth:Xe,masterTable:V,isRelation:P,tableWidgetList:Te,richEditWidgetList:Ce,getWidgetValue:$,getWidgetProp:ke,getWidgetVisible:Z,onValueChange:ee,onWidgetValueChange:ae,getPrimaryData:le,getDropdownParams:ne,checkOperationPermCode:se,checkOperationDisabled:de,checkOperationVisible:ue,cloneWidget:ce,handlerOperation:ye,handlerScriptOperation:pe,loadOnlineFormConfig:me,getTableData:fe,setTableData:ve,initPage:he,initFormWidgetList:Re,initWidgetRule:Ie,getIgnoreMaskFields:We,initWidgetLinkage:xe,onPrint:Fe,onStartFlow:Be,onStartFlowImpl:Oe,loadOnlineDictList:Me,showDialog:z,showOnlineDialog:Q,masterTablePrimaryKey:Ne,showSelectDialog:G,tableInstance:j}}},13180:function(e,t,a){a.d(t,{D:function(){return i}});var l=a(90144);const i=e=>{const t=(0,l.KR)([]),a=(0,l.KR)(e),i=(a,l)=>{l&&l.length>0?t.value=1==e?[l[l.length-1]]:l:t.value=[]};return{fileList:t,onFileChange:i,maxCount:a}}},13538:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAZ+SURBVHgB7ZxPaBxVHMd/v5khRUVZqphDSzOxCvHQkORSLAETMGuSomzAk0aygYKgYoNeejGNelKomB6ESiEbwZ6ExEqa0AjZQ0AvtjU9NCDVSbCHQhtDxdSN2Xm+35ud7eyf2Z0/b//aD4Td7M5u9n339++993tBqALxuUEdWqDPBOxChDZgpg6IEf6UnnepAYxtAyoGY7ChpNNJUJmROL58DSoMQoWIfz/YZyoYQzTH+J+JQDi4QJDEtPld4tXL81ABpAoRXxzUTYAxZGxCwuDdsETZhY8SI0sGSEKKEEIABlP8zcagmjBIyBIklBDxub4I27fvNH+bCaglEgQJLMTopWhMBZypoAv4xWAAU18PL81CAHwLUTdW4Ar7AlMpbh3JbT+v8iUExQJmsjme+rqgvjEwBf1+XEXxemF8YaCL5/aVBhCB0Nk+WBH1i0c8WYQQAZWVOooHHmHbyMx+LwVZWSGEOzB2tfFEsPEmRknXsESABrQEJxhhqM6VcxNXIUR2ECJAyTdoEHTWwuZoTG4XuAphpcimEMGCB/nMmIo/XezBNxcG4wrCDDQhuGeOFJu4FQjxIC40kTXkwINnKtWeX3AVuAZNnqBpRSAwUsxFciwiYw2/w/8AXnm2OytPzflkZirdMHTsPwKx50bF/fNrn8Od+7c9v5a1AFnFuP17dtyNZA22AB37O7OPXbhxDi4b/havnFaRtYhGsIZiAtjc2fFuDTZmC8T5zRTdzwrBRXgR6pRSAtisb62BXxDZSXAKMXoxGoM6zBS9Bwa4AG/AU4+0lrxu895vsLP3N/gHI7TInHhlKSmEUDQlBnWEVwFs1rd+gaDQSju/sYSoB7d4VHsMou0xiOoj4r4f1u9eh6BY2w0wgdZag3oVakQYAWzeXn4toGtYUPbQ9tKoqxpUHb8C0EApMxx64pmcx4PHhwek+S6cpqjYB1UkiAVQobT6x3K2eHISJj7YIN+K1MReZBUI6gIkAhVLJzo/KPr8lds/QWgUpmt8c0SHClZSoYIgrw0u3PgK3uv50PW1m/duQlj4FmWbltmVlk7YIEjlMv2cOvqpaxolocLGBwuMUJjUQSL0oaN6DHoPDgTOAvO/fsNFmCspAiHDGjLo0vIFfWAKZr0HXoKg0Ld7fu0M9/sfuTtM8gxxuOT1UuJDhtBC0Dyg92A0lAAEBcWzVz4R3/Lrz78FPa0vlH2NRIsIJwSJcOroZxAWGhCJQGJQaU2uVQ558cGChDAgYJwoZ7peIDcgd6BBkQixZ0c9vU6mNXAMzepZCpY/V28tw6HHD0PHk0c8T5CcUFagGoEgV/AqAiEzPtCCLk+fwiICbezu/MuD2/Uz4j6tFdBg6MeLKM4VJbIst4LJjSDrD24wxA2NutdQQkFFH8wqgM4JIWxR8hdTyAXO/vxxdiB0bamCye1vScVEQ2OA12QXlhT07IKIBtjTeiybBUgoe5GVRChXKxRj/a5cIVTVXNFUBZLcKioGWQDFEvrJ50Tn+4Fiy/pW8PWHYjDF3BDGMHbp5T9rseNdyoVKEV8cAokYs8NL7aKO4BYxy+PESagyThciUZwB1w3p8YFBkm6sNUsT55lafSG+HPhW1AO01rB664ccFxKCPH2sIDXTtTJRVCZSVzZO1sI9EkOL4pYsY3L1HddK0bYUStc0GZNYUQq3oDvZEpsxnObucRpqALlGqcHZqVk6GbcgsrvhigIJqAE0QL9bdbKgbl37flaIxNASda4G6loNyuZfN8XmbU1gkHDuhuf0RyhobX9Vi8nVd33tYMvEaQ1EjhDCKhibhmYnzxqIgo4ZZTc1RbMxaF6MfGsgCoSg3iLcY+PQpPABTxXr0S7aXkhdZ83oIshLhBmXYwyufZbCRRir+KGyKmLA7v0ptyddhRAuouAIWEt5jU7m2IL7GY7yTekN25lvQ32V2F3u7EbZ8xrU1U7d7Y2ZSTKd+R4OsHg6uCLEQOyGxnITw+tZDcLzCR4qtvikrB8aQQwe5EVM8HGC2LMQhBAj9U93PadWSpG4m+r3e/Qx8LptfGEwzqxpuw51AY8HwMYTw8GOTPuyCCeJ40sJcpVqz1iLIayAOu6Hg58bf3gkOoP8Q/KWINSuqENFoJSI07BbOIMMQ+X+bcLFaMzUlJgcUdg2Y8qsYrJ56pKFClCVPnSqTiGNuqmqfYhmm9W3VeofaQBfF1E2FOBznV1Iyvzm3fgP5r4BKhMARDcAAAAASUVORK5CYII="},21013:function(e,t,a){a.d(t,{A:function(){return o}});var l=a(55583),i=a(18384);class o extends l.w{static getUserList(e,t){return super.post(i.x+"/upms/sysUser/list",e,t)}static addUser(e,t){return super.post(i.x+"/upms/sysUser/add",e,t)}static updateUser(e,t){return super.post(i.x+"/upms/sysUser/update",e,t)}static deleteUser(e,t){return super.post(i.x+"/upms/sysUser/delete",e,t)}static viewMenu(e,t){return super.post(i.x+"/upms/sysMenu/view",e,t)}static syncAzureUser(e){return super.post(i.x+"/upms/sysUser/syncAzureUser",e)}static getUser(e,t){return super.get(i.x+"/upms/sysUser/view",e,t)}static resetUserPassword(e,t){return super.post(i.x+"/upms/sysUser/resetPassword",e,t)}static listSysPermWithDetail(e,t){return super.get(i.x+"/upms/sysUser/listSysPermWithDetail",e,t)}static listSysPermCodeWithDetail(e,t){return super.get(i.x+"/upms/sysUser/listSysPermCodeWithDetail",e,t)}static listSysMenuWithDetail(e,t){return super.get(i.x+"/upms/sysUser/listSysMenuWithDetail",e,t)}}},28705:function(e,t,a){a.d(t,{D3:function(){return n},JY:function(){return s},Sb:function(){return d},Uo:function(){return c},dU:function(){return r},oG:function(){return p},ok:function(){return m},q2:function(){return o},wr:function(){return u}});a(44114),a(18111),a(22489),a(7588);var l=a(27007),i=a(92380);function o(e){return i.CriteriaFilterType.getList().filter(t=>{switch(e){case"Boolean":return-1!==[i.CriteriaFilterType.EQ,i.CriteriaFilterType.NOT_EQ].indexOf(t.id);case"String":return-1!==[i.CriteriaFilterType.EQ,i.CriteriaFilterType.NOT_EQ,i.CriteriaFilterType.LIKE,i.CriteriaFilterType.NOT_NULL,i.CriteriaFilterType.IS_NULL,i.CriteriaFilterType.IN,i.CriteriaFilterType.NOT_IN].indexOf(t.id);case"Date":return-1!==[i.CriteriaFilterType.EQ,i.CriteriaFilterType.GE,i.CriteriaFilterType.GT,i.CriteriaFilterType.LE,i.CriteriaFilterType.LT,i.CriteriaFilterType.BETWEEN,i.CriteriaFilterType.NOT_NULL,i.CriteriaFilterType.IS_NULL].indexOf(t.id);case"Integer":case"Long":case"Double":case"BigDecimal":return-1!==[i.CriteriaFilterType.EQ,i.CriteriaFilterType.NOT_EQ,i.CriteriaFilterType.GE,i.CriteriaFilterType.GT,i.CriteriaFilterType.LE,i.CriteriaFilterType.LT,i.CriteriaFilterType.NOT_NULL,i.CriteriaFilterType.IS_NULL,i.CriteriaFilterType.IN,i.CriteriaFilterType.NOT_IN].indexOf(t.id);default:return[]}})}function n(e,t,a){return Array.isArray(e)?e.filter(e=>{switch(a.fieldType){case"Boolean":return-1!==[i.FilterValueKind.FORM_PARAM,i.FilterValueKind.WIDGET_DATA,i.FilterValueKind.DICT_DATA,i.FilterValueKind.PRINT_INPUT_PARAM,i.FilterValueKind.INPUT_DATA].indexOf(e);case"String":return-1!==[i.FilterValueKind.FORM_PARAM,i.FilterValueKind.WIDGET_DATA,i.FilterValueKind.DICT_DATA,i.FilterValueKind.COLUMN_DATA,i.FilterValueKind.PRINT_INPUT_PARAM,i.FilterValueKind.INPUT_DATA].indexOf(e);case"Date":return-1!==[i.FilterValueKind.FORM_PARAM,i.FilterValueKind.WIDGET_DATA,i.FilterValueKind.DICT_DATA,i.FilterValueKind.COLUMN_DATA,i.FilterValueKind.PRINT_INPUT_PARAM,i.FilterValueKind.INNER_VARIABLE,i.FilterValueKind.INPUT_DATA].indexOf(e);case"Integer":case"Long":case"Double":case"BigDecimal":return-1!==[i.FilterValueKind.FORM_PARAM,i.FilterValueKind.WIDGET_DATA,i.FilterValueKind.DICT_DATA,i.FilterValueKind.COLUMN_DATA,i.FilterValueKind.PRINT_INPUT_PARAM,i.FilterValueKind.INPUT_DATA].indexOf(e);default:return[]}}).filter(e=>t!==i.CriteriaFilterType.IN&&t!==i.CriteriaFilterType.NOT_IN||(e===i.FilterValueKind.DICT_DATA||e===i.FilterValueKind.COLUMN_DATA)):[]}function r(e,t){let a=null;if(null==t||""===t)return a;switch(e){case i.CalculateType.SUM:a="sumOf";break;case i.CalculateType.COUNT:a="countOf";break;case i.CalculateType.AVG:a="avgOf";break;case i.CalculateType.MIN_BY:a="minOf";break;case i.CalculateType.MAX_BY:a="maxOf";break;case i.CalculateType.STD_DEV:a="stddevOf";break;case i.CalculateType.MEAN_DEV:a="varpopOf";break}return a+(0,l.ET)(t,1)}const s=(e,t,a)=>{if(null==e)return null;if(Array.isArray(t)){let l=t.length>0?e:void 0;for(let e=0;e<t.length;e++){const a=t[e];if(null==a||null==l){l=void 0;break}l=l[a]}return null!=l&&"number"===typeof l?d(l,a):l}{const a=t+"__DictMap";return e[a]?e[a].name:e[t]}},d=(e,t)=>void 0===t||null==e||null==e.toFixed?e:Number(e.toFixed(t)),u=(e,t)=>{const a=[];return t.forEach(t=>{a.push(d(e[t.columnName],t.fixed))}),a},p=(e,t)=>{if(e){if(Array.isArray(t)){let a=t.length>0?e:void 0;for(let e=0;e<t.length;e++){const l=t[e];if(!l||!a){a=void 0;break}const i=l+"__DictMap";a=a[i]?a[i].name:a[l]}return a}{const a=t,l=a+"__DictMap";return e[l]?e[l].name:e[a]}}},c=e=>Array.isArray(e)?e.join("__"):e,m=(e,t)=>{const a=[];return t.forEach(t=>{a.push(p(e,t.columnName))}),a.join("\r\n")}},37856:function(e,t,a){a.d(t,{A:function(){return Cl}});var l=a(85415),i=(a(97042),a(7409),a(97863)),o=(a(44332),a(17851)),n=(a(62436),a(20709),a(18111),a(22489),a(7588),a(61701),a(56768)),r=a(90144),s=a(24232),d=a(14022),u=a(77649),p=a(3740),c=a(18888),m=a(88284),g=a(54620),y=a(11384),f=a(41656),v=a(70305),h=a(66730),w=a(10785),C=a(98214),b=a(69862),T=a(40122),k=a(48104),E=a(84536),R=(a(53086),a(91542)),S=(a(37985),a(45130)),D=a(57477),I=a(164),A=a(31372),W=a(60962);const L={key:1,class:"sign-preview"},x=["src"];var _=(0,n.pM)({__name:"index",props:{modelValue:{},width:{default:"100%"},height:{default:"200px"},disabled:{type:Boolean},backgroundColor:{},penColor:{default:"#000000"},autoTrim:{type:Boolean,default:!0}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,i=()=>{l.disabled||A.l.show("手写签名",W.A,{area:["600px"]},{value:l.modelValue,width:"100%",height:"300px",autoTrim:l.autoTrim,backgroundColor:l.backgroundColor,penColor:l.penColor}).then(e=>{a("update:modelValue",e.data),a("change",e.data)})},o=()=>{I.s.confirm("确定要删除此签名吗？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a("update:modelValue",void 0),a("change",void 0)}).catch(e=>{console.log(e)})};return(e,t)=>{const a=R.tk,d=g.C4;return(0,n.uX)(),(0,n.CE)("div",{class:(0,s.C4)(["hand-sign-box",{disabled:e.disabled}]),style:(0,s.Tr)({width:e.width}),onClick:i},[null==l.modelValue||""===l.modelValue?((0,n.uX)(),(0,n.Wv)(d,{key:0,type:"info",underline:!1,class:"hand-sign"},{default:(0,n.k6)(()=>[(0,n.bF)(a,null,{default:(0,n.k6)(()=>[(0,n.bF)((0,r.R1)(D.Edit))]),_:1}),t[0]||(t[0]=(0,n.Lk)("span",null,"添加签名",-1))]),_:1,__:[0]})):((0,n.uX)(),(0,n.CE)("div",L,[(0,n.Lk)("div",{class:"preview-delete-icon",onClick:(0,S.D$)(o,["stop"])},[(0,n.bF)(a,null,{default:(0,n.k6)(()=>[(0,n.bF)((0,r.R1)(D.Delete))]),_:1})]),(0,n.Lk)("img",{src:l.modelValue,alt:"签名",style:(0,s.Tr)({height:e.height})},null,12,x)]))],6)}}}),F=a(71241);const N=(0,F.A)(_,[["__scopeId","data-v-d095cc24"]]);var O=N,B=a(54015),M=a(5833),X=a(16925);const V={style:{border:"1px solid #ccc"}},P={placeholder:"请输入内容...",MENU_CONF:{uploadImage:{base64LimitSize:1048576}}},U={toolbarKeys:["headerSelect","bold","underline","italic","through","color","bgColor","fontSize","fontFamily","indent","delIndent","lineHeight","insertImage","uploadImage","divider","insertLink","editLink","unLink","viewLink","codeBlock","blockquote","todo","redo","undo","fullScreen"]};var K=(0,n.pM)({__name:"index",props:{modelValue:{},editorConfig:{default:()=>P},toolbarConfig:{default:()=>U},height:{default:"300px"}},emits:["update:modelValue"],setup(e,{expose:t,emit:a}){const l=a,i=e,o=(0,r.IJ)(),d=(0,r.KR)("default"),u=(0,r.KR)(i.modelValue);(0,n.xo)(()=>{const e=o.value;null!=e&&e.destroy()});const p=e=>{o.value=e,e.setHtml(u.value),console.log("editor",e),console.log(e.getAllMenuKeys())};(0,n.wB)(()=>i.modelValue,e=>{e!==u.value&&(u.value=e)},{deep:!0,immediate:!0}),(0,n.wB)(()=>u.value,e=>{l("update:modelValue",e)});const c=()=>o.value?o.value.getHtml():void 0;return t({getHtml:c}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",V,[(0,n.bF)((0,r.R1)(X.M),{style:{"border-bottom":"1px solid #ccc"},editor:o.value,defaultConfig:e.toolbarConfig,mode:(0,r.R1)(d)},null,8,["editor","defaultConfig","mode"]),(0,n.bF)((0,r.R1)(X.K),{style:(0,s.Tr)([{"overflow-y":"hidden"},{height:e.height}]),modelValue:(0,r.R1)(u),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,r.i9)(u)?u.value=e:null),defaultConfig:e.editorConfig,mode:(0,r.R1)(d),onOnCreated:p},null,8,["style","modelValue","defaultConfig","mode"])]))}});const z=K;var Q=z,G=a(27007),Y=a(36525),j=a(21016);const H={class:"custom-label"},J=["innerHTML"];var q=(0,n.pM)({__name:"OnlineCustomLabel",props:{value:{type:[Number,String,Boolean,Array]},widget:{}},setup(e){const t=e,a=(0,n.WQ)("form",()=>(console.error("OnlineCustomLabel: form not injected"),{isEdit:!1})),l=(0,n.EW)(()=>-1!==[j.SysCustomWidgetType.Label,j.SysCustomWidgetType.Input,j.SysCustomWidgetType.NumberInput,j.SysCustomWidgetType.NumberRange,j.SysCustomWidgetType.Slider,j.SysCustomWidgetType.Radio,j.SysCustomWidgetType.CheckBox,j.SysCustomWidgetType.Switch,j.SysCustomWidgetType.Select,j.SysCustomWidgetType.Cascader,j.SysCustomWidgetType.Date,j.SysCustomWidgetType.DateRange,j.SysCustomWidgetType.UserSelect,j.SysCustomWidgetType.DeptSelect,j.SysCustomWidgetType.DataSelect,j.SysCustomWidgetType.DictSelect].indexOf(t.widget.widgetType)),i=(0,n.EW)(()=>(t.widget.widgetType===j.SysCustomWidgetType.RichEditor||t.widget.widgetType===j.SysCustomWidgetType.Label)&&t.widget.column&&t.widget.column.fieldKind===Y.SysOnlineFieldKind.RICH_TEXT),o=(0,n.EW)(()=>{switch(t.widget.widgetType){case j.SysCustomWidgetType.Label:case j.SysCustomWidgetType.Input:case j.SysCustomWidgetType.NumberInput:case j.SysCustomWidgetType.Slider:case j.SysCustomWidgetType.Date:case j.SysCustomWidgetType.RichEditor:case j.SysCustomWidgetType.Radio:case j.SysCustomWidgetType.CheckBox:case j.SysCustomWidgetType.Select:case j.SysCustomWidgetType.Cascader:case j.SysCustomWidgetType.UserSelect:case j.SysCustomWidgetType.DeptSelect:case j.SysCustomWidgetType.DictSelect:case j.SysCustomWidgetType.DataSelect:{let e=t.value?Array.isArray(t.value)?t.value.join(","):t.value:a().isEdit?"XXXXXXXXXX":void 0;if(!a().isEdit&&t.widget&&t.widget.column&&"Date"===t.widget.column.objectFieldType){let a=t.widget.props.dateType||t.widget.props.type||"YYYY-MM-DD HH:mm:ss";switch(a){case"date":case"daterange":case"week":a="YYYY-MM-DD";break;case"month":case"monthrange":a="YYYY-MM";break;case"year":a="YYYY";break;case"datetime":case"datetimerange":a="YYYY-MM-DD HH:mm:ss";break;default:break}e=e?(0,G.Yq)(e,a):""}return e}case j.SysCustomWidgetType.NumberRange:case j.SysCustomWidgetType.DateRange:return Array.isArray(t.value)&&t.value.length>1?t.value[0]+" 至 "+t.value[1]:a().isEdit?"XXXXX 至 XXXXX":void 0;case j.SysCustomWidgetType.Switch:return"boolean"===typeof t.value?t.value?"是":"否":t.value;default:return""}});return(e,a)=>((0,n.uX)(),(0,n.CE)("div",H,[(0,r.R1)(l)?((0,n.uX)(),(0,n.CE)("span",{key:0,class:(0,s.C4)({"auto-wrap":!!t.widget.props.autoWrap})},(0,s.v_)((0,r.R1)(o)),3)):(0,n.Q3)("",!0),(0,r.R1)(i)?((0,n.uX)(),(0,n.CE)("div",{key:1,class:(0,s.C4)({"auto-wrap":!!t.widget.props.autoWrap}),innerHTML:(0,r.R1)(o)},null,10,J)):(0,n.Q3)("",!0)]))}});const $=(0,F.A)(q,[["__scopeId","data-v-1eb66926"]]);var Z=$,ee=a(692),te=a(42587),ae=(a(18237),a(89277)),le=a(31932),ie=a(13180),oe=a(18384),ne=a(82572);const re={class:"online-custom-upload"};var se=(0,n.pM)({__name:"OnlineCustomUpload",props:{value:{},widget:{},readOnly:{type:Boolean,default:!1}},emits:["update:value","update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,i=(0,n.WQ)("form",()=>({isEdit:!1})),{downloadFile:o}=((0,ne.l5)(),(0,ae.m)()),{getUploadHeaders:s,getUploadActionUrl:d,parseUploadData:u,fileListToJson:p}=(0,le.v)(),c=(0,n.EW)(()=>l.widget.column?l.widget.column.maxFileCount:1),m=(0,n.EW)(()=>{let e={},t=i().flowData;return t&&(t.processDefinitionKey&&(e.processDefinitionKey=t.processDefinitionKey),t.processInstanceId&&(e.processInstanceId=t.processInstanceId),t.taskId&&(e.taskId=t.taskId)),e}),g=(0,n.EW)(()=>null==l.widget.props.actionUrl||""===l.widget.props.actionUrl?l.widget.relation?d(oe.x+"/online/onlineOperation/uploadOneToManyRelation/"+(l.widget.datasource||{}).variableName):d(oe.x+"/online/onlineOperation/uploadDatasource/"+(l.widget.datasource||{}).variableName):d(l.widget.props.actionUrl)),y=(0,n.EW)(()=>null==l.widget.props.downloadUrl||""===l.widget.props.downloadUrl?l.widget.relation?oe.x+"/online/onlineOperation/downloadOneToManyRelation/"+(l.widget.datasource||{}).variableName:oe.x+"/online/onlineOperation/downloadDatasource/"+(l.widget.datasource||{}).variableName:l.widget.props.downloadUrl),f=(0,r.KR)({}),v=(0,n.EW)(()=>C?C.fileList:[]),h=(0,n.EW)(()=>{if(l.widget&&l.widget.column){if(l.widget.column.fieldKind===Y.SysOnlineFieldKind.UPLOAD_IMAGE)return".png,.jpg,.jpeg,.gif,.bmp";{let e=l.widget.column.fileType;if(null!=e&&(e=e.split(",").map(e=>Number.parseInt(e))),null==e||0===e.length)return;{let t=e.reduce((e,t)=>{switch(""!==e&&(e+=","),t){case j.EnumFileType.IMAGE:return e+".png,.jpg,.jpeg,.gif,.bmp";case j.EnumFileType.AUDIO:return e+".mp3";case j.EnumFileType.VIDEO:return e+".mp4";case j.EnumFileType.PDF:return e+".pdf";case j.EnumFileType.WORD:return e+".docx";case j.EnumFileType.EXCEL:return e+".xlsx"}},"");return t}}}}),w=(0,r.KR)(!1),C=(0,r.Kh)((0,ie.D)(l.widget.column?l.widget.column.maxFileCount:0)),b=()=>{if(i().isEdit)return!0;const e=i().formAuth&&i().formAuth()&&i().formAuth().pc?i().formAuth().pc[l.widget.variableName]:null;return!(!e||!e.disabled)||(l.widget.eventInfo&&l.widget.eventInfo[j.OnlineFormEventType.DISABLE]?l.widget.eventInfo[j.OnlineFormEventType.DISABLE](i().instanceData()):l.widget.props.disabled)},T=e=>{C.fileList=e;const t=p(e);a("update:value",t),a("update:modelValue",t),a("change",t)};return(0,n.wB)(()=>l.widget,()=>{setTimeout(()=>{let e=l.widget.bindData?.column||l.widget.column;w.value=!!e&&e.fieldKind===Y.SysOnlineFieldKind.UPLOAD_IMAGE;let t={...m.value,datasourceId:(l.widget.datasource||{}).datasourceId,asImage:w.value,fieldName:(l.widget.column||{}).columnName};(l.widget.relation||{}).relationId&&(t.relationId=(l.widget.relation||{}).relationId);let a=i().flowData;a&&a.processDefinitionKey&&(t.processDefinitionKey=a.processDefinitionKey),f.value=t},30)},{deep:!0,immediate:!0}),(0,n.wB)(()=>l.value,e=>{C.fileList=[],setTimeout(()=>{if(null!=e&&""!==e){let t={...m.value,datasourceId:(l.widget.datasource||{}).datasourceId,fieldName:l.widget.column.columnName,asImage:w.value,dataId:i().getPrimaryData(l.widget)||""};l.widget.relation&&(t.relationId=l.widget.relation.relationId);let a=JSON.parse(e);a=Array.isArray(a)?a.map(e=>({...e,downloadUri:y.value})):[],C.fileList=u(JSON.stringify(a),t)}else C.fileList=[]},30)},{deep:!0,immediate:!0}),(e,t)=>{const a=te.A,l=ee.A;return(0,n.uX)(),(0,n.CE)("div",re,[e.readOnly?((0,n.uX)(),(0,n.Wv)(l,{key:1,supportPreview:!0,supportDownload:!0,"file-list":(0,r.R1)(v),type:"card",supportAdd:!1},null,8,["file-list"])):((0,n.uX)(),(0,n.Wv)(a,{key:0,type:(0,r.R1)(w)?"expand":"dropdown",name:e.widget.props.fileFieldName,headers:(0,r.R1)(s),action:(0,r.R1)(g),data:(0,r.R1)(f),modelValue:(0,r.R1)(v),limit:(0,r.R1)(c),accept:(0,r.R1)(h),disabled:b(),onChange:T,onInput:t[0]||(t[0]=(0,S.D$)(()=>{},["stop"]))},null,8,["type","name","headers","action","data","modelValue","limit","accept","disabled"]))])}}});const de=se;var ue=de,pe=a(50942),ce=(a(8696),a(65451));a(63390);const me={class:"text"};var ge=(0,n.pM)({__name:"OnlineCustomTree",props:{value:{},widget:{},multiple:{type:Boolean,default:!1},dataList:{default:()=>[]},filter:{}},emits:["update:value","change"],setup(e,{emit:t}){const a=e,l=(0,r.KR)(),i=(0,n.WQ)("form",()=>(console.error("OnlineCustomTree: form not injected"),{isEdit:!1})),o=(0,n.EW)(()=>i().filter),d=(0,n.EW)(()=>{let e=(a.dataList||[]).filter(e=>(e.children=null,null==o.value||null==o.value.name||-1!==e.name.indexOf(o.value.name))),t=(0,G.BN)(e,"id","parentId");return a.multiple?t:[{id:"",name:"全部"},...t]}),u=()=>{i().isEdit||a.multiple||m()},p=t,c=()=>{let e=a.value;l.value&&(e=a.multiple?l.value.getCheckedKeys():l.value.getCurrentKey()),p("update:value",e);let t=a.multiple?null:(0,G.PH)(a.dataList,e,"id");p("change",e,t)},m=()=>{(0,n.dY)(()=>{c()})},g=()=>{l.value&&(a.multiple?l.value.setCheckedKeys(a.value||[]):l.value.setCurrentKey(a.value))};return(0,n.wB)(()=>a.value,()=>{g()},{immediate:!0}),(0,n.wB)(()=>a.dataList,()=>{setTimeout(()=>{g()},50)},{immediate:!0}),(e,t)=>{const a=ce.S2,i=pe.qk;return(0,n.uX)(),(0,n.Wv)(i,{class:"online-custom-tree",ref_key:"tree",ref:l,data:d.value,"node-key":"id","show-checkbox":e.multiple,"highlight-current":!0,"default-expand-all":!0,"auto-expand-parent":!0,"expand-on-click-node":!1,onCheckChange:m,onNodeClick:u},{default:(0,n.k6)(({data:e})=>[(0,n.bF)(a,{class:"node-item",justify:"space-between",align:"middle"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",me,(0,s.v_)(e.name),1)]),_:2},1024)]),_:1},8,["data","show-checkbox"])}}});const ye=(0,F.A)(ge,[["__scopeId","data-v-548726ae"]]);var fe=ye,ve=a(38840),he=(a(95304),a(44114),a(22212)),we=a(82563),Ce=a(38885),be=a(40623),Te=a(74016),ke=a(89536),Ee=a(39922),Re=a(75095),Se=a(28705);const De=[96,86,73,68,82,92,62,82],Ie=De,Ae=De,We=[{value:1048,name:"Search Engine"},{value:735,name:"Direct"},{value:580,name:"Email"},{value:484,name:"Union Ads"},{value:300,name:"Video Ads"}],Le=De,xe=De,_e=[{name:"华为手机",value:[80,90,80,82,90]},{name:"中兴手机",value:[70,82,75,70,78]}];var Fe=a(86449),Ne=(0,n.pM)({__name:"lineChart",props:{data:{default:()=>[]},value:{},options:{},categrayColumnList:{default:()=>[]},valueColumnList:{default:()=>[]},callback:{default:()=>({})}},emits:["click","update:data","change","dblclick"],setup(e,{expose:t,emit:a}){const l={grid:{...(0,Fe.qO)()},title:{...(0,Fe.gs)()},legend:{...(0,Fe.Ji)()},label:{...(0,Fe.iJ)()},tooltip:{...(0,Fe.n_)()},xAxis:{...(0,Fe.TL)()},yAxis:{...(0,Fe._f)()}},i={...(0,Fe.M2)()};he.Y([Ce.a,be.a,Te.a,ke.a,Ee.a,Re.a]);const o=e,s=(0,r.KR)();let d=null,u=null,p=null;const c=(0,n.EW)(()=>{let e=[];return Array.isArray(o.categrayColumnList)&&Array.isArray(o.data)&&(e=o.data.map(e=>{let t=null;if(o.callback&&"function"===typeof o.callback.buildCategrayColumnLabel&&(t=o.callback.buildCategrayColumnLabel(e,o.categrayColumnList)),null==t){let a="";for(const t of o.categrayColumnList)t&&t.columnName&&(null!=a?a+="\r\n":a="",a+=(0,Se.JY)(e,t.columnName));t=a}return t})),e}),m=(0,n.EW)(()=>Array.isArray(o.valueColumnList)?o.valueColumnList.map(e=>e.name):[]),g=(0,n.EW)(()=>{let e=[];return Array.isArray(o.valueColumnList)&&Array.isArray(o.data)&&(e=o.valueColumnList.map((e,t)=>{let a=o.data.map(t=>(0,Se.JY)(t,e.columnName,e.fixed));return{name:m.value[t],...i,...o.options?.series,data:a,stack:o.options?.series.stack?"D":void 0,areaStyle:o.options?.series.areaStyle?{}:void 0}})),e.length>0?e:[{name:"test",...i,...o.options?.series,data:Ie,stack:o.options?.series.stack?"D":void 0,areaStyle:o.options?.series.areaStyle?{}:void 0}]}),y=(0,n.EW)(()=>{let e={...l,...o.options?.basic,series:g.value};return e.legend.data=m.value,e.xAxis.data=c.value,e}),f=a,v=()=>{f("click")},h=()=>{if(null!=d){0===o.data.length&&d.clear();const e=(0,Fe.rP)(y.value);console.log("lineChart options",e),d.setOption(e,!0),d.resize()}},w=()=>{null!=d&&d.resize()},C=e=>{let t=o.data[e.dataIndex];o.value===t&&(t=null),f("update:data",t),f("change",t),f("serie-click",t),u=e.dataIndex,p=e.seriesIndex},b=e=>{let t=o.data[e.dataIndex];f("dblclick",t)};return t({resize:w}),(0,n.wB)(()=>y.value,()=>{h()},{immediate:!0}),(0,n.sV)(()=>{d=we.Ts(s.value),d.on("click","series",C),d.on("dblclick","series",b),h()}),(0,n.KC)(()=>{null!=d&&(d.dispose(),d=null)}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{onClick:(0,S.D$)(v,["stop"]),ref_key:"container",ref:s},null,512))}});const Oe=Ne;var Be=Oe,Me=a(60468),Xe=a(73053),Ve=a(44582),Pe=a(3757),Ue=(0,n.pM)({__name:"barChart",props:{data:{default:()=>[]},value:{},options:{},categrayColumnList:{default:()=>[]},valueColumnList:{default:()=>[]},callback:{default:()=>({})}},emits:["click","update:data","change","dblclick"],setup(e,{expose:t,emit:a}){const l={grid:{...(0,Fe.qO)()},title:{...(0,Fe.gs)()},legend:{...(0,Fe.Ji)()},label:{...(0,Fe.iJ)()},tooltip:{...(0,Fe.n_)()},xAxis:{...(0,Fe.TL)()},yAxis:{...(0,Fe._f)()}},i={...(0,Fe.n1)()};he.Y([be.a,Me.a,ke.a,Ce.a,Te.a,Xe.a,Ve.a,Pe.a,Re.a]);const o=e;console.log("barChart props",o);const s=(0,r.KR)();let d=null,u=null,p=null;const c=(0,n.EW)(()=>{let e=[];return Array.isArray(o.categrayColumnList)&&Array.isArray(o.data)&&(e=o.data.map(e=>{let t=null;if(o.callback&&"function"===typeof o.callback.buildCategrayColumnLabel&&(t=o.callback.buildCategrayColumnLabel(e,o.categrayColumnList)),console.log("barChart categrayLabelName 1",t),null==t){let a="";for(const t of o.categrayColumnList)t&&t.columnName&&(null!=a?a+="\r\n":a="",a+=(0,Se.JY)(e,t.columnName));t=a,console.log("barChart categrayLabelName 2",t)}return t})),console.log("barChart categrayColumnData",e),e}),m=(0,n.EW)(()=>Array.isArray(o.valueColumnList)?o.valueColumnList.map(e=>e.name):[]),g=(0,n.EW)(()=>{let e=[];return Array.isArray(o.valueColumnList)&&Array.isArray(o.data)&&(e=o.valueColumnList.map((e,t)=>{let a=o.data.map(t=>(0,Se.JY)(t,e.columnName,e.fixed));return{name:m.value[t],...i,...o.options?.series,data:a,stack:o.options?.series.stack?"D":void 0,lateral:void 0}})),e.length>0?e:[{name:"test",...i,...o.options?.series,data:Ae,stack:o.options?.series.stack?"D":void 0,lateral:void 0}]}),y=(0,n.EW)(()=>{let e={...l,...o.options?.basic,series:g.value};if(e.legend.data=m.value,e.xAxis.data=c.value,o.options?.series.lateral){let t=e.xAxis,a=e.yAxis;e.xAxis=a,e.yAxis=t}return e}),f=a,v=()=>{f("click")},h=()=>{let e=(0,Fe.rP)(y.value);console.log("barChart options 1",e),null!=d&&(0===o.data.length&&d.clear(),d.setOption(e,!0),d.resize())},w=()=>{null!=d&&d.resize()},C=e=>{let t=o.data[e.dataIndex];o.value===t&&(t=null),f("update:data",t),f("change",t),f("serie-click",t),u=e.dataIndex,p=e.seriesIndex},b=e=>{let t=o.data[e.dataIndex];f("dblclick",t)};return t({resize:w}),(0,n.wB)(()=>y.value,()=>{h()},{immediate:!0}),(0,n.sV)(()=>{d=we.Ts(s.value),d.on("click","series",C),d.on("dblclick","series",b),h()}),(0,n.KC)(()=>{null!=d&&(d.dispose(),d=null)}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{onClick:(0,S.D$)(v,["stop"]),ref_key:"container",ref:s},null,512))}});const Ke=Ue;var ze=Ke,Qe=a(64193),Ge=(a(35132),a(14204),a(76408));a(87535);const Ye={class:"carousel-item-wrapper"},je=["src"],He={key:0,class:"carousel-item-text"};var Je=(0,n.pM)({__name:"carouselChart",props:{data:{},height:{},options:{},imagePath:{},imageName:{}},emits:["click"],setup(e,{emit:t}){const a=e,l=(0,r.KR)(!1);let i=null;const o=(0,r.KR)(),d=(0,n.EW)(()=>{if(console.log("title >>>",a.options),a.options&&null!=a.options.title&&a.options.title.show)return a.options.title.text}),u=(0,n.EW)(()=>{if(a.options&&null!=a.options.title)return{color:a.options.title.textStyle.color,"font-size":a.options.title.textStyle.fontSize+"px","font-weight":a.options.title.bold?600:void 0,"text-align":a.options.title.left,"font-style":a.options.title.italics?"italic":void 0}}),p=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options.basicInfo)return{color:a.options.basicInfo.cellFontColor,lineHeight:(a.options.basicInfo.cellRowHeight||30)+"px",height:(a.options.basicInfo.cellRowMaxHeight||30)+"px","background-color":a.options.basicInfo.cellBackgroundColor,"font-size":a.options.basicInfo.cellFontSize+"px",padding:"0px 5px",boxSizing:"border-box","text-align":a.options.basicInfo.cellAlign}}),c=(0,n.EW)(()=>Array.isArray(a.data)?a.data.length<a.options.pageParam.pageSize?a.data.length:a.options.pageParam.pageSize:1),m=(e,t)=>{if(null!=e){if(Array.isArray(t)){let a=t.length>0?e:void 0;for(let e=0;e<t.length;e++){let l=t[e];if(null==l||null==a){a=void 0;break}let i=l+"__DictMap";a=a[i]?a[i].name:a[l]}return a}{let a=t,l=a+"__DictMap";return e[l]?e[l].name:e[a]}}},g=(e,t)=>{if(t&&t.length>0)return m(e,t[0].columnName)},y=(0,n.EW)(()=>{let e=[];return Array.isArray(a.data)?(a.data.filter((t,l)=>{l<c.value&&e.push({url:g(t,a.imagePath),description:g(t,a.imageName)})}),e):(e.push({url:g(a.data,a.imagePath),description:g(a.data,a.imageName)}),e)}),f=t,v=()=>{f("click")},h=()=>{o.value=a.height};(0,n.wB)(()=>a.height,()=>{(0,n.dY)(()=>{h()})},{immediate:!0});const w=()=>{null!=i&&clearTimeout(i),l.value=!1,i=setTimeout(()=>{i=null,l.value=!0},50)};return(0,n.wB)(()=>a.data,()=>{(0,n.dY)(()=>{w()})},{immediate:!0}),(0,n.wB)(()=>a.options,()=>{(0,n.dY)(()=>{w()})},{deep:!0,immediate:!0}),(e,t)=>{const a=Ge.uD,i=Qe.vJ,c=Qe.eP,m=ce.S2;return(0,n.uX)(),(0,n.Wv)(m,{class:"carousel-chart",onClick:(0,S.D$)(v,["stop"]),style:{background:"white"}},{default:(0,n.k6)(()=>[null!=(0,r.R1)(d)&&""!==(0,r.R1)(d)?((0,n.uX)(),(0,n.Wv)(a,{key:0,ref:"titleRef",class:"title",span:24,style:(0,s.Tr)((0,r.R1)(u))},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)((0,r.R1)(d)),1)]),_:1},8,["style"])):(0,n.Q3)("",!0),(0,n.bo)((0,n.bF)(a,{class:"table",span:24},{default:(0,n.k6)(()=>[(0,n.bF)(c,{"indicator-position":e.options&&e.options.basicInfo.indicatorPosition,height:(0,r.R1)(o)},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,r.R1)(y),(t,a)=>((0,n.uX)(),(0,n.Wv)(i,{key:a},{default:(0,n.k6)(()=>[(0,n.Lk)("div",Ye,[(0,n.Lk)("img",{class:"carousel-item-image",src:t.url,style:(0,s.Tr)({"object-fit":e.options&&e.options.basicInfo.objectFit})},null,12,je),t.description?((0,n.uX)(),(0,n.CE)("div",He,[(0,n.Lk)("div",{style:(0,s.Tr)((0,r.R1)(p))},(0,s.v_)(t.description),5)])):(0,n.Q3)("",!0)])]),_:2},1024))),128))]),_:1},8,["indicator-position","height"])]),_:1},512),[[S.aG,(0,r.R1)(l)]])]),_:1})}}});const qe=(0,F.A)(Je,[["__scopeId","data-v-d857e5dc"]]);var $e=qe,Ze=a(86575),et=(0,n.pM)({__name:"scatterChart",props:{data:{default:()=>[]},value:{},options:{},categrayColumnList:{default:()=>[]},valueColumnList:{default:()=>[]},callback:{default:()=>({})}},emits:["click","update:data","change","dblclick","cell-click"],setup(e,{expose:t,emit:a}){const l={grid:{...(0,Fe.qO)()},title:{...(0,Fe.gs)()},legend:{...(0,Fe.Ji)()},label:{...(0,Fe.iJ)()},tooltip:{...(0,Fe.n_)()},xAxis:{...(0,Fe.TL)()},yAxis:{...(0,Fe._f)()}},i={...(0,Fe.E)()};he.Y(Ze.a);const o=e,s=(0,r.KR)();let d=null,u=null,p=null;const c=(0,n.EW)(()=>{let e=[];return Array.isArray(o.categrayColumnList)&&Array.isArray(o.data)&&(e=o.data.map(e=>{let t=null;if(o.callback&&"function"===typeof o.callback.buildCategrayColumnLabel&&(t=o.callback.buildCategrayColumnLabel(e,o.categrayColumnList)),null==t){let a="";for(const t of o.categrayColumnList)t&&t.columnName&&(null!=a?a+="\r\n":a="",a+=(0,Se.JY)(e,t.columnName));t=a}return t})),e}),m=(0,n.EW)(()=>Array.isArray(o.valueColumnList)?o.valueColumnList.map(e=>e.name):[]),g=(0,n.EW)(()=>{let e=[];return Array.isArray(o.valueColumnList)&&Array.isArray(o.data)&&(e=o.valueColumnList.map((e,t)=>{let a=c.value.map((t,a)=>{let l=(0,Se.JY)(o.data[a],e.columnName,e.fixed),i=o.options?.series.itemSize;return o.options?.series.symbolType===j.ScatterSymbolType.VALUE&&(i=l),[t,l,i]});return{name:m.value[t],...i,...o.options?.series,symbolSize:o.options?.series.itemSize,data:a}})),e.length>0?e:[{name:"test",...i,...o.options?.series,symbolSize:o.options?.series.itemSize,data:Le}]}),y=(0,n.EW)(()=>{let e={...l,...o.options?.basic,series:g.value};return e.legend.data=m.value,e.xAxis.data=c.value,e}),f=a,v=()=>{f("click")},h=()=>{if(null!=d){0===o.data.length&&d.clear();const e=(0,Fe.rP)(y.value);d.setOption(e,!0),d.resize()}},w=()=>{null!=d&&d.resize()},C=e=>{let t=o.data[e.dataIndex];o.value===t&&(t=null),f("update:data",t),f("change",t),f("cell-click",t),u=e.dataIndex,p=e.seriesIndex},b=e=>{let t=o.data[e.dataIndex];f("dblclick",t)};return t({resize:w}),(0,n.wB)(()=>y.value,()=>{h()},{immediate:!0}),(0,n.sV)(()=>{d=we.Ts(s.value),d.on("click","series",C),d.on("dblclick","series",b),h()}),(0,n.KC)(()=>{null!=d&&(d.dispose(),d=null)}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{onClick:(0,S.D$)(v,["stop"]),ref_key:"container",ref:s},null,512))}});const tt=et;var at=tt,lt=a(12751),it=(a(82654),a(4311));a(25393);const ot={class:"data-card-footer"},nt=["innerHTML"];var rt=(0,n.pM)({__name:"dataProgressCard",props:{data:{},options:{}},emits:["click","update:data","change","dblclick"],setup(e,{emit:t}){const a=e,l=e=>a.options&&a.options.datasetInfo[e]&&Array.isArray(a.options.datasetInfo[e])&&a.options.datasetInfo[e].length>0?a.options.datasetInfo[e][0].columnName:void 0,i=(e,t,a)=>{let i;if(i="string"===typeof e?l(e):e.columnName,!i)return t;const o=(0,Se.oG)(a||d.value,i);return o||t},o=(e,t=null)=>{let a=i(e,"0",t);return"string"===typeof a?isNaN(Number(a))?0:Number(a):a},d=(0,n.EW)(()=>Array.isArray(a.data)?a.data[0]:a.data),u=(0,n.EW)(()=>h("mainTextStyle")),p=(0,n.EW)(()=>h("numTextStyle")),c=(0,n.EW)(()=>({color:a.options?.seriesSetting.progress.textStyle.color,width:a.options?.seriesSetting.progress.textStyle.width+"px","font-size":a.options?.seriesSetting.progress.textStyle.fontSize+"px","font-weight":a.options?.seriesSetting.progress.textStyle.bold?600:void 0,"font-style":a.options?.seriesSetting.progress.textStyle.italics?"italic":void 0})),m=(0,n.EW)(()=>a.options&&l("progressColumn")?100*Number((o("progressColumn")/a.options.seriesSetting.progress.maxValue).toFixed(2)):0),g=(0,n.EW)(()=>({height:a.options?.seriesSetting.iconSize+"px",width:a.options?.seriesSetting.iconSize+"px",borderRadius:a.options?.seriesSetting.iconRadius+"px"})),y=t,f=()=>{y("click")},v=()=>{y("dblclick",d.value)},h=e=>({...a.options?.seriesSetting[e],fontStyle:a.options?.seriesSetting[e].italics?"italic":void 0,fontWeight:a.options?.seriesSetting[e].bold?"bold":void 0,fontSize:a.options?.seriesSetting[e].fontSize+"px"}),w=e=>a.options?.seriesSetting.progress.textInside?a.options.seriesSetting.progress.textStyle.text.replace("{percent}",e):"",C=e=>a.options?.seriesSetting.progress.textStyle.text.replace(/\{percent\}/gi,e);return(0,n.wB)(()=>a,()=>{console.log("<><><> props",a,"data",a.data)},{deep:!0}),(e,t)=>{const a=it.Zq,l=lt.ve;return(0,n.uX)(),(0,n.CE)("div",{class:"data-card-progress",onClick:(0,S.D$)(f,["stop"]),onDblclick:v,style:{background:"white"}},[e.options?.seriesSetting.icon?((0,n.uX)(),(0,n.Wv)(a,{key:0,class:"data-card-image",src:e.options.seriesSetting.icon,style:(0,s.Tr)((0,r.R1)(g))},null,8,["src","style"])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:"data-card-title",style:(0,s.Tr)((0,r.R1)(u))},(0,s.v_)(i("mainTextColumn","卡片标题")),5),(0,n.Lk)("div",{class:"data-card-number",style:(0,s.Tr)((0,r.R1)(p))},(0,s.v_)(i("numTextColumn")),5),(0,n.Lk)("div",ot,[(0,n.bF)(l,{type:"line",style:{"flex-grow":"1"},percentage:(0,r.R1)(m),"define-back-color":e.options?.seriesSetting.progress.defineBackColor,"stroke-width":e.options?.seriesSetting.progress.strokeWidth,"show-text":e.options?.seriesSetting.progress.showText,"text-inside":!0,"text-color":e.options?.seriesSetting.progress.textStyle.color,color:e.options?.seriesSetting.progress.color,format:w},null,8,["percentage","define-back-color","stroke-width","show-text","text-color","color"]),e.options?.seriesSetting.progress.textInside?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",{key:0,class:"progress-text",style:(0,s.Tr)((0,r.R1)(c))},[(0,n.Lk)("div",{class:"text",innerHTML:C((0,r.R1)(m))},null,8,nt)],4))])],32)}}});const st=(0,F.A)(rt,[["__scopeId","data-v-271902ee"]]);var dt=st;const ut=["onDblclick"],pt={class:"common-list-item-wrapper"},ct={key:0,class:"item-icon"},mt={key:1,width:"14",height:"14"},gt=["stroke"];var yt=(0,n.pM)({__name:"commonList",props:{data:{},options:{}},emits:["click","dblclick"],setup(e,{emit:t}){const a=e,l=t,i=()=>{l("click")},o=e=>{l("dblclick",e)},d=(0,n.EW)(()=>Array.isArray(a.data)?a.data[0]:a.data),u=e=>({...a.options?.seriesSetting[e],fontStyle:a.options?.seriesSetting[e].italics?"italic":void 0,fontWeight:a.options?.seriesSetting[e].bold?"bold":"normal",fontSize:a.options?.seriesSetting[e].fontSize+"px"}),p=e=>a.options&&a.options.datasetInfo[e]&&Array.isArray(a.options.datasetInfo[e])&&a.options.datasetInfo[e].length>0?a.options.datasetInfo[e][0].columnName:void 0,c=(e,t,a)=>{let l;if(l="string"===typeof e?p(e):e.columnName,!l)return t;let i=(0,Se.oG)(a||d.value,l);return i||t},m=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options?.title&&a.options?.title.show)return a.options?a.options?.title.text:void 0}),g=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options?.title)return{color:a.options?.title.textStyle.color,"font-size":a.options?.title.textStyle.fontSize+"px","font-weight":a.options?.title.bold?600:void 0,"text-align":a.options?.title.left,"font-style":a.options?.title.italics?"italic":void 0}}),y=(0,n.EW)(()=>u("titleStyle")),f=(0,n.EW)(()=>({...u("textStyle"),paddingLeft:a.options?.seriesSetting.listIcon?"20px":"0px"})),v=(0,n.EW)(()=>u("timeStyle")),h=(0,n.EW)(()=>a.data&&Array.isArray(a.data)?a.data:a.data&&!Array.isArray(a.data)?[a.data]:[]);return(e,t)=>{const a=Ge.uD,l=ce.S2;return(0,n.uX)(),(0,n.Wv)(l,{class:"common-list",onClick:(0,S.D$)(i,["stop"]),style:{background:"white"}},{default:(0,n.k6)(()=>[null!=(0,r.R1)(m)&&""!==(0,r.R1)(m)?((0,n.uX)(),(0,n.Wv)(a,{key:0,ref_key:"title",ref:m,class:"title",span:24,style:(0,s.Tr)((0,r.R1)(g))},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)((0,r.R1)(m)),1)]),_:1},8,["style"])):(0,n.Q3)("",!0),(0,n.bF)(a,{class:"common-list-container",span:24},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,r.R1)(h),(t,a)=>((0,n.uX)(),(0,n.CE)("div",{class:"common-list-item",key:a,onDblclick:e=>o(t)},[(0,n.Lk)("div",pt,[e.options?.seriesSetting.listIcon?((0,n.uX)(),(0,n.CE)("div",ct,["digit"===e.options.seriesSetting.listIcon?((0,n.uX)(),(0,n.CE)("span",{key:0,style:(0,s.Tr)({color:e.options.seriesSetting.listIconColor})},(0,s.v_)(a+1),5)):(0,n.Q3)("",!0),"circle"===e.options.seriesSetting.listIcon?((0,n.uX)(),(0,n.CE)("svg",mt,[(0,n.Lk)("circle",{cx:"7",cy:"7",r:"3.5",fill:"none",stroke:e.options.seriesSetting.listIconColor,"stroke-width":"2"},null,8,gt)])):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:"item-title",style:(0,s.Tr)((0,r.R1)(y))},(0,s.v_)(c((0,r.R1)(Se.Uo)("titleColumn"),"标题",t)),5),c((0,r.R1)(Se.Uo)("timeColumn"),"",t)?((0,n.uX)(),(0,n.CE)("div",{key:1,class:"item-date",style:(0,s.Tr)((0,r.R1)(v))},(0,s.v_)(c((0,r.R1)(Se.Uo)("timeColumn"),"",t)),5)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",{class:"item-content",style:(0,s.Tr)((0,r.R1)(f))},(0,s.v_)(c((0,r.R1)(Se.Uo)("textColumn"),"内容",t)),5)],40,ut))),128))]),_:1})]),_:1})}}});const ft=(0,F.A)(yt,[["__scopeId","data-v-644886e4"]]);var vt=ft;const ht={key:1,class:"data-card-footer"};var wt=(0,n.pM)({__name:"dataCard",props:{data:{},options:{}},emits:["click","dblclick"],setup(e,{emit:t}){const a=e,l=t,i=e=>a.options&&a.options.datasetInfo[e]&&Array.isArray(a.options.datasetInfo[e])&&a.options.datasetInfo[e].length>0?a.options.datasetInfo[e][0].columnName:void 0,o=(e,t,a)=>{let l;if(l="string"===typeof e?i(e):e.columnName,!l)return t;let o=(0,Se.oG)(a||p.value,l);return o||t},d=()=>{l("click")},u=()=>{l("dblclick",p.value)},p=(0,n.EW)(()=>Array.isArray(a.data)?a.data[0]:a.data),c=e=>({...a.options?.seriesSetting[e],fontStyle:a.options?.seriesSetting[e].italics?"italic":void 0,fontWeight:a.options?.seriesSetting[e].bold?"bold":void 0,fontSize:a.options?.seriesSetting[e].fontSize+"px"}),m=(0,n.EW)(()=>a.options?.datasetInfo.footTextColumn&&a.options?.datasetInfo.footTextColumn.length>0),g=(0,n.EW)(()=>a.options?.datasetInfo.footNumTextColumn&&a.options?.datasetInfo.footNumTextColumn.length>0),y=(0,n.EW)(()=>c("mainTextStyle")),f=(0,n.EW)(()=>c("numTextStyle")),v=(0,n.EW)(()=>c("footTextStyle")),h=(0,n.EW)(()=>({...c("footNumTextStyle"),color:w.value===D.TopRight?"#00A241":"#EF502F"})),w=(0,n.EW)(()=>isNaN(C.value)?"":C.value>=0?D.TopRight:D.BottomLeft),C=(0,n.EW)(()=>{let e=o("footNumTextColumn","",p.value);return isNaN(e)?e:Number(e)}),b=(0,n.EW)(()=>isNaN(C.value)?C.value:Math.abs(C.value)),T=(0,n.EW)(()=>({height:a.options?.seriesSetting.iconSize+"px",width:a.options?.seriesSetting.iconSize+"px",borderRadius:a.options?.seriesSetting.iconRadius+"px"}));return(e,t)=>{const a=it.Zq,l=R.tk;return(0,n.uX)(),(0,n.CE)("div",{class:"data-card",onClick:(0,S.D$)(d,["stop"]),onDblclick:u,style:{background:"white"}},[e.options?.seriesSetting.icon?((0,n.uX)(),(0,n.Wv)(a,{key:0,class:"data-card-image",src:e.options.seriesSetting.icon,style:(0,s.Tr)((0,r.R1)(T))},null,8,["src","style"])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:"data-card-title",style:(0,s.Tr)((0,r.R1)(y))},(0,s.v_)(o("mainTextColumn","卡片标题",(0,r.R1)(p))),5),(0,n.Lk)("div",{class:"data-card-number",style:(0,s.Tr)((0,r.R1)(f))},(0,s.v_)(o("numTextColumn","",(0,r.R1)(p))),5),(0,r.R1)(m)||(0,r.R1)(g)?((0,n.uX)(),(0,n.CE)("div",ht,[(0,r.R1)(m)?((0,n.uX)(),(0,n.CE)("span",{key:0,style:(0,s.Tr)((0,r.R1)(v))},(0,s.v_)(o("footTextColumn","",(0,r.R1)(p))),5)):(0,n.Q3)("",!0),(0,r.R1)(g)?((0,n.uX)(),(0,n.CE)("span",{key:1,style:(0,s.Tr)((0,r.R1)(h))},[""!==(0,r.R1)(w)?((0,n.uX)(),(0,n.Wv)(l,{key:0},{default:(0,n.k6)(()=>[((0,n.uX)(),(0,n.Wv)((0,n.$y)((0,r.R1)(w))))]),_:1})):(0,n.Q3)("",!0),(0,n.eW)(" "+(0,s.v_)((0,r.R1)(b)),1)],4)):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)],32)}}});const Ct=(0,F.A)(wt,[["__scopeId","data-v-05c1086a"]]);var bt=Ct;const Tt=["innerHTML"];var kt=(0,n.pM)({__name:"progressCircle",props:{data:{},options:{}},emits:["click","update:data","change","dblclick"],setup(e,{emit:t}){const a=e,l=(0,n.EW)(()=>{if(a.options&&a.options.title&&a.options.title.show)return a.options?a.options.title.text:void 0}),i=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options.title)return{color:a.options.title.textStyle.color,"font-size":a.options.title.textStyle.fontSize+"px","font-weight":a.options.title.bold?600:void 0,"text-align":a.options.title.left,"font-style":a.options.title.italics?"italic":void 0}}),o=(0,n.EW)(()=>a.options?.seriesSetting.textStyle.text.replace("{percent}",g.value)),d=(0,n.EW)(()=>a.options?{...a.options.seriesSetting.textStyle,fontStyle:a.options.seriesSetting.textStyle.italics?"italic":void 0,fontWeight:a.options.seriesSetting.textStyle.bold?"bold":void 0,fontSize:a.options.seriesSetting.textStyle.fontSize+"px"}:{}),u=(0,n.EW)(()=>Array.isArray(a.data)?a.data[0]:a.data),p=e=>a.options&&a.options.datasetInfo[e]&&Array.isArray(a.options.datasetInfo[e])&&a.options.datasetInfo[e].length>0?a.options.datasetInfo[e][0].columnName:void 0,c=(e,t,a)=>{let l;if(l="string"===typeof e?p(e):e.columnName,!l)return t;let i=(0,Se.oG)(a||u.value,l);return i||t},m=(e,t=null)=>{let a=c(e,"0",t);return"string"===typeof a?isNaN(Number(a))?0:Number(a):a},g=(0,n.EW)(()=>p("progressColumn")&&a.options?100*Number((m("progressColumn")/a.options.seriesSetting.maxValue).toFixed(2)):0),y=t,f=()=>{y("click")},v=()=>{y("dblclick",u.value)};return(e,t)=>{const a=Ge.uD,u=lt.ve,p=ce.S2;return(0,n.uX)(),(0,n.Wv)(p,{class:"progress-circle",onClick:(0,S.D$)(f,["stop"]),style:{background:"white"}},{default:(0,n.k6)(()=>[null!=(0,r.R1)(l)&&""!==(0,r.R1)(l)?((0,n.uX)(),(0,n.Wv)(a,{key:0,ref_key:"title",ref:l,class:"title",span:24,style:(0,s.Tr)((0,r.R1)(i))},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)((0,r.R1)(l)),1)]),_:1},8,["style"])):(0,n.Q3)("",!0),(0,n.bF)(a,{class:"progress-circle-container",span:24},{default:(0,n.k6)(()=>[(0,n.Lk)("div",{class:"progress-circle-wrapper",onDblclick:v},[(0,n.bF)(u,{type:"circle",percentage:(0,r.R1)(g),"stroke-linecap":e.options?.seriesSetting.strokeLinecap,"define-back-color":e.options?.seriesSetting.defineBackColor,"stroke-width":e.options?.seriesSetting.strokeWidth,width:e.options?.seriesSetting.width,"show-text":!1,color:e.options?.seriesSetting.color},null,8,["percentage","stroke-linecap","define-back-color","stroke-width","width","color"]),(0,n.Lk)("div",{class:"progress-text",style:(0,s.Tr)((0,r.R1)(d))},[(0,n.Lk)("div",{class:"text",innerHTML:(0,r.R1)(o)},null,8,Tt)],4)],32)]),_:1})]),_:1})}}});const Et=(0,F.A)(kt,[["__scopeId","data-v-e6ceb8d2"]]);var Rt=Et,St=a(92380),Dt=a(80311),It=(0,n.pM)({__name:"pieChart",props:{data:{default:()=>[]},value:{},options:{},categrayColumnList:{default:()=>[]},valueColumnList:{default:()=>[]},callback:{default:()=>({})}},emits:["click","update:data","change","dblclick"],setup(e,{expose:t,emit:a}){const l={grid:{...(0,Fe.qO)()},title:{...(0,Fe.gs)()},legend:{...(0,Fe.Ji)()},label:{...(0,Fe.iJ)()},tooltip:{...(0,Fe.n_)()}},i={...(0,Fe.al)()};he.Y(Dt.a);const o=e,s=(0,r.KR)();let d=null,u=null,p=null;const c=(0,n.EW)(()=>{let e=[];return Array.isArray(o.categrayColumnList)&&Array.isArray(o.data)&&(e=o.data.map(e=>{let t=null;if(o.callback&&"function"===typeof o.callback.buildCategrayColumnLabel&&(t=o.callback.buildCategrayColumnLabel(e,o.categrayColumnList)),null==t){let a="";for(const t of o.categrayColumnList)t&&t.columnName&&(null!=a?a+="\r\n":a="",a+=(0,Se.JY)(e,t.columnName));t=a}return t})),e}),m=(0,n.EW)(()=>{let e=[],t=["50%","50%"],a=["0%","70%"];return Array.isArray(o.valueColumnList)&&Array.isArray(o.data)&&(e=o.valueColumnList.map(e=>{let l=c.value.map((t,a)=>({value:(0,Se.JY)(o.data[a],e.columnName,e.fixed),name:t}));return null!=o.options?.series.centerX&&""!==o.options?.series.centerX&&(t[0]=o.options?.series.centerX+"%"),null!=o.options?.series.centerY&&""!==o.options?.series.centerY&&(t[1]=o.options?.series.centerY+"%"),null!=o.options?.series.radiusInner&&""!==o.options?.series.radiusInner&&(a[0]=o.options?.series.radiusInner),null!=o.options?.series.radiusOuter&&""!==o.options?.series.radiusOuter&&(a[1]=o.options?.series.radiusOuter),{...i,...o.options?.series,roseType:o.options?.series.isRose?"area":void 0,center:t,radius:a,label:o.options?.basic.label,data:l}})),e.length>0?e:[{...i,...o.options?.series,roseType:o.options?.series.isRose?"area":void 0,center:t,radius:a,label:o.options?.basic.label,data:We}]}),g=(0,n.EW)(()=>{let e={...l,...o.options?.basic,series:m.value,xAxis:void 0,yAxis:void 0,label:void 0};return e}),y=a,f=()=>{y("click")},v=()=>{if(null!=d){0===o.data.length&&d.clear();const e=(0,Fe.rP)(g.value);d.setOption(e,!0),d.resize()}},h=()=>{null!=d&&d.resize()},w=e=>{let t=o.data[e.dataIndex];o.value===t&&(t=null),y("update:data",t),y("change",t),y("serie-click",t),u=e.dataIndex,p=e.seriesIndex},C=e=>{let t=o.data[e.dataIndex];y("dblclick",t)};return t({resize:h}),(0,n.wB)(()=>g.value,()=>{v()},{immediate:!0}),(0,n.sV)(()=>{d=we.Ts(s.value),d.on("click","series",w),d.on("dblclick","series",C),v()}),(0,n.KC)(()=>{null!=d&&(d.dispose(),d=null)}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{onClick:(0,S.D$)(f,["stop"]),ref_key:"container",ref:s},null,512))}});const At=It;var Wt=At,Lt=(a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(61473)),xt=a(99540);const _t={class:"vxe-cell--label"};var Ft=(0,n.pM)({__name:"pivotTableColumn",props:{columnInfo:{}},setup(e){const t=e;console.log("pivotTableColumn props",t);const a=(0,n.EW)(()=>t.columnInfo&&t.columnInfo.isGroup?xt.xx:xt.Wq),l=(0,n.EW)(()=>{let e={...t.columnInfo};return delete e.children,console.log("pivotTable column props",e),e});return(e,t)=>(0,r.R1)(a)==(0,r.R1)(xt.Wq)?((0,n.uX)(),(0,n.Wv)((0,r.R1)(xt.Wq),(0,s._B)((0,n.v6)({key:0},(0,r.R1)(l))),{default:(0,n.k6)(e=>[(0,n.Lk)("span",_t,(0,s.v_)(e.row[(0,r.R1)(l).field]),1)]),_:1},16)):((0,n.uX)(),(0,n.Wv)((0,r.R1)(xt.xx),(0,s._B)((0,n.v6)({key:1},(0,r.R1)(l))),{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((e.columnInfo||{}).children,e=>((0,n.uX)(),(0,n.Wv)(Ot,{key:e.id,columnInfo:e},null,8,["columnInfo"]))),128))]),_:1},16))}});const Nt=Ft;var Ot=Nt;const Bt={class:"table",span:24};var Mt=(0,n.pM)({__name:"pivotTable",props:{data:{default:()=>[]},options:{},height:{},rowGroupColumnList:{default:()=>[]},columnGroupColumnList:{default:()=>[]},valueColumnList:{default:()=>[]}},emits:["click","cell-click"],setup(e,{emit:t}){const a=e,l=(0,r.KR)(),i=(0,r.KR)(!1);let o=null;const d=(0,r.KR)([]),u=(0,r.KR)([]),p=(0,r.KR)(!1),c=(0,r.KR)([]),m=(0,r.KR)();let g=new Map;const y=(0,n.EW)(()=>{if(a.options&&a.options?.title&&a.options?.title.show)return a.options?a.options?.title.text:void 0}),f=(0,n.EW)(()=>({height:a.options?.cellRowHeight,isHover:!0})),v=(0,n.EW)(()=>({border:"1px solid "+a.options?.borderColor,"border-bottom":"none"})),h=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options?.title)return{color:a.options?.title.textStyle.color,"font-size":a.options?.title.textStyle.fontSize+"px","font-weight":a.options?.title.bold?600:void 0,"text-align":a.options?.title.left,"font-style":a.options?.title.italics?"italic":void 0}}),w=()=>[c.value],C=({$columnIndex:e})=>({height:a.options?.headerRowHeight+"px","border-bottom":"1px solid "+a.options?.borderColor,"border-left":e>0?"1px solid "+a.options?.borderColor:"none",background:a.options?.headerCellBackgroundColor,color:a.options?.headerCellFontColor,"font-size":a.options?.headerCellFontSize+"px","text-align":a.options?.headerAlign}),b=({$columnIndex:e})=>{let t={height:a.options?.cellRowHeight+"px",padding:"0px","border-bottom":"1px solid "+a.options?.borderColor,"border-left":e>0?"1px solid "+a.options?.borderColor:"none",background:e<a.rowGroupColumnList.length?a.options?.rowGroupBackgroundColor:a.options?.cellBackgroundColor,color:e<a.rowGroupColumnList.length?a.options?.rowGroupFontColor:a.options?.cellFontColor,"font-size":(e<a.rowGroupColumnList.length?a.options?.rowGroupFontSize:a.options?.cellFontSize)+"px","text-align":e<a.rowGroupColumnList.length?a.options?.rowGroupAlign:a.options?.cellAlign,"font-weight":e<a.rowGroupColumnList.length?700:void 0};return t},T=t,k=()=>{T("click")},E=e=>{let{row:t,rowIndex:a,$rowIndex:l,column:i,columnIndex:o,$columnIndex:n,triggerRadio:r,triggerCheckbox:s,triggerTreeNode:d,triggerExpandNode:u}=e;console.log("onTableCellClick",t,i);const p=i.field,c=t[p+"__rowData"]||t[p];T("cell-click",c,i,t)},R=()=>{let e=null,t=null,l=(new Date).getTime();console.log("pivotTable buildRowGroupInfo",a.columnGroupColumnList);for(const o of a.columnGroupColumnList||[]){let a={id:"rowGroup"+l++,title:o.showName,isGroup:!0,fixed:"left"};null==e?e=a:t&&(Array.isArray(t.children)||(t.children=[]),t.children.push(a)),t=a}let i=a.rowGroupColumnList.map(e=>({id:"rowColumn"+l++,title:e.showName,field:(0,Se.Uo)(e.columnName),fixed:"left","min-width":e.columnWidth}));null!=t?(t.children=i,e&&d.value.push(e)):d.value=i,console.log("pivotTable buildRowGroupInfo tableGroupInfo",d.value)},D=e=>{let t=null;return a.rowGroupColumnList.forEach(a=>{let l=(0,Se.JY)(e,a.columnName);if(null==l)return null;t=null==t?l:t+"__"+l}),t},I=e=>{let t=null;return a.columnGroupColumnList.forEach(a=>{let l=(0,Se.JY)(e,a.columnName);if(null==l)return null;t=null==t?l:t+"__"+l}),t},A=(e,t)=>{let l=(new Date).getTime(),i={children:d.value};for(const n of a.columnGroupColumnList||[]){let a=null;Array.isArray(i.children)||(i.children=[]);for(let t=0;t<i.children.length;t++)if(i.children[t].dataValue===(0,Se.JY)(e,n.columnName)){a=i.children[t];break}null==a&&(a={id:t+"columnGroup"+l++,dataValue:(0,Se.JY)(e,n.columnName),title:((0,Se.JY)(e,n.columnName)||"").toString(),children:[],isGroup:!0},i.children.push(a)),i=a}let o=a.valueColumnList.map(e=>({id:t+"column"+l++,title:e.name,field:t+"__"+(0,Se.Uo)(e.columnName),"min-width":e.columnWidth}));Array.isArray(i.children)||(i.children=[]),i.children.push(...o)},W=()=>{let e=[],t={};if(Array.isArray(a.data)){let l=new Map,i=new Set;a.options?.totalSetting.row.show&&a.rowGroupColumnList.forEach(l=>{let i=(0,Se.Uo)(l.columnName);e.push(i),t[i]=a.options?.totalSetting.row.showName}),a.data.forEach(o=>{let n=D(o),r=I(o);if(null!=n){let s=l.get(n);null==s&&(s=a.rowGroupColumnList.reduce((e,t)=>{let a=(0,Se.Uo)(t.columnName);return e[a]=(0,Se.JY)(o,t.columnName),e},{}),l.set(n,s),u.value.push(s)),r&&!i.has(r)&&(A(o,r),i.add(r)),(a.valueColumnList||[]).forEach(l=>{let i=(0,Se.JY)(o,l.columnName),n=r+"__"+(0,Se.Uo)(l.columnName);if(g.set(n,l),s[n]=i,s[n+"__rowData"]=o,a.options?.totalSetting.row.show&&(-1===e.indexOf(n)&&(e.push(n),t[n]=0),null!=i&&(t[n]+=i)),a.options?.totalSetting.col.show&&null!=i){let e="__total__data__"+(0,Se.Uo)(l.columnName);a.options?.totalSetting.row.show&&(null==t[e]&&(t[e]=0),null!=i&&(t[e]+=i)),null==s[e]?s[e]=i:null!=i&&(s[e]+=i)}})}}),a.options?.totalSetting.col.show&&(a.valueColumnList||[]).forEach(t=>{let a="__total__data__"+(0,Se.Uo)(t.columnName);g.set(a,t),e.push(a)}),l.clear(),i.clear()}e.forEach(e=>{c.value.push(t[e])})},L=()=>{let e=null,t=[],i=[],o=a.rowGroupColumnList.map(e=>e.columnName);if(Array.isArray(u.value))for(let a=0;a<u.value.length;a++){let l=u.value[a];if(null==e){e=[],t=[];for(const a of o)e.push((0,Se.JY)(l,a)),t.push(0)}else{let n=!1;for(let r=0;r<o.length;r++){let s=o[r],d=0,p=0;e[r]!==(0,Se.JY)(l,s)?(d=t[r],p=a-d,e[r]=(0,Se.JY)(l,s),t[r]=a,n=!0):n?(d=t[r],p=a-d,e[r]=(0,Se.JY)(l,s),t[r]=a):a===u.value.length-1&&(d=t[r],p=a-d+1,e[r]=(0,Se.JY)(l,s),t[r]=a),p>1&&i.push({row:d,col:r,rowspan:p,colspan:1})}}}(0,n.dY)(()=>{l.value&&l.value.setMergeCells(i)})},x=()=>{a.options?.totalSetting.col.show&&d.value.push({id:"__total__data__",title:a.options?.totalSetting.col.showName,fixed:"right",children:a.valueColumnList.map(e=>{let t="__total__data__"+(0,Se.Uo)(e.columnName);return{id:t,title:e.name,field:t,fixed:"right","min-width":e.columnWidth}}),isGroup:!0}),a.options?.totalSetting.row.show&&(0,n.dY)(()=>{l.value&&l.value.setMergeFooterItems([{row:0,col:0,rowspan:1,colspan:a.rowGroupColumnList.length}])})},_=()=>{null==a.height||""===a.height?m.value="calc(400px - 32px)":m.value="calc("+a.height+" - 32px)"},F=()=>{let e=[];function t(a){!a.isGroup&&a.field&&e.push(a.field),a.isGroup&&Array.isArray(a.children)&&a.children.forEach(e=>{t(e)})}Array.isArray(d.value)&&d.value.forEach(e=>{t(e)}),e.forEach((e,t)=>{let a=g.get(e);if(a&&null!=a.fixed&&(u.value.forEach(t=>{t[e]=t[e].toFixed(a.fixed)}),p.value&&Array.isArray(c.value))){let e=c.value[t];c.value[t]="string"==typeof e?e:e?e.toFixed(a.fixed):e}}),console.log("pivotTable data",a.data,u.value)},N=()=>{console.log("pivotTable buildTableInfo >>>"),null!=o&&clearTimeout(o),i.value=!1,o=setTimeout(()=>{d.value=[],u.value=[],c.value=[],g=new Map,p.value=!1,R(),W(),x(),L(),o=null,p.value=a.options?.totalSetting.row.show,F(),_(),i.value=!0,g.clear(),console.log("pivotTable tableDataList",u.value),console.log("pivotTable tableGroupInfo",d.value)},50)};return(0,n.wB)(()=>a.rowGroupColumnList,()=>{N()},{immediate:!0}),(0,n.wB)(()=>a.columnGroupColumnList,()=>{N()},{immediate:!0}),(0,n.wB)(()=>a.valueColumnList,()=>{N()},{immediate:!0}),(0,n.wB)(()=>a.data,()=>{N()},{immediate:!0}),(0,n.wB)(()=>a.options,()=>{N()},{deep:!0,immediate:!0}),(0,n.wB)(()=>a.height,()=>{_()},{immediate:!0}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{class:"pivot-table",onClick:(0,S.D$)(k,["stop"]),style:(0,s.Tr)([{background:"white"},{height:(0,r.R1)(m)}])},[null!=(0,r.R1)(y)&&""!==(0,r.R1)(y)?((0,n.uX)(),(0,n.CE)("div",{key:0,ref_key:"title",ref:y,class:"title",span:24,style:(0,s.Tr)((0,r.R1)(h))},(0,s.v_)((0,r.R1)(y)),5)):(0,n.Q3)("",!0),(0,n.bo)((0,n.Lk)("div",Bt,[(0,n.bF)((0,r.R1)(xt.CP),{ref_key:"table",ref:l,class:"online-table",data:(0,r.R1)(u),style:(0,s.Tr)((0,r.R1)(v)),border:"","show-overflow":"title","show-header-overflow":"title","row-config":(0,r.R1)(f),"header-cell-style":C,"cell-style":b,"footer-cell-style":b,"show-footer":(0,r.R1)(p),height:"100%","min-height":"50px","footer-method":w,onCellClick:E},{empty:(0,n.k6)(()=>t[0]||(t[0]=[(0,n.Lk)("div",{class:"table-empty unified-font"},[(0,n.Lk)("img",{src:Lt}),(0,n.Lk)("span",null,"暂无数据")],-1)])),default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,r.R1)(d),e=>((0,n.uX)(),(0,n.Wv)(Ot,{key:e.id,columnInfo:e},null,8,["columnInfo"]))),128))]),_:1},8,["data","style","row-config","show-footer"])],512),[[S.aG,(0,r.R1)(i)]]),t[1]||(t[1]=(0,n.Lk)("div",{style:{height:"2px","background-color":"rgb(215, 215, 215)"}},null,-1))],4))}});const Xt=(0,F.A)(Mt,[["__scopeId","data-v-72f5fc4e"]]);var Vt=Xt,Pt=a(69080);a(25374),a(20116);const Ut={class:"pagination",style:{width:"100%"}};var Kt=(0,n.pM)({__name:"dataViewTable",props:{data:{default:()=>[]},options:{},columnList:{default:()=>[]}},emits:["click","refresh","cell-click"],setup(e,{emit:t}){const a=e;(0,r.KR)(!0);const l=(0,r.KR)(),i=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options?.title&&a.options?.title.show)return a.options?a.options?.title.text:void 0}),o=(0,n.EW)(()=>({height:a.options?.cellRowHeight,isHover:!0})),d=(0,n.EW)(()=>({border:"1px solid "+a.options?.borderColor,borderBottom:a.data&&a.data.length>0?"none":"1px solid "+a.options?.borderColor})),u=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options?.title)return{color:a.options?.title.textStyle.color,"font-size":a.options?.title.textStyle.fontSize+"px","font-weight":a.options?.title.bold?600:void 0,"text-align":a.options?.title.left,"font-style":a.options?.title.italics?"italic":void 0}}),p=({$columnIndex:e})=>({height:a.options?.columnSetting.headerRowHeight+"px","border-bottom":"1px solid "+a.options?.borderColor,"border-left":e>0?"1px solid "+a.options?.borderColor:"none",background:a.options?.columnSetting.backgroundColor,color:a.options?.columnSetting.fontColor,"font-size":a.options?.columnSetting.fontSize+"px","text-align":a.options?.columnSetting.align}),c=()=>({height:a.options?.cellRowHeight+"px",padding:"0px","border-bottom":"1px solid "+a.options?.borderColor,"border-left":"1px solid "+a.options?.borderColor,background:a.options?.rowSetting.backgroundColor,color:a.options?.rowSetting.fontColor,"font-size":a.options?.rowSetting.fontSize+"px","text-align":a.options?.rowSetting.align}),m=t,g=()=>{m("click")},y=e=>{let{row:t,rowIndex:a,$rowIndex:l,column:i,columnIndex:o,$columnIndex:n,triggerRadio:r,triggerCheckbox:s,triggerTreeNode:d,triggerExpandNode:u}=e;m("cell-click",t,i)},f=(0,n.EW)(()=>(a.data||[]).map(e=>({...e}))),v=()=>{m("refresh",a.options?.pagerSetting.show?a.options?.datasetInfo.pageParam:void 0)},h=e=>{if(a.options){const t=a.options;t.datasetInfo.pageParam.pageNum=e}v()},w=e=>{if(a.options){const t=a.options;t.datasetInfo.pageParam.pageSize=e}v()},C=e=>{let t=a.options?.datasetInfo.showColumnList.find(t=>t.columnName===e.field);if(a.options){const l=a.options;l.datasetInfo.orderInfoList=[{id:t.columnId,columnId:t.columnId,showName:t.columnComment,orderType:"desc"===e.order?2:1}]}};return(0,n.wB)(()=>a.data,()=>{},{immediate:!0}),(0,n.wB)(()=>a.options,()=>{},{deep:!0,immediate:!0}),(e,t)=>{const m=Ge.uD,v=Pt.aQ,b=ce.S2;return(0,n.uX)(),(0,n.Wv)(b,{class:"dataview-table",onClick:(0,S.D$)(g,["stop"]),style:{background:"white"}},{default:(0,n.k6)(()=>[null!=(0,r.R1)(i)&&""!==(0,r.R1)(i)?((0,n.uX)(),(0,n.Wv)(m,{key:0,ref_key:"title",ref:i,class:"title",span:24,style:(0,s.Tr)((0,r.R1)(u))},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)((0,r.R1)(i)),1)]),_:1},8,["style"])):(0,n.Q3)("",!0),(0,n.bF)(m,{class:"table",span:24},{default:(0,n.k6)(()=>[(0,n.bF)((0,r.R1)(xt.CP),{class:"online-table",ref_key:"table",ref:l,height:a.options?.basicInfo.height,data:(0,r.R1)(f),style:(0,s.Tr)((0,r.R1)(d)),border:"","show-overflow":"title","show-header-overflow":"title","row-config":(0,r.R1)(o),"header-cell-style":p,"cell-style":c,"footer-cell-style":c,"sort-config":{trigger:"cell",orders:["desc","asc",null]},onSortChange:C,onCellClick:y},{empty:(0,n.k6)(()=>t[0]||(t[0]=[(0,n.Lk)("div",{class:"table-empty unified-font"},[(0,n.Lk)("img",{src:Lt}),(0,n.Lk)("span",null,"暂无数据")],-1)])),default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.columnList,(e,t)=>((0,n.uX)(),(0,n.Wv)((0,r.R1)(xt.Wq),{key:e.columnId+"_"+t,title:e.showName||e.columnComment,width:t==a.columnList.length-1?void 0:e.columnWidth,sortable:e.sortable||void 0},{default:(0,n.k6)(t=>[(0,n.eW)((0,s.v_)((0,r.R1)(Se.oG)(t.row,e.columnName)),1)]),_:2},1032,["title","width","sortable"]))),128))]),_:1},8,["height","data","style","row-config"]),(0,n.Lk)("div",Ut,[a.options?.pagerSetting.show?((0,n.uX)(),(0,n.Wv)(v,{key:0,class:(0,s.C4)(["display-"+a.options?.pagerSetting.align,"dataViewTable"]),total:e.data.totalCount,"page-size":a.options.datasetInfo.pageParam.pageSize,"page-sizes":[10,20,50,100],background:"1"==a.options.pagerSetting.background||void 0,small:"small"==a.options.pagerSetting.size||void 0,layout:"total, prev, pager, next, sizes","current-page":a.options.datasetInfo.pageParam.pageNum,onCurrentChange:h,onSizeChange:w},null,8,["class","total","page-size","background","small","current-page"])):(0,n.Q3)("",!0)])]),_:1})]),_:1})}}});const zt=(0,F.A)(Kt,[["__scopeId","data-v-57d0ceec"]]);var Qt=zt;const Gt=["innerHTML"];var Yt=(0,n.pM)({__name:"richText",props:{data:{},height:{},options:{},widget:{},textColumn:{}},emits:["click"],setup(e,{emit:t}){const a=e,l=(0,r.KR)(!0),i=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options.title&&a.options.title.show)return a.options?a.options.title.text:void 0}),o=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options.title)return{color:a.options.title.textStyle.color,"font-size":a.options.title.textStyle.fontSize+"px","font-weight":a.options.title.bold?600:void 0,"text-align":a.options.title.left,"font-style":a.options.title.italics?"italic":void 0}}),d=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options.basicInfo)return{color:a.options.basicInfo.cellFontColor,"line-height":(a.options.basicInfo.cellRowHeight||30)+"px","background-color":a.options.basicInfo.cellBackgroundColor+"A0","font-size":a.options.basicInfo.cellFontSize+"px","text-align":a.options.basicInfo.cellAlign}}),u=(e,t)=>{if(t&&t.length>0)return(0,Se.oG)(e,t[0].columnName)},p=(0,n.EW)(()=>Array.isArray(a.data)?u(a.data[0],a.textColumn):u(a.data,a.textColumn)),c=t,m=()=>{c("click")};return(e,t)=>{const a=Ge.uD,u=ce.S2;return(0,n.uX)(),(0,n.Wv)(u,{class:"rich-text",onClick:(0,S.D$)(m,["stop"]),style:{background:"white"}},{default:(0,n.k6)(()=>[null!=(0,r.R1)(i)&&""!==(0,r.R1)(i)?((0,n.uX)(),(0,n.Wv)(a,{key:0,ref_key:"title",ref:i,class:"title",span:24,style:(0,s.Tr)((0,r.R1)(o))},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)((0,r.R1)(i)),1)]),_:1},8,["style"])):(0,n.Q3)("",!0),(0,n.bo)((0,n.bF)(a,{class:"table",span:24},{default:(0,n.k6)(()=>[(0,n.Lk)("div",{style:(0,s.Tr)((0,r.R1)(d)),innerHTML:(0,r.R1)(p),class:"html-text"},null,12,Gt)]),_:1},512),[[S.aG,(0,r.R1)(l)]])]),_:1})}}});const jt=(0,F.A)(Yt,[["__scopeId","data-v-2ac44e44"]]);var Ht=jt,Jt=a(53290),qt=(0,n.pM)({__name:"gaugeChart",props:{data:{default:()=>[]},value:{},options:{},categrayColumnList:{default:()=>[]},valueColumnList:{default:()=>[]},callback:{default:()=>({})}},setup(e,{expose:t}){const a={title:{...(0,Fe.gs)()},label:{...(0,Fe.iJ)()},tooltip:{...(0,Fe.n_)()}},l={...(0,Fe.r2)()};he.Y(Jt.a);const i=e,o=(0,r.KR)();let d=null;const u=(0,n.EW)(()=>Array.isArray(i.categrayColumnList)&&i.categrayColumnList.length>0?i.categrayColumnList[0].columnName:""),p=(0,n.EW)(()=>{if(Array.isArray(i.valueColumnList)&&Array.isArray(i.data)&&i.data.length>0){let e={name:(0,Se.JY)(i.data[0],u.value),value:(0,Se.wr)(i.data[0],i.valueColumnList)},t={...i.options?.series};return[{...l,...t,data:[e]}]}return[]}),c=(0,n.EW)(()=>{let e={...a,...i.options?.basic,color:i.options?.basic.chartColors,series:p.value};return Object.keys(e).forEach(t=>{e[t]||delete e[t]}),e}),m=()=>{if(null!=d){0===i.data.length&&d.clear();const e=(0,Fe.rP)(c.value);d.setOption(e,!0),d.resize()}},g=()=>{null!=d&&d.resize()};return t({resize:g}),(0,n.wB)(()=>c.value,()=>{m()},{immediate:!0}),(0,n.sV)(()=>{d=we.Ts(o.value),m()}),(0,n.KC)(()=>{null!=d&&(d.dispose(),d=null)}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{ref_key:"container",ref:o},(0,s.v_)((0,r.R1)(c)),513))}});const $t=qt;var Zt=$t,ea=a(31323),ta=(0,n.pM)({__name:"funnelChart",props:{data:{default:()=>[]},value:{},options:{},categrayColumnList:{default:()=>[]},valueColumnList:{default:()=>[]},callback:{default:()=>({})}},emits:["click","update:data","change","dblclick"],setup(e,{expose:t,emit:a}){const l={title:{...(0,Fe.gs)()},legend:{...(0,Fe.Ji)()},label:{...(0,Fe.iJ)()},tooltip:{...(0,Fe.n_)()}},i={...(0,Fe.QL)()};he.Y([Ce.a,be.a,Te.a,ke.a,ea.a,Re.a]);const o=e,s=(0,r.KR)();let d=null;const u=(0,n.EW)(()=>o.options?.basic.label),p=(0,n.EW)(()=>{if(Array.isArray(o.data))return o.data.map(e=>(0,Se.ok)(e,o.categrayColumnList));{let e=[];return o.valueColumnList.forEach(t=>{e.push(t.name)}),e}}),c=(0,n.EW)(()=>{let e={...o.options?.series,left:o.options?.series.left+"%",width:o.options?.series.width+"%",minSize:o.options?.series.minSize+"%",maxSize:o.options?.series.maxSize+"%"};if(Array.isArray(o.valueColumnList)&&Array.isArray(o.data)){let t=[];return t=o.valueColumnList.map((t,a)=>{let l=o.data.map(e=>{let a=(0,Se.JY)(e,t.columnName,t.fixed);return{value:(0,Se.Sb)(a,t.fixed),name:(0,Se.ok)(e,o.categrayColumnList)}});return{name:p.value[a],...i,...e,label:u.value,data:l}}),t.length>0?t:[{name:"test",...i,...e,label:u.value,data:xe}]}{let t=[],a=[];return o.valueColumnList.forEach(e=>{let t=o.data,l=t[e.columnName+"__DictMap"]?t[e.columnName+"__DictMap"]:t[e.columnName];a.push({name:e.name,value:(0,Se.Sb)(l,e.fixed)})}),t.push({name:p.value,...i,...e,label:u.value,data:a}),t.length>0?t:[{name:"test",...i,...e,label:u.value,data:xe}]}}),m=(0,n.EW)(()=>{let e={...l,...o.options?.basic,series:c.value};return e.legend.data=p.value,e}),g=a,y=()=>{g("click")},f=()=>{if(null!=d){0===o.data.length&&d.clear();const e=(0,Fe.rP)(m.value);d.setOption(e,!0),d.resize()}},v=()=>{null!=d&&d.resize()},h=e=>{let t=o.data,a=t[e.dataIndex];o.value===a&&(a=null),g("update:data",a),g("serie-click",a)},w=e=>{let t=o.data,a=t[e.dataIndex];g("dblclick",a)};return t({resize:v}),(0,n.wB)(()=>m.value,()=>{f()},{deep:!0,immediate:!0}),(0,n.sV)(()=>{d=we.Ts(s.value),d.on("click","series",h),d.on("dblclick","series",w),f()}),(0,n.KC)(()=>{null!=d&&(d.dispose(),d=null)}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{onClick:(0,S.D$)(y,["stop"]),ref_key:"container",ref:s},null,512))}});const aa=ta;var la=aa,ia=a(43285),oa=(0,n.pM)({__name:"radarChart",props:{data:{default:()=>[]},value:{},options:{},categrayColumnList:{default:()=>[]},valueColumnList:{default:()=>[]},callback:{default:()=>({})}},emits:["click","update:data","change","dblclick"],setup(e,{expose:t,emit:a}){const l={title:{...(0,Fe.gs)()},label:{...(0,Fe.iJ)()},tooltip:{...(0,Fe.n_)()}},i={...(0,Fe.Yb)()};he.Y([Ce.a,be.a,Te.a,ke.a,ia.a,Re.a]);const o=e,s=(0,r.KR)();let d=null,u=null,p=null;const c=a,m=()=>{c("click")},g=()=>{if(null!=d){0===o.data.length&&d.clear();const e=(0,Fe.rP)(T.value);d.setOption(e,!0),d.resize()}},y=()=>{null!=d&&d.resize()},f=e=>{let t=o.data,a=t[e.dataIndex];o.value===a&&(a=null),c("update:data",a),c("change",a),c("serie-click",a),u=e.dataIndex,p=e.seriesIndex},v=e=>{let t=o.data,a=t[e.dataIndex];c("dblclick",a)};t({resize:y});const h=(0,n.EW)(()=>({label:o.options?.basic.label})),w=(0,n.EW)(()=>{let e={...o.options?.series};if(Array.isArray(o.valueColumnList)&&Array.isArray(o.data)){let t=o.data.map((e,t)=>{let a=o.data,l={name:(0,Se.ok)(e,a),value:(0,Se.wr)(e,o.valueColumnList),areaStyle:{opacity:(o.options?.series.areaStyleOpacity||0)/10}};return l});return[{...i,...e,data:t.length>0?t:_e}]}{let t=[],a=[];o.valueColumnList.forEach(e=>{let t=o.data;a.push(t[e.columnName+"__DictMap"]?t[e.columnName+"__DictMap"]:t[e.columnName])});let l=o.data;return t.push({name:(0,Se.ok)(o.data,l),value:a,areaStyle:{opacity:(o.options?.series.areaStyleOpacity||0)/10}}),[{...i,...e,...this.labelSetting,data:t.length>0?t:_e}]}}),C=(0,n.EW)(()=>{let e=o.options?.radar,t=o.options?.datasetInfo.valueColumnList.map(e=>({text:e.showName,max:e.max,min:e.min}));for(let a=0;a<3-o.valueColumnList.length;a++)t.push({});return e.indicator=t,e}),b=(0,n.EW)(()=>o.options?.basic.color||["#5470C6","#91CC75","#FAC858","#EE6666","#73C0DE","#3BA272","#FC8452","#9A60B4","#EA7CCC"]),T=(0,n.EW)(()=>{let e={...l,...o.options?.basic,color:b.value,radar:C.value,label:h.value,series:w.value};return e});return(0,n.wB)(()=>T.value,()=>{g()},{immediate:!0}),(0,n.sV)(()=>{d=we.Ts(s.value),d.on("click","series",f),d.on("dblclick","series",v),g()}),(0,n.KC)(()=>{null!=d&&(d.dispose(),d=null)}),(e,t)=>((0,n.uX)(),(0,n.CE)("div",{onClick:(0,S.D$)(m,["stop"]),ref_key:"container",ref:s},null,512))}});const na=oa;var ra=na;const sa=["onDblclick"],da=["innerHTML"],ua={class:"progress-container"};var pa=(0,n.pM)({__name:"progressBar",props:{data:{},options:{}},emits:["click","update:data","change","dblclick"],setup(e,{emit:t}){const a=e,l=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options.title&&a.options.title.show)return a.options?a.options.title.text:void 0}),i=(0,n.EW)(()=>{if(null!=a.options&&null!=a.options.title)return{color:a.options.title.textStyle.color,"font-size":a.options.title.textStyle.fontSize+"px","font-weight":a.options.title.bold?600:void 0,"text-align":a.options.title.left,"font-style":a.options.title.italics?"italic":void 0}}),o=(0,n.EW)(()=>({color:a.options?.seriesSetting.textStyle.color,width:a.options?.seriesSetting.textStyle.width+"px","font-size":a.options?.seriesSetting.textStyle.fontSize+"px","font-weight":a.options?.seriesSetting.textStyle.bold?600:void 0,"font-style":a.options?.seriesSetting.textStyle.italics?"italic":void 0})),d=(0,n.EW)(()=>[a.data.dataList,a.options?.seriesSetting.maxValue]),u=(0,n.EW)(()=>Array.isArray(a.data)?a.data[0]:a.data),p=e=>a.options?.datasetInfo[e]&&Array.isArray(a.options.datasetInfo[e])&&a.options.datasetInfo[e].length>0?a.options.datasetInfo[e][0].columnName:void 0,c=(e,t,a)=>{let l;if(l="string"===typeof e?p(e):e.columnName,!l)return t;const i=(0,Se.oG)(a||u.value,l);return i||t},m=(e,t=null)=>{let a=c(e,"0",t);return"string"===typeof a?isNaN(Number(a))?0:Number(a):a},g=t,y=()=>{g("click")},f=e=>{g("dblclick",e)},v=(e,t)=>{if(!a.options?.seriesSetting.textInside)return"";let l=c("textColumn","",t);return a.options.seriesSetting.textStyle.text.replace(/\{percent\}/gi,e).replace(/\{text\}/gi,l)},h=(e,t)=>{let l=c("textColumn","",t);return a.options?.seriesSetting.textStyle.text.replace(/:/gi,l?":":"").replace(/\{percent\}/gi,e).replace(/\{text\}/gi,l)},w=e=>{try{if(!p("progressColumn")||!a.options)return 0;let t=Number((m("progressColumn",e)/a.options.seriesSetting.maxValue*100).toFixed(2));return t>100?100:t}catch(t){return console.warn(t),0}};return(0,n.wB)(()=>d.value,()=>{if(Array.isArray(a.data.dataList)){const e=a.data.dataList;for(let t=0;t<a.data.dataList.length;t++)e[t].percentage=w(e[t])}},{deep:!0,immediate:!0}),(e,t)=>{const a=Ge.uD,d=lt.ve,u=ce.S2;return(0,n.uX)(),(0,n.Wv)(u,{class:"progress-bar",onClick:(0,S.D$)(y,["stop"]),style:{background:"white"}},{default:(0,n.k6)(()=>[null!=(0,r.R1)(l)&&""!==(0,r.R1)(l)?((0,n.uX)(),(0,n.Wv)(a,{key:0,ref_key:"title",ref:l,class:"title",span:24,style:(0,s.Tr)((0,r.R1)(i))},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)((0,r.R1)(l)),1)]),_:1},8,["style"])):(0,n.Q3)("",!0),e.data.dataList&&e.data.dataList.length>0?((0,n.uX)(),(0,n.Wv)(a,{key:1,class:"progress-bar-container",span:24},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.data.dataList,(t,a)=>((0,n.uX)(),(0,n.CE)("div",{class:"progress-container",key:a,onDblclick:e=>f(t)},[(0,n.bF)(d,{type:"line",percentage:t.percentage,"define-back-color":e.options?.seriesSetting.defineBackColor,"stroke-width":e.options?.seriesSetting.strokeWidth,"show-text":e.options?.seriesSetting.showText,"text-inside":!0,"text-color":e.options?.seriesSetting.textStyle.color,color:e.options?.seriesSetting.color,format:e=>v(e,t)},null,8,["percentage","define-back-color","stroke-width","show-text","text-color","color","format"]),e.options?.seriesSetting.textInside?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",{key:0,class:"progress-text",style:(0,s.Tr)((0,r.R1)(o))},[(0,n.Lk)("div",{class:"text",innerHTML:h(w(t),t)},null,8,da)],4))],40,sa))),128))]),_:1})):((0,n.uX)(),(0,n.Wv)(a,{key:2,class:"progress-bar-container",span:24},{default:(0,n.k6)(()=>[(0,n.Lk)("div",ua,[(0,n.bF)(d,{type:"line",percentage:10,"define-back-color":e.options?.seriesSetting.defineBackColor,"stroke-width":e.options?.seriesSetting.strokeWidth,"show-text":e.options?.seriesSetting.showText,"text-inside":!0,"text-color":e.options?.seriesSetting.textStyle.color,color:e.options?.seriesSetting.color,format:()=>""},null,8,["define-back-color","stroke-width","show-text","text-color","color"]),(0,n.Lk)("div",{class:"progress-text",style:(0,s.Tr)((0,r.R1)(o))},t[0]||(t[0]=[(0,n.Lk)("div",{class:"text"},"10%",-1)]),4)])]),_:1}))]),_:1})}}});const ca=(0,F.A)(pa,[["__scopeId","data-v-d2f69cd8"]]);var ma=ca,ga=(0,n.pM)({__name:"OnlineCustomChart",props:{value:{},isEdit:{type:Boolean,default:!1},widget:{}},emits:["widgetClick","update:value"],setup(e,{expose:t,emit:a}){const l=e,i=(0,r.KR)(),o=(0,r.KR)([]);let d;const u=(0,r.KR)([]),p=(0,r.KR)([]),c=(0,r.KR)(),m=(0,r.KR)(),g=(0,r.KR)([]),y=(0,r.KR)([]),f=(0,r.KR)([]),v=(0,r.KR)([]),h=(0,r.KR)([]),w=(0,r.KR)([]);let C;const b=(0,n.WQ)("form",()=>(console.error("OnlineCustomChart: form not injected"),{isEdit:!1})),T=a,k=()=>{T("widgetClick",l.widget)},E=(e,t)=>e&&"function"===typeof e[t]?e[t]:null,I=e=>{let t=E(l.widget.eventInfo,j.OnlineFormEventType.SERIE_CLICK);null!=t&&t(e,b().instanceData())},A=(e,t)=>{let a=E(l.widget.eventInfo,j.OnlineFormEventType.REPORT_CELL_CLICK);null!=a&&a(e,t,b().instanceData())},W=e=>{if(null==l.widget||null==l.widget.dataset)return null;e||(null==l.widget.props.pagerSetting||l.widget.props.pagerSetting.show)&&l.widget.props.datasetInfo.pageParam;return{datasetId:l.widget.dataset.datasetId,orderDataList:l.widget.props.datasetInfo.orderInfoList,pageParam:e,datasetFilterParams:(l.widget.props.datasetInfo.datasetFilterParams||[]).map(e=>b().getQueryParam(e)).filter(e=>null!=e.paramValue),filterParams:Array.isArray(l.widget.props.datasetInfo.filterList)?l.widget.props.datasetInfo.filterList.map(e=>b().getQueryParam(e)).filter(e=>null!=e.paramValue):[]}},L=(e=null)=>{d&&clearTimeout(d),d=setTimeout(async()=>{let t=W(e),a=E(l.widget.eventInfo,j.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA);if(null!=a&&(t=await a(t,b().instanceData())),null!=t&&null!=l.widget.dataset)try{let e=await b().listDataWithGroup(t),a=e.dataList,i=E(l.widget.eventInfo,j.OnlineFormEventType.AFTER_LOAD_TABLE_DATA);null!=i&&(a=await i(a,b().instanceData())),o.value=a,d=null}catch(i){console.error(i),d=null}else o.value=[],d=null},50)},x=()=>{(0,n.dY)(()=>{L(m.value?.datasetInfo.pageParam)})},_=()=>{null!=C&&clearTimeout(C),C=setTimeout(()=>{i.value&&"function"===typeof i.value.resize&&i.value.resize(),l.widget.widgetType!==j.SysCustomWidgetType.DataViewTable&&l.widget.widgetType!==j.SysCustomWidgetType.ProgressBar?(0,n.dY)(N):(0,n.dY)(L),C=null},200)},F=e=>{b().onChartDblClick(l.widget,e)},N=()=>{null!=d&&clearTimeout(d),d=setTimeout(async()=>{let e=M(),t=E(l.widget.eventInfo,j.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA);if(null!=t&&(e=await t(e,b().instanceData())),null!=e&&null!=l.widget.dataset)try{let t=await b().listDataWithGroup(e),a=t.dataList,i=E(l.widget.eventInfo,j.OnlineFormEventType.AFTER_LOAD_TABLE_DATA);null!=i&&(a=await i(a,b().instanceData()));let n=null;if(l.widget.dataset.datasetType===St.DatasetType.API&&(n=z(l.widget.props.datasetInfo.bindColumnId)),Array.isArray(n)&&n.length>0){let e=n[0],i=e&&"Object"===e.fieldType?a[0]:a;if(n.length>1)for(let t=1;t<n.length;t++){let e=n[t];if(i=i[e.columnName],null==i)break}null!=i&&(l.widget.widgetType===j.SysCustomWidgetType.DataViewTable?o.value=t:o.value=i)}else o.value=a;d=null}catch(a){console.error(a),d=null}else o.value=[],d=null},50)},O=e=>{T("update:value",e)},B=e=>{if(null!=e)return JSON.parse(JSON.stringify(e))},M=()=>{if(![j.SysCustomWidgetType.DataViewTable,j.SysCustomWidgetType.Carousel,j.SysCustomWidgetType.RichText,j.SysCustomWidgetType.CommonList,j.SysCustomWidgetType.DataCard,j.SysCustomWidgetType.DataProgressCard,j.SysCustomWidgetType.ProgressBar,j.SysCustomWidgetType.ProgressCircle].find(e=>e===l.widget.widgetType)&&(null==l.widget||null==l.widget.dataset||!Array.isArray(l.widget.props.datasetInfo.valueColumnList)||0===l.widget.props.datasetInfo.valueColumnList.length))return null;let e=l.widget.props.datasetInfo.categroyColumnList;if(l.widget.widgetType===j.SysCustomWidgetType.PivotTable){if(!Array.isArray(l.widget.props.datasetInfo.rowGroupColumnList)||0===l.widget.props.datasetInfo.rowGroupColumnList.length)return null;e=(l.widget.props.datasetInfo.rowGroupColumnList||[]).concat(l.widget.props.datasetInfo.columnGroupColumnList||[])}if(![j.SysCustomWidgetType.DataViewTable,j.SysCustomWidgetType.Carousel,j.SysCustomWidgetType.RichText,j.SysCustomWidgetType.CommonList,j.SysCustomWidgetType.DataCard,j.SysCustomWidgetType.DataProgressCard,j.SysCustomWidgetType.ProgressBar,j.SysCustomWidgetType.ProgressCircle].find(e=>e===l.widget.widgetType)&&(!Array.isArray(e)||0===e.length))return null;let t=[];l.widget.widgetType===j.SysCustomWidgetType.PivotTable&&(Array.isArray(l.widget.props.datasetInfo.rowGroupColumnList)&&l.widget.props.datasetInfo.rowGroupColumnList.forEach(e=>{e.columnId&&t.push({columnId:e.columnId,orderType:St.OrderType.ASC})}),Array.isArray(l.widget.props.datasetInfo.columnGroupColumnList)&&l.widget.props.datasetInfo.columnGroupColumnList.forEach(e=>{e.columnId&&t.push({columnId:e.columnId,orderType:St.OrderType.ASC})})),l.widget.props.datasetInfo&&Array.isArray(l.widget.props.datasetInfo.orderInfoList)&&l.widget.props.datasetInfo.orderInfoList.forEach(e=>{t.push({columnId:e.orderColumnId,calculateType:e.calculateType,orderType:e.orderType})});let a=(l.widget.dataset||{}).datasetType===St.DatasetType.API;return{datasetId:(l.widget.dataset||{}).datasetId,dimensionDataList:a?[]:(e||[]).map(e=>({columnId:e.columnId})),indexDataList:a?[]:(l.widget.props.datasetInfo.valueColumnList||[]).map(e=>({columnId:e.columnId,calculateType:e.calculateType,filterParams:Array.isArray(e.filterList)?e.filterList.map(e=>b().getQueryParam(e)).filter(e=>null!=e.paramValue):[]})),orderDataList:a?[]:t,filterParams:a?[]:Array.isArray(l.widget.props.datasetInfo.filterList)?l.widget.props.datasetInfo.filterList.map(e=>b().getQueryParam(e)).filter(e=>null!=e.paramValue):[],datasetFilterParams:Array.isArray(l.widget.props.datasetInfo.datasetFilterParams)?l.widget.props.datasetInfo.datasetFilterParams.map(e=>b().getQueryParam(e)).filter(e=>null!=e.paramValue):[]}},X=()=>null==l.widget||null==l.widget.dataset||null==l.widget.props.datasetInfo.categroyColumnList||0===l.widget.props.datasetInfo.categroyColumnList.length?[]:l.widget.props.datasetInfo.categroyColumnList.map(e=>{let t=Q(e.columnId);return{columnName:null!=t?t:void 0}}),V=()=>null==l.widget||null==l.widget.dataset||null==l.widget.props.datasetInfo.valueColumnList||0===l.widget.props.datasetInfo.valueColumnList.length?[]:l.widget.props.datasetInfo.valueColumnList.map(e=>{let t=Q(e.columnId,e.calculateType);return null==t?null:{columnName:t,name:e.showName,columnWidth:e.columnWidth,fixed:e.fixed}}).filter(e=>null!=e),P=()=>{if(console.log("getRowGroupColumnList >>>",l),null==l.widget||null==l.widget.dataset||null==l.widget.props.datasetInfo.rowGroupColumnList||0===l.widget.props.datasetInfo.rowGroupColumnList.length)return g.value||[];const e=l.widget.props.datasetInfo.rowGroupColumnList.map(e=>{let t=Q(e.columnId);return console.log("getRowGroupColumnList columnName >>>",t,e),null==t?null:{columnName:t,columnWidth:e.columnWidth,showName:e.showName}}).filter(e=>null!=e);return console.log("getRowGroupColumnList rowGroupColumnList >>>",e),e},U=()=>null==l.widget||null==l.widget.dataset||null==l.widget.props.datasetInfo.showColumnList||0===l.widget.props.datasetInfo.showColumnList.length?[]:l.widget.props.datasetInfo.showColumnList.map(e=>{let t=Q(e.columnId);return null==t?null:{...e,columnName:t}}).filter(e=>null!=e),K=()=>null==l.widget||null==l.widget.dataset||null==l.widget.props.datasetInfo.columnGroupColumnList||0===l.widget.props.datasetInfo.columnGroupColumnList.length?[]:l.widget.props.datasetInfo.columnGroupColumnList.map(e=>{let t=Q(e.columnId);return null==t?null:{columnName:t,columnWidth:e.columnWidth,showName:e.showName}}).filter(e=>null!=e),z=(e,t=null)=>{let a=(l.widget.dataset||{}).columnList||l.widget.columnList;if(null==l.widget||null==l.widget.dataset||!Array.isArray(a))return[];let i=(0,G.BN)(a.map(e=>({...e,children:void 0})),"columnId","parentId"),o=(0,G.I_)(i,e,"columnId"),n=[],r=!1;return o.forEach(e=>{(r||null==t)&&n.push(e),r||e.columnId!==t||(r=!0)}),n},Q=(e,t=null)=>{let a=(l.widget.dataset||{}).columnList||l.widget.columnList;if(null==l.widget||null==l.widget.dataset||!Array.isArray(a))return null;let i=l.widget.dataset.datasetType===St.DatasetType.API;if(i){let t=z(e,l.widget.props.datasetInfo.bindColumnId);if(Array.isArray(t))return t.map(e=>e.columnName)}else{let l=(0,G.PH)(a,e,"columnId");if(null!=l)return null==t?l.columnName:(0,Se.dU)(t,l.columnName)}return null},Y=()=>{l.widget.widgetType===j.SysCustomWidgetType.PivotTable&&(c.value={borderColor:l.widget.props.basicInfo.borderColor,cellBackgroundColor:l.widget.props.basicInfo.cellBackgroundColor,cellFontColor:l.widget.props.basicInfo.cellFontColor,cellFontSize:l.widget.props.basicInfo.cellFontSize,cellAlign:l.widget.props.basicInfo.cellAlign,headerCellBackgroundColor:l.widget.props.columnGroupSetting.backgroundColor,headerCellFontColor:l.widget.props.columnGroupSetting.fontColor,headerCellFontSize:l.widget.props.columnGroupSetting.fontSize,headerRowHeight:l.widget.props.columnGroupSetting.headerRowHeight,headerAlign:l.widget.props.columnGroupSetting.align,rowGroupBackgroundColor:l.widget.props.rowGroupSetting.backgroundColor,rowGroupFontColor:l.widget.props.rowGroupSetting.fontColor,rowGroupFontSize:l.widget.props.rowGroupSetting.fontSize,rowGroupAlign:l.widget.props.rowGroupSetting.align,cellRowHeight:l.widget.props.basicInfo.cellRowHeight,totalSetting:{row:{show:l.widget.props.rowTotalSetting.show,showName:l.widget.props.rowTotalSetting.showName,position:l.widget.props.rowTotalSetting.position},col:{show:l.widget.props.colTotalSetting.show,showName:l.widget.props.colTotalSetting.showName,position:l.widget.props.colTotalSetting.position}},subTotalSetting:{row:{show:l.widget.props.rowSubTotalSetting.show,showName:l.widget.props.rowSubTotalSetting.showName,position:l.widget.props.rowSubTotalSetting.position},col:{show:l.widget.props.colSubTotalSetting.show,showName:l.widget.props.colSubTotalSetting.showName,position:l.widget.props.colSubTotalSetting.position}},title:JSON.parse(JSON.stringify(l.widget.props.titleSetting)),cellRule:{cellThreshold:l.widget.props.cellRule}})},H=e=>{let t=["mainTextColumn","numTextColumn","footTextColumn","footNumTextColumn","textColumn","titleColumn","timeColumn","progressColumn"],a=JSON.parse(JSON.stringify(e));return t.forEach(e=>{null!=a[e]&&(Array.isArray(a[e])?a[e].forEach(e=>{const t=Q(e.columnId);Array.isArray(t)&&t.length>0&&(e.columnName=Q(e.columnId)||e.columnName)}):a[e].columnName=Q(a[e].columnId))}),a},J=()=>{const e=[j.SysCustomWidgetType.DataViewTable,j.SysCustomWidgetType.Carousel,j.SysCustomWidgetType.RichText,j.SysCustomWidgetType.GaugeChart,j.SysCustomWidgetType.FunnelChart,j.SysCustomWidgetType.RadarChart,j.SysCustomWidgetType.ProgressBar,j.SysCustomWidgetType.ProgressCircle,j.SysCustomWidgetType.DataCard,j.SysCustomWidgetType.DataProgressCard,j.SysCustomWidgetType.CommonList];e.find(e=>e===l.widget.widgetType)&&(m.value={datasetInfo:H(l.widget.props.datasetInfo),basicInfo:l.widget.props.basicInfo,borderColor:l.widget.props.basicInfo.borderColor,cellAlign:l.widget.props.basicInfo.cellAlign,cellRowHeight:l.widget.props.basicInfo.cellRowHeight,rowSetting:l.widget.props.rowSetting,columnSetting:l.widget.props.columnSetting,pagerSetting:l.widget.props.pagerSetting,seriesSetting:l.widget.props.seriesSetting,routeSetting:l.widget.props.routeSetting,pageParam:l.widget.props.datasetInfo.pageParam,title:l.widget.props.titleSetting?JSON.parse(JSON.stringify(l.widget.props.titleSetting)):{},cellRule:{cellThreshold:l.widget.props.cellRule}})},q=e=>Array.isArray(e)?e.map(e=>({...e,columnName:Q(e.columnId)})):[],$=(0,n.EW)(()=>{if(null!=l.widget)return{basic:{color:B(l.widget.props.basicInfo.chartColors),grid:l.widget.props.basicInfo.grid?B(l.widget.props.basicInfo.grid):void 0,label:B(l.widget.props.labelSetting),tooltip:B(l.widget.props.tooltipSetting),xAxis:l.widget.props.xAxisSetting?B(l.widget.props.xAxisSetting):void 0,yAxis:l.widget.props.yAxisSetting?{...B(l.widget.props.yAxisSetting),min:null==l.widget.props.yAxisSetting||l.widget.props.yAxisSetting.yAxisValueAuto?void 0:l.widget.props.yAxisSetting.min,max:null==l.widget.props.yAxisSetting||l.widget.props.yAxisSetting.yAxisValueAuto?void 0:l.widget.props.yAxisSetting.max,interval:null==l.widget.props.yAxisSetting||l.widget.props.yAxisSetting.yAxisValueAuto?void 0:l.widget.props.yAxisSetting.interval}:void 0,title:{...B(l.widget.props.titleSetting),textStyle:{...B(l.widget.props.titleSetting.textStyle),fontStyle:l.widget.props.titleSetting.italics?"italic":"normal",fontWeight:l.widget.props.titleSetting.bold?"bold":"normal"}},legend:B(l.widget.props.legendSetting)},series:{...B(l.widget.props.seriesSetting),barWidth:l.widget.props.seriesSetting.autoWidth?void 0:l.widget.props.seriesSetting.barWidth},radar:l.widget.props.radarSetting?B(l.widget.props.radarSetting):null,datasetInfo:l.widget.props.datasetInfo}}),Z=(0,n.EW)(()=>l.widget?l.widget.widgetType!==j.SysCustomWidgetType.PivotTable&&l.widget.widgetType!==j.SysCustomWidgetType.DataViewTable?{padding:l.widget.widgetType===j.SysCustomWidgetType.Carousel?"0px":"15px",height:(l.widget||{}).props.basicInfo.height}:void 0:{});return(0,n.wB)(()=>l.widget.dataset,()=>{p.value=V(),u.value=X(),g.value=P(),y.value=K(),f.value=U(),v.value=q(l.widget.props.datasetInfo.imagePath),h.value=q(l.widget.props.datasetInfo.imageName),w.value=q(l.widget.props.datasetInfo.textColumn),Y(),J(),_()},{deep:!0,immediate:!0}),(0,n.wB)(()=>l.widget.props,()=>{p.value=V(),u.value=X(),g.value=P(),y.value=K(),f.value=U(),v.value=q(l.widget.props.datasetInfo.imagePath),h.value=q(l.widget.props.datasetInfo.imageName),w.value=q(l.widget.props.datasetInfo.textColumn),Y(),J(),_()},{deep:!0,immediate:!0}),(0,n.hi)(()=>{C&&clearTimeout(C),C=null}),t({refresh:_,loadListData:L,refreshDataViewTable:x}),(e,t)=>{const a=R.tk,l=ve.Ik;return(0,n.uX)(),(0,n.Wv)(l,{class:"custom-chart","body-style":(0,r.R1)(Z),shadow:e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Carousel?"never":"always",style:(0,s.Tr)({border:e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Carousel?"none":void 0}),onClick:t[12]||(t[12]=e=>k())},{default:(0,n.k6)(()=>[e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).LineChart?((0,n.uX)(),(0,n.Wv)(Be,{key:0,ref_key:"innerObj",ref:i,value:e.value,onInput:O,style:{height:"100%"},data:(0,r.R1)(o),options:(0,r.R1)($),categrayColumnList:(0,r.R1)(u),valueColumnList:(0,r.R1)(p),onClick:k,onDblclick:F,onSerieClick:I},null,8,["value","data","options","categrayColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).BarChart?((0,n.uX)(),(0,n.Wv)(ze,{key:1,ref_key:"innerObj",ref:i,value:e.value,onInput:O,style:{height:"100%"},data:(0,r.R1)(o),options:(0,r.R1)($),categrayColumnList:(0,r.R1)(u),valueColumnList:(0,r.R1)(p),onClick:t[0]||(t[0]=e=>k()),onDblclick:F,onSerieClick:I},null,8,["value","data","options","categrayColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).PieChart?((0,n.uX)(),(0,n.Wv)(Wt,{key:2,ref_key:"innerObj",ref:i,value:e.value,onInput:O,style:{height:"100%"},data:(0,r.R1)(o),options:(0,r.R1)($),categrayColumnList:(0,r.R1)(u),valueColumnList:(0,r.R1)(p),onClick:t[1]||(t[1]=e=>k()),onDblclick:F,onSerieClick:I},null,8,["value","data","options","categrayColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).ScatterChart?((0,n.uX)(),(0,n.Wv)(at,{key:3,ref_key:"innerObj",ref:i,value:e.value,onInput:O,style:{height:"100%"},data:(0,r.R1)(o),options:(0,r.R1)($),categrayColumnList:(0,r.R1)(u),valueColumnList:(0,r.R1)(p),onClick:t[2]||(t[2]=e=>k()),onDblclick:F,onSerieClick:I},null,8,["value","data","options","categrayColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).PivotTable?((0,n.uX)(),(0,n.Wv)(Vt,{key:4,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(c),rowGroupColumnList:(0,r.R1)(g),columnGroupColumnList:(0,r.R1)(y),valueColumnList:(0,r.R1)(p),onClick:t[3]||(t[3]=e=>k()),onCellClick:A},null,8,["data","height","options","rowGroupColumnList","columnGroupColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).DataViewTable?((0,n.uX)(),(0,n.Wv)(Qt,{key:5,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),columnList:(0,r.R1)(f),onClick:t[4]||(t[4]=e=>k()),onRefresh:x,onCellClick:A},null,8,["data","height","options","columnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Carousel?((0,n.uX)(),(0,n.Wv)($e,{key:6,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),imagePath:(0,r.R1)(v),imageName:(0,r.R1)(h),onClick:t[5]||(t[5]=e=>k()),onSerieClick:I},null,8,["data","height","options","imagePath","imageName"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).RichText?((0,n.uX)(),(0,n.Wv)(Ht,{key:7,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),onClick:t[6]||(t[6]=e=>k())},null,8,["data","height","options"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).GaugeChart?((0,n.uX)(),(0,n.Wv)(Zt,{key:8,ref_key:"innerObj",ref:i,value:e.value,onInput:O,style:{height:"100%"},data:(0,r.R1)(o),options:(0,r.R1)($),categrayColumnList:(0,r.R1)(u),valueColumnList:(0,r.R1)(p),onClick:k,onDblclick:F},null,8,["value","data","options","categrayColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).FunnelChart?((0,n.uX)(),(0,n.Wv)(la,{key:9,ref_key:"innerObj",ref:i,value:e.value,onInput:O,style:{height:"100%"},data:(0,r.R1)(o),options:(0,r.R1)($),categrayColumnList:(0,r.R1)(u),valueColumnList:(0,r.R1)(p),onClick:k,onDblclick:F,onSerieClick:I},null,8,["value","data","options","categrayColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).RadarChart?((0,n.uX)(),(0,n.Wv)(ra,{key:10,ref_key:"innerObj",ref:i,value:e.value,onInput:O,style:{height:"100%"},data:(0,r.R1)(o),options:(0,r.R1)($),categrayColumnList:(0,r.R1)(u),valueColumnList:(0,r.R1)(p),onClick:k,onDblclick:F,onSerieClick:I},null,8,["value","data","options","categrayColumnList","valueColumnList"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).ProgressBar?((0,n.uX)(),(0,n.Wv)(ma,{key:11,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),onClick:t[7]||(t[7]=e=>k()),onDblclick:F},null,8,["data","height","options"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).ProgressCircle?((0,n.uX)(),(0,n.Wv)(Rt,{key:12,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),onClick:t[8]||(t[8]=e=>k()),onDblclick:F},null,8,["data","height","options"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).DataCard?((0,n.uX)(),(0,n.Wv)(bt,{key:13,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),onClick:t[9]||(t[9]=e=>k()),onDblclick:F},null,8,["data","height","options"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).DataProgressCard?((0,n.uX)(),(0,n.Wv)(dt,{key:14,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),onClick:t[10]||(t[10]=e=>k()),onDblclick:F},null,8,["data","height","options"])):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).CommonList?((0,n.uX)(),(0,n.Wv)(vt,{key:15,ref_key:"innerObj",ref:i,data:(0,r.R1)(o),height:(e.widget||{}).props.basicInfo.height,options:(0,r.R1)(m),onClick:t[11]||(t[11]=e=>k()),onDblclick:F},null,8,["data","height","options"])):(0,n.Q3)("",!0),e.widget.widgetType!==(0,r.R1)(j.SysCustomWidgetType).Carousel?((0,n.uX)(),(0,n.Wv)(a,{key:16,class:"refresh-btn",onClick:(0,S.D$)(_,["stop"])},{default:(0,n.k6)(()=>[(0,n.bF)((0,r.R1)(D.Refresh))]),_:1})):(0,n.Q3)("",!0)]),_:1},8,["body-style","shadow","style"])}}});const ya=(0,F.A)(ga,[["__scopeId","data-v-0f304c12"]]);var fa=ya,va=a(9202),ha=a(96399),wa=(0,n.pM)({__name:"OnlineCustomText",props:{value:{default:""},align:{default:"left"},valign:{default:"center"},bgColor:{},height:{default:25},textIndent:{default:0},fontSize:{default:14},padding:{default:2},fontColor:{default:"#383838"},fontBold:{type:Boolean,default:!1},fontItalic:{type:Boolean,default:!1}},setup(e){const t=e,a=(0,n.EW)(()=>({width:"100%","text-indent":t.textIndent+"em","text-align":t.align,"max-height":t.height?t.height+"px":void 0,"line-height":1.5,"font-size":t.fontSize+"px",color:t.fontColor,"font-weight":t.fontBold?600:400,"font-style":t.fontItalic?"italic":void 0,overflow:"hidden","word-break":"break-word"}));return(e,t)=>((0,n.uX)(),(0,n.CE)("div",{class:"online-custom-text",style:(0,s.Tr)({background:e.bgColor,height:e.height?e.height+"px":void 0,"justify-content":e.valign,padding:e.padding+"px"})},[(0,n.Lk)("div",{style:(0,s.Tr)((0,r.R1)(a))},(0,s.v_)(e.value),5)],4))}});const Ca=(0,F.A)(wa,[["__scopeId","data-v-42a0a2a6"]]);var ba=Ca,Ta=a(80277),ka=a(77195);a(38389),a(61688);const Ea={class:"online-custom-radio-group"},Ra={key:1,class:"empty-box"};var Sa=(0,n.pM)({name:"OnlineCustomRadioGroup",__name:"OnlineCustomRadioGroup",props:{modelValue:{},widget:{},supportAll:{type:Boolean,default:!0},dataList:{default:()=>[]}},emits:["update:modelValue","change"],setup(e,{expose:t,emit:a}){const l=a,i=e,o=((0,n.WQ)("form",()=>({isEdit:!1})),(0,r.KR)("temp_all")),s=(0,r.KR)(),d=e=>{s.value=e},u=e=>(s.value||{})[e]||0;return(0,n.wB)(()=>i.modelValue,e=>{o.value=null==e||""===e?"temp_all":e},{immediate:!0}),(0,n.wB)(()=>i.dataList,e=>{if(e&&e.length>0){const t=e.find(e=>e.id===o.value);null==t&&(o.value=i.supportAll?"temp_all":e[0].id)}else o.value="temp_all"},{immediate:!0}),(0,n.wB)(()=>o.value,e=>{const t=i.dataList.find(t=>t.id===e);l("update:modelValue",(t||{}).id),l("change",(t||{}).id,t)}),t({setGroupData:d}),(e,t)=>{const a=ka.v$,l=ka.q,d=R.tk;return(0,n.uX)(),(0,n.CE)("div",Ea,[(i.dataList||[]).length>0?((0,n.uX)(),(0,n.Wv)(l,{key:0,modelValue:(0,r.R1)(o),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,r.i9)(o)?o.value=e:null)},{default:(0,n.k6)(()=>[e.supportAll?((0,n.uX)(),(0,n.Wv)(a,{key:0,name:"temp_all",label:"全部",style:{width:"100%"}})):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.dataList,e=>((0,n.uX)(),(0,n.Wv)(a,{key:e.id,name:e.id,label:e.name+((0,r.R1)(s)?" ("+u(e.id)+")":""),style:{width:"100%"}},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])):((0,n.uX)(),(0,n.CE)("div",Ra,[(0,n.bF)(d,{style:{"text-align":"center",height:"40px",width:"40px","line-height":"40px",border:"1px dashed #d9dbdd","font-size":"24px","margin-right":"8px",color:"#d9dbdd","border-radius":"6px"}},{default:(0,n.k6)(()=>[(0,n.bF)((0,r.R1)(D.UploadFilled))]),_:1}),t[1]||(t[1]=(0,n.Lk)("span",null,"请点击进行编辑",-1))]))])}}});const Da=(0,F.A)(Sa,[["__scopeId","data-v-2a826bcf"]]);var Ia=Da;const Aa={class:"mobile-base-filter",style:{"margin-top":"16px"}},Wa={class:"label"},La={class:"right"},xa={key:0,class:"select"},_a={key:1,class:"expand-text"};var Fa=(0,n.pM)({__name:"MobileBaseFilter",props:{label:{},expandText:{default:"展开"},supportExpand:{type:Boolean,default:!0},select:{}},setup(e){return(e,t)=>{const a=R.tk,l=ce.S2;return(0,n.uX)(),(0,n.CE)("div",Aa,[(0,n.bF)(l,{type:"flex",justify:"space-between",align:"middle"},{default:(0,n.k6)(()=>[(0,n.Lk)("span",Wa,(0,s.v_)(e.label),1),(0,n.Lk)("div",La,[null!=e.select&&""!==e.select?((0,n.uX)(),(0,n.CE)("span",xa,(0,s.v_)(e.select),1)):(0,n.Q3)("",!0),(0,n.RG)(e.$slots,"right"),e.supportExpand?((0,n.uX)(),(0,n.CE)("span",_a,(0,s.v_)(e.expandText),1)):(0,n.Q3)("",!0),e.supportExpand?((0,n.uX)(),(0,n.Wv)(a,{key:2,class:"expand-icon"},{default:(0,n.k6)(()=>[(0,n.bF)((0,r.R1)(D.ArrowDown))]),_:1})):(0,n.Q3)("",!0)])]),_:3}),(0,n.RG)(e.$slots,"default")])}}});const Na=(0,F.A)(Fa,[["__scopeId","data-v-1ccd29d8"]]);var Oa=Na,Ba=(0,n.pM)({__name:"MobileSelectFilter",props:{label:{},dictDataList:{default:()=>[]}},setup(e){return(e,t)=>{const a=Ge.uD,l=ce.S2;return(0,n.uX)(),(0,n.Wv)(Oa,{label:e.label},{default:(0,n.k6)(()=>[(0,n.bF)(l,{gutter:8},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.dictDataList,(e,t)=>((0,n.uX)(),(0,n.Wv)(a,{class:"select-item",span:8,key:e.id},{default:(0,n.k6)(()=>[(0,n.Lk)("div",{class:(0,s.C4)(["text",{active:0===t}])},(0,s.v_)(e.name),3)]),_:2},1024))),128))]),_:1})]),_:1},8,["label"])}}});const Ma=(0,F.A)(Ba,[["__scopeId","data-v-6d13438d"]]);var Xa=Ma,Va=(0,n.pM)({__name:"MobileInputFilter",props:{label:{},placeholder:{}},setup(e){return(e,t)=>{const a=(0,n.g2)("van-search");return(0,n.uX)(),(0,n.Wv)(Oa,{label:e.label,supportExpand:!1},{default:(0,n.k6)(()=>[(0,n.bF)(a,{style:{padding:"0","margin-top":"8px"},placeholder:e.placeholder},null,8,["placeholder"])]),_:1},8,["label"])}}});const Pa=Va;var Ua=Pa,Ka=(0,n.pM)({__name:"MobileSwitchFilter",props:{label:{},activeColor:{},inactiveColor:{}},setup(e){return(e,t)=>{const a=(0,n.g2)("van-switch");return(0,n.uX)(),(0,n.Wv)(Oa,{label:e.label,supportExpand:!1},{right:(0,n.k6)(()=>[(0,n.bF)(a,{size:"22px","active-color":e.activeColor,"inactive-color":e.inactiveColor},null,8,["active-color","inactive-color"])]),_:1},8,["label"])}}});const za=Ka;var Qa=za,Ga=(0,n.pM)({__name:"MobileDateRangeFilter",props:{label:{},placeholder:{}},setup(e){return(e,t)=>((0,n.uX)(),(0,n.Wv)(Oa,{label:e.label,supportExpand:!1},{default:(0,n.k6)(()=>t[0]||(t[0]=[(0,n.Lk)("div",{class:"date-range"},[(0,n.Lk)("span",null,"开始日期"),(0,n.Lk)("div",{style:{width:"12px",height:"1px",background:"#999"}}),(0,n.Lk)("span",null,"结束日期"),(0,n.Lk)("i",{class:"icon el-icon-date"})],-1)])),_:1,__:[0]},8,["label"]))}});const Ya=(0,F.A)(Ga,[["__scopeId","data-v-12d2b40d"]]);var ja=Ya;const Ha={class:"number-range"},Ja={class:"text"};var qa=(0,n.pM)({__name:"MobileNumberRangeFilter",props:{label:{},quickSelect:{},startPlaceholder:{default:"最低价格"},endPlaceholder:{default:"最高价格"}},setup(e){return(e,t)=>{const a=Ge.uD,l=ce.S2;return(0,n.uX)(),(0,n.Wv)(Oa,{label:e.label,supportExpand:!1},{default:(0,n.k6)(()=>[(0,n.Lk)("div",Ha,[(0,n.Lk)("span",null,(0,s.v_)(e.startPlaceholder),1),t[0]||(t[0]=(0,n.Lk)("div",{style:{width:"12px",height:"1px",margin:"0 10px",background:"#999"}},null,-1)),(0,n.Lk)("span",null,(0,s.v_)(e.endPlaceholder),1)]),(0,n.bF)(l,{gutter:8},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.quickSelect,e=>((0,n.uX)(),(0,n.Wv)(a,{class:"select-item",span:8,key:e.id},{default:(0,n.k6)(()=>[(0,n.Lk)("div",Ja,(0,s.v_)(e.name),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["label"])}}});const $a=(0,F.A)(qa,[["__scopeId","data-v-64aa5692"]]);var Za=$a;const el={class:"qr-code"};function tl(e,t,a,l,i,o){return(0,n.uX)(),(0,n.CE)("div",el,[(0,n.Lk)("canvas",{ref:"canvas",style:(0,s.Tr)({width:this.width,height:this.width})},null,4)])}var al=a(78420),ll={name:"QrCode",props:{value:{type:String,default:""},width:{type:Number,default:100}},watch:{value:{handler(e){this.generateQRCode(e)},immediate:!0},width:{handler(e){this.generateQRCode(this.value)}}},methods:{generateQRCode(e){null!=e&&""!==e?this.$refs.canvas&&al.mo(this.$refs.canvas,e,{errorCorrectionLevel:"H",width:this.width,height:this.width},e=>{e&&console.error(e),console.log("QR Code generated successfully!")}):console.warn("No text provided for QR Code generation.")}},mounted(){this.generateQRCode(this.value)}};const il=(0,F.A)(ll,[["render",tl]]);var ol=il;const nl={class:"bar-code"},rl={ref:"canvas",style:{width:"100%"}};function sl(e,t,a,l,i,o){return(0,n.uX)(),(0,n.CE)("div",nl,[(0,n.Lk)("canvas",rl,null,512)])}var dl=a(6240),ul=a.n(dl),pl={name:"BarCode",props:{value:{type:String,default:""},showText:{type:Boolean,default:!1},text:{type:String,default:""}},watch:{value:{handler(e){this.generateBarCode(e)},immediate:!0},showText:{handler(e){this.generateBarCode(this.value)}},text:{handler(e){this.generateBarCode(this.value)}}},methods:{generateBarCode(e){if(this.$refs.canvas){const t={text:this.text||e,displayValue:this.showText,fontSize:10,height:20,width:2};console.log("Generating barcode with text:",this.$refs.canvas,t.text),ul()(this.$refs.canvas,e,t)}}},mounted(){this.generateBarCode(this.value)}};const cl=(0,F.A)(pl,[["render",sl]]);var ml=cl,gl=a(70483),yl=a.p+"img/map.c29960b1.png";const fl=["src"],vl={key:10,style:{width:"100%",height:"160px"},controls:""};var hl=(0,n.pM)({__name:"OnlineCustomWidget",props:{value:{type:[String,Boolean,Date,Number,Object,Array]},widget:{},isEdit:{type:Boolean},masterTableData:{}},emits:["change","update:value","update:modelValue","update:widget","input","widgetClick"],setup(e,{expose:t,emit:a}){const R=a,S=e,D=(0,n.WQ)("form",()=>({isEdit:!1})),I=(0,n.WQ)("parentWidget",null),{propsWidget:A,onWidgetClick:W}=(0,gl.Q)(S,R),L=(0,r.KR)([]),x=(0,r.KR)(),_=(0,n.EW)(()=>-1!==[j.SysCustomWidgetType.Select,j.SysCustomWidgetType.CheckBox,j.SysCustomWidgetType.Cascader,j.SysCustomWidgetType.DictSelect,j.SysCustomWidgetType.Tree,j.SysCustomWidgetType.UserSelect].indexOf(S.widget.widgetType)&&(S.widget.widgetType===j.SysCustomWidgetType.CheckBox||(D().formType===j.SysOnlineFormType.QUERY||D().formType===j.SysOnlineFormType.ADVANCE_QUERY||D().formType===j.SysOnlineFormType.GROUP_QUERY?!(!S.widget.column||S.widget.column.filterType!==Y.SysOnlineColumnFilterType.MULTI_SELECT_FILTER):D().formType===j.SysOnlineFormType.REPORT?j.SysCustomWidgetType.CheckBox===S.widget.widgetType:S.widget.column&&S.widget.column.fieldKind===Y.SysOnlineFieldKind.MULTI_SELECT))),F=(0,n.EW)(()=>-1!==[j.SysCustomWidgetType.MobileRadioFilter,j.SysCustomWidgetType.MobileCheckBoxFilter,j.SysCustomWidgetType.MobileInputFilter,j.SysCustomWidgetType.MobileDateRangeFilter,j.SysCustomWidgetType.MobileNumberRangeFilter,j.SysCustomWidgetType.MobileSwitchFilter].indexOf(S.widget.widgetType)),N=(0,n.EW)(()=>S.widget.props.supportAll?[{id:"",name:"全部"},...L.value]:L.value),X=(0,n.EW)(()=>({width:S.widget.widgetType!==j.SysCustomWidgetType.Link?"100%":void 0})),V=(0,n.EW)(()=>{if(-1===[j.SysCustomWidgetType.Text,j.SysCustomWidgetType.Image,j.SysCustomWidgetType.Upload,j.SysCustomWidgetType.Link,j.SysCustomWidgetType.Signature].indexOf(S.widget.widgetType)&&D().readOnly)return Z;let e=D().mode;switch(S.widget.widgetType){case j.SysCustomWidgetType.Label:return"pc"!==e?y.D0:Z;case j.SysCustomWidgetType.Input:return"pc"!==e?y.D0:d.WK;case j.SysCustomWidgetType.NumberInput:return u.lq;case j.SysCustomWidgetType.NumberRange:return E.A;case j.SysCustomWidgetType.Switch:return"pc"!==e?y.D0:p.qi;case j.SysCustomWidgetType.Radio:return"pc"!==e?y.D0:o.MQ;case j.SysCustomWidgetType.CheckBox:return"pc"!==e?y.D0:i.o5;case j.SysCustomWidgetType.Select:return"pc"!==e?y.D0:l.AV;case j.SysCustomWidgetType.Cascader:return"pc"!==e?y.D0:c._m;case j.SysCustomWidgetType.Date:return"pc"!==e?y.D0:m.MG;case j.SysCustomWidgetType.DateRange:return m.MG;case j.SysCustomWidgetType.Upload:return"pc"!==e?y.D0:ue;case j.SysCustomWidgetType.RichEditor:return Q;case j.SysCustomWidgetType.Link:return g.C4;case j.SysCustomWidgetType.Signature:return"pc"!==e?y.D0:O;case j.SysCustomWidgetType.UserSelect:return"pc"!==e?y.D0:M.A;case j.SysCustomWidgetType.DeptSelect:return"pc"!==e?y.D0:B.A;case j.SysCustomWidgetType.DataSelect:return"pc"!==e?y.D0:va.A;case j.SysCustomWidgetType.DictSelect:return"pc"!==e?y.D0:ha.A;case j.SysCustomWidgetType.Tree:return fe;case j.SysCustomWidgetType.Rate:return y.D0;case j.SysCustomWidgetType.Stepper:return y.D0;case j.SysCustomWidgetType.Calendar:return y.D0;case j.SysCustomWidgetType.LineChart:case j.SysCustomWidgetType.PieChart:case j.SysCustomWidgetType.BarChart:case j.SysCustomWidgetType.ScatterChart:case j.SysCustomWidgetType.PivotTable:case j.SysCustomWidgetType.DataViewTable:case j.SysCustomWidgetType.Carousel:case j.SysCustomWidgetType.RichText:case j.SysCustomWidgetType.GaugeChart:case j.SysCustomWidgetType.FunnelChart:case j.SysCustomWidgetType.RadarChart:case j.SysCustomWidgetType.ProgressBar:case j.SysCustomWidgetType.ProgressCircle:case j.SysCustomWidgetType.DataCard:case j.SysCustomWidgetType.DataProgressCard:case j.SysCustomWidgetType.CommonList:return fa;case j.SysCustomWidgetType.Text:return ba;case j.SysCustomWidgetType.Image:return Ta.A;case j.SysCustomWidgetType.RadioButtonGroup:return Ia;case j.SysCustomWidgetType.MobileRadioFilter:case j.SysCustomWidgetType.MobileCheckBoxFilter:return Xa;case j.SysCustomWidgetType.MobileInputFilter:return Ua;case j.SysCustomWidgetType.MobileSwitchFilter:return Qa;case j.SysCustomWidgetType.MobileDateRangeFilter:return ja;case j.SysCustomWidgetType.MobileNumberRangeFilter:return Za;case j.SysCustomWidgetType.QRCODE:return"pc"!==e?y.D0:ol;case j.SysCustomWidgetType.BARCODE:return"pc"!==e?y.D0:ml;case j.SysCustomWidgetType.MAP:return"pc"!==e?y.D0:"";case j.SysCustomWidgetType.Video:return"pc"!==e?y.D0:"";default:return console.warn("widget getComponent 未知类型"),"div"}}),P=(0,n.EW)(()=>{let e=S.widget.widgetType===j.SysCustomWidgetType.Link?S.widget.props.href:void 0;return!D().isEdit&&S.widget.eventInfo&&"function"===typeof S.widget.eventInfo[j.OnlineFormEventType.LINK_HERF]&&(e=S.widget.eventInfo[j.OnlineFormEventType.LINK_HERF](S.widget.props.href,D().instanceData())),e}),U=()=>{D().isEdit||S.widget.widgetType===j.SysCustomWidgetType.Link&&(S.widget.eventInfo&&S.widget.eventInfo[j.OnlineFormEventType.LINK_CLICK]?S.widget.eventInfo[j.OnlineFormEventType.LINK_CLICK](P.value,D().instanceData()):P.value&&window.open(P.value,"_blank"))},K=(0,n.EW)(()=>-1!==[j.SysCustomWidgetType.Select,j.SysCustomWidgetType.CheckBox,j.SysCustomWidgetType.Radio,j.SysCustomWidgetType.Cascader,j.SysCustomWidgetType.Tree,j.SysCustomWidgetType.RadioButtonGroup,j.SysCustomWidgetType.MobileCheckBoxFilter,j.SysCustomWidgetType.MobileRadioFilter].indexOf(S.widget.widgetType)),z=(0,n.EW)(()=>{if(null!=S.widget&&null!=S.widget.column)switch(S.widget.column.objectFieldType){case"String":return"String";case"Date":return"Date";case"Boolean":return"Boolean";case"Integer":case"Long":case"Float":case"Double":case"BigDecimal":return"Number";default:return}}),H=(0,n.EW)({get(){if((S.widget.widgetType===j.SysCustomWidgetType.BARCODE||S.widget.widgetType===j.SysCustomWidgetType.QRCODE)&&D().isEdit)return"1234567890";let e=void 0===S.value?"":S.value;K.value&&(e=null==e?"":e+""),_.value&&S.value&&"string"===typeof e&&(e=e.split(","),Array.isArray(e)&&(e=e.filter(e=>null!=e&&""!==e)));let t=z.value;if(S.widget.widgetType===j.SysCustomWidgetType.Text)return S.widget&&S.widget.column&&"Date"===S.widget.column.objectFieldType&&!D().isEdit?(0,G.Yq)(e,S.widget.props.dateType||"YYYY-MM-DD HH:mm:ss"):e;if(S.widget.widgetType===j.SysCustomWidgetType.Switch){let a=(S.widget.column||{}).dictId;return(D().readOnly||S.widget.props.readOnly)&&null!=a||("Number"===t?e=0!==e&&null!=e:"String"===t?e="true"===e:"Boolean"!==t&&(e=!1)),e}if(S.widget.widgetType===j.SysCustomWidgetType.CheckBox)return"mobile"===D().mode?void 0:e||[];if(S.widget.widgetType===j.SysCustomWidgetType.Cascader){if(_.value){if(D().readOnly)return e;if(Array.isArray(e))return e.map(e=>{let t=(0,G.Zi)(L.value,e);return Array.isArray(t)&&t.length>0?t:null}).filter(e=>null!=e);{let t=(0,G.Zi)(L.value,e.toString());return t||[]}}{let t=(0,G.Zi)(L.value,e.toString());return t.length>0?t:e}}return S.widget.widgetType,j.SysCustomWidgetType.NumberInput,e},set(e){ne(e)}}),J=(0,n.EW)(()=>{if(S.widget.widgetType!==j.SysCustomWidgetType.Upload)return!1;let e=S.widget.bindData.column||S.widget.column;return!!e&&e.fieldKind===Y.SysOnlineFieldKind.UPLOAD_IMAGE}),q=(0,n.EW)(()=>-1!==[j.SysCustomWidgetType.Select,j.SysCustomWidgetType.Cascader,j.SysCustomWidgetType.Date,j.SysCustomWidgetType.UserSelect,j.SysCustomWidgetType.DeptSelect,j.SysCustomWidgetType.Calendar].indexOf(S.widget.widgetType)),$=(0,r.KR)((0,G.yk)()),ee=(0,n.EW)(()=>{let e={...S.widget.props||{}};if(S.widget.widgetType===j.SysCustomWidgetType.Date||S.widget.widgetType===j.SysCustomWidgetType.DateRange){let t="YYYY-MM-DD";switch(S.widget.props.type){case"date":case"daterange":t="YYYY-MM-DD";break;case"month":case"monthrange":t="YYYY-MM";break;case"year":t="YYYY";break;case"datetime":case"datetimerange":t="YYYY-MM-DD HH:mm:ss";break;default:t="YYYY-MM-DD HH:mm:ss";break}e["format"]=t,e["value-format"]="YYYY-MM-DD HH:mm:ss"}return S.widget.widgetType===j.SysCustomWidgetType.Input&&"textarea"===e.type&&e["autosize"]&&(e["autosize"]={minRows:e["rows"]},delete e["rows"]),{...e,clearable:!0,filterable:!0,readonly:"mobile"===D().mode&&j.SysCustomWidgetType.Label===S.widget.widgetType||void 0,readOnly:S.widget.widgetType===j.SysCustomWidgetType.Upload?D().readOnly||e.readOnly:void 0,options:S.widget.widgetType===j.SysCustomWidgetType.Cascader?L.value:void 0,props:S.widget.widgetType===j.SysCustomWidgetType.Cascader?{label:"name",value:"id",multiple:_.value,checkStrictly:!0}:void 0,"disabled-date":S.widget.widgetType===j.SysCustomWidgetType.Date?(S.widget.eventInfo||{})[j.OnlineFormEventType.DISABLED_DATE]:void 0,operationList:S.widget.operationList,multiple:_.value,"collapse-tags":_.value,dataList:S.widget.widgetType===j.SysCustomWidgetType.Tree||S.widget.widgetType===j.SysCustomWidgetType.RadioButtonGroup?L.value:void 0,dictDataList:F.value?N.value:void 0,href:P.value,label:"mobile"!==D().mode||V.value!==y.D0&&!F.value?void 0:S.widget.showName,widget:S.widget,extraData:S.widget.widgetType===j.SysCustomWidgetType.DataSelect?D().formData:{}}});(0,n.wB)(()=>ee.value.autosize,()=>{$.value=(0,G.yk)()},{immediate:!0,deep:!0});const te=(0,r.KR)(!1),ae=()=>{const e=D().formAuth&&D().formAuth()&&D().formAuth().pc?D().formAuth().pc[S.widget.variableName]:null;e&&e.disabled?te.value=!0:S.widget.eventInfo&&S.widget.eventInfo[j.OnlineFormEventType.DISABLE]?te.value=S.widget.eventInfo[j.OnlineFormEventType.DISABLE](D().instanceData()):S.widget.widgetType===j.SysCustomWidgetType.Signature?te.value=S.widget.props.disabled||D().readOnly:te.value=S.widget.props.disabled},le=(0,r.KR)(!0),ie=()=>{le.value=D().getWidgetVisible(S.widget)};(0,n.wB)(()=>D().instanceData().formData,()=>{ae(),ie()},{immediate:!0,deep:!0});const oe=e=>{let t=z.value;return S.widget?.widgetType===j.SysCustomWidgetType.Switch?"Number"===t?e?1:0:"String"===t?e?"true":"false":"Boolean"===t&&e:S.widget.widgetType===j.SysCustomWidgetType.Cascader?_.value&&Array.isArray(e)?e.map(e=>e[e.length-1]).filter(e=>null!=e):Array.isArray(e)?e[e.length-1]:void 0:e},ne=e=>{let t;if(e){if(e instanceof InputEvent||e instanceof Event)return;t=oe(e),_.value&&Array.isArray(t)&&(t=0===t.length?"":t.join(",")+",")}else t=oe(e);R("update:value",t),R("update:modelValue",t),R("input",t)},re=(e,t=void 0,a=void 0)=>{let l;l=oe(e),null==a&&null!=e&&(_.value?a=e.map(e=>S.widget.widgetType===j.SysCustomWidgetType.Cascader?(Array.isArray(e)&&(e=e[e.length-1]),(0,G.Ee)(L.value,e,"id","children")):(0,G.PH)(L.value,e,"id")).filter(e=>null!=e):S.widget.widgetType===j.SysCustomWidgetType.Cascader?(Array.isArray(e)&&(e=e[e.length-1]),a=(0,G.Ee)(L.value,e.toString(),"id","children")):a=(0,G.PH)(L.value,e.toString(),"id")),R("change",l,{dictData:a,selectRow:t})},se=()=>{S.widget.eventInfo&&S.widget.eventInfo[j.OnlineFormEventType.BLUR]&&S.widget.eventInfo[j.OnlineFormEventType.BLUR](D().instanceData())},de=()=>{S.widget.eventInfo&&S.widget.eventInfo[j.OnlineFormEventType.FOCUS]&&S.widget.eventInfo[j.OnlineFormEventType.FOCUS](D().instanceData())},pe=()=>{null!=S.widget&&K.value&&(L.value=[],setTimeout(()=>{let e=(S.widget.props.dictInfo||{}).dict;if(e&&D().getDictDataList){let t,a=D().getDropdownParams(S.widget),l=!1;e.dictType===j.SysOnlineDictType.TABLE&&e.treeFlag&&S.widget.widgetType===j.SysCustomWidgetType.Select&&0===Object.keys(a).length&&(l=!0),t=(D().pageCode,D().getDictDataList(e,a,l)),t.then(e=>{e.forEach(e=>{e.id=e.id+"",e.parentId&&(e.parentId=e.parentId+"")}),S.widget.widgetType===j.SysCustomWidgetType.Cascader&&(e=(0,G.BN)(e,"id","parentId")),S.widget.eventInfo&&S.widget.eventInfo[j.OnlineFormEventType.DROPDOWN_CHANGE]&&(e=S.widget.eventInfo[j.OnlineFormEventType.DROPDOWN_CHANGE](e)),L.value=e}).catch(e=>{console.log(e)})}},30))},ce=(0,n.nI)(),me=e=>{const t=ce?.proxy;return t?t.$refs[e]:null},ge=()=>{if(S.widget.widgetType===j.SysCustomWidgetType.RichEditor){const e=me(S.widget.variableName);if(e&&"function"===typeof e.getHtml)return e.getHtml()}},ye=()=>{ne(void 0),re(void 0),(0,n.dY)(()=>{pe()})},ve=()=>{const e=me(S.widget.variableName);e&&"function"===typeof e.refresh&&e.refresh()},he=()=>me(S.widget.variableName);return t({getHtml:ge,reset:ye,refresh:ve,getRef:he}),(0,n.wB)(()=>S.widget,()=>{S.widget&&pe()},{deep:!0,immediate:!0}),(0,n.sV)(()=>{A.value.hasParent=null!=I,A.value.widgetImpl={getHtml:ge,reset:ye,refresh:ve}}),(e,t)=>{const a=o.Zh,d=o.ll,u=i.dI,p=l.P9,c=(0,n.g2)("Uploader");return S.widget.bindData.dataType!==(0,r.R1)(j.SysCustomWidgetBindDataType).Column||null!=S.widget.column||e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Text||e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Link||null!=(0,r.R1)(D)().pageCode||"mobile"===(0,r.R1)(D)().mode?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,r.R1)(le)?((0,n.uX)(),(0,n.Wv)((0,n.$y)((0,r.R1)(V)),(0,n.v6)({key:0},(0,r.R1)(ee),{ref:e.widget.variableName,key:(0,r.R1)($),style:(0,r.R1)(X),disabled:(0,r.R1)(te),widget:e.widget,modelValue:(0,r.R1)(H),"onUpdate:modelValue":t[5]||(t[5]=e=>(0,r.i9)(H)?H.value=e:null),value:(0,r.R1)(H),onInput:ne,onChange:re,change:re,onWidgetClick:(0,r.R1)(W),onBlur:se,onFocus:de}),(0,n.eX)({default:(0,n.k6)(()=>["pc"===(0,r.R1)(D)().mode?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Radio?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[e.widget.props.showButton?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)((0,r.R1)(N),e=>((0,n.uX)(),(0,n.Wv)(a,{key:e.id,value:e.id},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)(e.name),1)]),_:2},1032,["value"]))),128)):((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)((0,r.R1)(N),e=>((0,n.uX)(),(0,n.Wv)(d,{key:e.id,value:e.id},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)(e.name),1)]),_:2},1032,["value"]))),128))],64)):e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).CheckBox?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)((0,r.R1)(N),e=>((0,n.uX)(),(0,n.Wv)(u,{key:e.id,value:e.id},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)(e.name),1)]),_:2},1032,["value"]))),128)):e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Select?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:2},(0,n.pI)((0,r.R1)(N),e=>((0,n.uX)(),(0,n.Wv)(p,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128)):(0,n.Q3)("",!0),e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Link?((0,n.uX)(),(0,n.CE)("span",{key:3,onClick:U},(0,s.v_)(e.widget.props.showText||e.widget.showName),1)):(0,n.Q3)("",!0)],64)):(0,n.Q3)("",!0)]),_:2},["pc"===(0,r.R1)(D)().mode&&e.widget.widgetType===(0,r.R1)(j.SysCustomWidgetType).Cascader?{name:"default",fn:(0,n.k6)(({data:e})=>[(0,n.Lk)("span",null,(0,s.v_)(e.name),1)]),key:"0"}:void 0,"mobile"===(0,r.R1)(D)().mode&&e.widget.widgetType!==(0,r.R1)(j.SysCustomWidgetType).Input?{name:"input",fn:(0,n.k6)(()=>[(0,r.R1)(j.SysCustomWidgetType).Radio===e.widget.widgetType?((0,n.uX)(),(0,n.Wv)((0,r.R1)(f.z6),(0,n.v6)({key:0},(0,r.R1)(ee),{modelValue:(0,r.R1)(x),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,r.i9)(x)?x.value=e:null)}),{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,r.R1)(N),e=>((0,n.uX)(),(0,n.Wv)((0,r.R1)(v.sx),{class:(0,s.C4)({"van-vertical-item":"vertical"===(0,r.R1)(ee).direction}),key:e.id,name:e.id},{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)(e.name),1)]),_:2},1032,["class","name"]))),128))]),_:1},16,["modelValue"])):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).CheckBox===e.widget.widgetType?((0,n.uX)(),(0,n.Wv)((0,r.R1)(h.$Q),(0,n.v6)({key:1},(0,r.R1)(ee),{value:(0,r.R1)(x),"onUpdate:value":t[1]||(t[1]=e=>(0,r.i9)(x)?x.value=e:null)}),{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,r.R1)(N),e=>((0,n.uX)(),(0,n.Wv)((0,r.R1)(w.Sc),(0,n.v6)({ref_for:!0},(0,r.R1)(ee),{class:{"van-vertical-item":"vertical"===(0,r.R1)(ee).direction},key:e.id,name:e.id,shape:"square"}),{default:(0,n.k6)(()=>[(0,n.eW)((0,s.v_)(e.name),1)]),_:2},1040,["class","name"]))),128))]),_:1},16,["value"])):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).Rate===e.widget.widgetType?((0,n.uX)(),(0,n.Wv)((0,r.R1)(C.tt),(0,n.v6)({key:2},(0,r.R1)(ee),{value:(0,r.R1)(x),"onUpdate:value":t[2]||(t[2]=e=>(0,r.i9)(x)?x.value=e:null)}),null,16,["value"])):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).Switch===e.widget.widgetType?((0,n.uX)(),(0,n.Wv)((0,r.R1)(b.dO),(0,n.v6)({key:3},(0,r.R1)(ee),{value:(0,r.R1)(x),"onUpdate:value":t[3]||(t[3]=e=>(0,r.i9)(x)?x.value=e:null)}),null,16,["value"])):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).Upload===e.widget.widgetType&&(0,r.R1)(J)?((0,n.uX)(),(0,n.Wv)(c,(0,n.v6)({key:4},(0,r.R1)(ee),{deletable:!0}),null,16)):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).Upload!==e.widget.widgetType||(0,r.R1)(J)?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)((0,r.R1)(T.$n),{key:5,icon:"plus",type:"default",size:"small"},{default:(0,n.k6)(()=>t[7]||(t[7]=[(0,n.eW)(" 上传文件 ")])),_:1,__:[7]})),(0,r.R1)(j.SysCustomWidgetType).Stepper===e.widget.widgetType?((0,n.uX)(),(0,n.Wv)((0,r.R1)(k.C1),(0,n.v6)({key:6},(0,r.R1)(ee),{value:(0,r.R1)(x),"onUpdate:value":t[4]||(t[4]=e=>(0,r.i9)(x)?x.value=e:null)}),null,16,["value"])):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).QRCODE===e.widget.widgetType?((0,n.uX)(),(0,n.Wv)(ol,{key:7,value:"qrcode",width:e.widget.props.width||100},null,8,["width"])):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).BARCODE===e.widget.widgetType?((0,n.uX)(),(0,n.Wv)(ml,{key:8,value:"barcode",showText:e.widget.props.showText,text:e.widget.props.text},null,8,["showText","text"])):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).MAP===e.widget.widgetType?((0,n.uX)(),(0,n.CE)("img",{key:9,style:{width:"100%"},src:(0,r.R1)(yl)},null,8,fl)):(0,n.Q3)("",!0),(0,r.R1)(j.SysCustomWidgetType).Video===e.widget.widgetType?((0,n.uX)(),(0,n.CE)("video",vl," 您的浏览器不支持 video 标签。 ")):(0,n.Q3)("",!0)]),key:"1"}:void 0,"mobile"===(0,r.R1)(D)().mode&&(0,r.R1)(q)?{name:"right-icon",fn:(0,n.k6)(()=>[t[8]||(t[8]=(0,n.Lk)("i",{class:"van-icon van-icon-arrow van-cell__right-icon"},null,-1))]),key:"2"}:void 0]),1040,["style","disabled","widget","modelValue","value","onWidgetClick"])):(0,n.Q3)("",!0)],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,r.R1)(le)?((0,n.uX)(),(0,n.Wv)((0,n.$y)((0,r.R1)(V)),{key:0,ref:e.widget.variableName,style:(0,s.Tr)((0,r.R1)(X)),disabled:(0,r.R1)(te),widget:e.widget,modelValue:(0,r.R1)(H),"onUpdate:modelValue":t[6]||(t[6]=e=>(0,r.i9)(H)?H.value=e:null),value:(0,r.R1)(H),onChange:re,onInput:ne,change:re,onWidgetClick:(0,r.R1)(W)},null,40,["style","disabled","widget","modelValue","value","onWidgetClick"])):(0,n.Q3)("",!0)],64))}}});const wl=(0,F.A)(hl,[["__scopeId","data-v-88257504"]]);var Cl=wl},42587:function(e,t,a){a.d(t,{A:function(){return W}});var l=a(25136),i=(a(97042),a(69957),a(72855)),o=(a(64491),a(72153),a(31328),a(91542)),n=(a(37985),a(92358)),r=(a(5954),a(65451)),s=(a(63390),a(18111),a(22489),a(61701),a(14603),a(47566),a(98721),a(56768)),d=a(24232),u=a(90144),p=a(45130),c=a(26695),m=a(57477),g=a(89277),y=a(31932),f=a(13180),v=a(692),h=a(96027),w=a(27007);const C={class:"custom-upload"},b={class:"upload-btn"},T={key:0,class:"file-count"},k=["onClick"],E={key:0,style:{height:"1px",background:"#eeeff1"}},R={key:1,class:"upload-file-list"},S={key:0};var D=(0,s.pM)({__name:"index",props:{modelValue:{default:()=>[]},size:{default:"default"},type:{default:"dropdown"},itemType:{default:"card"},direction:{default:"vertical"},supportPreview:{type:Boolean,default:!0},supportDownload:{type:Boolean,default:!0},limit:{},disabled:{type:Boolean,default:!1},action:{default:""},headers:{default:{}},multiple:{type:Boolean,default:!1},data:{default:{}},name:{default:"file"},accept:{},beforeUpload:{},beforeRemove:{},onExceed:{}},emits:["update:modelValue","error","success","remove","change"],setup(e,{emit:t}){const{downloadFile:a}=(0,g.m)(),{getUploadHeaders:D,getUploadActionUrl:I,parseUploadData:A,fileListToJson:W}=(0,y.v)(),L=e,x=((0,u.KR)(!1),(0,u.KR)(!1)),_=(0,u.KR)(0),F=(0,f.D)(L.limit||0),N=(0,s.EW)(()=>(L.modelValue||[]).map(e=>({...e,type:(0,w.ti)(e.name)}))),O=(0,s.EW)(()=>{let e="card"===L.itemType&&(0===L.limit||null==L.limit||N.value.length<L.limit);return e}),B=t,M=(e,t)=>{L.supportPreview?(_.value=t.findIndex(t=>t.url===e.url),(0,s.dY)(()=>{x.value=!0})):L.supportDownload&&a(e.url,e.name)},X=(e,t,a)=>{e.success?(t.downloadUri=e.data.downloadUri,t.filename=e.data.filename,t.uploadPath=e.data.uploadPath,t.url=URL.createObjectURL(t.raw),F.onFileChange(t,a),console.log("uploadWidget.fileList",F.fileList.value),G(F.fileList.value),B("success",e,t,a)):(c.nk.error(e.message),B("error",e,t,a))},V=(e,t)=>{null!=e&&null!=t&&(t=t.filter(t=>t.url!==e.url)),F.onFileChange(e,t),G(F.fileList.value),B("remove",e,t)},P=(e,t,a)=>{c.nk.error("文件上传失败")},U=(e,t)=>{L.onExceed&&"function"===typeof L.onExceed?L.onExceed(e,t):c.nk.error("已经超出最大上传个数限制")},K=(e,t)=>{F.onFileChange(e,t),G(F.fileList.value),B("remove",e,t)},z=(0,u.KR)(null),Q=()=>{z.value&&z.value.click()},G=e=>{B("update:modelValue",e),B("change",e)};return(0,s.wB)(()=>L.modelValue,e=>{F.fileList.value=e},{immediate:!0}),(e,t)=>{const a=r.S2,c=n.j5,g=o.tk,y=i.c6,f=i.Iy,w=i.dW,D=l.S2;return(0,s.uX)(),(0,s.CE)("div",C,["dropdown"===e.type?((0,s.uX)(),(0,s.Wv)(w,{key:0,size:e.size,"split-button":"",type:"default",trigger:"click",class:(0,d.C4)({"hide-list":(0,u.R1)(N).length<=0})},{dropdown:(0,s.k6)(()=>[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,u.R1)(N),(t,l)=>((0,s.uX)(),(0,s.Wv)(y,{key:t.url},{default:(0,s.k6)(()=>[(0,s.bF)(a,{class:"dropdown-file-item",type:"flex",justify:"space-between",align:"middle",style:{height:"36px"}},{default:(0,s.k6)(()=>[(0,s.Lk)("span",{onClick:e=>M(t,(0,u.R1)(N)),style:{"flex-grow":"1"}},(0,d.v_)(t.name),9,k),e.disabled?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(g,{key:0,style:{"margin-left":"8px"},onClick:(0,p.D$)(e=>V(t,(0,u.R1)(F).fileList.value),["stop"])},{default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(m.CircleCloseFilled))]),_:2},1032,["onClick"]))]),_:2},1024),l!==(0,u.R1)(N).length-1?((0,s.uX)(),(0,s.CE)("div",E)):(0,s.Q3)("",!0)]),_:2},1024))),128))]),_:1})]),default:(0,s.k6)(()=>[(0,s.bF)(c,{name:e.name,style:{width:"100%"},headers:e.headers,action:e.action,data:e.data,limit:e.limit,disabled:e.disabled,multiple:e.multiple,accept:e.accept,"show-file-list":!1,"file-list":(0,u.R1)(N),"before-upload":e.beforeUpload,"before-remove":e.beforeRemove,"on-exceed":U,"on-success":X,"on-remove":V,"on-error":P},{default:(0,s.k6)(()=>[(0,s.bF)(a,{type:"flex",align:"middle"},{default:(0,s.k6)(()=>[(0,s.Lk)("span",b,[t[1]||(t[1]=(0,s.eW)(" 上传文件 ")),(0,u.R1)(F).fileList.length>0?((0,s.uX)(),(0,s.CE)("div",T,(0,d.v_)((0,u.R1)(N).length),1)):(0,s.Q3)("",!0)])]),_:1})]),_:1},8,["name","headers","action","data","limit","disabled","multiple","accept","file-list","before-upload","before-remove"])]),_:1},8,["size","class"])):"expand"===e.type?((0,s.uX)(),(0,s.Wv)(c,{key:1,class:(0,d.C4)(["expand-upload",e.itemType]),name:e.name,style:{width:"100%"},headers:e.headers,action:e.action,data:e.data,limit:e.limit,disabled:e.disabled||null!=e.limit&&(0,u.R1)(N).length>=e.limit,multiple:e.multiple,accept:e.accept,"show-file-list":!1,"file-list":(0,u.R1)(N),"before-upload":e.beforeUpload,"before-remove":e.beforeRemove,"on-exceed":U,"on-success":X,"on-remove":V,"on-error":P},{default:(0,s.k6)(()=>["card"===e.itemType?((0,s.uX)(),(0,s.Wv)(a,{key:0,type:"flex",style:{"flex-wrap":"wrap"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",{ref_key:"uploadBtn",ref:z,style:{width:"0px",height:"0px",border:"none"}},null,512)]),_:1})):((0,s.uX)(),(0,s.CE)("div",R,[(0,s.bF)(D,{size:e.size,disabled:e.disabled||null!=e.limit&&(0,u.R1)(N).length>=e.limit,type:"primary"},{default:(0,s.k6)(()=>t[2]||(t[2]=[(0,s.eW)(" 点击上传 ")])),_:1,__:[2]},8,["size","disabled"])]))]),_:1},8,["class","name","headers","action","data","limit","disabled","multiple","accept","file-list","before-upload","before-remove"])):(0,s.Q3)("",!0),"expand"===e.type&&"card"===e.itemType?((0,s.uX)(),(0,s.Wv)(a,{key:2,type:"flex",style:{"flex-wrap":"wrap"}},{default:(0,s.k6)(()=>[(0,s.bF)(v.A,{supportPreview:e.supportPreview,supportDownload:e.supportDownload,"file-list":(0,u.R1)(N),type:e.itemType,direction:e.direction,supportAdd:(0,u.R1)(O),onRemove:K,onAdd:Q},{default:(0,s.k6)(()=>[(0,u.R1)(O)?((0,s.uX)(),(0,s.CE)("div",S,[(0,s.bF)(g,{style:{"font-size":"18px"}},{default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(m.Plus))]),_:1})])):(0,s.Q3)("",!0)]),_:1},8,["supportPreview","supportDownload","file-list","type","direction","supportAdd"])]),_:1})):(0,s.Q3)("",!0),"expand"===e.type&&"text"===e.itemType?((0,s.uX)(),(0,s.Wv)(v.A,{key:3,supportPreview:e.supportPreview,supportDownload:e.supportDownload,"file-list":(0,u.R1)(N),type:e.itemType,direction:e.direction,style:{"margin-top":"8px"},onRemove:K},null,8,["supportPreview","supportDownload","file-list","type","direction"])):(0,s.Q3)("",!0),(0,u.R1)(x)?((0,s.uX)(),(0,s.Wv)(h.A,{key:4,visible:(0,u.R1)(x),"file-list":(0,u.R1)(N),defaultIndex:(0,u.R1)(_),readonly:!e.supportDownload,onClose:t[0]||(t[0]=e=>x.value=!1)},null,8,["visible","file-list","defaultIndex","readonly"])):(0,s.Q3)("",!0)])}}}),I=a(71241);const A=(0,I.A)(D,[["__scopeId","data-v-5d53cb33"]]);var W=A},45352:function(e,t,a){a.d(t,{A:function(){return W}});var l=a(69080),i=(a(97042),a(25374),a(65451)),o=(a(63390),a(76408)),n=(a(87535),a(44114),a(18111),a(22489),a(61701),a(18237),a(56768)),r=a(24232),s=a(90144),d=a(45130),u=a(164),p=a(26695),c=a(81387),m=a(27007),g=a(37856),y=a(51351),f=a(60265),v=a(21016),h=a(36525),w=a(53155),C=a(18384),b=a(31932),T=a(71066),k=a(42933),E=a(46954),R=a(11051),S=a(69838),D=(0,n.pM)({__name:"index",props:{formConfig:{},height:{},masterTableData:{},isEdit:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},currentWidget:{},fullscreen:{type:Boolean,default:!1},mode:{default:"pc"},dialog:{},thirdParamsString:{},dialogKey:{}},emits:["widgetClick","tableClick"],setup(e,{emit:t}){const a=(0,c.rd)(),D=t,I=e,{onCloseThirdDialog:A}=(0,T.P)(I),{fetchUpload:W}=(0,b.v)(),L=(0,s.KR)(!1),x=(0,s.KR)([]),_=(0,s.KR)(),{getDictDataList:F}=(0,E.o)(),N=(0,n.EW)(()=>K.value.tableWidget),O=(0,n.EW)(()=>K.value.groupWidget),B=(0,n.EW)(()=>K.value.widgetList),M=(0,n.EW)(()=>N.value&&null!=N.value.props.groupColumn&&""!==N.value.props.groupColumn),X=()=>{I.dialog?I.dialog.cancel():A(!1)},V=(e=!1,t=void 0)=>{ge.value=t,U.value.isEdit||(e?Se.refreshTable(!0,1):Se.refreshTable())},{isReady:P,dialogParams:U,form:K,formData:z,getWidgetValue:Q,getWidgetProp:G,getWidgetVisible:Y,onValueChange:j,onWidgetValueChange:H,getDropdownParams:J,checkOperationPermCode:q,checkOperationDisabled:$,checkOperationVisible:Z,cloneWidget:ee,handlerOperation:te,handlerScriptOperation:ae,loadOnlineFormConfig:le,getIgnoreMaskFields:ie,onPrint:oe,initPage:ne,initFormWidgetList:re,initWidgetLinkage:se,onStartFlow:de,loadOnlineDictList:ue,showDialog:pe,showOnlineDialog:ce,instanceData:me}=(0,R.m)({props:I,router:a,close:X,refresh:V});(0,n.Gt)("form",()=>({...K.value,mode:I.mode||"pc",isEdit:I.isEdit,readOnly:I.readOnly,formData:z,getWidgetValue:Q,getWidgetProp:G,getWidgetVisible:Y,onValueChange:j,onWidgetValueChange:H,getDropdownParams:J,checkOperationPermCode:q,checkOperationDisabled:$,checkOperationVisible:Z,cloneWidget:ee,onPrint:oe,onStartFlow:de,handlerScriptOperation:ae,handlerOperation:te,getIgnoreMaskFields:ie,getDictDataList:F,loadOnlineFormConfig:le,loadOnlineDictList:ue,isActive:e=>I.currentWidget===e,getWidgetObject:k.A.getWidgetObject,instanceData:()=>me}));const ge=(0,s.KR)([]),ye=e=>{N.value.childWidgetList=e},fe=e=>{if(null==e)return;if(e.bindData.dataType!==v.SysCustomWidgetBindDataType.Column||null==e.column)return;let t=e.column,a=Q(e);if(null==a||""===a||Array.isArray(a)&&0===a.length)return;const l={tableName:e.table.tableName,columnName:e.column.columnName,filterType:e.column.filterType,columnValue:e.column.filterType!==h.SysOnlineColumnFilterType.RANFGE_FILTER?a:void 0};return t.filterType===h.SysOnlineColumnFilterType.RANFGE_FILTER&&(l.columnValueStart=a[0],l.columnValueEnd=a[1]),l},ve=()=>{let e=[];if(Array.isArray(B.value)&&(e=B.value.map(e=>fe(e)).filter(e=>null!=e)),null!=O.value){let t=fe(O.value);t?t.groupCount=null!=O.value.props.groupCount&&O.value.props.groupCount:t={tableName:O.value.table.tableName,columnName:O.value.column.columnName,filterType:h.SysOnlineColumnFilterType.NONE,groupCount:null!=O.value.props.groupCount&&O.value.props.groupCount,columnValue:void 0},e.push(t)}return e},he=(0,s.KR)(),we=()=>{if(he.value){let e=he.value;if(Array.isArray(he.value)&&(e=he.value[0]),e)return e.getSearchString()}return null},Ce=async e=>{let t=K.value.tableMap.get(N.value.bindData.tableId);if(!t)throw console.warn("table is undefined tableId=",N.value.bindData.tableId),new Error;e.datasourceId=t.datasource.datasourceId,e.filterDtoList=ve(),null!=N.value.relation&&(e.relationId=t.relation.relationId,e.filterDtoList.push({tableName:N.value.table.tableName,columnName:N.value.relation.slaveColumn.columnName,filterType:h.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(U.value.masterTableData||{})[N.value.relation.masterColumn.columnName]}));let a,l=we();if(Array.isArray(N.value.props.likeQueryColumn)&&N.value.props.likeQueryColumn.length>0&&null!=l&&""!==l){let t=N.value.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(e.filterDtoList)||(e.filterDtoList=[]),e.filterDtoList.push({columnName:t,filterType:14,columnValue:l})}if(null!=ge.value&&(e.customFilterGroupList=ge.value),e.ignoreMaskFields=ie(N.value),!Array.isArray(e.orderParam)||e.orderParam.length<=0){let{orderColumn:t,orderAsc:a}=N.value.props;t&&(e.orderParam=[{fieldName:t,asc:!!a}])}if(U.value.isEdit||"function"!==typeof N.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(e=await N.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](e,me)),null==e)throw new Error;if(a=null!=t.relation?await(0,w.bE)(C.x+"/online/onlineOperation/listByOneToManyRelationId/"+t.datasource.variableName,e):await(0,w.bE)(C.x+"/online/onlineOperation/listByDatasourceId/"+t.datasource.variableName,e),U.value.isEdit||"function"!==typeof N.value.eventInfo[v.OnlineFormEventType.AFTER_LOAD_TABLE_DATA]||(a.data.dataList=await N.value.eventInfo[v.OnlineFormEventType.AFTER_LOAD_TABLE_DATA](a.data.dataList,me)),N.value&&N.value.props.treeFlag&&N.value.props.parentIdColumn&&(a.data.dataList=(0,m.BN)(a.data.dataList,We.value,N.value.props.parentIdColumn)),x.value=[],_.value&&_.value.getRef()){let e=a.data.extra?a.data.extra.reduce((e,t)=>(e[t.GROUP_KEY]=t.GROUP_COUNT,e),{}):null;_.value.getRef().setGroupData(e)}return{dataList:a.data.dataList,totalCount:a.data.totalCount}},be=()=>!0,Te=(0,n.EW)(()=>N.value&&N.value.props.treeFlag&&N.value.props.parentIdColumn?{rowField:We.value,parentField:N.value.props.parentIdColumn}:null);let ke=!0;const Ee=U.value.formConfig?.tableWidget;ke=!(Ee&&Ee.props&&Ee.props.treeFlag&&Ee.props.parentIdColumn)&&Ee?.props?.paged;const Re={loadTableData:Ce,verifyTableParameter:be,paged:!M.value&&ke},Se=(0,s.Kh)((0,f.K)(Re)),De=()=>{D("tableClick",N.value)},Ie=e=>{D("widgetClick",e)},Ae=(0,n.EW)(()=>K.value.operationList),We=(0,n.EW)(()=>{if(U.value.isEdit)return;let e=K.value.tableMap.get(N.value.bindData.tableId);if(e&&Array.isArray(e.columnList))for(let t=0;t<e.columnList.length;t++){let a=e.columnList[t];if(a.primaryKey)return a.columnName}return null}),Le=e=>{B.value.push(e)},xe=e=>{u.s.confirm("是否删除此组件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=K.value.widgetList.indexOf(e);-1!==t&&K.value.widgetList.splice(t,1),Ie(null)}).catch(e=>{console.warn(e)})},_e=e=>{x.value=e},Fe=e=>{V(!0)},Ne=()=>{x.value.length<=0?p.nk.error("请选择要批量删除的数据！"):u.s.confirm("是否删除选中数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e,t=K.value.tableMap.get(N.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataIdList:x.value.map(e=>e[We.value]).filter(e=>null!=e)};e=a.relationId?(0,w.bE)(C.x+"/online/onlineOperation/deleteBatchOneToManyRelation/"+t.datasource.variableName,a):(0,w.bE)(C.x+"/online/onlineOperation/deleteBatchDatasource/"+t.datasource.variableName,a),e.then(()=>{p.nk.success("删除成功！"),V(!0)}).catch(e=>{console.warn(e)})})},Oe=e=>{u.s.confirm("是否删除当前数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=K.value.tableMap.get(N.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataId:e[We.value]},l=null;l=a.relationId?(0,w.bE)(C.x+"/online/onlineOperation/deleteOneToManyRelation/"+t.datasource.variableName,a):(0,w.bE)(C.x+"/online/onlineOperation/deleteDatasource/"+t.datasource.variableName,a),l.then(()=>{p.nk.success("删除成功！"),V(!0)}).catch(e=>{console.warn(e)})})},Be=(e,t)=>{console.log(e,t);let a=K.value.tableMap.get(N.value.bindData.tableId);if(null==t)return void p.nk.error("请选择要导入的文件！");if(null==a)return void p.nk.error("未找到数据源！");let l="/admin/online/onlineOperation/importDatasource/"+a.datasource.variableName,i={datasourceId:a.datasource.datasourceId,importColumnIds:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder).map(e=>e.columnId),duplicateVerifyColumns:(e.exportColumnList||[]).filter(e=>e.duplicateCheckColumn).map(e=>e.columnId),skipHeader:e.skipHeader,importFile:t};W(l,i).then(()=>{p.nk.success("导入成功！"),V(!0)}).catch(e=>{p.nk.error(e)})},Me=e=>{u.s.confirm("是否导出表格数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=K.value.tableMap.get(N.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,filterDtoList:ve(),exportInfoList:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder)};null!=N.value.relation&&a.filterDtoList.push({tableName:N.value.table.tableName,columnName:N.value.relation.slaveColumn.columnName,filterType:h.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(U.value.masterTableData||{})[N.value.relation.masterColumn.columnName]});let l=we();if(Array.isArray(N.value.props.likeQueryColumn)&&N.value.props.likeQueryColumn.length>0&&null!=l&&""!==l){let e=N.value.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(a.filterDtoList)||(a.filterDtoList=[]),a.filterDtoList.push({columnName:e,filterType:14,columnValue:l})}if(U.value.isEdit||"function"!==typeof N.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(a=await N.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](a,me)),null==a)throw new Error;try{a.relationId?await(0,w.RG)(C.x+"/online/onlineOperation/exportByOneToManyRelationId/"+t.datasource.variableName,a,N.value.showName+".xlsx"):await(0,w.RG)(C.x+"/online/onlineOperation/exportByDatasourceId/"+t.datasource.variableName,a,N.value.showName+".xlsx"),p.nk.success("导出成功！")}catch(i){p.nk.error(i)}})},Xe=(e,t=null)=>{if(null==e)return;let a,l=K.value.tableMap.get(N.value.bindData.tableId),i={datasourceId:l.datasource.datasourceId,relationId:(l.relation||{}).relationId,masterData:{},slaveData:{}};if(null!=e.relationId?i.slaveData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}):i.masterData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}),e.rowOperation){if(null==t||null==t[We.value])return void p.nk.error("请选择要更新的数据！");i.dataIdList=[t[We.value]]}else{if(x.value.length<=0)return void p.nk.error("请选择要更新的数据！");i.dataIdList=x.value.map(e=>e[We.value]).filter(e=>null!=e)}a=i.relationId?(0,w.bE)(C.x+"/online/onlineOperation/updateOneToManyRelationBatch/"+l.datasource.variableName,i):(0,w.bE)(C.x+"/online/onlineOperation/updateDatasourceBatch/"+l.datasource.variableName,i),a.then(t=>{p.nk.success(e.name+"成功！"),V(!0)}).catch(e=>{console.warn(e)})},Ve=(e,t)=>{if(!U.value.isEdit)if(e.type===v.SysCustomWidgetOperationType.BATCH_DELETE)Ne();else if(e.type===v.SysCustomWidgetOperationType.DELETE)t&&Oe(t);else if(e.type===v.SysCustomWidgetOperationType.EXPORT)Me(e);else if(e.type===v.SysCustomWidgetOperationType.IMPORT)Be(e,t);else if(e.type===v.SysCustomWidgetOperationType.PRINT)oe(e,t,x.value,N.value.showName);else if(e.type===v.SysCustomWidgetOperationType.START_FLOW)console.log("启动流程"),de(e,t);else if(e.type===v.SysCustomWidgetOperationType.UPDATE)Xe(e,t);else if(e.type===v.SysCustomWidgetOperationType.SCRIPT)ae(e,t).catch(e=>{console.warn(e)});else{let a=[];if(e.type===v.SysCustomWidgetOperationType.UPDATE_DIALOG)if(e.rowOperation){if(null==t)return void p.nk.error("请选择要更新的数据！");a=[t[We.value]]}else{if(x.value.length<=0)return void p.nk.error("请选择要更新的数据！");a=x.value.map(e=>e[We.value])}te(e,{isEdit:U.value.isEdit,isUpdate:e.type===v.SysCustomWidgetOperationType.UPDATE_DIALOG,updateIdList:a,rowData:t,masterTableData:U.value.masterTableData||t,callback:()=>{V()}})}},Pe=()=>{V(!0)},Ue=()=>{V(!0)};return(0,n.sV)(()=>{P.value=!1,U.value.isEdit||(K.value.eventInfo&&"function"===typeof K.value.eventInfo[v.OnlineFormEventType.AFTER_CREATE_FORM]&&K.value.eventInfo[v.OnlineFormEventType.AFTER_CREATE_FORM](me),Ue(),se()),P.value=!0}),(e,t)=>{const a=o.uD,u=i.S2,p=l.aQ;return(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",{class:"online-query-form",style:(0,r.Tr)({height:e.height?e.height:"100%"})},[(0,s.R1)(B)&&(0,s.R1)(B).length>0||(0,s.R1)(U).isEdit?((0,n.uX)(),(0,n.Wv)(S.A,{key:0,class:"query-filter-box",isEdit:(0,s.R1)(U).isEdit,ref:"filterBox",itemWidth:(0,s.R1)(K).filterItemWidth||350,style:{"margin-bottom":"16px"},widgetList:(0,s.R1)(B),formData:(0,s.R1)(z),operationList:(0,s.R1)(Ae),onWidgetClick:Ie,onSearch:t[0]||(t[0]=e=>V(!0)),onReset:Pe,onCopy:Le,onDelete:xe,onOperationClick:Ve},null,8,["isEdit","itemWidth","widgetList","formData","operationList"])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:(0,r.C4)(["query-table-box custom-widget-item widget-item",{active:(0,s.R1)(U).isEdit&&e.currentWidget===(0,s.R1)(N)}]),style:(0,r.Tr)({padding:(0,s.R1)(U).isEdit?"0":""}),onClick:(0,d.D$)(De,["stop"])},[(0,n.bF)(u,null,{default:(0,n.k6)(()=>[(0,n.bF)(a,{span:24,class:(0,r.C4)(["widget-item",{active:(0,s.R1)(U).isEdit&&e.currentWidget===(0,s.R1)(O)}]),style:(0,r.Tr)([{background:"white",padding:"10px 16px 0px 16px"},{"min-height":(0,s.R1)(U).isEdit?"40px":void 0}]),onClick:t[2]||(t[2]=(0,d.D$)(e=>Ie((0,s.R1)(O)),["stop"]))},{default:(0,n.k6)(()=>[(0,n.bF)(g.A,{ref_key:"groupWidgetRef",ref:_,widget:(0,s.R1)(O),value:(0,s.R1)(Q)((0,s.R1)(O)),onInput:t[1]||(t[1]=e=>(0,s.R1)(j)((0,s.R1)(O),e)),onChange:Fe},null,8,["widget","value"])]),_:1},8,["class","style"])]),_:1}),(0,n.bF)(y.A,{ref_key:"table",ref:he,dataList:(0,s.R1)(Se).dataList,style:{height:"100%","flex-grow":"1"},isEdit:(0,s.R1)(U).isEdit,widget:(0,s.R1)(N),multiSelect:(0,s.R1)(L),operationList:(0,s.R1)(Ae),getTableIndex:(0,s.R1)(Se).getTableIndex,sortChange:(0,s.R1)(Se).onSortChange,onSelectChange:_e,treeConfig:(0,s.R1)(Te),onOperationClick:Ve,onRefresh:t[3]||(t[3]=e=>V(!1,e)),onWidgetClick:Ie,onUpdateChildWidgetList:ye},{pagination:(0,n.k6)(()=>[!(0,s.R1)(M)&&(0,s.R1)(N)&&(0,s.R1)(N).props.paged&&null==(0,s.R1)(Te)?((0,n.uX)(),(0,n.Wv)(u,{key:0,type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,n.k6)(()=>[(0,n.bF)(p,{total:(0,s.R1)(Se).totalCount,"current-page":(0,s.R1)(Se).currentPage,"page-size":(0,s.R1)(Se).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,s.R1)(Se).onCurrentPageChange,onSizeChange:(0,s.R1)(Se).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})):(0,n.Q3)("",!0)]),_:1},8,["dataList","isEdit","widget","multiSelect","operationList","getTableIndex","sortChange","treeConfig"])],6)],4)),[[d.aG,(0,s.R1)(P)]])}}}),I=a(71241);const A=(0,I.A)(D,[["__scopeId","data-v-2823dec0"]]);var W=A},46954:function(e,t,a){a.d(t,{o:function(){return d}});a(18111),a(61701);var l=a(78430),i=a(21016),o=a(36525),n=a(36947),r=a(53155);const s={...l.A},d=()=>{function e(e,t,a=!1){return new Promise((l,i)=>{const o=t?Object.keys(t).map(e=>({columnName:e,columnValue:t[e]})):[],r={dictId:e,filterDtoList:o,rootDataWhenNoParentId:a};n.NZ.listDict(r).then(e=>{l(e.data)}).catch(e=>{i(e)})})}function t(e,t,a,l="get"){const i="get"==l?r.Jt:r.bE;return new Promise((l,o)=>{i(e,t).then(e=>{Array.isArray(e.data)?l(e.data.map(e=>({id:e[a.keyColumnName],name:e[a.valueColumnName],parentId:e[a.parentKeyColumnName]}))):o()}).catch(e=>{o(e)})})}function a(e,a){const l=e.dictListUrl;return null!=l&&""!==l?t(l,a,e,"get"):(console.error("字典 ["+e.dictName+"] url为空"),Promise.reject())}function l(t,l,i=!1){const n=s,r=JSON.parse(t.dictDataJson);switch(t.dictType){case o.SysOnlineDictType.TABLE:case o.SysOnlineDictType.CODE:return e(t.dictId,l,i);case o.SysOnlineDictType.URL:return a(t,l||{});case o.SysOnlineDictType.CUSTOM:return null!=r&&Array.isArray(r.dictData)?Promise.resolve(r.dictData):Promise.reject(new Error("获取自定义字典数据错误！"));case o.SysOnlineDictType.STATIC:return null!=r&&null!=r.staticDictName&&null!=n[r.staticDictName]?Promise.resolve(n[r.staticDictName].getList()):Promise.reject(new Error("未知的静态字典！"));default:return Promise.reject(new Error("未知的字典类型！"))}}function d(e,t){const a=(e.datasource||{}).variableName;let l="view";switch(t.type){case i.SysCustomWidgetOperationType.ADD:case i.SysCustomWidgetOperationType.EDIT:case i.SysCustomWidgetOperationType.DELETE:l="edit";break;default:l="view"}return"online:"+a+":"+l}return{getDictDataList:l,getDictDataByUrl:t,getOperationPermCode:d}}},49825:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var l=a(54880),i=(a(97042),a(51582),a(42763),a(60713),a(2403)),o=(a(63266),a(69225),a(65451)),n=(a(63390),a(25136)),r=(a(69957),a(11194)),s=(a(57583),a(44114),a(18111),a(22489),a(7588),a(61701),a(18237),a(56768)),d=a(90144),u=a(24232),p=a(45130),c=a(57477),m=a(26695),g=a(21929),y=a(27652),f=a(81387),v=a(21016),h=a(36525),w=a(53155),C=a(89001),b=a(18384),T=a(71066),k=a(42933),E=a(82572),R=a(46954),S=a(11051);const D={class:"online-edit-form",style:{position:"relative",height:"100%","min-height":"200px"}},I={style:{display:"flex",height:"40px","line-height":"40px"}},A={style:{"font-size":"18px",color:"#333","font-weight":"bold"}},W={style:{width:"8000px","max-width":"90vw",height:"100%",padding:"15px",background:"white"}};var L=(0,s.pM)({__name:"index",props:{formConfig:{},height:{},masterTableData:{},isEdit:{type:Boolean,default:!1},isCopy:{type:Boolean},isUpdate:{type:Boolean,default:!1},updateIdList:{default:void 0},readOnly:{type:Boolean,default:!1},currentWidget:{},rowData:{},fullscreen:{type:Boolean,default:!1},saveData:{type:Boolean,default:!0},mode:{default:"pc"},dialog:{},processDefinitionKey:{},taskVariableList:{},thirdParamsString:{},dialogKey:{}},emits:["widgetClick"],setup(e,{emit:t}){const a=(0,f.rd)(),L=((0,E.i1)(),t),x=e,_=(0,E.l5)(),{onCloseThirdDialog:F}=(0,T.P)(x),N=(0,d.KR)(),{getDictDataList:O}=(0,R.o)(),B=()=>{x.dialog?x.dialog.cancel():F(!1)},{isReady:M,rules:X,dialogParams:V,form:P,formData:U,masterTable:K,isRelation:z,tableWidgetList:Q,richEditWidgetList:G,getWidgetValue:Y,getWidgetVisible:j,onValueChange:H,onWidgetValueChange:J,getPrimaryData:q,getDropdownParams:$,checkOperationPermCode:Z,checkOperationDisabled:ee,checkOperationVisible:te,cloneWidget:ae,handlerOperation:le,handlerScriptOperation:ie,tableInstance:oe,showSelectDialog:ne,loadOnlineFormConfig:re,getTableData:se,setTableData:de,initPage:ue,initFormWidgetList:pe,initWidgetRule:ce,getIgnoreMaskFields:me,initWidgetLinkage:ge,onPrint:ye,showDialog:fe,showOnlineDialog:ve,onStartFlowImpl:he,masterTablePrimaryKey:we,instanceData:Ce}=(0,S.m)({props:x,router:a,formRef:N,close:B});(0,s.Gt)("form",()=>({...P.value,mode:x.mode||"pc",isEdit:V.value.isEdit,readOnly:V.value.readOnly,formData:U,getWidgetValue:Y,getWidgetVisible:j,onValueChange:H,onWidgetValueChange:J,getTableData:se,setTableData:de,getPrimaryData:q,getDropdownParams:$,checkOperationPermCode:Z,checkOperationDisabled:ee,checkOperationVisible:te,cloneWidget:ae,handlerOperation:le,handlerScriptOperation:ie,tableInstance:oe,showSelectDialog:ne,getDictDataList:O,loadOnlineFormConfig:re,isActive:e=>x.currentWidget===e,getWidgetObject:k.A.getWidgetObject,instanceData:()=>Ce}));const be=e=>{L("widgetClick",e)},Te=e=>{if(e.typpe===v.SysCustomWidgetOperationType.PRINT){let t;t=null==K.value.relation?K.value.datasource.variableName:K.value.relation.variableName,ye(e,U[t],null,P.value.formName)}else if(e.type===v.SysCustomWidgetOperationType.SCRIPT)ie(e);else{let t=[];le(e,{isEdit:V.value.isEdit,isUpdate:e.type===v.SysCustomWidgetOperationType.UPDATE_DIALOG,updateIdList:t,masterTableData:V.value.masterTableData})}},ke=async()=>{if(null==K.value||null==K.value.datasource)throw m.nk.error("表单使用主数据源或主表不存在！"),new Error;let e={datasourceId:K.value.datasource.datasourceId,relationId:(K.value.relation||{}).relationId,masterData:z.value?void 0:U[K.value.datasource.variableName]};if(z.value){e.slaveData={...U[K.value.relation.variableName]};let t=(V.value.masterTableData||{})[K.value.relation.masterColumn.columnName];null!=t&&(e.slaveData[K.value.relation.slaveColumn.columnName]=t)}else e.slaveData=Q.reduce((e,t)=>(null!=t.relation&&(e[t.relation.variableName]=U[t.relation.variableName]),e),{});if(!V.value.isEdit&&"function"===typeof P.value.eventInfo[v.OnlineFormEventType.BEFORE_COMMIT_FORM_DATA]&&(e=await P.value.eventInfo[v.OnlineFormEventType.BEFORE_COMMIT_FORM_DATA](e,Ce),!e))return;if(null==e)throw new Error;if(!z.value&&e.slaveData){let t=Object.keys(e.slaveData);if(t.length>0){let a=new Map;P.value.tableMap.forEach(e=>{null!=e.relation&&a.set(e.relation.variableName,e.relation.relationId)}),t.forEach(t=>{let l=a.get(t);null!=l&&(e.slaveData[l]=e.slaveData[t]),e.slaveData[t]=void 0})}}let t,a=!1;z.value||null==x.processDefinitionKey||""===x.processDefinitionKey||(a=!0),t=z.value?null==V.value.rowData||V.value.isCopy?b.x+"/online/onlineOperation/addOneToManyRelation/":b.x+"/online/onlineOperation/updateOneToManyRelation/":null==V.value.rowData||V.value.isCopy?b.x+"/online/onlineOperation/addDatasource/":b.x+"/online/onlineOperation/updateDatasource/",t+=K.value.datasource.variableName;let l=await(0,w.bE)(t,e);if(a?l.data&&(U[K.value.datasource.variableName][we.value]=l.data):(m.nk.success("保存成功！"),x.dialog?x.dialog.submit(l,U):F(!0,V.value.rowData,l)),a)try{await he(x.processDefinitionKey,x.taskVariableList,U[K.value.datasource.variableName]),m.nk.success("保存并启动成功！"),x.dialog?x.dialog.submit(l,U):F(!0,V.value.rowData,l)}catch(i){x.dialog?x.dialog.submit(l,U):F(!0,V.value.rowData,l)}},Ee=()=>{let e,t={datasourceId:K.value.datasource.datasourceId,relationId:(K.value.relation||{}).relationId,masterData:z.value?void 0:U[K.value.datasource.variableName],slaveData:z.value?{...U[K.value.relation.variableName]}:void 0,dataIdList:V.value.updateIdList};e=t.relationId?(0,w.bE)(b.x+"/online/onlineOperation/updateOneToManyRelationBatch/"+K.value.datasource.variableName,t):(0,w.bE)(b.x+"/online/onlineOperation/updateDatasourceBatch/"+K.value.datasource.variableName,t),e.then(e=>{m.nk.success("保存成功！"),x.dialog?x.dialog.submit(e):F(!0,V.value.rowData,e)}).catch(e=>{console.warn(e)})},Re=()=>{V.value.isEdit||(Array.isArray(G)&&G.forEach(e=>{e&&e.widgetImpl&&H(e,e.widgetImpl.getHtml())}),N.value.validate(async e=>{if(e)if(V.value.isUpdate)Ee();else if(V.value.saveData)ke().catch(e=>{console.error(e)});else{let e=U;V.value.isEdit||"function"!==typeof P.value.eventInfo[v.OnlineFormEventType.BEFORE_COMMIT_FORM_DATA]||(e=await P.value.eventInfo[v.OnlineFormEventType.BEFORE_COMMIT_FORM_DATA](U,Ce)),x.dialog?x.dialog.submit(e):F(!0,V.value.rowData,e)}}))},Se=(e,t)=>{null!=e&&t.forEach(t=>{e[t]=void 0})},De=async e=>{if(null==e||null==e.datasource||null==e.relation)throw new Error;let t={datasourceId:e.datasource.datasourceId,relationId:e.relation.relationId,filterDtoList:[{tableName:e.table.tableName,columnName:e.relation.slaveColumn.columnName,filterType:h.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(U[e.datasource.variableName]||{})[e.relation.masterColumn.columnName]}]};if(t.ignoreMaskFields=me(e),!Array.isArray(t.orderParam)||t.orderParam.length<=0){let{orderColumn:a,orderAsc:l}=e.props;a&&(t.orderParam=[{fieldName:a,asc:!!l}])}if(V.value.isEdit||"function"!==typeof e.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(t=await e.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](t,Ce)),null==t)throw new Error;let a=await(0,w.bE)(b.x+"/online/onlineOperation/listByOneToManyRelationId/"+e.datasource.variableName,t);if(V.value.isEdit||"function"!==typeof e.eventInfo[v.OnlineFormEventType.AFTER_LOAD_TABLE_DATA]||(a.data.dataList=await e.eventInfo[v.OnlineFormEventType.AFTER_LOAD_TABLE_DATA](a.data.dataList,Ce)),V.value.isCopy){let t=(new Date).getTime(),l=[];e.table&&Array.isArray(e.table.columnList)&&e.table.columnList.forEach(e=>{e.fieldKind===h.SysOnlineFieldKind.AUTO_CODE&&l.push(e.columnName)}),a.data.dataList.forEach(a=>{e.primaryColumnName&&(a[e.primaryColumnName]=void 0),a.__cascade_add_id__=t++,l.forEach(e=>{a[e]=void 0})})}U[e.relation.variableName]=a.data.dataList},Ie=()=>null!=V.value.rowData?new Promise((e,t)=>{let a=[];if(V.value.isCopy&&K&&Array.isArray(K.value.columnList)&&K.value.columnList.forEach(e=>{(e.primaryKey||e.fieldKind===h.SysOnlineFieldKind.AUTO_CODE)&&a.push(e.columnName)}),z.value)Object.keys(V.value.rowData).forEach(e=>{U[K.value.relation.variableName][e]=V.value.rowData[e]}),Se(U[K.value.relation.variableName],a),e();else{let i=[],o="";if(P.value.tableMap.forEach(e=>{e.relation&&e.relation.relationType===h.SysOnlineRelationType.ONE_TO_ONE?(i.push(e.relation.variableName),e.columnList.forEach(t=>{U[e.relation.variableName][t.columnName]=void 0})):null==e.relation&&(o=e.datasource.variableName)}),Object.keys(V.value.rowData).forEach(e=>{-1===i.indexOf(e)?U[o][e]=V.value.rowData[e]:V.value.rowData[e]&&Object.keys(V.value.rowData[e]).forEach(t=>{U[e][t]=V.value.rowData[e][t],V.value.rowData[e][t+"DictMapList"]&&(U[e][t+"DictMapList"]=V.value.rowData[e][t+"DictMapList"])})}),Array.isArray(Q)&&Q.length>0)try{let l=Q.map(e=>e.relation&&e.relation.relationType===h.SysOnlineRelationType.ONE_TO_MANY?De(e):null).filter(e=>null!=e);Promise.all(l).then(()=>{Se(U[o],a),e()}).catch(e=>{console.log(e),Se(U[o],a),t(e)})}catch(l){console.log(l)}else Se(U[o],a),e()}}):Promise.resolve();return(0,s.sV)(()=>{M.value=!1,V.value.isEdit?M.value=!0:(P.value.eventInfo&&"function"===typeof P.value.eventInfo[v.OnlineFormEventType.AFTER_CREATE_FORM]&&P.value.eventInfo[v.OnlineFormEventType.AFTER_CREATE_FORM](Ce),ce(),Ie().then(()=>{P.value.eventInfo&&"function"===typeof P.value.eventInfo[v.OnlineFormEventType.AFTER_LOAD_FORM_DATA]&&P.value.eventInfo[v.OnlineFormEventType.AFTER_LOAD_FORM_DATA](Ce),ge(),setTimeout(()=>{N.value.clearValidate()}),M.value=!0}).catch(e=>{console.error(e),M.value=!0}))}),(e,t)=>{const a=r.fR,m=n.S2,f=o.S2,h=l.bZ,w=i.kA,b=l.ZO,T=l.LK,k=l.lX;return(0,s.uX)(),(0,s.CE)("div",D,[(0,d.R1)(V).fullscreen&&!(0,d.R1)(V).isEdit?((0,s.uX)(),(0,s.Wv)(k,{key:0},{default:(0,s.k6)(()=>[(0,s.bF)(h,{style:{height:"72px",background:"white"}},{default:(0,s.k6)(()=>[(0,s.bF)(f,{type:"flex",align:"middle",style:{"justify-content":"space-between",width:"100%",height:"100%"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",I,[t[4]||(t[4]=(0,s.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"BIQS",-1)),(0,s.bF)(a,{direction:"vertical",style:{height:"26px",margin:"7px 8px"}}),(0,s.Lk)("span",A,(0,u.v_)((0,d.R1)(P).formName),1)]),(0,s.bF)(m,{link:"",size:"default",icon:(0,d.R1)(c.Close),style:{"font-size":"24px",color:"#909399"},onClick:B},null,8,["icon"])]),_:1})]),_:1}),(0,s.bF)(b,{style:{width:"100%",padding:"25px",background:"#f9f9f9"}},{default:(0,s.k6)(()=>[(0,s.bF)(f,{type:"flex",justify:"center",style:(0,u.Tr)({height:"calc(100vh - "+((0,d.R1)(V).readOnly&&((0,d.R1)(P).operationList||[]).length<=0?122:192)+"px)"})},{default:(0,s.k6)(()=>[(0,s.Lk)("div",W,[(0,s.bF)(w,{style:{height:"100%"},class:"custom-scroll"},{default:(0,s.k6)(()=>[(0,s.bF)((0,d.R1)(g.US),{ref_key:"formRef",ref:N,model:(0,d.R1)(U),class:"full-width-input",rules:(0,d.R1)(X),style:{width:"100%"},"label-width":((0,d.R1)(P).labelWidth||100)+"px","label-position":(0,d.R1)(P).labelPosition||"right",size:(0,d.R1)(_).defaultFormItemSize,"validate-on-rule-change":!1,onSubmit:t[1]||(t[1]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,d.R1)(M)?((0,s.uX)(),(0,s.Wv)(C.A,{key:0,ref:"root",value:(0,d.R1)(P).widgetList,"onUpdate:value":t[0]||(t[0]=e=>(0,d.R1)(P).widgetList=e),height:"100%",isEdit:(0,d.R1)(V).isEdit,showBorder:!1,onWidgetClick:be},null,8,["value","isEdit"])):(0,s.Q3)("",!0)]),_:1},8,["model","rules","label-width","label-position","size"])]),_:1})])]),_:1},8,["style"])]),_:1}),!(0,d.R1)(V).readOnly||((0,d.R1)(P).operationList||[]).length>0?((0,s.uX)(),(0,s.Wv)(T,{key:0,style:{background:"white"},height:"70px;"},{default:(0,s.k6)(()=>[(0,s.bF)(f,{type:"flex",justify:"center",align:"middle",style:{height:"70px"}},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,d.R1)(P).operationList,e=>((0,s.uX)(),(0,s.Wv)(m,{key:e.id,size:"default",style:{"margin-right":"16px"},type:e.btnType,plain:e.plain,onClick:t=>Te(e)},{default:(0,s.k6)(()=>[(0,s.eW)((0,u.v_)(e.name||(0,d.R1)(v.SysCustomWidgetOperationType).getValue(e.type)),1)]),_:2},1032,["type","plain","onClick"]))),128)),(0,d.R1)(V).readOnly?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(m,{key:0,type:"primary",size:"default",style:{"margin-right":"16px"},onClick:Re},{default:(0,s.k6)(()=>t[5]||(t[5]=[(0,s.eW)(" 保存 ")])),_:1,__:[5]})),(0,s.bF)(m,{size:"default",plain:!0,onClick:B},{default:(0,s.k6)(()=>t[6]||(t[6]=[(0,s.eW)(" 返回 ")])),_:1,__:[6]})]),_:1})]),_:1})):(0,s.Q3)("",!0)]),_:1})):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.Lk)("div",{class:"form-box",style:(0,u.Tr)({"min-height":(0,d.R1)(V).isEdit?e.height:"0px"})},[(0,s.bF)(w,{style:{height:"100%"},class:"custom-scroll"},{default:(0,s.k6)(()=>[((0,s.uX)(),(0,s.Wv)((0,s.$y)("pc"===e.mode?(0,d.R1)(g.US):(0,d.R1)(y.lV)),{ref_key:"formRef",ref:N,model:(0,d.R1)(U),class:"full-width-input",rules:(0,d.R1)(X),style:{width:"100%"},"label-width":((0,d.R1)(P).labelWidth||100)+"px","label-position":(0,d.R1)(P).labelPosition||"right",size:(0,d.R1)(_).defaultFormItemSize,onSubmit:t[3]||(t[3]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,d.R1)(M)?((0,s.uX)(),(0,s.Wv)(C.A,{key:0,ref:"root",value:(0,d.R1)(P).widgetList,"onUpdate:value":t[2]||(t[2]=e=>(0,d.R1)(P).widgetList=e),height:e.height,isEdit:(0,d.R1)(V).isEdit,showBorder:!1,onWidgetClick:be},null,8,["value","height","isEdit"])):(0,s.Q3)("",!0)]),_:1},40,["model","rules","label-width","label-position","size"]))]),_:1})],4),(0,d.R1)(V).isEdit?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(f,{key:0,class:"menu-box",type:"flex",justify:"end"},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,d.R1)(P).operationList,e=>((0,s.uX)(),(0,s.Wv)(m,{key:e.id,size:(0,d.R1)(_).defaultFormItemSize,type:e.btnType,plain:e.plain,onClick:t=>Te(e)},{default:(0,s.k6)(()=>[(0,s.eW)((0,u.v_)(e.name||(0,d.R1)(v.SysCustomWidgetOperationType).getValue(e.type)),1)]),_:2},1032,["size","type","plain","onClick"]))),128)),(0,d.R1)(V).readOnly?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(m,{key:0,type:"primary",size:(0,d.R1)(_).defaultFormItemSize,plain:!0,onClick:B},{default:(0,s.k6)(()=>t[7]||(t[7]=[(0,s.eW)(" 取消 ")])),_:1,__:[7]},8,["size"])),(0,d.R1)(V).readOnly?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(m,{key:1,type:"primary",size:(0,d.R1)(_).defaultFormItemSize,onClick:Re},{default:(0,s.k6)(()=>t[8]||(t[8]=[(0,s.eW)(" 保存 ")])),_:1,__:[8]},8,["size"]))]),_:1}))],64))])}}}),x=a(71241);const _=(0,x.A)(L,[["__scopeId","data-v-2872deb2"]]);var F=_},51351:function(e,t,a){a.d(t,{A:function(){return st}});var l=a(56768),i=a(90144),o=a(99540);const n=["onFocus"];var r=(0,l.pM)({__name:"InlineAutoSaveColumn",emits:["save"],setup(e,{emit:t}){const a=t,r=e=>{a("save",e)};return(e,t)=>((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{width:"0px"},{default:(0,l.k6)(e=>[(0,l.Lk)("input",{class:"auto-edit-next",onFocus:t=>r(e.row)},null,40,n)]),_:1}))}}),s=a(71241);const d=(0,s.A)(r,[["__scopeId","data-v-48ac3cde"]]);var u=d,p=a(21929),c=(a(97042),a(32465),a(24232));a(18111),a(61701);const m=(e,t,a,i,o)=>{const n=(0,l.OA)(),r=(0,l.WQ)("inlineEditConfig"),s=(0,l.EW)(()=>r),d=(0,l.EW)(()=>{const e=(s.value||{}).rowCopy;if(null==e||null==n.field)return;const t=n.field.split(".");let a=e;for(let l=0;l<t.length;l++)if(a=a[t[l]],null==a)break;return a}),u=e=>s.value&&s.value.rowData===e,p=()=>{},c=(t,a)=>{if(null!=n.field&&""!==n.field&&null!=s.value){s.value.isDirty=!0;const l=n.field.split(".");let i=s.value.rowCopy;if(!i)return;for(let o=0;o<l.length;o++){const n=l[o];o!==l.length-1?null==i[n]&&(i[n]={}):(i[n]=t,e?i[n+"DictMapList"]=a:i[n+"DictMap"]=a),i=i[n]}}},m=e=>e,g=e=>{},y=e=>{const t=i?i(e):m(e),a=o?o(e):g(e);return c(t,a),t},f=(e,a,l)=>{const i=y(e);t("change",i,s.value?.rowCopy,a,l)},v=()=>{a.value&&a.value.focus&&a.value.focus()},h=e=>{if(null==e)return;if(e.isAggregate&&null!=e.groupField){if(!0!==n["row-group-node"])return"";const t=e._X_ROW_CHILD_LIST;if(Array.isArray(t)&&t.length>0){const a=t[0];let l="";return l=null!=a[e.groupField+"DictMap"]?a[e.groupField+"DictMap"].name:null!=a[e.groupField+"DictMapList"]?a[e.groupField+"DictMapList"].map(e=>e.name).join(","):a[e.groupField],`${l}【${t.length}】`}}const t=n.field.split(".");let a=e;for(let l=0;l<t.length;l++)if(a=a[t[l]],null==a)break;return a};return{editConfig:s,isEdit:u,getRowData:d,getRowValue:h,getDictData:g,reset:p,setRowData:c,onInput:y,onChange:f,focus:v}};var g=m;const y={key:2};var f=(0,l.pM)({__name:"InlineCustomColumn",props:{editComponent:{},props:{}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,r=e,s=(0,i.KR)(),{isEdit:d,getRowData:u,getRowValue:m,onInput:f,onChange:v,reset:h}=g(!1,n,s);return t({reset:h,focus:()=>{s.value&&s.value.focus&&s.value.focus()}}),(e,t)=>{const a=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(t=>[(0,i.R1)(d)(t.row)?((0,l.uX)(),(0,l.Wv)(a,{key:0,label:"",prop:e.$attrs.field},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(e.editComponent),(0,l.v6)({ref_key:"inputWidget",ref:s,style:{width:"100%"},modelValue:(0,i.R1)(u),value:(0,i.R1)(u),props:r.props},e.$attrs,{"onUpdate:modelValue":(0,i.R1)(v),onInput:(0,i.R1)(f),onChange:(0,i.R1)(v)}),null,16,["modelValue","value","props","onUpdate:modelValue","onInput","onChange"]))]),_:1},8,["prop"])):e.$slots.default?(0,l.RG)(e.$slots,"default",{key:1,row:t.row}):((0,l.uX)(),(0,l.CE)("span",y,(0,c.v_)((0,i.R1)(m)(t.row)),1))]),_:3},16)}}});const v=f;var h=v,w=a(18888),C=(a(3172),a(22489),a(27007)),b=a(99080),T=(0,l.pM)({__name:"InlineCascaderColumn",props:{size:{default:"default"},multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},checkStrictly:{type:Boolean,default:!1},loadDropdownData:{type:Function,default:void 0}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,r=e,s=()=>null!=r.loadDropdownData?new Promise((e,t)=>{r.loadDropdownData((E.value||{}).rowCopy).then(t=>{e({dataList:t.map(e=>({...e,children:void 0}))})}).catch(()=>{t()})}):Promise.resolve([]),d={loadData:s,isTree:!0},u=(0,b.B)(d),{dropdownList:m}=u,y=e=>{if(Array.isArray(e)&&0!==e.length){if(r.multiple){let t=e.map(e=>Array.isArray(e)&&e.length>0?e[e.length-1]:null).filter(e=>null!=e);return t.length>0?t.join(","):void 0}return e[e.length-1]}},f=e=>{if(Array.isArray(e)&&0!==e.length){if(r.multiple)return e.map(e=>{if(Array.isArray(e)&&e.length>0){let t=(0,C.I_)(m.value,e[e.length-1],"id");return t[t.length-1]}return null}).filter(e=>null!=e);{let t=(0,C.I_)(m.value,e[e.length-1],"id");return t[t.length-1]}}},v=(0,l.OA)(),h=(0,l.EW)(()=>{let e=(E.value||{}).rowCopy;if(null==e||null==v.field)return;let t=v.field.split("."),a=e;for(let l=0;l<t.length;l++)if(a=a[t[l]],null==a)break;return null!=a&&(a+="",a=r.multiple?a.split(","):[a],a=a.map(e=>(0,C.Zi)(m.value,e,"id")).filter(e=>e.length>0),r.multiple||(a=a[0])),a}),T=()=>{u.setDirty(!0),u.refresh()},k=(0,i.KR)(),{editConfig:E,isEdit:R,onChange:S}=g(!1,n,k,y,f),D=e=>{S(e,void 0,f(e))};return(0,l.wB)(()=>E.value.rowData,()=>{E.value&&E.value.rowData&&T()},{immediate:!0}),t({reset:T,focus:()=>{}}),(e,t)=>{const a=w._m,n=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(t=>[(0,i.R1)(R)(t.row)?((0,l.uX)(),(0,l.Wv)(n,{key:0,label:"",prop:e.$attrs.field},{default:(0,l.k6)(()=>[(0,l.bF)(a,{ref_key:"inputWidget",ref:k,size:e.size,clearable:e.clearable,"collapse-tags":!0,filterable:!0,options:(0,i.R1)(m),props:{value:"id",label:"name",children:"children",multiple:e.multiple,checkStrictly:e.checkStrictly},"model-value":((0,i.R1)(m)||[]).length>0?(0,i.R1)(h):void 0,"onUpdate:modelValue":D},null,8,["size","clearable","options","props","model-value"])]),_:1},8,["prop"])):(0,l.RG)(e.$slots,"default",{key:1,row:t.row})]),_:3},16)}}});const k=T;var E=k,R=a(85415);a(22243),a(7409),a(20116);const S={key:2};var D=(0,l.pM)({__name:"InlineSelectColumn",props:{size:{default:"default"},multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},loadDropdownData:{type:Function,default:void 0}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,r=e,s=()=>null!=r.loadDropdownData?new Promise((e,t)=>{r.loadDropdownData((T.value||{}).rowCopy).then(t=>{e({dataList:t})}).catch(()=>{t()})}):Promise.resolve([]),d={loadData:s,isTree:!1},u=(0,b.B)(d),{dropdownList:m}=u,y=e=>r.multiple?e.join(","):e,f=e=>r.multiple?m.value.filter(t=>e.includes(t.id)):m.value.find(t=>t.id===e),v=(0,l.OA)(),h=(0,l.EW)(()=>{let e=(T.value||{}).rowCopy;if(null==e||null==v.field)return;let t=v.field.split("."),a=e;for(let l=0;l<t.length;l++)if(a=a[t[l]],null==a)break;return null!=a&&(a+="",a=""!==a?r.multiple?a.split(","):a:r.multiple?[]:""),a}),w=()=>{u.setDirty(!0),u.refresh()},C=(0,i.KR)(),{editConfig:T,isEdit:k,getRowValue:E,onChange:D}=g(!1,n,C,y,f),I=e=>{D(e,void 0,f(e))};return(0,l.wB)(()=>T.value.rowData,()=>{T.value&&T.value.rowData&&w()},{immediate:!0}),t({reset:w,focus:()=>{C.value&&C.value.focus()}}),(e,t)=>{const a=R.P9,n=R.AV,r=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(t=>[(0,i.R1)(k)(t.row)?((0,l.uX)(),(0,l.Wv)(r,{key:0,label:"",prop:e.$attrs.field},{default:(0,l.k6)(()=>[(0,l.bF)(n,{ref_key:"inputWidget",ref:C,size:e.size,clearable:e.clearable,multiple:e.multiple,"collapse-tags":!0,filterable:!0,"model-value":((0,i.R1)(m)||[]).length>0?(0,i.R1)(h):"","onUpdate:modelValue":I},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,i.R1)(m),e=>((0,l.uX)(),(0,l.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["size","clearable","multiple","model-value"])]),_:1},8,["prop"])):e.$slots.default?(0,l.RG)(e.$slots,"default",{key:1,row:t.row}):((0,l.uX)(),(0,l.CE)("span",S,(0,c.v_)((0,i.R1)(E)(t.row)),1))]),_:3},16)}}});const I=D;var A=I,W=a(42587),L=a(31932),x=a(13180);const _={key:2};var F=(0,l.pM)({__name:"InlineUploadColumn",props:{type:{default:"file"},fileListType:{default:"dropdown"},action:{default:""},data:{default:{}},limit:{default:void 0},rowKey:{default:void 0},parseUploadDataFunction:{type:Function,default:void 0}},emits:["change"],setup(e,{expose:t,emit:a}){const{getUploadHeaders:n,getUploadActionUrl:r,fileListToJson:s,parseUploadData:d,getPictureList:u}=(0,L.v)(),m=e,y=a,f=(0,x.D)(m.limit),{fileList:v,maxCount:h}=f,w=e=>s(e),C=e=>{R(e)},b=(0,i.KR)(),{isEdit:T,getRowData:k,getRowValue:E,onChange:R,reset:S,editConfig:D}=g(!1,y,b,w);return(0,l.wB)(()=>k.value,e=>{let t=(D.value||{}).rowCopy,a={...m.data};t&&t[m.rowKey]&&(a[m.rowKey]=t[m.rowKey]),v.value=m.parseUploadDataFunction?m.parseUploadDataFunction(e,t):d(e,a)},{immediate:!0}),t({reset:S,focus:()=>{b.value&&b.value.focus&&b.value.focus()}}),(e,t)=>{const a=W.A,s=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(o=>[(0,i.R1)(T)(o.row)?((0,l.uX)(),(0,l.Wv)(s,{key:0,label:"",prop:e.$attrs.field,style:{width:"100%"}},{default:(0,l.k6)(()=>[(0,l.bF)(a,{modelValue:(0,i.R1)(v),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,i.i9)(v)?v.value=e:null),ref_key:"inputWidget",ref:b,name:"uploadFile",action:(0,i.R1)(r)(e.action),headers:(0,i.R1)(n),data:e.data,limit:e.limit,size:"default",type:e.fileListType,onChange:C},null,8,["modelValue","action","headers","data","limit","type"])]),_:1},8,["prop"])):e.$slots.default?(0,l.RG)(e.$slots,"default",{key:1,row:o.row}):((0,l.uX)(),(0,l.CE)("span",_,(0,c.v_)((0,i.R1)(E)(o.row)),1))]),_:3},16)}}});const N=(0,s.A)(F,[["__scopeId","data-v-2cc4b03a"]]);var O=N,B=a(692),M=a(3740);a(42899);const X={key:2};var V=(0,l.pM)({__name:"InlineSwitchColumn",props:{size:{default:"default"}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,r=(0,i.KR)(),{isEdit:s,getRowData:d,getRowValue:u,onChange:m,reset:y}=g(!1,n,r),f=(0,l.EW)(()=>{let e=d.value;return null!=e&&("string"===typeof e?e="true"===e:"number"===typeof e&&(e=1===e),e)}),v=e=>{let t=e;"string"===typeof t?t=e?"true":"false":"number"===typeof t&&(t=e?1:0),m(t)};return t({reset:y,focus:()=>{r.value&&r.value.focus()}}),(e,t)=>{const a=M.qi,n=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(t=>[(0,i.R1)(s)(t.row)?((0,l.uX)(),(0,l.Wv)(n,{key:0,label:"",prop:e.$attrs.field},{default:(0,l.k6)(()=>[(0,l.bF)(a,{ref_key:"inputWidget",ref:r,"model-value":(0,i.R1)(f),size:e.size,"onUpdate:modelValue":v},null,8,["model-value","size"])]),_:1},8,["prop"])):e.$slots.default?(0,l.RG)(e.$slots,"default",{key:1,row:t.row}):((0,l.uX)(),(0,l.CE)("span",X,(0,c.v_)((0,i.R1)(u)(t.row)?"是":"否"),1))]),_:3},16)}}});const P=V;var U=P,K=a(12687),z=(a(31112),a(88284));a(36715);const Q={key:2};var G=(0,l.pM)({__name:"InlineDateColumn",props:{size:{default:"default"},type:{default:"date"},format:{default:"YYYY-MM-DD HH:mm:ss"},valueFormat:{default:"YYYY-MM-DD HH:mm:ss"},clearable:{type:Boolean,default:!0}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,r=(0,i.KR)(),{isEdit:s,getRowData:d,getRowValue:u,onChange:m,reset:y}=g(!1,n,r);return t({reset:y,focus:()=>{r.value&&r.value.focus()}}),(e,t)=>{const a=z.MG,n=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(t=>[(0,i.R1)(s)(t.row)?((0,l.uX)(),(0,l.Wv)(n,{key:0,label:"",prop:e.$attrs.field},{default:(0,l.k6)(()=>[(0,l.bF)(a,{ref_key:"inputWidget",ref:r,style:{width:"100%"},type:e.type,"start-placeholder":"","end-placeholder":"",clearable:!0,size:e.size,format:e.format,"value-format":e.valueFormat,"model-value":(0,i.R1)(d),"onUpdate:modelValue":(0,i.R1)(m)},null,8,["type","size","format","value-format","model-value","onUpdate:modelValue"])]),_:1},8,["prop"])):e.$slots.default?(0,l.RG)(e.$slots,"default",{key:1,row:t.row}):((0,l.uX)(),(0,l.CE)("span",Q,(0,c.v_)((0,i.R1)(u)(t.row)),1))]),_:3},16)}}});const Y=G;var j=Y,H=a(77649);a(87603);const J={key:2};var q=(0,l.pM)({__name:"InlineNumberColumn",props:{size:{default:"default"},min:{default:void 0},max:{default:void 0},step:{default:void 0},precision:{default:void 0},clearable:{type:Boolean,default:!0}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,r=(0,i.KR)(),{isEdit:s,getRowData:d,getRowValue:u,onChange:m,reset:y}=g(!1,n,r);return t({reset:y,focus:()=>{r.value&&r.value.focus()}}),(e,t)=>{const a=H.lq,n=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(t=>[(0,i.R1)(s)(t.row)?((0,l.uX)(),(0,l.Wv)(n,{key:0,label:"",prop:e.$attrs.field},{default:(0,l.k6)(()=>[(0,l.bF)(a,{ref_key:"inputWidget",ref:r,style:{width:"100%"},size:e.size,miin:e.min,max:e.max,step:e.step,precision:e.precision,controls:!1,clearable:e.clearable,"model-value":(0,i.R1)(d),"onUpdate:modelValue":(0,i.R1)(m)},null,8,["size","miin","max","step","precision","clearable","model-value","onUpdate:modelValue"])]),_:1},8,["prop"])):e.$slots.default?(0,l.RG)(e.$slots,"default",{key:1,row:t.row}):((0,l.uX)(),(0,l.CE)("span",J,(0,c.v_)((0,i.R1)(u)(t.row)),1))]),_:3},16)}}});const $=q;var Z=$,ee=a(14022);a(72343);const te={key:2};var ae=(0,l.pM)({__name:"InlineInputColumn",props:{size:{default:"default"},clearable:{type:Boolean,default:!0}},emits:["change"],setup(e,{expose:t,emit:a}){const n=a,r=(0,i.KR)(),{isEdit:s,getRowData:d,getRowValue:u,onChange:m,reset:y}=g(!1,n,r);return t({reset:y,focus:()=>{r.value&&r.value.focus()}}),(e,t)=>{const a=ee.WK,n=p.xE;return(0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),(0,c._B)((0,l.Ng)(e.$attrs)),{default:(0,l.k6)(t=>[(0,i.R1)(s)(t.row)?((0,l.uX)(),(0,l.Wv)(n,{key:0,label:"",prop:e.$attrs.field},{default:(0,l.k6)(()=>[(0,l.bF)(a,{ref_key:"inputWidget",ref:r,size:e.size,clearable:e.clearable,"model-value":(0,i.R1)(d),"onUpdate:modelValue":(0,i.R1)(m)},null,8,["size","clearable","model-value","onUpdate:modelValue"])]),_:1},8,["prop"])):e.$slots.default?(0,l.RG)(e.$slots,"default",{key:1,row:t.row}):((0,l.uX)(),(0,l.CE)("span",te,(0,c.v_)((0,i.R1)(u)(t.row)),1))]),_:3},16)}}});const le=ae;var ie=le,oe=(a(98421),a(92358)),ne=(a(5954),a(25136)),re=(a(69957),a(44114),a(7588),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(45130)),se=a(61473),de=a(26695),ue=a(89813),pe=a(57477),ce=a(70944),me=a(89277),ge=a(53155),ye=a(21016),fe=a(36525),ve=a(36947),he=a(18384),we=a(82572),Ce=a(88279);const be={key:0},Te={key:0},ke={key:0},Ee={key:0},Re={key:0},Se={key:0},De={key:0},Ie={key:5};function Ae(e,t,a,i,o,n){const r=(0,l.g2)("OnlineCustomTableColumnGroup",!0),s=ie,d=Z,u=j,p=K.u,m=U,g=B.A,y=O,f=A,v=E,w=h,C=(0,l.g2)("InlineCustomDataSelect"),b=(0,l.g2)("InlineDictSelect"),T=(0,l.g2)("vxe-column"),k=(0,l.g2)("vxe-colgroup");return a.tableColumn.isGroup?((0,l.uX)(),(0,l.Wv)(k,{key:0,title:a.tableColumn.showName},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.tableColumn.children,t=>((0,l.uX)(),(0,l.CE)(l.FK,{key:t.columnId},[t.isGroup?((0,l.uX)(),(0,l.Wv)(r,{key:t.columnId+"__group",tableColumn:t,getActionUrl:a.getActionUrl,getUploadData:a.getUploadData,getUploadLimit:a.getUploadLimit,parseInlineUploadData:a.parseInlineUploadData,loadTableColummnDropdownData:a.loadTableColummnDropdownData,onTableDropdownChange:a.onTableDropdownChange,filterMethod:a.filterMethod,firstColumnField:a.firstColumnField,primaryColumnName:a.primaryColumnName,table:a.table,inlineEditConfig:a.inlineEditConfig},null,8,["tableColumn","getActionUrl","getUploadData","getUploadLimit","parseInlineUploadData","loadTableColummnDropdownData","onTableDropdownChange","filterMethod","firstColumnField","primaryColumnName","table","inlineEditConfig"])):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[t.inlineEdit?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[t.inlineEditWidgetType===o.SysCustomWidgetType.INLINE_INPUT?((0,l.uX)(),(0,l.Wv)(s,{key:0,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},null,8,["title","width","field","sortable","filters","filter-method","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.INLINE_NUMBER_INPUT?((0,l.uX)(),(0,l.Wv)(d,{key:1,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},null,8,["title","width","field","sortable","filters","filter-method","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.INLINE_DATE?((0,l.uX)(),(0,l.Wv)(u,{key:2,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},null,8,["title","width","field","sortable","filters","filter-method","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.INLINE_SWITCH?((0,l.uX)(),(0,l.Wv)(m,{key:3,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",be,(0,c.v_)(n.getObjectValue(e,t.showFieldName,a.firstColumnField)),1)):((0,l.uX)(),(0,l.Wv)(p,{key:1,size:o.layoutStore.defaultFormItemSize,type:n.getObjectValue(e,t.showFieldName)?"success":"danger"},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(n.getObjectValue(e,t.showFieldName)?"是":"否"),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","filters","filter-method","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.INLINE_UPLOAD?((0,l.uX)(),(0,l.Wv)(y,{key:4,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.showFieldName,type:t.column&&t.column.fieldKind===o.SysOnlineFieldKind.UPLOAD_IMAGE?"image":"file",action:a.getActionUrl(t),data:a.getUploadData(t),limit:a.getUploadLimit(t),rowKey:e.widget.primaryColumnName,parseUploadDataFunction:(e,l)=>a.parseInlineUploadData(t,l,e),fileListType:"dropdown",visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",Te,(0,c.v_)(n.getObjectValue(e,t.showFieldName,a.firstColumnField)),1)):((0,l.uX)(),(0,l.Wv)(g,{key:1,"file-list":n.parseTableUploadData(t,e),type:t.column.fieldKind===o.SysOnlineFieldKind.UPLOAD_IMAGE?"card":"text",direction:"horizontal",readonly:!0},null,8,["file-list","type"]))]),_:2},1032,["title","width","field","type","action","data","limit","rowKey","parseUploadDataFunction","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.INLINE_SELECT?((0,l.uX)(),(0,l.Wv)(f,{key:5,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,multiple:t.column&&t.column.fieldKind===o.SysOnlineFieldKind.MULTI_SELECT,filters:t.filterable?t[t.showFieldName]:void 0,"filter-method":a.filterMethod,loadDropdownData:e=>a.loadTableColummnDropdownData(e,t),visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,l)=>a.onTableDropdownChange(e,l,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",ke,(0,c.v_)(n.getObjectValue(e,t.showFieldName,a.firstColumnField)),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)(n.getObjectValue(e,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(p,{key:2,size:o.layoutStore.defaultFormItemSize,type:n.getCellTagType(t,e)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(n.getObjectValue(e,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","multiple","filters","filter-method","loadDropdownData","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.INLINE_CASCADER?((0,l.uX)(),(0,l.Wv)(v,{key:6,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,multiple:t.column&&t.column.fieldKind===o.SysOnlineFieldKind.MULTI_SELECT,filters:t.filterable?t[t.showFieldName]:void 0,"filter-method":a.filterMethod,loadDropdownData:e=>a.loadTableColummnDropdownData(e,t),visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",Ee,(0,c.v_)(n.getObjectValue(e,t.showFieldName,a.firstColumnField)),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)(n.getObjectValue(e,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(p,{key:2,size:o.layoutStore.defaultFormItemSize,type:n.getCellTagType(t,e)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(n.getObjectValue(e,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","multiple","filters","filter-method","loadDropdownData","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.UserSelect?((0,l.uX)(),(0,l.Wv)(w,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,editComponent:e.UserSelect,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",Re,(0,c.v_)(n.getObjectValue(e,t.showFieldName,a.firstColumnField)),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)(n.getObjectValue(e,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(p,{key:2,size:o.layoutStore.defaultFormItemSize,type:n.getCellTagType(t,e)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(n.getObjectValue(e,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","filters","filter-method","editComponent","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.DeptSelect?((0,l.uX)(),(0,l.Wv)(w,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,editComponent:e.DeptSelect,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",Se,(0,c.v_)(n.getObjectValue(e,t.showFieldName,a.firstColumnField)),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)(n.getObjectValue(e,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(p,{key:2,size:o.layoutStore.defaultFormItemSize,type:n.getCellTagType(t,e)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(n.getObjectValue(e,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","filters","filter-method","editComponent","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.DataSelect?((0,l.uX)(),(0,l.Wv)(C,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,relativeTable:t.relativeTable,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a)=>n.onInlineColumnValueChange(e,a,t)},null,8,["title","width","field","sortable","filters","filter-method","relativeTable","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===o.SysCustomWidgetType.DictSelect?((0,l.uX)(),(0,l.Wv)(b,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,widget:t.column,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"filter-method":a.filterMethod,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,onChange:(e,a,l,i)=>n.onInlineColumnValueChange(e,a,t,l,i)},null,8,["title","width","field","sortable","widget","filters","filter-method","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0)],64)):((0,l.uX)(),(0,l.Wv)(T,{key:1,title:t.showName,field:t.showFieldName,width:t.columnWidth,filters:t.filterable?e.tableColumnFilterList[t.showFieldName]:void 0,"class-name":t.supportCellClick?"cell-click":"","filter-method":a.filterMethod,sortable:t.sortable,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":a.firstColumnField===t.showFieldName,"show-overflow":void 0!=t.textShowType&&0!==t.textShowType?"title":void 0},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",De,(0,c.v_)(n.getObjectValue(e,t.showFieldName,a.firstColumnField)),1)):t.column&&"Boolean"===t.column.objectFieldType?((0,l.uX)(),(0,l.Wv)(p,{key:1,size:o.layoutStore.defaultFormItemSize,type:n.getObjectValue(e,t.showFieldName)?"success":"danger"},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(n.getObjectValue(e,t.showFieldName)?"是":"否"),1)]),_:2},1032,["size","type"])):t.column&&t.column.fieldKind===o.SysOnlineFieldKind.UPLOAD_IMAGE?((0,l.uX)(),(0,l.Wv)(g,{key:2,"file-list":n.parseTableUploadData(t,e),type:"card",direction:"horizontal",readonly:!0},null,8,["file-list"])):t.column&&t.column.fieldKind===o.SysOnlineFieldKind.UPLOAD?((0,l.uX)(),(0,l.Wv)(g,{key:3,"file-list":n.parseTableUploadData(t,e),type:"text",direction:"horizontal",readonly:!0},null,8,["file-list"])):t.needRender?((0,l.uX)(),(0,l.Wv)((0,l.$y)(()=>n.onCellRender(a.tableColumn,e)),{key:4})):t.column&&"Date"===t.column.objectFieldType?((0,l.uX)(),(0,l.CE)("span",Ie,(0,c.v_)(n.getDateColumnValue(t,e)),1)):((0,l.uX)(),(0,l.CE)(l.FK,{key:6},[0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:0,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)(n.getObjectValue(e,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(p,{key:1,size:o.layoutStore.defaultFormItemSize,type:n.getCellTagType(t,e)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(n.getObjectValue(e,t.showFieldName)),1)]),_:2},1032,["size","type"]))],64))]),_:2},1032,["title","field","width","filters","class-name","filter-method","sortable","visible","fixed","row-group-node","show-overflow"]))],64))],64))),128))]),_:1},8,["title"])):(0,l.Q3)("",!0)}function We(e,t,a,i,o,n){const r=(0,l.g2)("InlineCustomColumn");return(0,l.uX)(),(0,l.Wv)(r,(0,l.v6)({ref:"inputWidget"},e.$attrs,{disabled:a.disabled,size:a.size,clearable:a.clearable,collapseTags:a.collapseTags,placeholder:a.placeholder,relativeTable:a.relativeTable,multiple:a.multiple,editComponent:o.OnlineCustomDataSelect,onChange:n.onChange}),{default:(0,l.k6)(e=>[(0,l.Lk)("span",null,(0,c.v_)(n.getShowValue(e.row)),1)]),_:1},16,["disabled","size","clearable","collapseTags","placeholder","relativeTable","multiple","editComponent","onChange"])}var Le=a(9202),xe={name:"InlineCustomDataSelect",props:{disabled:{type:Boolean,default:!1},size:{type:String},clearable:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0},placeholder:{type:String},relativeTable:{type:Object},multiple:{type:Boolean,default:!1}},components:{InlineCustomColumn:h},inject:["form"],data(){return{OnlineCustomDataSelect:Le.A}},computed:{getRelation(){return this.form().relationMap.get(this.relativeTable.relationId)}},methods:{onChange(e,t,a){this.getRelation&&(t[this.getRelation.variableName]=a),this.$emit("input",e),this.$emit("change",e,t)},getShowValue(e){if(e.isAggregate&&null!=e.groupField){if(!0!==this.$attrs["row-group-node"])return"";let t=e._X_ROW_CHILD_LIST;if(Array.isArray(t)&&t.length>0){let a=t[0],l="";return l=null!=a[e.groupField+"DictMap"]?a[e.groupField+"DictMap"].name:null!=a[e.groupField+"DictMapList"]?a[e.groupField+"DictMapList"].map(e=>e.name).join(","):a[e.groupField],`${l} ( {childrenList.length} )`}}if(this.getRelation&&e[this.getRelation.variableName])return e[this.getRelation.variableName][this.relativeTable.displayField];{let t=this.$attrs.field;return e[t+"DictMap"]?e[t+"DictMap"].name:e[t]}},focus(){this.$refs.inputWidget&&this.$refs.inputWidget.focus&&this.$refs.inputWidget.focus()}},mounted(){console.log("InlineCustomDataSelect mounted",this.relativeTable)}};const _e=(0,s.A)(xe,[["render",We]]);var Fe=_e;function Ne(e,t,a,i,o,n){const r=(0,l.g2)("InlineCustomColumn");return(0,l.uX)(),(0,l.Wv)(r,(0,l.v6)({ref:"inputWidget"},e.$attrs,{disabled:a.disabled,size:a.size,clearable:a.clearable,collapseTags:a.collapseTags,placeholder:a.placeholder,widget:a.widget,multiple:a.multiple,editComponent:o.OnlineDictSelect,onChange:n.onChange}),{default:(0,l.k6)(e=>[(0,l.Lk)("span",null,(0,c.v_)(n.getShowValue(e.row)),1)]),_:1},16,["disabled","size","clearable","collapseTags","placeholder","widget","multiple","editComponent","onChange"])}var Oe=a(96399),Be={name:"InlineCustomDataSelect",props:{disabled:{type:Boolean,default:!1},size:{type:String},clearable:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0},placeholder:{type:String},widget:{type:Object},multiple:{type:Boolean,default:!1}},components:{InlineCustomColumn:h},inject:["form"],data(){return{OnlineDictSelect:Oe.A}},methods:{onChange(e,t,a,l){this.$emit("input",e),this.$emit("change",e,t,a,l)},getShowValue(e){if(null==e)return"";if(e.isAggregate&&null!=e.groupField){if(!0!==this.$attrs["row-group-node"])return"";let t=e._X_ROW_CHILD_LIST;if(Array.isArray(t)&&t.length>0){let a=t[0],l="";return l=null!=a[e.groupField+"DictMap"]?a[e.groupField+"DictMap"].name:null!=a[e.groupField+"DictMapList"]?a[e.groupField+"DictMapList"].map(e=>e.name).join(","):a[e.groupField],`${l}【${t.length}】`}}let t=this.$attrs.field;return e[t+"DictMap"]?e[t+"DictMap"].name:e[t+"DictMapList"]&&Array.isArray(e[t+"DictMapList"])?e[t+"DictMapList"].map(e=>e.name).join(","):e[t]},focus(){this.$refs.inputWidget&&this.$refs.inputWidget.focus&&this.$refs.inputWidget.focus()}}};const Me=(0,s.A)(Be,[["render",Ne]]);var Xe=Me;const Ve=(0,we.l5)();var Pe={name:"OnlineCustomTableColumnGroup",props:{tableColumn:{type:Object,required:!0},getActionUrl:{type:Function},getUploadData:{type:Function},getUploadLimit:{type:Function},parseInlineUploadData:{type:Function},loadTableColummnDropdownData:{type:Function},onTableDropdownChange:{type:Function},filterMethod:{type:Function},firstColumnField:{type:String},primaryColumnName:{type:String},table:{type:Object,required:!0},inlineEditConfig:{type:Object,required:!0}},components:{OnlineCustomTableColumnGroup:Ke,InlineCustomDataSelect:Fe,InlineDictSelect:Xe,VxeColgroup:o.xx,VxeColumn:o.Wq},data(){return{layoutStore:Ve,SysOnlineFieldKind:fe.SysOnlineFieldKind,SysCustomWidgetType:ye.SysCustomWidgetType}},methods:{onCellRender(e,t){return e&&e.eventInfo[ye.OnlineFormEventType.CELL_RENDER]?e.eventInfo[ye.OnlineFormEventType.CELL_RENDER](t,this.form().instanceData(),l.h,ue):(0,C.nh)(this.table.isRowEditing(t)?this.inlineEditConfig.value.rowCopy:t,e.showFieldName)},parseTableUploadData(e,t){let a=(0,C.nh)(this.table.isRowEditing(t)?this.inlineEditConfig.value.rowCopy:t,e.showFieldName);return this.parseInlineUploadData(e,t,a)},getObjectValue(e,t,a){return(0,C.nh)(this.table.isRowEditing(e)?this.inlineEditConfig.value.rowCopy:e,t,a)},getCellTagType(e,t){return e&&e.eventInfo[ye.OnlineFormEventType.CELL_TAG_TYPE]?e.eventInfo[ye.OnlineFormEventType.CELL_TAG_TYPE](t):"primary"},getDateColumnValue(e,t){let a=(0,C.nh)(this.table.isRowEditing(t)?this.inlineEditConfig.value.rowCopy:t,e.showFieldName);return null==a?"":"Date"===e.column.objectFieldType?(0,C.Yq)(a,e.dateType||"YYYY-MM-DD HH:mm:ss"):a},onInlineColumnValueChange(e,t,a,l,i){a.eventInfo&&a.eventInfo[ye.OnlineFormEventType.INLINE_VALUE_CHANGE]&&a.eventInfo[ye.OnlineFormEventType.INLINE_VALUE_CHANGE](e,t,{selectRow:l,dictData:i},this.form().instanceData())}}};const Ue=(0,s.A)(Pe,[["render",Ae]]);var Ke=Ue,ze=a(54015),Qe=a(5833),Ge=a(89001);const Ye={key:0},je={key:0},He={key:0},Je={key:0},qe={key:0},$e={key:0},Ze={key:0},et={key:0},tt={key:0},at={key:0},lt={key:2},it={key:0},ot={key:0,class:"table-empty unified-font"};var nt=(0,l.pM)({__name:"OnlineCustomTable",props:{dataList:{default:()=>[]},height:{default:"auto"},border:{default:void 0},multiSelect:{type:Boolean,default:!1},singleSelect:{type:Boolean,default:!1},operationList:{default:()=>[]},widget:{default:void 0},getTableIndex:{},sortChange:{},onSelectChange:{},onRadioChange:{},treeConfig:{default:void 0},saveRow:{type:Function,default:void 0},rowKey:{default:void 0},supportAutoEditNext:{type:Boolean,default:!0},supportCustomQuery:{type:Boolean,default:!0},isSelectDialog:{type:Boolean,default:!1}},emits:["delete","operationClick","refresh","widgetClick","updateChildWidgetList","cell-click"],setup(e,{expose:t,emit:a}){const n=(0,we.l5)(),{downloadFile:r}=(0,me.m)(),{parseUploadData:s}=(0,L.v)();(0,l.Gt)("isTableChild",!0);const d=a,m=e,g=(0,i.KR)(),y=(0,l.WQ)("form",()=>(console.error("OnlineCustomTable: form not injected"),{isEdit:!1})),f=(0,l.Ht)(),v=(0,i.KR)(null),w=(0,i.KR)([]),b=(0,i.KR)(),T=(0,i.KR)({}),k=(0,i.KR)(null),R=(0,i.KR)(),S=(0,l.EW)(()=>g.value?g.value.getInlineEditConfig():{}),D=(0,l.EW)({get:()=>m.widget.childWidgetList,set:e=>{d("updateChildWidgetList",e)}}),I=(0,l.EW)(()=>{let e={},t=y().flowData;return t&&(t.processDefinitionKey&&(e.processDefinitionKey=t.processDefinitionKey),t.processInstanceId&&(e.processInstanceId=t.processInstanceId),t.taskId&&(e.taskId=t.taskId)),e}),W=(0,l.EW)(()=>{let e=m.widget&&m.widget.props&&Array.isArray(m.widget.props.tableColumnList)?m.widget.props.tableColumnList:[],t=[];return(0,C.DS)(e,e=>{let a={...e,columnId:e.columnId||e.id,children:void 0};0===a.fieldType||null==a.fieldType?(a.column&&(a.showFieldName=a.column.columnName),null==m.widget.relation&&null!=a.relation&&(a.showFieldName=a.relation.variableName+"."+a.showFieldName),a.editFieldName=a.showFieldName,a.column&&a.column.dictInfo&&(a.showFieldName=a.showFieldName+"DictMap.name")):a.showFieldName=a.customFieldName,a.supportCellClick=null!=(a.eventInfo||{})[ye.OnlineFormEventType.CELL_CLICK],a.needRender=null!=(a.eventInfo||{})[ye.OnlineFormEventType.CELL_RENDER],t.push(a)}),(0,C.BN)(t,"columnId")}),x=async e=>{k.value=void 0,m.widget&&m.widget.eventInfo&&"function"===typeof m.widget.eventInfo[ye.OnlineFormEventType.FOOTER_DATA]&&(k.value=await m.widget.eventInfo[ye.OnlineFormEventType.FOOTER_DATA](e))},_=e=>{d("widgetClick",e)},F=e=>{if(e&&e.btnIcon)return pe[e.btnIcon];switch(e.type){case ye.SysCustomWidgetOperationType.ADD:case ye.SysCustomWidgetOperationType.INLINE_ADD:return pe.Plus;case ye.SysCustomWidgetOperationType.DELETE:return pe.Delete;case ye.SysCustomWidgetOperationType.DOWNLOAD:return pe.Download;case ye.SysCustomWidgetOperationType.IMPORT:return pe.Upload;default:return null}},N=(0,l.EW)(()=>{let e=m.operationList.filter(e=>{let t=e.enabled&&!e.rowOperation;return t=t||e.type===ye.SysCustomWidgetOperationType.INLINE_ADD,t=t&&!y().readOnly&&y().checkOperationVisible(e),t});return e=e.sort((e,t)=>{const a=null==e.showOrder?0:e.showOrder,l=null==t.showOrder?0:t.showOrder;return a-l}),e}),M=(0,l.EW)(()=>y().customConfig),X=(0,l.EW)(()=>b.value&&b.value.extraData?b.value.extraData[m.widget.variableName]:void 0),V=(0,l.EW)(()=>{let e=[];const t=X.value;return(0,C.DS)(W.value||[],a=>{t&&t.tableColumnConfig&&t.tableColumnConfig[a.columnId]?e.push({...a,...t.tableColumnConfig[a.columnId],children:void 0}):e.push({...a,show:!0,children:void 0})}),e}),P=(0,l.EW)(()=>{let e=new Set,t=V.value.map(e=>({...e})),a=(0,C.BN)(t,"columnId");V.value.forEach(t=>{if(null==t.isGroup||!t.isGroup){let l=(0,C.Zi)(a,t.columnId,"columnId");Array.isArray(l)&&l.forEach(t=>{e.add(t)})}}),t=t.filter(t=>(t.children=void 0,e.has(t.columnId))),e=null;let l=(0,C.BN)(t,"columnId");return l}),z=(0,l.EW)(()=>{let e=!1;return(0,C.DS)(P.value,t=>{t.isGroup&&(e=!0)}),e}),Q=(0,l.EW)(()=>({tableColumnList:V.value})),G=(0,l.EW)(()=>b.value&&b.value.extraData&&b.value.extraData[m.widget.variableName]&&b.value.extraData[m.widget.variableName].queryHistory||[]),Y=(0,l.EW)(()=>{if(m.isSelectDialog)return[];let e=m.operationList.filter(e=>{let t=e.enabled&&e.rowOperation;return t&&y().readOnly&&(t=t&&e.readOnly),t});return e=e.sort((e,t)=>{const a=null==e.showOrder?0:e.showOrder,l=null==t.showOrder?0:t.showOrder;return a-l}),e}),H=(0,l.EW)(()=>{let e=(0,C.PH)(m.operationList,ye.SysCustomWidgetOperationType.BATCH_DELETE,"type"),t=(0,C.PH)(m.operationList,ye.SysCustomWidgetOperationType.PRINT,"type"),a=m.operationList.find(e=>!(e.rowOperation||e.type!==ye.SysCustomWidgetOperationType.UPDATE&&e.type!==ye.SysCustomWidgetOperationType.UPDATE_DIALOG));return null!=e&&e.enabled||null!=t&&t.enabled&&!t.rowOperation||null!=a&&a.enabled&&!a.rowOperation}),J=(0,l.EW)(()=>P.value.filter(e=>e.column&&e.column.fieldKind===fe.SysOnlineFieldKind.UPLOAD_IMAGE&&e.show).length>0),q=(0,l.EW)(()=>(y().formType===ye.SysOnlineFormType.QUERY||y().formType===ye.SysOnlineFormType.ADVANCE_QUERY||y().formType===ye.SysOnlineFormType.GROUP_QUERY)&&(!!m.widget&&(m.widget.props||{}).paged)),$=(0,l.EW)(()=>!m.isSelectDialog&&(m.operationList.filter(e=>e.enabled&&!e.rowOperation).length>0&&!y().readOnly||null!=(f.operator&&f.operator()))),ee=(0,l.EW)(()=>Array.isArray(m.widget.props.likeQueryColumn)&&m.widget.props.likeQueryColumn.length>0),te=(0,l.EW)(()=>null!=m.widget.props.groupColumn&&""!==m.widget.props.groupColumn?[m.widget.props.groupColumn]:void 0),ae=(0,l.EW)(()=>{let e;if(P.value.length>0&&null!=te.value)for(let t=0;t<P.value.length;t++){let a=(0,C.IL)(P.value[t],e=>(null==e.isGroup||!e.isGroup)&&e.show);if(null!=a){e=a.showFieldName;break}}return e}),le=({value:e,cellValue:t,row:a,column:l})=>{let i=P.value.find(e=>e.showFieldName===l.field);return null!=i?a[i.editFieldName]===e:t===e},be=()=>{T.value={},m.dataList.forEach(e=>{P.value.forEach(t=>{let a;null==T.value[t.showFieldName]&&(T.value[t.showFieldName]=[]),t.column&&"Date"===t.column.objectFieldType?a=Se(t,e):t.column&&"Boolean"===t.column.objectFieldType?(a=(0,C.nh)(e,t.showFieldName),a=a?"是":"否"):a=(0,C.nh)(e,t.showFieldName),null!=a&&""!==a&&t.filterable&&null==T.value[t.showFieldName].find(e=>e.label===a)&&T.value[t.showFieldName].push({label:a,value:e[t.editFieldName]})})}),Object.keys(T.value).forEach(e=>{g.value&&g.value.getTableImpl().setFilter(e,T.value[e])})},Te=(e,t)=>e&&e.eventInfo[ye.OnlineFormEventType.CELL_TAG_TYPE]?e.eventInfo[ye.OnlineFormEventType.CELL_TAG_TYPE](t):"primary",ke=(e,t)=>e&&e.eventInfo[ye.OnlineFormEventType.CELL_RENDER]?e.eventInfo[ye.OnlineFormEventType.CELL_RENDER](t,y().instanceData(),l.h,ue):(0,C.nh)(t,e.showFieldName),Ee=({row:e,rowIndex:t,column:a,columnIndex:i})=>{if(m.widget.props.clickToEdit&&!e["_X_ROW_CHILD_LIST"]){const t=Y.value.filter(e=>e.type===ye.SysCustomWidgetOperationType.INLINE_EDIT&&e.enabled);if(t.length>0){let a=t[0];if(!y().checkOperationVisible(a,e))return;if(!y().checkOperationPermCode(a)||y().checkOperationDisabled(a,e))return;const l=e=>{g.value.editRow(e,!1),R.value=e,st()};if(R.value&&R.value["_X_ROW_KEY"]===e["_X_ROW_KEY"])return;return R.value&&g.value.isTableEditing(R.value)?(g.value.cancelEditRow(!0),l(e)):l(e)}}const o=g.value.getTableImpl();if(m.isSelectDialog&&m.multiSelect){const t=o.isCheckedByCheckboxRow(e);return o.setCheckboxRow(e,!t),void(0,l.dY)(Pe)}if(m.isSelectDialog&&m.singleSelect)return o.setRadioRow(e),void(0,l.dY)(Ue);let n=a.field,r=P.value.find(e=>e.showFieldName===n);r&&r.supportCellClick&&r.eventInfo[ye.OnlineFormEventType.CELL_CLICK](e,y().instanceData()),d("cell-click",e,g.value?g.value.getTableImpl():void 0)},Re=()=>g.value?g.value.getSearchString():null,Se=(e,t)=>{let a=(0,C.nh)(g.value.isRowEditing(t)?S.value.rowCopy:t,e.showFieldName);return null==a?"":"Date"===e.column.objectFieldType?(0,C.Yq)(a,e.dateType||"YYYY-MM-DD HH:mm:ss"):a},De=(0,l.nI)(),Ie=(0,l.EW)(()=>{let e=P.value.filter(e=>e.inlineEdit);if(0===e.length)return null;const t=De?.proxy;let a=[];return null!=t&&(a=t.$refs[e[0].columnId]),Array.isArray(a)?a[0]:a}),Ae=(0,l.EW)(()=>{let e={};return W.value.forEach(t=>{if(t.inlineEdit&&t.column){let a=(0,Ce.E)(t.column,t.showName);a&&a.length>0&&(e[t.editFieldName]=a)}}),e}),We=(0,l.EW)(()=>{if(m.widget.datasource&&m.widget.relation&&m.widget.relation.slaveTable)return[{id:m.widget.relation.slaveTable.tableName,name:m.widget.relation.relationName,children:(m.widget.relation.slaveTable.columnList||[]).map(e=>({tableName:m.widget.relation.slaveTable.tableName,id:e.columnName,name:e.columnComment,...e}))}];if(m.widget.datasource&&m.widget.datasource.masterTable){let e=[];return y().relationMap.forEach((t,a)=>{if(t.relationType===fe.SysOnlineRelationType.ONE_TO_ONE){const a={id:t.slaveTable.tableName,name:t.relationName,children:(t.slaveTable.columnList||[]).map(e=>({tableName:t.slaveTable.tableName,id:e.columnName,name:e.columnComment,...e}))};e.push(a)}}),[...e,{id:m.widget.datasource.masterTable.tableName,name:m.widget.datasource.datasourceName,children:m.widget.datasource.masterTable.columnList.map(e=>({tableName:m.widget.datasource.masterTable.tableName,id:e.columnName,name:e.columnComment,...e}))}]}return[]}),Le=(0,l.EW)(()=>{if(!m.isSelectDialog&&m.supportCustomQuery)return m.widget.props.supportAdvanceQuery?{dictList:w.value,fieldList:We.value,getDictDataList:y().getDictDataList,customQueryHistory:G.value}:void 0}),xe=e=>{null==b.value&&(b.value={id:void 0,onlineFormId:y().rawData.onlineForm.formId,extraData:{}}),null==b.value.extraData&&(b.value.extraData={}),null==b.value.extraData[m.widget.variableName]&&(b.value.extraData[m.widget.variableName]={}),b.value.extraData[m.widget.variableName].tableColumnConfig=e,b.value={...b.value};const t=y().rawData.onlineForm.formId;ve.k$.saveFormUserExt({id:(b.value||{}).id,onlineFormId:t,extraData:JSON.stringify(b.value.extraData)},{showMask:!1}).then(e=>{b.value.id=e.data}).catch(e=>{console.log(e)})},_e=e=>{let t=e.map(e=>({logicOperator:e.logicOperator,filterList:e.filterList.map(e=>{let t,a,l,i=We.value.find(t=>t.id===e.tableName),o=i?i.children.find(t=>t.id===e.columnName):null;switch(e.filterType===ye.CriteriaFilterType.IN||e.filterType===ye.CriteriaFilterType.NOT_IN?(a=!o||"String"!==o.objectFieldType&&"Date"!==o.objectFieldType?e.filterItemValue.map(e=>Array.isArray(e)?e[e.length-1]:void 0):e.filterItemValue.map(e=>{let t=Array.isArray(e)?e[e.length-1]:void 0;return t?`'${t}'`:void 0}),a=a.filter(e=>null!=e),0===a.length&&(a=null)):(t=Array.isArray(e.filterItemValue)?e.filterItemValue[e.filterItemValue.length-1]:e.filterItemValue,!o||"String"!==o.objectFieldType&&"Date"!==o.objectFieldType||e.filterType===ye.CriteriaFilterType.LIKE||(t=`'${t}'`)),e.filterType){case ye.CriteriaFilterType.EQ:l=1;break;case ye.CriteriaFilterType.NOT_EQ:l=9;break;case ye.CriteriaFilterType.GE:l=10;break;case ye.CriteriaFilterType.GT:l=11;break;case ye.CriteriaFilterType.LE:l=12;break;case ye.CriteriaFilterType.LT:l=13;break;case ye.CriteriaFilterType.LIKE:l=3;break;case ye.CriteriaFilterType.IN:l=4;break;case ye.CriteriaFilterType.NOT_IN:l=6;break;case ye.CriteriaFilterType.IS_NULL:l=7;break;case ye.CriteriaFilterType.NOT_NULL:l=8;break;default:l=1;break}return{tableName:e.tableName,columnName:e.columnName,columnValue:t,columnValueList:a,filterType:l,logicOperator:e.logicOperator}}).filter(e=>null!=e.tableName&&null!=e.columnName&&(null!=e.columnValue||null!=e.columnValueList))}));if(t=t.filter(e=>e.filterList.length>0),t.length>0){null==b.value&&(b.value={id:void 0,onlineFormId:y().rawData.onlineForm.formId,extraData:{}}),null==b.value.extraData&&(b.value.extraData={}),null==b.value.extraData[m.widget.variableName]&&(b.value.extraData[m.widget.variableName]={}),null==b.value.extraData[m.widget.variableName].queryHistory&&(b.value.extraData[m.widget.variableName].queryHistory=[]);let t=JSON.stringify(e),a=b.value.extraData[m.widget.variableName].queryHistory.findIndex(e=>e.data===t);-1===a?(b.value.extraData[m.widget.variableName].queryHistory.unshift({id:(new Date).getTime(),name:(0,C.Yq)(new Date,"YYYY-MM-DD HH:mm:ss"),data:t}),b.value.extraData[m.widget.variableName].queryHistory=b.value.extraData[m.widget.variableName].queryHistory.slice(0,10)):(b.value.extraData[m.widget.variableName].queryHistory.splice(a,1),b.value.extraData[m.widget.variableName].queryHistory.unshift({id:(new Date).getTime(),name:(0,C.Yq)(new Date,"YYYY-MM-DD HH:mm:ss"),data:t})),b.value={...b.value};const l=y().rawData.onlineForm.formId;ve.k$.saveFormUserExt({id:(b.value||{}).id,onlineFormId:l,extraData:JSON.stringify(b.value.extraData)},{showMask:!1}).then(e=>{b.value.id=e.data}).catch(e=>{console.log(e)})}Ne(t)},Ne=e=>{d("refresh",e)},Oe=e=>(0,C.PH)(m.operationList,e,"type")||{},Be=e=>y().checkOperationDisabled(e)||!y().checkOperationPermCode(e),Me=e=>m.getTableIndex&&null==m.treeConfig?m.getTableIndex(e.seq-1):e.seq,Ve=e=>{if(!m.widget.props.paged)return;let t=e.property.replace("DictMap.name",""),a=e.order;null==a&&(t=void 0),"asc"===a&&(a="ascending"),null!=v.value&&v.value?.prop===t&&v.value?.order===a||(v.value={prop:t,order:a},m.sortChange&&m.sortChange(v.value))},Pe=()=>{if(g.value&&"function"===typeof m.onSelectChange){let e=g.value.getTableImpl().getCheckboxRecords(!0);m.onSelectChange(e)}},Ue=()=>{if(g.value&&"function"===typeof m.onRadioChange){let e=g.value.getTableImpl().getRadioRecord();m.onRadioChange(e)}},nt=e=>{g.value.getTableImpl().setRadioRow(m.dataList[e]),(0,l.dY)(Ue)},rt=e=>(dt(Oe(ye.SysCustomWidgetOperationType.IMPORT),e),!1),st=()=>{null!=Ie.value&&null!=Ie.value.focus&&(0,l.dY)(()=>{Ie.value.focus()})},dt=(e,t=null)=>{if(e.type===ye.SysCustomWidgetOperationType.INLINE_ADD){let e={},t=[];m.widget.datasource&&m.widget.relation&&m.widget.relation.slaveTable?t=m.widget.relation.slaveTable.columnList:m.widget.datasource&&m.widget.datasource.masterTable&&(t=m.widget.datasource.masterTable.columnList),t.forEach(t=>{e[t.columnName]=void 0}),g.value.editRow(e,!0),R.value=e,st()}else e.type===ye.SysCustomWidgetOperationType.INLINE_EDIT?(g.value.editRow(t,!1),R.value=t,st()):d("operationClick",e,t)},ut=e=>{let t=null;return t=null!=y().flowData?he.x+"/flow/flowOnlineOperation/download":e.relationId?he.x+"/online/onlineOperation/downloadOneToManyRelation/"+(m.widget.datasource||{}).variableName:he.x+"/online/onlineOperation/downloadDatasource/"+(m.widget.datasource||{}).variableName,t},pt=(e,t)=>{if(t.widgetType!==ye.SysCustomWidgetType.Table){let a="";return t.column&&(a=t.column.columnName),null!=t.relation&&(a=t.relation.variableName+"."+a),t.column&&t.column.dictInfo&&(a+="DictMap.name"),(0,C.nh)(e,a)}},ct=(e,t,a)=>{if(null==a)return[];let l=y().flowData,i={...I.value,datasourceId:m.widget.datasource.datasourceId,relationId:e.relationId,fieldName:e.column.columnName,asImage:e.column?.fieldKind===fe.SysOnlineFieldKind.UPLOAD_IMAGE,processDefinitionKey:l?l.processDefinitionKey:void 0};null!=m.widget.primaryColumnName&&(i.dataId=t[m.widget.primaryColumnName]||"");let o=ut(e),n=JSON.parse(a);return n=Array.isArray(n)?n.map(e=>({...e,downloadUri:o})):[],s(JSON.stringify(n),i)},mt=(e,t)=>{let a=(0,C.nh)(g.value.isRowEditing(t)?S.value.rowCopy:t,e.showFieldName);return ct(e,t,a)},gt=e=>{null!=e&&Object.keys(e).forEach(t=>{let a=e[t];if("object"===typeof a&&-1===t.indexOf("DictMap"))gt(a);else if(-1!==t.indexOf("DictMapList")&&Array.isArray(e[t])){let a=t.replace("DictMapList","DictMap");e[a]={id:e[t.replace("DictMapList","")],name:e[t].map(e=>e.name).join(",")}}})},yt=e=>{const t=De?.proxy;if(null==e||null==e.column||null==t)return null;const a=t.$refs[e.column.columnId];return Array.isArray(a)?a[0]:a},ft=(e,t)=>{g.value.saveRow(t).then(a=>{if(m.saveRow)m.saveRow(e,t,a),R.value=void 0;else{let{rowData:e,nextRow:t,isNew:l,isDirty:i}=a;const o=m.widget.datasource,n=m.widget.relation;if(null!=o){let t,a={datasourceId:o.datasourceId,relationId:n?n.relationId:null,masterData:n?void 0:e,slaveData:n?e:void 0};t=l?n?he.x+"/online/onlineOperation/addOneToManyRelation/":he.x+"/online/onlineOperation/addDatasource/":n?he.x+"/online/onlineOperation/updateOneToManyRelation/":he.x+"/online/onlineOperation/updateDatasource/",t+=o.variableName,(0,ge.bE)(t,a).then(e=>{de.nk.success("保存成功！"),Ne(),R.value=void 0}).catch(e=>{console.warn(e)})}}}).catch(e=>{if(null!=e&&null!=e.message&&""!==e.message){let t=P.value.find(t=>t.column.columnName===e.message),a=yt(t);null!=a&&null!=a.focus&&a.focus()}})},vt=e=>{g.value.cancelEditRow(!0),R.value=void 0},ht=e=>P.value.find(t=>!(!t.inlineEdit||!t.column)&&t.columnId===e),wt=(e,t,a)=>{switch(e){case fe.SysOnlineParamValueType.TABLE_COLUMN:{let e=ht(t);return null!=e&&a?a[e.editFieldName]:void 0}case fe.SysOnlineParamValueType.STATIC_DICT:return Array.isArray(t)?t[1]:void 0;case fe.SysOnlineParamValueType.INPUT_VALUE:return t}},Ct=(e,t)=>new Promise((a,l)=>{if(null==t.column.dictInfo)return void l();let i={};(t.dictParams||[]).forEach(t=>{let a=wt(t.dictValueType,t.dictValue,e);a&&""!==a&&(i[t.dictParamName]=a)});let o=!1,n=t.column.dictInfo;n.dictType===ye.SysOnlineDictType.TABLE&&n.treeFlag&&t.inlineEditWidgetType===ye.SysCustomWidgetType.INLINE_SELECT&&0===Object.keys(i).length&&(o=!0),y().getDictDataList(n,i,o).then(e=>{e.forEach(e=>{e.id=e.id+"",e.parentId&&(e.parentId=e.parentId+"")}),a(e)}).catch(e=>{console.log(e)})});let bt=!1;const Tt=(e,t,a,l,i)=>{if(!bt){if(bt=!0,a.eventInfo&&a.eventInfo[ye.OnlineFormEventType.INLINE_VALUE_CHANGE]){const o={selectRow:l,dictData:i};a.eventInfo[ye.OnlineFormEventType.INLINE_VALUE_CHANGE](e,t,o,y().instanceData())}setTimeout(()=>{bt=!1},50)}},kt=(e,t,a)=>{const l=a.editFieldName;P.value.forEach(e=>{e.dictParams&&e.inlineEdit&&e.dictParams.forEach(a=>{if(a.dictValueType===fe.SysOnlineParamValueType.TABLE_COLUMN){let i=ht(a.dictValue);if(i&&i.editFieldName===l&&(t[e.editFieldName]=void 0,e.inlineEdit&&e.column)){let t=yt(e);t&&t.reset()}}})}),Tt(e,t,a)},Et=e=>{const t=m.widget.datasource,a=m.widget.relation;let l;return null!=t&&(l=a?he.x+"/online/onlineOperation/uploadOneToManyRelation/":he.x+"/online/onlineOperation/uploadDatasource/",l+=t.variableName),l},Rt=e=>{let t={...I.value,datasourceId:(m.widget.datasource||{}).datasourceId,asImage:(e.column||{}).fieldKind===fe.SysOnlineFieldKind.UPLOAD_IMAGE,fieldName:(e.column||{}).columnName};(m.widget.relation||{}).relationId&&(t.relationId=(m.widget.relation||{}).relationId);let a=y().flowData;return a&&a.processDefinitionKey&&(t.processDefinitionKey=a.processDefinitionKey),t},St=e=>(e.column||{}).maxFileCount;(0,l.wB)(()=>W.value,e=>{(e||[]).forEach(e=>{e.filterable&&(T.value[e.showFieldName]=[])}),setTimeout(()=>{be()},0)},{immediate:!0});const Dt=(0,i.KR)(0);return(0,l.wB)(()=>P.value,()=>{(0,l.dY)(()=>{g.value&&Dt.value++})},{immediate:!0}),(0,l.wB)(()=>M.value,e=>{null!=e&&(b.value=e)},{immediate:!0,deep:!0}),(0,l.wB)(()=>m.dataList,()=>{Array.isArray(m.dataList)&&(m.dataList.forEach(e=>{gt(e)}),setTimeout(()=>{st(),be()})),x(m.dataList),setTimeout(()=>{g.value&&g.value.getTableImpl().setAllRowGroupExpand(!0)},30)},{immediate:!0}),(0,l.sV)(()=>{null!=y().loadOnlineDictList&&y().loadOnlineDictList().then(e=>{w.value=e}).catch(e=>{console.log(e)})}),t({setSelectedRow:nt,getSearchString:Re}),(e,t)=>{const a=ne.S2,r=oe.j5,s=p.US,d=ie,m=Z,f=j,v=K.u,w=U,b=B.A,R=O,I=A,W=E,L=h,x=u;return(0,l.uX)(),(0,l.Wv)(ce.A,{ref_key:"table",ref:g,style:{height:"100%"},data:e.dataList,key:(0,i.R1)(Dt),rowKey:e.rowKey||e.widget.primaryColumnName,class:(0,c.C4)(["draggable-widget page-table",{"expand-table":e.widget.props.supportExpand}]),"header-cell-class-name":"table-header-gray",hasImageColumn:(0,i.R1)(J),size:(0,i.R1)(n).defaultFormItemSize,"tree-config":(0,i.R1)(te)?void 0:e.treeConfig,"seq-config":{seqMethod:Me},hasExtend:(0,i.R1)($),supportTableConfig:!0,"sort-config":{remote:(0,i.R1)(q)},inlineRules:(0,i.R1)(Ae),customQueryOptions:(0,i.R1)(Le),customConfig:(0,i.R1)(Q),showSearchString:(0,i.R1)(ee),border:(0,i.R1)(z)?"full":e.border,"show-footer":null!=(0,i.R1)(k),"footer-data":(0,i.R1)(k),"expand-config":{padding:!0,accordion:!0},supportGroup:null!=(0,i.R1)(te),"row-group-config":(0,i.R1)(te)?{groupFields:(0,i.R1)(te),showTotal:!0}:void 0,onCustomQuery:_e,onTableConfig:xe,onSortChange:Ve,onCheckboxSelectChange:Pe,onRadioSelectChange:Ue,onRefresh:t[3]||(t[3]=e=>Ne()),onCellClick:Ee},(0,l.eX)({empty:(0,l.k6)(()=>[null!=e.widget.props.supportExpand&&!1!==e.widget.props.supportExpand&&(0,i.R1)(y)().isEdit?((0,l.uX)(),(0,l.Wv)(s,{key:1,class:"full-width-input","label-width":((0,i.R1)(y)().labelWidth||100)+"px","label-position":(0,i.R1)(y)().labelPosition||"right",size:e.defaultFormItemSize,onSubmit:t[2]||(t[2]=(0,re.D$)(()=>{},["prevent"]))},{default:(0,l.k6)(()=>[(0,l.bF)(Ge.A,{value:(0,i.R1)(D),"onUpdate:value":t[1]||(t[1]=e=>(0,i.i9)(D)?D.value=e:null),isTableExpand:!0,isEdit:!0,onWidgetClick:_},null,8,["value"])]),_:1},8,["label-width","label-position","size"])):((0,l.uX)(),(0,l.CE)("div",ot,t[6]||(t[6]=[(0,l.Lk)("img",{src:se},null,-1),(0,l.Lk)("span",null,"暂无数据",-1)])))]),pagination:(0,l.k6)(()=>[(0,l.RG)(e.$slots,"pagination")]),default:(0,l.k6)(()=>[(0,i.R1)(H)&&!(0,i.R1)(y)().readOnly||e.isSelectDialog&&e.multiSelect?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:0,fixed:"left",type:"checkbox",width:50})):(0,l.Q3)("",!0),e.singleSelect?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:1,fixed:"left",type:"radio",align:"center",width:50})):(0,l.Q3)("",!0),(0,i.R1)(P).length>0&&null==(0,i.R1)(te)?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:2,field:"seq",type:"seq",title:"序号",fixed:"left",width:null!=e.treeConfig?90:60,"tree-node":null!=e.treeConfig},null,8,["width","tree-node"])):(0,l.Q3)("",!0),e.widget.props.supportExpand?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:3,fixed:"left",type:"expand",width:40},{content:(0,l.k6)(({row:t})=>[(0,l.bF)(s,{class:"full-width-input","label-width":((0,i.R1)(y)().labelWidth||100)+"px","label-position":(0,i.R1)(y)().labelPosition||"right",size:e.defaultFormItemSize},{default:(0,l.k6)(()=>[(0,l.bF)(Ge.A,{value:(0,i.R1)(D),isEdit:(0,i.R1)(y)().isEdit,isTableExpand:!0,getSubWidgetValue:e=>pt(t,e),masterTableData:t,onWidgetClick:_},null,8,["value","isEdit","getSubWidgetValue","masterTableData"])]),_:2},1032,["label-width","label-position","size"])]),_:1})):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,i.R1)(P),t=>((0,l.uX)(),(0,l.CE)(l.FK,{key:t.columnId},[t.isGroup?((0,l.uX)(),(0,l.Wv)(Ke,{key:t.columnId,tableColumn:t,getActionUrl:Et,getUploadData:Rt,getUploadLimit:St,parseInlineUploadData:ct,loadTableColummnDropdownData:Ct,onTableDropdownChange:kt,firstColumnField:(0,i.R1)(ae),primaryColumnName:e.widget.primaryColumnName,table:(0,i.R1)(g),inlineEditConfig:(0,i.R1)(S)},null,8,["tableColumn","firstColumnField","primaryColumnName","table","inlineEditConfig"])):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[t.inlineEdit?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).INLINE_INPUT?((0,l.uX)(),(0,l.Wv)(d,{key:0,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},null,8,["title","width","field","sortable","filters","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).INLINE_NUMBER_INPUT?((0,l.uX)(),(0,l.Wv)(m,{key:1,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},null,8,["title","width","field","sortable","filters","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).INLINE_DATE?((0,l.uX)(),(0,l.Wv)(f,{key:2,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},null,8,["title","width","field","sortable","filters","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).INLINE_SWITCH?((0,l.uX)(),(0,l.Wv)(w,{key:3,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",Ye,(0,c.v_)((0,i.R1)(C.nh)(e,t.showFieldName,(0,i.R1)(ae))),1)):((0,l.uX)(),(0,l.Wv)(v,{key:1,size:(0,i.R1)(n).defaultFormItemSize,type:(0,i.R1)(C.nh)(e,t.showFieldName)?"success":"danger"},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,i.R1)(C.nh)(e,t.showFieldName)?"是":"否"),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","filters","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).INLINE_UPLOAD?((0,l.uX)(),(0,l.Wv)(R,{key:4,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.showFieldName,type:t.column&&t.column.fieldKind===(0,i.R1)(fe.SysOnlineFieldKind).UPLOAD_IMAGE?"image":"file",action:Et(t),data:Rt(t),limit:St(t),rowKey:e.widget.primaryColumnName,parseUploadDataFunction:(e,a)=>ct(t,a,e),fileListType:"dropdown",visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",je,(0,c.v_)((0,i.R1)(C.nh)(e,t.showFieldName,(0,i.R1)(ae))),1)):((0,l.uX)(),(0,l.Wv)(b,{key:1,"file-list":mt(t,e),type:t.column.fieldKind===(0,i.R1)(fe.SysOnlineFieldKind).UPLOAD_IMAGE?"card":"text",direction:"horizontal",readonly:!0},null,8,["file-list","type"]))]),_:2},1032,["title","width","field","type","action","data","limit","rowKey","parseUploadDataFunction","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).INLINE_SELECT?((0,l.uX)(),(0,l.Wv)(I,{key:5,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,multiple:t.column&&t.column.fieldKind===(0,i.R1)(fe.SysOnlineFieldKind).MULTI_SELECT,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,loadDropdownData:e=>Ct(e,t),visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>kt(e,a,t)},{default:(0,l.k6)(({row:a})=>[a.isAggregate&&null!=a.groupField?((0,l.uX)(),(0,l.CE)("span",He,(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName,(0,i.R1)(ae))),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(v,{key:2,size:e.defaultFormItemSize,type:Te(t,a)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","multiple","filters","loadDropdownData","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).INLINE_CASCADER?((0,l.uX)(),(0,l.Wv)(W,{key:6,ref_for:!0,ref:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,multiple:t.column&&t.column.fieldKind===(0,i.R1)(fe.SysOnlineFieldKind).MULTI_SELECT,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,loadDropdownData:e=>Ct(e,t),visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},{default:(0,l.k6)(({row:a})=>[a.isAggregate&&null!=a.groupField?((0,l.uX)(),(0,l.CE)("span",Je,(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName,(0,i.R1)(ae))),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(v,{key:2,size:e.defaultFormItemSize,type:Te(t,a)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","multiple","filters","loadDropdownData","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).UserSelect?((0,l.uX)(),(0,l.Wv)(L,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,editComponent:Qe.A,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},{default:(0,l.k6)(({row:a})=>[a.isAggregate&&null!=a.groupField?((0,l.uX)(),(0,l.CE)("span",qe,(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName,(0,i.R1)(ae))),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(v,{key:2,size:e.defaultFormItemSize,type:Te(t,a)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","filters","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).DeptSelect?((0,l.uX)(),(0,l.Wv)(L,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,editComponent:ze.A,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},{default:(0,l.k6)(({row:a})=>[a.isAggregate&&null!=a.groupField?((0,l.uX)(),(0,l.CE)("span",$e,(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName,(0,i.R1)(ae))),1)):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),3)):((0,l.uX)(),(0,l.Wv)(v,{key:2,size:e.defaultFormItemSize,type:Te(t,a)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName)),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","field","sortable","filters","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).DataSelect?((0,l.uX)(),(0,l.Wv)(Fe,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,relativeTable:t.relativeTable,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a)=>Tt(e,a,t)},null,8,["title","width","field","sortable","filters","relativeTable","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0),t.inlineEditWidgetType===(0,i.R1)(ye.SysCustomWidgetType).DictSelect?((0,l.uX)(),(0,l.Wv)(Xe,{ref_for:!0,ref:t.columnId,key:t.columnId,title:t.showName,width:t.columnWidth,field:t.editFieldName,sortable:t.sortable,widget:t,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,onChange:(e,a,l,i)=>Tt(e,a,t,l,i)},null,8,["title","width","field","sortable","widget","filters","visible","fixed","row-group-node","onChange"])):(0,l.Q3)("",!0)],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[t.column&&"Boolean"===t.column.objectFieldType?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:t.id+"Boolean",title:t.showName,width:t.columnWidth,filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",Ze,(0,c.v_)((0,i.R1)(C.nh)(e,t.showFieldName,(0,i.R1)(ae))),1)):((0,l.uX)(),(0,l.Wv)(v,{key:1,size:(0,i.R1)(n).defaultFormItemSize,type:(0,i.R1)(C.nh)((0,i.R1)(g).isRowEditing(e)?(0,i.R1)(S).rowCopy:e,t.showFieldName)?"success":"danger"},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,i.R1)(C.nh)((0,i.R1)(g).isRowEditing(e)?(0,i.R1)(S).rowCopy:e,t.showFieldName)?"是":"否"),1)]),_:2},1032,["size","type"]))]),_:2},1032,["title","width","filters","visible","fixed","row-group-node"])):t.column&&t.column.fieldKind===(0,i.R1)(fe.SysOnlineFieldKind).UPLOAD_IMAGE?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:t.id+"Image",title:t.showName,width:t.columnWidth,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",et,(0,c.v_)((0,i.R1)(C.nh)(e,t.showFieldName,(0,i.R1)(ae))),1)):((0,l.uX)(),(0,l.Wv)(b,{key:1,"file-list":mt(t,e),type:"card",direction:"horizontal",readonly:!0},null,8,["file-list"]))]),_:2},1032,["title","width","visible","fixed","row-group-node"])):t.column&&t.column.fieldKind===(0,i.R1)(fe.SysOnlineFieldKind).UPLOAD?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:t.id+"File",title:t.showName,width:t.columnWidth,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",tt,(0,c.v_)((0,i.R1)(C.nh)(e,t.showFieldName,(0,i.R1)(ae))),1)):((0,l.uX)(),(0,l.Wv)(b,{key:1,"file-list":mt(t,e),type:"text",direction:"horizontal",readonly:!0},null,8,["file-list"]))]),_:2},1032,["title","width","visible","fixed","row-group-node"])):t.column&&"Date"===t.column.objectFieldType?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:t.columnId,title:t.showName,field:t.showFieldName,width:t.columnWidth,"class-name":t.supportCellClick?"cell-click":"",filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName,"show-overflow":void 0!=t.textShowType&&0!==t.textShowType?"title":void 0},{default:(0,l.k6)(({row:e})=>[e.isAggregate&&null!=e.groupField?((0,l.uX)(),(0,l.CE)("span",at,(0,c.v_)((0,i.R1)(C.nh)(e,t.showFieldName,(0,i.R1)(ae))),1)):t.needRender?((0,l.uX)(),(0,l.Wv)((0,l.$y)(()=>ke(t,e)),{key:1})):((0,l.uX)(),(0,l.CE)("span",lt,(0,c.v_)(Se(t,e)),1))]),_:2},1032,["title","field","width","class-name","filters","visible","fixed","row-group-node","show-overflow"])):((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:t.id+"Other",title:t.showName,field:t.showFieldName,width:t.columnWidth,sortable:t.sortable,"class-name":t.supportCellClick?"cell-click":"",filters:t.filterable?(0,i.R1)(T)[t.showFieldName]:void 0,"filter-method":le,"show-overflow":void 0!=t.textShowType&&0!==t.textShowType?"title":void 0,visible:t.show,fixed:"none"===t.fixed?void 0:t.fixed,"row-group-node":(0,i.R1)(ae)===t.showFieldName},{default:(0,l.k6)(({row:a})=>[a.isAggregate&&null!=a.groupField?((0,l.uX)(),(0,l.CE)("span",it,(0,c.v_)((0,i.R1)(C.nh)(a,t.showFieldName,(0,i.R1)(ae))),1)):t.needRender?((0,l.uX)(),(0,l.Wv)((0,l.$y)(()=>ke(t,a)),{key:1})):0===t.fieldShowType||null==t.fieldShowType?((0,l.uX)(),(0,l.CE)("span",{key:2,class:(0,c.C4)({"cell-click":t.supportCellClick})},(0,c.v_)((0,i.R1)(C.nh)((0,i.R1)(g).isRowEditing(a)?(0,i.R1)(S).rowCopy:a,t.showFieldName)),3)):1===t.fieldShowType?((0,l.uX)(),(0,l.Wv)(v,{key:3,size:e.defaultFormItemSize,type:Te(t,a)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,i.R1)(C.nh)((0,i.R1)(g).isRowEditing(a)?(0,i.R1)(S).rowCopy:a,t.showFieldName)),1)]),_:2},1032,["size","type"])):(0,l.Q3)("",!0)]),_:2},1032,["title","field","width","sortable","class-name","filters","show-overflow","visible","fixed","row-group-node"]))],64))],64))],64))),128)),e.supportAutoEditNext?((0,l.uX)(),(0,l.Wv)(x,{key:4,onSave:t[0]||(t[0]=e=>ft(e,!0))})):(0,l.Q3)("",!0),(0,i.R1)(Y).length>0&&(0,i.R1)(P).length>0?((0,l.uX)(),(0,l.Wv)((0,i.R1)(o.Wq),{key:5,title:"操作",width:e.widget.props.operationColumnWidth||160,fixed:"right","show-overflow":!1},{default:(0,l.k6)(({row:e})=>[(0,i.R1)(g).isRowEditing(e)||!0===e.isAggregate?!0!==e.isAggregate?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.bF)(a,{link:"",type:"primary",size:(0,i.R1)(n).defaultFormItemSize,onClick:(0,re.D$)(t=>ft(e,!1),["stop"])},{default:(0,l.k6)(()=>t[4]||(t[4]=[(0,l.eW)(" 保存 ")])),_:2,__:[4]},1032,["size","onClick"]),(0,l.bF)(a,{link:"",type:"primary",size:(0,i.R1)(n).defaultFormItemSize,onClick:(0,re.D$)(t=>vt(e),["stop"])},{default:(0,l.k6)(()=>t[5]||(t[5]=[(0,l.eW)(" 取消 ")])),_:2,__:[5]},1032,["size","onClick"])],64)):(0,l.Q3)("",!0):((0,l.uX)(!0),(0,l.CE)(l.FK,{key:0},(0,l.pI)((0,i.R1)(Y),t=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(a,{key:t.id,size:(0,i.R1)(n).defaultFormItemSize,link:"",class:(0,c.C4)(t.btnClass),disabled:!(0,i.R1)(y)().checkOperationPermCode(t)||(0,i.R1)(y)().checkOperationDisabled(t,e)||(0,i.R1)(g).isTableEditing(e),onClick:(0,re.D$)(a=>dt(t,e),["stop"])},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(t.name),1)]),_:2},1032,["size","class","disabled","onClick"])),[[re.aG,(0,i.R1)(y)().checkOperationVisible(t,e)]])),128))]),_:1},8,["width"])):(0,l.Q3)("",!0)]),_:2},[e.operationList.filter(e=>e.enabled&&!e.rowOperation||e.type===(0,i.R1)(ye.SysCustomWidgetOperationType).INLINE_ADD).length>0&&!(0,i.R1)(y)().readOnly&&!e.isSelectDialog?{name:"operator",fn:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,i.R1)(N),e=>((0,l.uX)(),(0,l.CE)(l.FK,{key:e.id},[e.type===(0,i.R1)(ye.SysCustomWidgetOperationType).IMPORT?((0,l.uX)(),(0,l.Wv)(r,{key:0,class:"table-operation",style:{display:"inline-block"},action:"","show-file-list":!1,accept:".xlsx, .xls","before-upload":rt},{default:(0,l.k6)(()=>[(0,l.bF)(a,{size:(0,i.R1)(n).defaultFormItemSize,type:e.btnType,plain:e.plain,disabled:Be(e),icon:F(e)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(e.name||"导入"),1)]),_:2},1032,["size","type","plain","disabled","icon"])]),_:2},1024)):((0,l.uX)(),(0,l.Wv)(a,{key:1,class:"table-operation",size:(0,i.R1)(n).defaultFormItemSize,type:e.btnType,plain:e.plain,disabled:Be(e),icon:F(e),onClick:t=>dt(e)},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(e.name),1)]),_:2},1032,["size","type","plain","disabled","icon","onClick"]))],64))),128))]),key:"0"}:void 0]),1032,["data","rowKey","class","hasImageColumn","size","tree-config","seq-config","hasExtend","sort-config","inlineRules","customQueryOptions","customConfig","showSearchString","border","show-footer","footer-data","supportGroup","row-group-config"])}}});const rt=(0,s.A)(nt,[["__scopeId","data-v-51fc918e"]]);var st=rt},52912:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAUASURBVHgB7Zw/jBtFFMbfzPoQhCj4JApoyEaioEHy0UARhNPRxYco6HAkSiSupMORKCgTiR7TH0rSIZqzIDWcREMB0h4NFCdhkij/PZP37c749vbWPu94dr2285P2vHuW726+eW9m3ps3J6gC/rvRDklRW5FqSSnO87dCvprmNU3E1xCvSukDqeWAAoo2twf7VDKCSoIb31ZKdbjhn1LS6HmI+BrQSNza/Hhwk0rAqxBxz5Pihosdmr/xk4gIopC4ypYSkSe8CAEBlFY9KeLer5K+L0HmEoIF4F5XXxkLWCT9eQVxFuJwt90JAv0dlecCRYlI697mRz9/Tw4UFqJGVjABfY1IwjqGRT5VSIhkMNQ3+LZF9Sbipl0q4iozC8EitIwIIS0HURExZhLCiLBH9RkPZmVoxDh1QXaqEMYdfqPlE8Eykxhy2ptGhGW0hDRNuHTSlslMtIhkdogtIaTVYN9YRu5sMsUiMEWujAigZdqUS65FHP7Q7gYyXiytHiOxnRe4nRAiNS6E5Al55jV6+d2vKXjlzUKfU/f/pXu3d+JXj2DwvJB1kROugeCJPLvEmXe+LCwCgIAvvf05eaaZ5yLHhIA1LCCCnIrYOEv+ETvZWaSRfjChNLmA3nvxre74+ck/t+PLJxuvX4wvoJ/co0d/7c7hNhpWccU+jYUwY4OzNZy9eC0Ww4I/0LcQcK8X3vhw/Nx4tUV39z4jR7rc5nHoPnYNMzY4kxYhC3qvDFzGnTScSuza+7EQ7BIfkEfSvv3wj76TCUPAB79/S2XB+dQv7H3sGoe773fI80wBX7Y+PPr/T7rz0ydTrSaPtHgQNu0WnmgiyczuMYiFEFJ0yDNoNMYNX2sAuEEZMwgy7fySCOHbLSwQo6gVVI3ZbtiRSa5hpWKKorB7vBfK0WgU0pozUhtt9grRpjVHkOCtyGQvcq3hxXSIdURINQPrB88R51TYK85DiFql4SAAls1Yd2AdUhHNWllENv9QoVWEkmpCVgQsoNLRbNlUJgQaeP/Xb+jx3z/mvpcVAavScnIR+TSoIuDvEAEXGmx7uw4iAFhERBVgEyoA0aiNSOsgAhNBiEK7xq4giYLcpQVCYHaogQhgWJlFAITRaTFswmbBIpDW+kCieo0qJCvGokUAWlPU0CR5K0xTlUAMCPD0cD++X6QIYKOh9xqBRIVa9UCIeXOOvhip4ECaLG4lA2ZNiQta4wUVjxNOBVgrwgBfYiE4Fi+lmnUZCKSK2x4LgSwurad7ROcu/3ILN0cbPKSv0/oxsDdHGzwk+7R2iKv2biwEZg+l12rQ7KdLD4+F4VLIHq0NR9YAjgkRW4VyGyvK2uidxhwZrH62EPVEYoan0h45zCDYrK0y4QrhEcE6EGWtAeRWhfDuV8eUG68cgdTdc5dPVvDnpurYbG66ukitUeJ6nghgYs7SuEjph8oqJOLW9ia9OVGIpPxObFOFiZsSiaZV3YJZitKXtTLfgg7dOu24wqnp/KSqXVyi5YxFhrOe2ZhpX8OIsUXL5SbRrGc1gMtRJq/lySWBjtsucpSp0E5X8oPFVq2nVp4ii57nAs7HHdk6uqZ6NaR6gPHgCtZA5IDz3if/wj6Ur0XEmljBBVcRwPMj0QYvQlhSgqBcMaRygAtgjOrX7pB8HgjcWJSOJ1GGyLQjyWzyq94pTYg0tpZTKdUu9I80sAvHG1A+e34SzwCbVjUqLRNTFwAAAABJRU5ErkJggg=="},54015:function(e,t,a){a.d(t,{A:function(){return g}});var l=a(85415),i=(a(97042),a(22243),a(7409),a(44114),a(18111),a(22489),a(61701),a(56768)),o=a(90144),n=a(27007),r=a(54428),s=a(31372),d=a(85386);const u={class:"dept-select"};var p=(0,i.pM)({__name:"index",props:{modelValue:{},size:{default:"default"},placeholder:{},props:{default:()=>({label:"deptName",value:"deptId"})},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0}},emits:["update:modelValue","change","blur","focus"],setup(e,{emit:t}){const a=t,p=e,c=(0,o.KR)((0,n.yk)()),m=(0,o.KR)([]),g=(0,i.EW)(()=>p.props),y=e=>{m.value=[],p.multiple?Array.isArray(e)&&(m.value=e):null!=e&&m.value.push(e),C()&&w()},f=e=>{e&&s.l.show("部门选择",d["default"],{area:["900px","650px"],offset:"100px"},{value:m.value,props:p.props,path:"thirdSelectDept/"+c.value,multiple:p.multiple},{width:"900px",height:"650px",pathName:"/thirdParty/thirdSelectDept"}).then(e=>{y(e)}).catch(e=>{console.log(e)})},v=e=>{m.value=m.value.filter(t=>t[p.props.value]!==e),w()},h=()=>{m.value=[],w()},w=()=>{let e,t;p.multiple?e=m.value.map(e=>(null==t&&(t=[]),t.push({id:e[p.props.value],name:e[p.props.label]}),e[p.props.value])):(e=(m.value[0]||{})[p.props.value],null!=e&&(t={id:e,name:(m.value[0]||{})[p.props.label]})),a("update:modelValue",e),a("change",e,m.value,t)},C=()=>{let e=p.multiple&&Array.isArray(p.modelValue)?(p.modelValue||[]).sort((e,t)=>e===t?0:e<t?-1:1).join(","):p.modelValue||"",t=m.value.sort((e,t)=>e[p.props.value]===t[p.props.value]?0:e[p.props.value]<t[p.props.value]?-1:1).map(e=>e[p.props.value]).join(",");return e!==t},b=()=>{let e={widgetType:"upms_dept"};(null==p.modelValue||""===p.modelValue||p.modelValue.length<=0)&&(m.value=[]),p.multiple?e.fieldValues=Array.isArray(p.modelValue)?p.modelValue:[]:(e.fieldValues=Array.isArray(p.modelValue)?p.modelValue[0]:p.modelValue,e.fieldValues=null==e.fieldValues?[]:[e.fieldValues]),Array.isArray(e.fieldValues)&&e.fieldValues.length>0&&(e.fieldValues=e.fieldValues.join(","),r.If.viewByIds(e,{showMask:!1}).then(e=>{Array.isArray(e.data)&&(m.value=e.data)}).catch(e=>{console.warn(e)}))};return(0,i.wB)(()=>p.modelValue,()=>{p.modelValue&&b()},{immediate:!0}),(e,t)=>{const n=l.P9,r=l.AV;return(0,i.uX)(),(0,i.CE)("div",u,[(0,i.bF)(r,{"model-value":e.modelValue,style:{width:"100%"},multiple:e.multiple,disabled:e.disabled,size:e.size,clearable:e.clearable,"collapse-tags":e.collapseTags,placeholder:e.placeholder,teleported:!1,"popper-class":"dept-select-popper",onVisibleChange:f,onRemoveTag:v,onClear:h,onBlur:t[0]||(t[0]=()=>a("blur")),onFocus:t[1]||(t[1]=()=>a("focus"))},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,o.R1)(m),e=>((0,i.uX)(),(0,i.Wv)(n,{key:e[(0,o.R1)(g).value],label:e[(0,o.R1)(g).label],value:e[(0,o.R1)(g).value]},null,8,["label","value"]))),128))]),_:1},8,["model-value","multiple","disabled","size","clearable","collapse-tags","placeholder"])])}}}),c=a(71241);const m=(0,c.A)(p,[["__scopeId","data-v-70a8eb8e"]]);var g=m},54428:function(e,t,a){a.d(t,{v9:function(){return n},n5:function(){return r},lE:function(){return f},_4:function(){return w},C7:function(){return u},If:function(){return C},qY:function(){return d},ek:function(){return p},$z:function(){return c},$D:function(){return h},S_:function(){return y},fe:function(){return s},sV:function(){return m},r0:function(){return g.A}});a(18111),a(61701);var l=a(55583),i=a(52081),o=a(18384);class n extends l.w{static dictSysRole(e,t){return new Promise((a,l)=>{super.get(o.x+"/upms/sysRole/listDict",e,t).then(e=>{const t=new i.w("角色字典",e.data);a(t)}).catch(e=>{l(e)})})}static dictGlobalDict(e,t){return new Promise((a,l)=>{super.get(o.x+"/upms/globalDict/listDict",e,t).then(e=>{const t=new i.w("编码字典",(e.data||[]).map(e=>({...e,disabled:1===e.status})));a(t)}).catch(e=>{l(e)})})}static dictGlobalDictByIds(e,t){return new Promise((a,l)=>{super.get(o.x+"/upms/globalDict/listDictByIds",e,t).then(e=>{const t=new i.w("编码字典",e.data);a(t)}).catch(e=>{l(e)})})}static dictAllMenu(e,t){return new Promise((a,l)=>{super.get(o.x+"/upms/sysMenu/listDict",e,t).then(e=>{const t=new i.w("菜单字典",e.data);a(t)}).catch(e=>{l(e)})})}static dictSysMenu(e,t){return new Promise((a,l)=>{super.get(o.x+"/upms/sysMenu/listMenuDict",e,t).then(e=>{const t=new i.w("菜单字典",e.data);a(t)}).catch(e=>{l(e)})})}static dictDeptPost(e,t){return new Promise((a,l)=>{super.get(o.x+"/upms/sysDept/listSysDeptPostWithRelation",e,t).then(e=>{a(e.data)}).catch(e=>{l(e)})})}static dictSysPost(e,t){return new Promise((a,l)=>{super.get(o.x+"/upms/sysPost/listDict",e,t).then(e=>{const t=new i.w("岗位字典",e.data);a(t)}).catch(e=>{l(e)})})}static dictReportDblink(e,t){return new Promise((a,l)=>{super.get(o.x+"/report/reportDblink/listDict",e,t).then(e=>{const t=new i.w("数据库链接",e.data);a(t)}).catch(e=>{l(e)})})}static dictReportDict(e,t){return new Promise((a,l)=>{super.get(o.x+"/report/reportDict/listDict",e,t).then(e=>{const t=new i.w("字典管理",e.data);a(t)}).catch(e=>{l(e)})})}static dictSysUser(e,t){return new Promise((a,l)=>{super.get("/admin/upms/sysUser/listDict",e,t).then(e=>{let t=new i.w("用户字典",e.data);a(t)}).catch(e=>{l(e)})})}static dictSysDept(e,t){return new Promise((a,l)=>{super.get("/admin/upms/sysDept/listDict",e,t).then(e=>{let t=new i.w("部门字典",e.data);a(t)}).catch(e=>{l(e)})})}static dictSysDeptByParentId(e,t){return new Promise((a,l)=>{super.get("/admin/upms/sysDept/listDictByParentId",e,t).then(e=>{let t=new i.w("部门字典",e.data);a(t)}).catch(e=>{l(e)})})}}class r extends l.w{static listSysLoginUser(e,t){return super.post(o.x+"/upms/loginUser/list",e,t)}static deleteSysLoginUser(e,t){return super.post(o.x+"/upms/loginUser/delete",e,t)}}class s extends l.w{static getMenuPermList(e,t){return super.post(o.x+"/upms/sysMenu/list",e,t)}static addMenu(e,t){return super.post(o.x+"/upms/sysMenu/add",e,t)}static updateMenu(e,t){return super.post(o.x+"/upms/sysMenu/update",e,t)}static deleteMenu(e,t){return super.post(o.x+"/upms/sysMenu/delete",e,t)}static viewMenu(e,t){return super.get(o.x+"/upms/sysMenu/view",e,t)}static listMenuPermCode(e,t){return super.get(o.x+"/upms/sysMenu/listMenuPerm",e,t)}static listSysPermByMenuIdWithDetail(e,t){return super.get(o.x+"/upms/sysMenu/listSysPermWithDetail",e,t)}static listSysUserByMenuIdWithDetail(e,t){return super.get(o.x+"/upms/sysMenu/listSysUserWithDetail",e,t)}}class d extends l.w{static updateSysConf(e,t){return super.post(o.x+"/upms/sysConf/update",e,t)}static getSysConf(e,t){return super.get(o.x+"/upms/sysConf/view",e,t)}}class u extends l.w{static getPermCodeList(e,t){return super.get(o.x+"/upms/login/getAllPermCodes",e,t)}}class p extends l.w{static add(e,t){return super.post(o.x+"/upms/sysDataPerm/add",e,t)}static update(e,t){return super.post(o.x+"/upms/sysDataPerm/update",e,t)}static delete(e,t){return super.post(o.x+"/upms/sysDataPerm/delete",e,t)}static list(e,t){return super.post(o.x+"/upms/sysDataPerm/list",e,t)}static view(e,t){return super.get(o.x+"/upms/sysDataPerm/view",e,t)}static listDataPermUser(e,t){return super.post(o.x+"/upms/sysDataPerm/listDataPermUser",e,t)}static addDataPermUser(e,t){return super.post(o.x+"/upms/sysDataPerm/addDataPermUser",e,t)}static deleteDataPermUser(e,t){return super.post(o.x+"/upms/sysDataPerm/deleteDataPermUser",e,t)}static listNotInDataPermUser(e,t){return super.post(o.x+"/upms/sysDataPerm/listNotInDataPermUser",e,t)}}class c extends l.w{static list(e,t){return super.post(o.x+"/upms/sysDept/list",e,t)}static view(e,t){return super.get(o.x+"/upms/sysDept/view",e,t)}static export(e,t){return super.download(o.x+"/upms/sysDept/export",e,t)}static add(e,t){return super.post(o.x+"/upms/sysDept/add",e,t)}static update(e,t){return super.post(o.x+"/upms/sysDept/update",e,t)}static delete(e,t){return super.post(o.x+"/upms/sysDept/delete",e,t)}static listNotInSysDeptPost(e,t){return super.post(o.x+"/upms/sysDept/listNotInSysDeptPost",e,t)}static listSysDeptPost(e,t){return super.post(o.x+"/upms/sysDept/listSysDeptPost",e,t)}static addSysDeptPost(e,t){return super.post(o.x+"/upms/sysDept/addSysDeptPost",e,t)}static updateSysDeptPost(e,t){return super.post(o.x+"/upms/sysDept/updateSysDeptPost",e,t)}static deleteSysDeptPost(e,t){return super.post(o.x+"/upms/sysDept/deleteSysDeptPost",e,t)}static viewSysDeptPost(e,t){return super.get(o.x+"/upms/sysDept/viewSysDeptPost",e,t)}}class m extends l.w{static getRoleList(e,t){return super.post(o.x+"/upms/sysRole/list",e,t)}static getRole(e,t){return super.get(o.x+"/upms/sysRole/view",e,t)}static deleteRole(e,t){return super.post(o.x+"/upms/sysRole/delete",e,t)}static addRole(e,t){return super.post(o.x+"/upms/sysRole/add",e,t)}static updateRole(e,t){return super.post(o.x+"/upms/sysRole/update",e,t)}static listRoleUser(e,t){return super.post(o.x+"/upms/sysRole/listUserRole",e,t)}static listNotInUserRole(e,t){return super.post(o.x+"/upms/sysRole/listNotInUserRole",e,t)}static addRoleUser(e,t){return super.post(o.x+"/upms/sysRole/addUserRole",e,t)}static deleteRoleUser(e,t){return super.post(o.x+"/upms/sysRole/deleteUserRole",e,t)}}var g=a(21013);class y extends l.w{static list(e,t){return super.post(o.x+"/upms/sysPost/list",e,t)}static view(e,t){return super.get(o.x+"/upms/sysPost/view",e,t)}static add(e,t){return super.post(o.x+"/upms/sysPost/add",e,t)}static update(e,t){return super.post(o.x+"/upms/sysPost/update",e,t)}static delete(e,t){return super.post(o.x+"/upms/sysPost/delete",e,t)}}class f extends l.w{static list(e,t){return super.post(o.x+"/mobile/mobileEntry/list",e,t)}static view(e,t){return super.get(o.x+"/mobile/mobileEntry/view",e,t)}static add(e,t){return super.post(o.x+"/mobile/mobileEntry/add",e,t)}static update(e,t){return super.post(o.x+"/mobile/mobileEntry/update",e,t)}static delete(e,t){return super.post(o.x+"/mobile/mobileEntry/delete",e,t)}static uploadImage(e,t){return super.post(o.x+"/mobile/mobileEntry/uploadImage",e,t)}static downloadImage(e,t){return super.post(o.x+"/mobile/mobileEntry/downloadImage",e,t)}}var v=a(53155);class h{static list(e,t){return(0,v.bE)(o.x+"/upms/globalDict/list",e,t)}static listAll(e,t){return(0,v.Jt)(o.x+"/upms/globalDict/listAll",e,t)}static add(e,t){return(0,v.bE)(o.x+"/upms/globalDict/add",e,t)}static update(e,t){return(0,v.bE)(o.x+"/upms/globalDict/update",e,t)}static delete(e,t){return(0,v.bE)(o.x+"/upms/globalDict/delete",e,t)}static addItem(e,t){return(0,v.bE)(o.x+"/upms/globalDict/addItem",e,t)}static updateItem(e,t){return(0,v.bE)(o.x+"/upms/globalDict/updateItem",e,t)}static updateItemStatus(e,t){return(0,v.bE)(o.x+"/upms/globalDict/updateItemStatus",e,t)}static deleteItem(e,t){return(0,v.bE)(o.x+"/upms/globalDict/deleteItem",e,t)}static reloadCachedData(e,t){return(0,v.Jt)(o.x+"/upms/globalDict/reloadCachedData",e,t)}}class w extends l.w{static listSysOperationLog(e,t){return super.post(o.x+"/upms/sysOperationLog/list",e,t)}}class C extends l.w{static list(e,t){return super.post(o.x+"/commonext/bizwidget/list",e,t)}static viewByIds(e,t){return super.post(o.x+"/commonext/bizwidget/view",e,t)}}},54442:function(e,t,a){a.d(t,{A:function(){return h}});var l=a(65451),i=(a(97042),a(63390),a(91542)),o=(a(37985),a(56768)),n=a(45130),r=a(90144),s=a(24232),d=a(57477),u=a(89001),p=a(38383),c=a(70483),m=a(80277);const g={class:"content"};var y=(0,o.pM)({__name:"OnlineCustomImageCard",props:{widget:{},supportEdit:{type:Boolean,default:!1},supportDelete:{type:Boolean,default:!1},supportUpdate:{type:Boolean,default:!1},supportContent:{type:Boolean,default:!0},isEdit:{type:Boolean,default:!1},masterTableData:{}},emits:["widgetClick","update:widget"],setup(e,{emit:t}){const a=t,y=e,f=(0,o.WQ)("form",()=>(console.warn("form not injected"),{isEdit:!1})),{childWidgetList:v,onWidgetClick:h}=(0,c.Q)(y,a),w=(0,r.KR)([]),C=(0,o.EW)(()=>y.widget&&Array.isArray(y.widget.childWidgetList)&&y.widget.childWidgetList.length>0?y.widget.childWidgetList[0]:null),b=e=>{v.value=[C.value,...e]},T=e=>f().getWidgetValue(e);return(0,o.wB)(()=>y.widget.childWidgetList,e=>{if(!Array.isArray(y.widget.childWidgetList)||0===y.widget.childWidgetList.length){let e=f().getWidgetObject(p.A);e["relation"]=void 0,e["datasource"]=void 0,e["column"]=void 0,v.value=[e]}w.value=y.widget.childWidgetList.slice(1)},{immediate:!0}),(e,t)=>{const a=i.tk,p=l.S2;return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",{class:"online-custom-image-card",onClick:t[2]||(t[2]=(0,n.D$)(t=>(0,r.R1)(h)(e.widget),["stop"]))},[e.widget.props&&"left"===e.widget.props.imagePosition&&(0,r.R1)(C)?((0,o.uX)(),(0,o.Wv)(m.A,{key:0,class:(0,s.C4)(["image widget-item",{active:e.isEdit&&(0,r.R1)(f)().isActive((0,r.R1)(C))}]),style:(0,s.Tr)([{"margin-right":"10px"},{"align-self":e.widget.props?.imageAlign}]),value:T((0,r.R1)(C)),src:(0,r.R1)(C).props.src,fit:(0,r.R1)(C).props.fit,width:(0,r.R1)(C).props.width,height:(0,r.R1)(C).props.height,round:(0,r.R1)(C).props.round,radius:(0,r.R1)(C).props.radius,widget:(0,r.R1)(C),onClick:t[0]||(t[0]=(0,n.D$)(e=>(0,r.R1)(h)((0,r.R1)(C)),["stop"]))},null,8,["style","class","value","src","fit","width","height","round","radius","widget"])):(0,o.Q3)("",!0),(0,o.Lk)("div",g,[(0,o.RG)(e.$slots,"content"),e.supportContent?((0,o.uX)(),(0,o.Wv)(u.A,{key:0,value:(0,r.R1)(w),onChange:b,isEdit:e.isEdit,onWidgetClick:(0,r.R1)(h)},null,8,["value","isEdit","onWidgetClick"])):(0,o.Q3)("",!0)]),e.widget.props&&"right"===e.widget.props.imagePosition&&(0,r.R1)(C)?((0,o.uX)(),(0,o.Wv)(m.A,{key:1,class:(0,s.C4)(["image",{active:e.isEdit&&(0,r.R1)(f)().isActive((0,r.R1)(C))}]),style:(0,s.Tr)([{"margin-left":"10px"},{"align-self":e.widget.props?.imageAlign}]),value:T((0,r.R1)(C)),src:(0,r.R1)(C).props.src,fit:(0,r.R1)(C).props.fit,width:(0,r.R1)(C).props.width,height:(0,r.R1)(C).props.height,round:(0,r.R1)(C).props.round,radius:(0,r.R1)(C).props.radius,widget:(0,r.R1)(C),onClick:t[1]||(t[1]=(0,n.D$)(e=>(0,r.R1)(h)((0,r.R1)(C)),["stop"]))},null,8,["style","class","value","src","fit","width","height","round","radius","widget"])):(0,o.Q3)("",!0)]),(0,o.RG)(e.$slots,"menu"),e.supportEdit?((0,o.uX)(),(0,o.Wv)(p,{key:0,justify:"end",style:{"padding-top":"10px",margin:"0 15px 10px","border-top":"1px solid #e0e2e3"}},{default:(0,o.k6)(()=>[(0,o.bF)(a,{style:{"font-size":"14px",color:"#dc4c33"}},{default:(0,o.k6)(()=>[(0,o.bF)((0,r.R1)(d.Delete))]),_:1}),(0,o.bF)(a,{style:{"margin-left":"10px","font-size":"14px",color:"#ee8133"}},{default:(0,o.k6)(()=>[(0,o.bF)((0,r.R1)(d.Edit))]),_:1})]),_:1})):(0,o.Q3)("",!0)])}}}),f=a(71241);const v=(0,f.A)(y,[["__scopeId","data-v-75f08b67"]]);var h=v},54607:function(e,t,a){a.d(t,{A:function(){return F}});var l=a(54880),i=(a(97042),a(51582),a(60713),a(25136)),o=(a(69957),a(69080)),n=(a(25374),a(24404),a(2403)),r=(a(63266),a(65451)),s=(a(63390),a(14022)),d=(a(72343),a(44114),a(18111),a(22489),a(61701),a(56768)),u=a(24232),p=a(90144),c=a(45130),m=a(57477),g=a(164),y=a(26695),f=a(81387),v=a(21016),h=a(36525),w=a(53155),C=a(51351),b=a(37856),T=a(60265),k=a(18384),E=a(42933),R=a(82572),S=a(46954),D=a(11051),I=a(69838);const A={class:"title"},W={class:"name"};var L=(0,d.pM)({__name:"index",props:{formConfig:{},height:{},masterTableData:{},isEdit:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},currentWidget:{},rowData:{},fullscreen:{type:Boolean,default:!1},selectedColumn:{},selectedValue:{},extraData:{},mode:{}},emits:["widgetClick","tableClick","radioSelectChanged","submit","cancel"],setup(e,{emit:t}){const a=(0,f.rd)(),L=(0,p.KR)(),x=t,_=e,F=(0,R.l5)(),{getDictDataList:N}=(0,S.o)(),O=(e=!1)=>{M.value.isEdit||(e?he.refreshTable(!0,1):he.refreshTable())},{isReady:B,dialogParams:M,form:X,formData:V,getWidgetValue:P,getWidgetVisible:U,onValueChange:K,onWidgetValueChange:z,getDropdownParams:Q,checkOperationPermCode:G,checkOperationDisabled:Y,checkOperationVisible:j,cloneWidget:H,handlerOperation:J,loadOnlineFormConfig:q,initPage:$,initFormWidgetList:Z,getIgnoreMaskFields:ee,onPrint:te,onStartFlow:ae,handlerScriptOperation:le,showDialog:ie,showOnlineDialog:oe,instanceData:ne}=(0,D.m)({props:_,router:a,refresh:O});(0,d.Gt)("form",()=>({...X.value,mode:_.mode||"pc",isEdit:M.value.isEdit,readOnly:M.value.readOnly,formData:V,getWidgetValue:P,getWidgetVisible:U,onValueChange:K,onWidgetValueChange:z,getDropdownParams:Q,checkOperationPermCode:G,checkOperationDisabled:Y,checkOperationVisible:j,cloneWidget:H,onPrint:te,onStartFlow:ae,handlerScriptOperation:le,handlerOperation:J,getIgnoreMaskFields:ee,getDictDataList:N,loadOnlineFormConfig:q,isActive:e=>_.currentWidget===e,getWidgetObject:E.A.getWidgetObject,filter:{name:L.value},instanceData:()=>ne}));const re=(0,p.KR)(),se=(0,p.KR)([]),de=(0,d.EW)(()=>X.value.widgetList),ue=e=>{we.value.childWidgetList=e},pe=(e,t)=>{t&&(t.setRadioRow(e),Ie(e))},ce=e=>{if(e.bindData.dataType!==v.SysCustomWidgetBindDataType.Column||null==e.column)return null;let t=e.column,a=P(e);if(null==a||""===a||Array.isArray(a)&&0===a.length)return null;let l={tableName:e.table.tableName,columnName:e.column.columnName,filterType:e.column.filterType,columnValue:e.column.filterType!==h.SysOnlineColumnFilterType.RANFGE_FILTER?a:void 0};return t.filterType===h.SysOnlineColumnFilterType.RANFGE_FILTER&&(l.columnValueStart=a[0],l.columnValueEnd=a[1]),l},me=()=>{let e=[];if(Array.isArray(de.value)&&(e=de.value.map(e=>ce(e)).filter(e=>null!=e)),null!=Ne.value){let t=ce(Ne.value);t&&e.push(t)}return e},ge=()=>{if(re.value){let e=re.value;if(Array.isArray(re.value)&&(e=re.value[0]),e)return e.getSearchString()}return null},ye=async e=>{let t=X.value.tableMap.get(we.value.bindData.tableId);e.datasourceId=t.datasource.datasourceId,e.filterDtoList=me(),null!=we.value.relation&&(e.relationId=t.relation.relationId);let a,l=ge();if(Array.isArray(we.value.props.likeQueryColumn)&&we.value.props.likeQueryColumn.length>0&&null!=l&&""!==l){let t=we.value.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(e.filterDtoList)||(e.filterDtoList=[]),e.filterDtoList.push({columnName:t,filterType:14,columnValue:l})}if(e.ignoreMaskFields=ee(we.value),!Array.isArray(e.orderParam)||e.orderParam.length<=0){let{orderColumn:t,orderAsc:a}=we.value.props;t&&(e.orderParam=[{fieldName:t,asc:!!a}])}if(M.value.isEdit||"function"!==typeof we.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(e=await we.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](e,ne)),null==e)throw new Error;a=null!=t.relation?await(0,w.bE)(k.x+"/online/onlineOperation/listByOneToManyRelationId/"+t.datasource.variableName,e):await(0,w.bE)(k.x+"/online/onlineOperation/listByDatasourceId/"+t.datasource.variableName,e),M.value.isEdit||"function"!==typeof we.value.eventInfo[v.OnlineFormEventType.AFTER_LOAD_TABLE_DATA]||(a.data.dataList=await we.value.eventInfo[v.OnlineFormEventType.AFTER_LOAD_TABLE_DATA](a.data.dataList,ne));let i=a.data.dataList.findIndex(e=>!!_.selectedColumn&&e[_.selectedColumn]===_.selectedValue);return i>=0&&setTimeout(()=>{re.value&&re.value.setSelectedRow(i)},30),{dataList:a.data.dataList,totalCount:a.data.totalCount}},fe=()=>!0,ve={loadTableData:ye,verifyTableParameter:fe,paged:M.value.formConfig?.tableWidget?.props.paged},he=(0,p.Kh)((0,T.K)(ve)),we=(0,d.EW)(()=>X.value.tableWidget),Ce=(0,d.EW)(()=>X.value.operationList),be=(0,d.EW)(()=>{if(M.value.isEdit)return;let e=X.value.tableMap.get(we.value.bindData.tableId);if(e&&Array.isArray(e.columnList))for(let t=0;t<e.columnList.length;t++){let a=e.columnList[t];if(a.primaryKey)return a.columnName}return null}),Te=()=>{x("cancel")},ke=()=>{x("submit")},Ee=e=>{de.value.push(e)},Re=e=>{g.s.confirm("是否删除此组件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=X.value.widgetList.indexOf(e);-1!==t&&X.value.widgetList.splice(t,1),De(null)})},Se=()=>{x("tableClick",we.value)},De=e=>{x("widgetClick",e)},Ie=e=>{se.value=e,x("radioSelectChanged",se.value)},Ae=()=>{O(!0)},We=()=>{se.value.length<=0?y.nk.error("请选择要批量删除的数据！"):g.s.confirm("是否删除选中数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e,t=X.value.tableMap.get(we.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataIdList:se.value.map(e=>e[be.value])};e=a.relationId?(0,w.bE)(k.x+"/online/onlineOperation/deleteBatchOneToManyRelation/"+t.datasource.variableName,a):(0,w.bE)(k.x+"/online/onlineOperation/deleteBatchDatasource/"+t.datasource.variableName,a),e.then(()=>{y.nk.success("删除成功！"),O(!0)}).catch(e=>{console.warn(e)})})},Le=e=>{g.s.confirm("是否删除当前数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=X.value.tableMap.get(we.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataId:e[be.value]},l=null;l=a.relationId?(0,w.bE)(k.x+"/online/onlineOperation/deleteOneToManyRelation/"+t.datasource.variableName,a):(0,w.bE)(k.x+"/online/onlineOperation/deleteDatasource/"+t.datasource.variableName,a),l.then(()=>{y.nk.success("删除成功！"),O(!0)}).catch(e=>{console.warn(e)})})},xe=e=>{g.s.confirm("是否导出表格数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=X.value.tableMap.get(we.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,filterDtoList:me(),exportInfoList:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder)};if(null!=we.value.relation&&a.filterDtoList.push({tableName:we.value.table.tableName,columnName:we.value.relation.slaveColumn.columnName,filterType:h.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(M.value.masterTableData||{})[we.value.relation.masterColumn.columnName]}),M.value.isEdit||"function"!==typeof we.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(a=await we.value.eventInfo[v.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](a,ne)),null==a)throw new Error;try{a.relationId?await(0,w.RG)(k.x+"/online/onlineOperation/exportByOneToManyRelationId/"+t.datasource.variableName,a,we.value.showName+".xlsx"):await(0,w.RG)(k.x+"/online/onlineOperation/exportByDatasourceId/"+t.datasource.variableName,a,we.value.showName+".xlsx"),y.nk.success("导出成功！")}catch(l){y.nk.error(l)}})},_e=(e,t)=>{M.value.isEdit||(e.type===v.SysCustomWidgetOperationType.BATCH_DELETE?We():e.type===v.SysCustomWidgetOperationType.DELETE?t&&Le(t):e.type===v.SysCustomWidgetOperationType.EXPORT?xe(e):e.type===v.SysCustomWidgetOperationType.PRINT?t&&te(e,t,null,we.value.showName):J(e,{isEdit:M.value.isEdit,rowData:t,masterTableData:M.value.masterTableData||t,callback:()=>{O()}}))},Fe=()=>{O(!0)};(0,d.sV)(()=>{B.value=!1,M.value.isEdit||(X.value.eventInfo&&"function"===typeof X.value.eventInfo[v.OnlineFormEventType.AFTER_CREATE_FORM]&&X.value.eventInfo[v.OnlineFormEventType.AFTER_CREATE_FORM](ne),Fe()),B.value=!0});const Ne=(0,d.EW)(()=>X.value.leftWidget),Oe=()=>{x("widgetClick",X.value.leftWidget)},Be=(e,t)=>{K(Ne.value,e),z(Ne.value,e,t),(0,d.dY)(()=>{O(!0)})};return(e,t)=>{const a=s.WK,g=r.S2,y=n.kA,f=l.Mb,v=o.aQ,h=i.S2,w=l.ZO,T=l.lX;return(0,d.bo)(((0,d.uX)(),(0,d.CE)("div",{class:"online-query-form",style:(0,u.Tr)({height:e.height?e.height:"100%",width:"100%"})},[(0,d.bF)(T,null,{default:(0,d.k6)(()=>[null!=(0,p.R1)(Ne)&&(0,p.R1)(X).leftTreeRightTable?((0,d.uX)(),(0,d.Wv)(f,{key:0,width:"265px",class:"left-panel",onClick:(0,c.D$)(Oe,["stop"])},{default:(0,d.k6)(()=>[(0,d.Lk)("div",A,[(0,d.bF)(g,{align:"middle",style:{"flex-wrap":"nowrap"}},{default:(0,d.k6)(()=>[(0,d.Lk)("span",W,(0,u.v_)((0,p.R1)(Ne).showName),1),(0,d.bF)(a,{class:"search round-search","prefix-icon":(0,p.R1)(m.Search),modelValue:(0,p.R1)(L),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,p.i9)(L)?L.value=e:null),clearable:"",size:(0,p.R1)(F).defaultFormItemSize,style:{"border-radius":"16px"},placeholder:"输入"+(0,p.R1)(Ne).showName},null,8,["prefix-icon","modelValue","size","placeholder"])]),_:1})]),(0,d.bF)(y,{class:"custom-scroll tree",style:{"flex-grow":"1"}},{default:(0,d.k6)(()=>[(0,d.Lk)("div",{class:(0,u.C4)(["widget-item",{active:(0,p.R1)(M).isEdit&&e.currentWidget===(0,p.R1)(Ne)}])},[(0,d.bF)(b.A,{widget:(0,p.R1)(Ne),ref:(0,p.R1)(Ne).variableName,value:(0,p.R1)(P)((0,p.R1)(Ne)),onInput:t[1]||(t[1]=e=>(0,p.R1)(K)((0,p.R1)(Ne),e)),onChange:Be},null,8,["widget","value"])],2)]),_:1})]),_:1})):(0,d.Q3)("",!0),(0,d.bF)(w,{class:"table-panel",style:{overflow:"hidden"}},{default:(0,d.k6)(()=>[(0,d.bF)(I.A,{class:"query-filter-box",isEdit:(0,p.R1)(M).isEdit,ref:"filterBox",style:{"margin-bottom":"16px"},itemWidth:(0,p.R1)(X).filterItemWidth||350,widgetList:(0,p.R1)(de),"onUpdate:widgetList":t[2]||(t[2]=e=>(0,p.i9)(de)?de.value=e:null),formData:(0,p.R1)(V),operationList:(0,p.R1)(Ce),onWidgetClick:De,onSearch:t[3]||(t[3]=e=>O(!0)),onReset:Ae,onCopy:Ee,onDelete:Re,onOperationClick:_e},null,8,["isEdit","itemWidth","widgetList","formData","operationList"]),(0,d.Lk)("div",{class:(0,u.C4)(["query-table-box custom-widget-item widget-item",{active:(0,p.R1)(M).isEdit&&e.currentWidget===(0,p.R1)(we)}]),style:{padding:"0px"},onClick:(0,c.D$)(Se,["stop"])},[(0,d.bF)(C.A,{ref_key:"tableWidget",ref:re,dataList:(0,p.R1)(he).dataList,isEdit:(0,p.R1)(M).isEdit,widget:(0,p.R1)(we),singleSelect:!0,operationList:(0,p.R1)(Ce),getTableIndex:(0,p.R1)(he).getTableIndex,sortChange:(0,p.R1)(he).onSortChange,onRadioChange:Ie,supportAutoEditNext:!1,supportCustomQuery:!1,onOperationClick:_e,onRefresh:t[5]||(t[5]=e=>O(!1)),onWidgetClick:De,onUpdateChildWidgetList:ue,onCellClick:pe},{pagination:(0,d.k6)(()=>[(0,d.bF)(g,{type:"flex",align:"middle",style:{padding:"16px 0px"}},{default:(0,d.k6)(()=>[(0,p.R1)(we)&&(0,p.R1)(we).props.paged?((0,d.uX)(),(0,d.Wv)(v,{key:0,total:(0,p.R1)(he).totalCount,"current-page":(0,p.R1)(he).currentPage,"page-size":(0,p.R1)(he).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next",onCurrentChange:(0,p.R1)(he).onCurrentPageChange,onSizeChange:(0,p.R1)(he).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])):(0,d.Q3)("",!0),t[8]||(t[8]=(0,d.Lk)("div",{style:{flex:"1",width:"16px"}},null,-1)),(0,d.Lk)("div",null,[(0,d.bF)(h,{onClick:Te},{default:(0,d.k6)(()=>t[6]||(t[6]=[(0,d.eW)("取消")])),_:1,__:[6]}),(0,d.bF)(h,{type:"primary",size:(0,p.R1)(F).defaultFormItemSize,onClick:t[4]||(t[4]=e=>ke())},{default:(0,d.k6)(()=>t[7]||(t[7]=[(0,d.eW)(" 确认选择 ")])),_:1,__:[7]},8,["size"])])]),_:1,__:[8]})]),_:1},8,["dataList","isEdit","widget","operationList","getTableIndex","sortChange"])],2)]),_:1})]),_:1})],4)),[[c.aG,(0,p.R1)(B)]])}}}),x=a(71241);const _=(0,x.A)(L,[["__scopeId","data-v-75696879"]]);var F=_},60760:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var l=a(25136),i=(a(97042),a(69957),a(69080)),o=(a(25374),a(76408)),n=(a(87535),a(21929)),r=(a(98421),a(65451)),s=(a(63390),a(32465),a(14022)),d=(a(72343),a(44114),a(18111),a(22489),a(61701),a(56768)),u=a(45130),p=a(90144),c=a(61473),m=a(99540),g=a(60265),y=a(54428),f=a(27007),v=a(71066);const h={style:{width:"100%"}};var w=(0,d.pM)({__name:"UserSelectDlg",props:{value:{},props:{default:()=>({label:"showName",value:"userId"})},multiple:{type:Boolean,default:!1},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:a,onCloseThirdDialog:w}=(0,v.P)(t),C=(0,p.KR)(),b=(0,p.Kh)({sysUserLoginName:void 0}),T=(0,p.KR)(),k=(0,d.EW)(()=>({value:t.value||a.value.value,props:t.props||null==a.value.props?t.props:a.value.props||{},multiple:t.multiple||null==a.value.multiple?t.multiple:a.value.multiple})),E=(0,d.EW)(()=>{let e=k.value.multiple&&Array.isArray(T.value)?(T.value||[]).map(e=>e[k.value.props.value]):(T.value||{})[k.value.props.value];return{highlight:!0,checkStrictly:!0,checkRowKeys:k.value.multiple?e:void 0,checkRowKey:k.value.multiple?void 0:e,showHeader:!1}}),R=()=>{null!=C.value&&Array.isArray(A.dataList)&&setTimeout(()=>{if(C.value.clearRadioRow(),C.value.clearCheckboxRow(),k.value.multiple)C.value.setCheckboxRow(A.dataList.filter(e=>null!=(0,f.PH)(T.value,e[k.value.props.value],k.value.props.value)),!0);else{let e=(0,f.PH)(A.dataList,(T.value||{})[k.value.props.value],k.value.props.value);C.value.setRadioRow(e)}},50)},S=e=>(e.widgetType="upms_user",e.filter={loginName:b.sysUserLoginName},new Promise((t,a)=>{y.If.list(e).then(e=>{t({dataList:e.data.dataList,totalCount:e.data.totalCount}),(0,d.dY)(()=>{R()})}).catch(e=>{a(e)})})),D=()=>!0,I={loadTableData:S,verifyTableParameter:D,paged:!0},A=(0,p.Kh)((0,g.K)(I)),W=(e=!1)=>{e?A.refreshTable(!0,1):A.refreshTable()},L=({checked:e,row:t})=>{k.value.multiple?null==t?(T.value=[],e&&(T.value=A.dataList)):(null==T.value&&(T.value=[]),e?T.value.push(t):T.value=T.value.filter(e=>e[k.value.props.value]!==t[k.value.props.value])):T.value=t},x=()=>{t.dialog?t.dialog.submit(T.value):w(!0,k.value.value,T.value)},_=()=>{t.dialog&&t.dialog.cancel()},F=({row:e})=>{if(k.value.multiple){const t=C.value.isCheckedByCheckboxRow(e);C.value.setCheckboxRow(e,!t),T.value||(T.value=[]),t?T.value=T.value.filter(t=>t[k.value.props.value]!==e[k.value.props.value]):T.value.push(e)}else C.value.setRadioRow(e),T.value=e};return(0,d.sV)(()=>{Array.isArray(k.value.value)&&k.value.value.length>0&&(k.value.multiple?T.value=k.value.value.map(e=>({...e})):T.value={...k.value.value[0]}),W(!0)}),(e,t)=>{const a=s.WK,g=n.xE,y=r.S2,f=n.US,v=o.uD,w=i.aQ,T=l.S2;return(0,d.uX)(),(0,d.CE)("div",h,[(0,d.bF)(f,{ref:"formSysUser",model:b,"label-width":"75px",size:"default","label-position":"right",onSubmit:t[2]||(t[2]=(0,u.D$)(()=>{},["prevent"]))},{default:(0,d.k6)(()=>[(0,d.bF)(y,{type:"flex",justify:"space-between"},{default:(0,d.k6)(()=>[(0,d.bF)(g,{label:"登录名称",prop:"sysUserLoginName"},{default:(0,d.k6)(()=>[(0,d.bF)(a,{modelValue:b.sysUserLoginName,"onUpdate:modelValue":t[0]||(t[0]=e=>b.sysUserLoginName=e),style:{width:"200px"},clearable:!0,placeholder:"登录名称",onChange:t[1]||(t[1]=e=>W(!0))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"]),(0,d.bF)(y,null,{default:(0,d.k6)(()=>[(0,d.bF)(v,{span:24},{default:(0,d.k6)(()=>[(0,d.bF)((0,p.R1)(m.CP),{ref_key:"table",ref:C,"row-id":k.value.props.value,data:A.dataList,height:"468","show-overflow":"title","show-header-overflow":"title","row-config":{height:35,isHover:!0},"radio-config":{highlight:!0},"checkbox-config":E.value,onRadioChange:L,onCheckboxChange:L,onCheckboxAll:L,onCellClick:F},{empty:(0,d.k6)(()=>t[3]||(t[3]=[(0,d.Lk)("div",{class:"table-empty unified-font"},[(0,d.Lk)("img",{src:c}),(0,d.Lk)("span",null,"暂无数据")],-1)])),default:(0,d.k6)(()=>[(0,d.bF)((0,p.R1)(m.Wq),{type:k.value.multiple?"checkbox":"radio",width:50},null,8,["type"]),(0,d.bF)((0,p.R1)(m.Wq),{title:"用户名",field:"loginName"}),(0,d.bF)((0,p.R1)(m.Wq),{title:"昵称",field:"showName"}),(0,d.bF)((0,p.R1)(m.Wq),{title:"所属部门",field:"deptIdDictMap.name"})]),_:1},8,["row-id","data","checkbox-config"])]),_:1}),(0,d.bF)(v,{span:24},{default:(0,d.k6)(()=>[(0,d.bF)(y,{type:"flex",justify:"space-between",style:{"margin-top":"12px"}},{default:(0,d.k6)(()=>[(0,d.bF)(w,{total:A.totalCount,"current-page":A.currentPage,"page-size":A.pageSize,layout:"total, prev, pager, next",onCurrentChange:A.onCurrentPageChange,onSizeChange:A.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"]),(0,d.Lk)("div",null,[(0,d.bF)(T,{onClick:_},{default:(0,d.k6)(()=>t[4]||(t[4]=[(0,d.eW)("取消")])),_:1,__:[4]}),(0,d.bF)(T,{type:"primary",onClick:x},{default:(0,d.k6)(()=>t[5]||(t[5]=[(0,d.eW)("确认选择")])),_:1,__:[5]})])]),_:1})]),_:1})]),_:1})])}}}),C=a(71241);const b=(0,C.A)(w,[["__scopeId","data-v-66825c4e"]]);var T=b},68308:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAcGSURBVHgB5ZzLb1NHFMa/meukSkrALYhC1AjTVvGiG1uESmVDsucR71q6IF2UdEeLusf8AVSwhC6aLkiXbtJ1hemilUoQlioVJVLA6SNpaVMZHCUise90ztjXOMY3vo8ZY5efFHKN7djz+ZyZc86cMUMbSGTuxoDyKOdIgOGQEJC3WRRMxLY9ULC8/KfAGPIQWLJtZAE7n0u9k4NhGAyRyNyWA2fjguGsvBlFKESegWftspjJpUa+gQG0CpHI/Bjjkd6zQohPEHrwbjii8Eu5VDIPTWgRggRg3EqD8bNoIwxsSpcgoYSQvh/lln1RQFnAc0OHIIGFSGTmxpmFL2HMBfwi8oJH0rkTya8QAN9CdIoVuCGt40rVOgr+nucDNRdEejJyaUugo5HWUY6M+XEVz0IkMj8lmGVl5IvE0BX4E8OTEBUR+E10zHzgmYIo22NeArKWQih3sHruovtEcPAkBt/pzooIvd1oCfVEmcUylTDfHVeLoNWBWfbd7pkTWiCQE7Y15raaRNyeV10iYzDAYH8vjrw6oK4Hei0UN8tY2djE3GoRxmBI0Jjk1afN726CDJYmqsGSVs68sR+Tw4MY6LFcHzP72yquzS8rYUwgykg1S9yeEeLpvKDPGmjgl4++iZG9A54ev7y+iQu3F7HweB0GkJOndbjRRZ6ZLFXypNklJuMHPYtAkOt8LoXbyXJCEK26yDa2CUHWoDuDHOzrxZnDr8EvJAa5kgkoPWhcRbYJUbEGvYweDL7ynnx9H0zRaBU1IUxYA+HHJRohqzDkHmQVE/VWURPChDUQuyLhBrLLkBAKXpqoXdb+k1nH8YLBGDvvXCshErNz4/+bCNIfUSoy04USggl7HIYY7H8JYYjv7odRZKVd/VI3DLnFyN5dasILw+gBs/keq2w3gFOt4QV1C4corR4cFo/BEPOPNxCWOyYTMQdL7sLJBXUUhihulWUCtYKgLDxaN5uROsgabITTXiTMcW1hWb3SZHzQ1/OWN57gve/voT2IGJd7kzEYZvrBQzUwP4SxJL/ILYBDHDYzXoYjF7lw+z6KpbKnx19bWMG3si7RNhiL8me25g1B/v7+rV9aPm76/kNVmGkv0jXQRqjg0op5M8WYlrRViJNDe7U8xgQRtIH4nj5VW/AySErbrx8bVnNEO+cJlpy588DUPEEh9jm5bAatSZAr0fI790/RWDG3AstHwEUBmgMJL9VqL1CecikRU9dGq9tCFDgTyEMTNHAy68/eHtJeWTol3eqLY3EMG8hGZbVqKWILLDENDURUpL0u32jYbLMZxVIJ04t/Y/b3VaxtlaAfcg0bOWj48C4ffcuICBRX3JCR6amhV6WbHFL1iaIUgxK6r+V9enIR66ZcNbayQA/CMDl8UK0MuiERpu//pVyiXmRyOyr4jMlaBU2mocNxe2uJ51Lv5uWlrzabesgl/CZUXqDchCyhlbvRpBxu/0OohlYVUAmBQA1YhKlNmOnFhztWuGjecBK5MCuUAM/S70pkaYvA3ayjB16BCagg47ZDplL0W/cw++u/6jaJELikJ7gauxIilzqaRQD3GN7dZ2SCJB7LTHXw5crfrmSvi0oA+vnohwUVpH0s91QdyEX9I93idHKGrmohthDiqqzzX/TzZ8JWqHdiTQ5+bbOEAblBRJ84/ZyTAlDsRyI4gVYYHLcgniZddmkKPonv1r9SOFDg9EddtkoDJ/N3E2FudQ2+KfNLzmVNCFo9hLADT5q6GTuwRxVo6qGItZkI5C5+i7wCbKq+9XB7Gm6X0/CBjiq1GyeH9smk64mKJXaCVg+aM3xTZw3ENiEqVoGr8Ej2zwJOfPez+q0bmhMokLohAyq3gMmZOFfW/SVijdZANGkdom668gP4bCkc3tOPDw7vx5F9cu3v0zeJUiqezuXVoI/I+cFZHWhOCLbn0bwj162ZjDrvMwgIvWEKhuJSHFpeg2aMZPYLjzYwL38olKZlNCyCWxPNOvjd+yxn5q7IrPQ8NEEWU1sKqz0T1FpIUHuhw7KsN1C1e0XODzoGXg+5fe70SNNTBe6lOttKg5ePU38iNEBV7OeLyMOOpN3udS3eUvudsLdSlZN33U5tXnCd1T00pXdtZ74D9VUmWx1XaFnOpxSVutsRIlV/jlQ781uf2fC0r1ERYyvZXW5C7uDtrAbh/ygT773Zrm3CwFQ68VN+jjL52ulSkafNk36iz3ZD7616HCHv53lhjjtOMC7T9s6xDjkf4MOgR6YD733KF5wS9uZYJ2SsygpUx33wc+PajkSDW2nW5iPRlDyhE45EN1ITBNZxgy5ToGqajBKnOu6QfDMocQO3xzWJUlCVdllkrtZXtWNMiHoqvZxcWgtG6Ys0UP0iDdYgkKh+kQaqX6ShduFgZXV+8m78ByDaFgsSgVelAAAAAElFTkSuQmCC"},69106:function(e,t,a){a.d(t,{MD:function(){return o},aX:function(){return n},tp:function(){return r}});var l=a(21016),i=a(27007);const o=[{id:l.OnlineFormEventType.CHANGE,name:"组件数据改变",functionName:"onChange",paramList:["val","detail","instance"],comment:"\n/**\n * 组件数据改变时触发\n * @params val 组件当前值\n * @params detail 组件当前值详情(selectRow, dictData)\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.BLUR,name:"组件失去焦点",functionName:"onBlur",paramList:["instance"],comment:"\n/**\n * 组件失去焦点时触发\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.FOCUS,name:"组件获取焦点",functionName:"onFocus",paramList:["instance"],comment:"\n/**\n * 组件获取焦点时触发\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.DISABLE,name:"是否禁用",functionName:"disabled",paramList:["instance"],comment:"\n/**\n * 组件是否禁用\n * @params instance\n */\nreturn false;\n"},{id:l.OnlineFormEventType.VISIBLE,name:"是否可见",functionName:"visible",paramList:["instance"],comment:"\n/**\n * 组件是否可见\n * @params instance\n */\nreturn true;\n"},{id:l.OnlineFormEventType.DROPDOWN_CHANGE,name:"组件下拉数据改变",functionName:"onDropdownChange",paramList:["dataList","instance"],comment:"\n/**\n * 组件下拉数据改变时触发\n * @params dataList 下拉数据\n * @params instance 表单组件\n */\nreturn dataList;\n"},{id:l.OnlineFormEventType.DISABLED_DATE,name:"日期组件设置日期是否禁用函数",functionName:"disabledDate",paramList:["date"],comment:"\n/**\n * 日期组件设置日期是否禁用函数，返回Boolean\n * @params date 当前日期\n */\nreturn false;\n"},{id:l.OnlineFormEventType.AFTER_LOAD_TABLE_DATA,name:"表格读取数据后回调",functionName:"afterLoadTableData",paramList:["dataList","instance"],comment:"\n/**\n * 读取列表数据后触发\n * @params dataList\n * @params instance\n */\nreturn dataList;\n"},{id:l.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA,name:"表格读取数据前回调",functionName:"beforeLoadTableData",paramList:["params","instance"],comment:"\n/**\n * 读取表格数据前触发\n * @params params 请求参数\n * @params instance 表单组件\n */\n return params;\n"},{id:l.OnlineFormEventType.AFTER_LOAD_FORM_DATA,name:"表单页面加载数据后回调",functionName:"afterLoadFormData",paramList:["instance"],comment:"\n/**\n * 表单页面加载数据后触发\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.BEFORE_COMMIT_FORM_DATA,name:"表单页面提交数据前回调",functionName:"beforeCommitFormData",paramList:["params","instance"],comment:"\n/**\n * 表单页面提交数据前触发\n * @params params 请求参数\n * @params instance 表单组件\n */\nreturn params;\n"},{id:l.OnlineFormEventType.AFTER_CREATE_FORM,name:"表单页面创建完毕",functionName:"formCreated",paramList:["instance"],comment:"\n/**\n * 表单页面创建完毕，可用于初始化表单数据\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.OPERATION_VISIBLE,name:"操作是否可见",functionName:"operationVisible",paramList:["rowData","instance"],comment:"\n/**\n * 操作是否可见\n * @params rowData 表格行内操作当前行数据\n * @params instance 表单组件\n */\nreturn true;\n"},{id:l.OnlineFormEventType.OPERATION_DISABLED,name:"操作是否禁用",functionName:"operationDisabled",paramList:["rowData","instance"],comment:"\n/**\n * 操作是否禁用\n * @params rowData 表格行内操作当前行数据\n * @params instance 表单组件\n */\nreturn false;\n"},{id:l.OnlineFormEventType.LINK_HERF,name:"超链接地址",functionName:"linkHerf",paramList:["herf","instance"],comment:"\n/**\n * 计算超链接地址\n * @params herf 参数中设置的herf\n * @params instance 表单组件\n * @return 返回新的地址\n */\nreturn herf;\n"},{id:l.OnlineFormEventType.OPERATION_CLICK,name:"操作点击事件",functionName:"operationClick",paramList:["rowData","instance"],comment:"\n/**\n * 操作点击事件\n * @params rowData 表格行内操作当前行数据\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.CELL_CLICK,name:"表格单元格点击事件",functionName:"tableCellClick",paramList:["rowData","instance"],comment:"\n/**\n * 表格单元格点击事件\n * @params rowData 表格行内操作当前行数据\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.CELL_RENDER,name:"表格单元格渲染事件",functionName:"tableCellRender",paramList:["rowData","instance","h","elComp"],comment:"\n/**\n * 表格单元格渲染事件\n * @params rowData 表格行内操作当前行数据\n * @params instance 表单组件\n * @params h vue h函数\n * @params elComp element组件实例\n */\n"},{id:l.OnlineFormEventType.DIALOG_OPEN,name:"选择对话框过滤事件",functionName:"dialogOpen",paramList:["params","instance"],comment:"\n/**\n  * 选择对话框过滤事件\n  * @params params 请求参数\n  * @params instance 表单组件\n  */\nreturn params;\n"},{id:l.OnlineFormEventType.DIALOG_SUBMIT,name:"选择对话框回调事件",functionName:"dialogSubmit",paramList:["selectItem","instance"],comment:"\n/**\n  * 选择对话框回调事件\n  * @params selectItem 选择的数据列表或者对象\n  * @params instance 表单组件\n  */\n"},{id:l.OnlineFormEventType.INLINE_VALUE_CHANGE,name:"行内编辑值改变",functionName:"inlineValueChange",paramList:["value","rowData","detail","instance"],comment:"\n/**\n * 行内编辑值改变\n * @params value 当前值\n * @params rowData 当前行数据\n * @params detail 组件当前值详情(selectRow, dictData)\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.CELL_TAG_TYPE,name:"单元格标签类型",functionName:"cellTagType",paramList:["rowData"],comment:"\n/**\n * 单元格标签类型\n * @params rowData 当前行数据\n * @params instance 表单组件\n */\nreturn 'primary';\n"},{id:l.OnlineFormEventType.FOOTER_DATA,name:"表格底部数据",functionName:"footerData",paramList:["dataList","instance"],comment:"\n/**\n * 表格底部数据\n * @params dataList 表格数据\n * @params instance 表单组件\n * @return 返回底部数据，https://vxetable.cn/#/component/table/base/footer\n */\nreturn undefined;\n"},{id:l.OnlineFormEventType.LINK_CLICK,name:"超链接点击事件",functionName:"linkClick",paramList:["herf","instance"],comment:"\n/**\n * 超链接点击事件\n * @params herf 超链接地址\n * @params instance 表单组件\n */\nreturn herf;\n"},{id:l.OnlineFormEventType.REPORT_CELL_CLICK,name:"报表单元格点击事件",functionName:"reportCellClick",paramList:["rowData","colData","instance"],comment:"\n/**\n * 报表单元格点击事件\n * @params rowData 报表行数据\n * @param colData 报表列数据\n * @params instance 表单组件\n */\n"},{id:l.OnlineFormEventType.SERIE_CLICK,name:"点击事件",functionName:"serieClick",paramList:["rowData","instance"],comment:"\n/**\n * 点击事件\n * @params rowData 报表行数据\n * @params instance 表单组件\n */\n"}],n=[{id:l.OnlineFormEventType.CHANGE,name:"组件数据改变",functionName:"onChange",paramList:["val"],comment:"\n/**\n * 组件数据改变时触发\n * @params val 组件当前值\n * @params this 表单组件\n */\n"},{id:l.OnlineFormEventType.DISABLE,name:"是否禁用",functionName:"disabled",paramList:[],comment:"\n/**\n * 组件是否禁用\n * @params this\n */\nreturn false;\n"},{id:l.OnlineFormEventType.VISIBLE,name:"是否可见",functionName:"visible",paramList:[],comment:"\n/**\n * 组件是否可见\n * @params this\n */\nreturn true;\n"},{id:l.OnlineFormEventType.DROPDOWN_CHANGE,name:"组件下拉数据改变",functionName:"onDropdownChange",paramList:["dataList"],comment:"\n/**\n * 组件下拉数据改变时触发\n * @params dataList 下拉数据\n * @params this 表单组件\n */\nreturn dataList;\n"},{id:l.OnlineFormEventType.DISABLED_DATE,name:"日期组件设置日期是否禁用函数",functionName:"disabledDate",paramList:["date"],comment:"\n/**\n * 日期组件设置日期是否禁用函数，返回Boolean\n * @params date 当前日期\n */\nreturn false;\n"},{id:l.OnlineFormEventType.AFTER_LOAD_TABLE_DATA,name:"表格读取数据后回调",functionName:"afterLoadTableData",paramList:["dataList"],comment:"\n/**\n * 读取列表数据后触发\n * @params dataList\n * @params this 表单组件\n */\nreturn dataList;\n"},{id:l.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA,name:"表格读取数据前回调",functionName:"beforeLoadTableData",paramList:["params"],comment:"\n/**\n * 读取表格数据前触发\n * @params params 请求参数\n * @params this 表单组件\n */\nreturn params;\n"},{id:l.OnlineFormEventType.AFTER_LOAD_FORM_DATA,name:"表单页面加载数据后回调",functionName:"afterLoadFormData",paramList:[],comment:"\n/**\n * 表单页面加载数据后触发\n * @params this 表单组件\n */\n"},{id:l.OnlineFormEventType.BEFORE_COMMIT_FORM_DATA,name:"表单页面提交数据前回调",functionName:"beforeCommitFormData",paramList:["params"],comment:"\n/**\n * 表单页面提交数据前触发\n * @params params 请求参数\n * @params this 表单组件\n */\nreturn params;\n"},{id:l.OnlineFormEventType.AFTER_CREATE_FORM,name:"表单页面创建完毕",functionName:"formCreated",paramList:[],comment:"\n/**\n * 表单页面创建完毕，可用于初始化表单数据\n * @params this 表单组件\n */\n"},{id:l.OnlineFormEventType.OPERATION_VISIBLE,name:"操作是否可见",functionName:"operationVisible",paramList:["rowData"],comment:"\n/**\n * 操作是否可见\n * @params rowData 表格行内操作当前行数据\n * @params this 表单组件\n */\nreturn true;\n"},{id:l.OnlineFormEventType.OPERATION_DISABLED,name:"操作是否禁用",functionName:"operationDisabled",paramList:["rowData"],comment:"\n/**\n * 操作是否禁用\n * @params rowData 表格行内操作当前行数据\n * @params this 表单组件\n */\nreturn false;\n"},{id:l.OnlineFormEventType.LINK_HERF,name:"超链接地址",functionName:"linkHerf",paramList:["herf"],comment:"\n/**\n * 计算超链接地址\n * @params herf 参数中设置的herf\n * @params this 表单组件\n * @return 返回新的地址\n */\nreturn herf;\n"}];function r(e){if(!e)return null;const t=(0,i.PH)(o,e.eventType,"id");return t&&null!=e.scriptString&&""!==e.scriptString?new Function(t.paramList,e.scriptString):(console.warn("eventFunction eventInfo is null, eventType=",e.eventType),null)}},69838:function(e,t,a){a.d(t,{A:function(){return b}});var l=a(21929),i=(a(97042),a(98421),a(65451)),o=(a(63390),a(91542)),n=(a(37985),a(25136)),r=(a(69957),a(76408)),s=(a(87535),a(32465),a(44114),a(18111),a(7588),a(56768)),d=a(90144),u=a(24232),p=a(45130),c=a(57477),m=a(82572),g=a(37972),y=a(37856),f=a(84602);const v={style:{"margin-right":"4px","font-size":"14px"}};var h=(0,s.pM)({__name:"OnlineFilterBox",props:{formData:{type:Object,required:!0},isEdit:{type:Boolean,default:!1},isAdvance:{type:Boolean,default:!1},isActive:{type:Boolean,default:!1},hasSlot:{type:Boolean,default:!1},widgetList:{type:Array,default:()=>[]}},emits:["copy","delete","search","reset","widgetClick"],setup(e,{emit:t}){const a=t,h=e,w=(0,m.l5)(),C=(0,s.WQ)("form",()=>({isEdit:!1})),b=(0,d.KR)(!1),T=(0,d.KR)(),k=(0,s.EW)(()=>w.formItemSize),E=(0,s.EW)(()=>{const e=(0,s.nI)();if(!e)return 0;const t=e.slots;return t&&t.default&&Array.isArray(t.default())?t.default().length:0}),R=(0,s.EW)(()=>(h.widgetList||[]).length+E.value),S=(0,s.EW)(()=>{if(h.isEdit||b.value)return h.widgetList;{let e=3-E.value,t=e>0?h.widgetList.slice(0,e):[];return t}}),D=e=>{a("copy",e)},I=e=>{a("delete",e)},A=e=>{if(!h.isEdit)return C().getWidgetValue(e)},W=(e,t)=>{if(!h.isEdit)return C().onValueChange(e,t)},L=(e,t,a)=>{if(!h.isEdit)return C().onWidgetValueChange(e,t,a)},x=e=>{a("widgetClick",e)},_=(e,t)=>({display:C().getWidgetVisible(t)?"block":"none"}),F=()=>{a("search")},N=()=>{T.value?.resetFields(),a("reset")};return(t,a)=>{const m=l.xE,h=r.uD,w=n.S2,E=o.tk,O=i.S2,B=l.US;return(0,s.uX)(),(0,s.Wv)(B,{ref_key:"filterBox",ref:T,size:(0,d.R1)(k),model:e.formData,"label-width":((0,d.R1)(C)().labelWidth||100)+"px","label-position":(0,d.R1)(C)().labelPosition,style:(0,u.Tr)({display:(0,d.R1)(R)>0||e.hasSlot||e.isEdit?"block":"none"}),onSubmit:a[1]||(a[1]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,d.R1)(R)>0||e.hasSlot||e.isEdit?((0,s.uX)(),(0,s.Wv)(O,{key:0,class:"online-filter-box",style:(0,u.Tr)({border:e.isEdit&&!e.isAdvance?"1px solid #e8eaec":"none","min-height":e.isEdit&&e.widgetList.length<=0?"86px":"0px"})},{default:(0,s.k6)(()=>[(0,s.bo)(((0,s.uX)(),(0,s.Wv)(O,{class:"custom-widget-item",style:{width:"100%",position:"relative"}},{default:(0,s.k6)(()=>[(0,s.RG)(t.$slots,"default",{class:"filter"}),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,d.R1)(S),(t,a)=>((0,s.uX)(),(0,s.Wv)(h,{key:t.variableName,span:6,style:(0,u.Tr)(_(a,t)),class:(0,u.C4)([{active:e.isEdit&&(0,d.R1)(C)().isActive(t)},"custom-widget-item widget-item"])},{default:(0,s.k6)(()=>[(0,s.bF)(m,{prop:t.propString,onClick:(0,p.D$)(e=>x(t),["stop"])},{label:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.Lk)("span",null,(0,u.v_)(t.showName),1),e.isEdit&&(0,d.R1)(C)().isActive(t)?((0,s.uX)(),(0,s.Wv)(f.A,{key:0,widget:t,onCopy:D,onDelete:e=>I(t)},null,8,["widget","onDelete"])):(0,s.Q3)("",!0)])]),default:(0,s.k6)(()=>[(0,s.bF)(y.A,{widget:t,style:{width:"100%"},ref_for:!0,ref:t.variableName,value:A(t),onInput:e=>W(t,e),onChange:(e,a)=>L(t,e,a)},null,8,["widget","value","onInput","onChange"])]),_:2},1032,["prop","onClick"])]),_:2},1032,["style","class"]))),128)),(0,s.bF)(h,{span:6,style:{"padding-left":"16px"}},{default:(0,s.k6)(()=>[(0,s.bF)(m,{"label-width":"0px"},{default:(0,s.k6)(()=>[(0,s.bo)((0,s.bF)(w,{class:"search-btn",size:(0,d.R1)(k),onClick:F,icon:(0,d.R1)(c.Search)},{default:(0,s.k6)(()=>a[2]||(a[2]=[(0,s.eW)("查询")])),_:1,__:[2]},8,["size","icon"]),[[p.aG,(0,d.R1)(R)>0]]),(0,s.bo)((0,s.bF)(w,{size:(0,d.R1)(k),onClick:N,style:{width:"72px"}},{default:(0,s.k6)(()=>a[3]||(a[3]=[(0,s.eW)(" 重置 ")])),_:1,__:[3]},8,["size"]),[[p.aG,(0,d.R1)(R)>0]]),(0,s.RG)(t.$slots,"operator"),(0,d.R1)(R)>3?((0,s.uX)(),(0,s.Wv)(O,{key:0,type:"flex",align:"middle",class:"expand-btn",onClick:a[0]||(a[0]=e=>b.value=!(0,d.R1)(b))},{default:(0,s.k6)(()=>[(0,s.Lk)("span",v,(0,u.v_)((0,d.R1)(b)?"收起":"展开"),1),(0,s.bF)(E,{class:(0,u.C4)((0,d.R1)(b)?"el-icon-arrow-up":"el-icon-arrow-down")},{default:(0,s.k6)(()=>[(0,d.R1)(b)?((0,s.uX)(),(0,s.Wv)((0,d.R1)(c.ArrowUp),{key:0})):((0,s.uX)(),(0,s.Wv)((0,d.R1)(c.ArrowDown),{key:1}))]),_:1},8,["class"])]),_:1})):(0,s.Q3)("",!0)]),_:3})]),_:3}),e.isEdit&&e.widgetList.length<=0&&!e.hasSlot?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"info",style:(0,u.Tr)({height:e.isAdvance?"40px":"60px"})},[(0,s.Lk)("div",null,[(0,s.bF)(E,null,{default:(0,s.k6)(()=>[(0,s.bF)((0,d.R1)(c.UploadFilled))]),_:1})]),a[4]||(a[4]=(0,s.Lk)("span",null,"请拖入组件进行编辑",-1))],4)):(0,s.Q3)("",!0)]),_:3})),[[(0,d.R1)(g.sH),[(0,d.R1)(S),{group:"componentsGroup",disabled:!e.isEdit,draggable:".custom-widget-item",group:"componentsGroup",filter:".filter"}]]])]),_:3},8,["style"])):(0,s.Q3)("",!0)]),_:3},8,["size","model","label-width","label-position","style"])}}}),w=a(71241);const C=(0,w.A)(h,[["__scopeId","data-v-56510318"]]);var b=C},70483:function(e,t,a){a.d(t,{Q:function(){return o}});a(44114),a(18111),a(22489);var l=a(164),i=a(56768);const o=(e,t)=>{const a=(0,i.EW)(()=>e.widget),o=(0,i.EW)({get(){return e.widget.childWidgetList||[]},set(e){a.value&&(a.value.childWidgetList=[...e])}}),n=(e=null)=>{t("widgetClick",e)},r=e=>{l.s.confirm("是否删除此组件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a.value.childWidgetList=a.value.childWidgetList.filter(t=>t!==e),n(null)}).catch(e=>{console.warn(e)})},s=t=>{const a=e.widget.childWidgetList;a.push(t)};return{propsWidget:a,childWidgetList:o,onWidgetClick:n,onDeleteWidget:r,onCopyWidget:s}}},73974:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAbXSURBVHgB7ZxPbBRVHMd/v7dbym5brIr8iYdOE/Eih60Joh60602BZPFguVGUg4kk4smLSjFcPJhA1ISD0uLJkmjXSD3aRg8STIADnDx0mmgIxARCaUsr+57v93ZnOzM7051584bu1n4S0unuY/585/d+v9/7vfeK8Ai4WXrRkj8GBWKBIfSBAPm76JWfWb6mNgDeBQSbC5gVAqY74KG9rfzHNUgZhJSQD08PXsoAPywAeyEZtrzT6QrHH58u/16GFDAqBL15xuAwCHHcwMOHoUQRHE7uLF+ywRBGhFCmjzAiT3YYHiUIY6YESSTETGmwN8cWT4DA47CWGBBEW4i/Sy+VsshHU+wCcbFRwMj28qXzoEFsIVrGCkJgKE7P89zJ/vL03Tj/L5YQ5AsQcUKGvgK0NrYMvcU4XYVFbXi7tKeACFNtIAJh0b3W8pdIRLIIEkEgm2ohfxAJBHEXBS9GSciaCqFyAxRX200Eh6hirNo1qj4B2s4S3NC9c8xMNOsmoUJQdKj6BFj1BG2CcvL0TGENQoVQIXJ9iFBDFLqqzxRIoI+QZjQsrWEU1iEVgQeDBm4NQjh+ARJYQ+feVwDz3bB8+Tfg83Oh7Tp2Pw8d1jOAXT2wfOMK/Hv9amhbJttsLr4uz3cfHkz9DLqQ81wQuX5/wpUNaDkCCUToGjoK3UPvqOPl61fgzifvNbTJ9u+C3g8/g8y2nZ7PK7dvqvb000/3kfch99o+ddxh7YK50TOgAznPWhf5wP25x0coa0gwgnSLoE7e1d3Qhh7+iU+/ahDB+e7Jz78N/G6TtB6H/IFD0COF0YXL4YE/inidZdUatPCLQCxMXmhot+XYR6orhIFSPGrjZ378G8/vJEaX73pxQAYex1kXIok1UF/3i3Dvy1Ow+Muk5zN60+43Gwa18VvF4tQk3PvilOezbin+pt0DoIWAYbdVrFiEpjWQE3vM9wbnzp1uECF/YAi2nv0BokJt/W+cxJg75/UNW459rO5Bk2HnoC6EtIZXQYPc/iHP21v4aRwWLo572pCp9xyJP2qnN+73BQsXv/Ocn66d2/8W6CCHDvWTKyFulV4ogUakoJtwdwny9vMXvH2ZRHC8vQ7kC/w+4/74157I0rX/kJZVUAShIjMdKyE4shJoQPmCG3Jo7ryBHGgSERzoHHlpeQ5C5hJu50kOdnPxDdBBiqGeXQmh2y0qt1beCr0h6sMOfmtJSs/bxyEr8wcHupbbKkgcHTLIVYDAv0ovF2Tt8SpokivuA7Zth8r23Df2uMwVokSIOPgTNBKbLOHhzJ+wdPlX0EVWs/qzcibJEtELVQ24rcAh2/+scREIOieFy+VaKq58ki+/0GSQVQAHwTD5fXpePAqde7R68apIP1Fgkj4wTIe0iLTwO2gzCItVJ2TNQR6cBlVpQX4hQQIVfE4UfVIIYbQMl7XSswYHcs4moXyCydhpQZsRNKpNiKUfLtYZG0LU2BCiBkUNGzawpbPEWLPGrQDmzYZPKuhS1LDBIDnNUWAcTOcpssQ/yzjns2CIqKW4pFD9IajAqw/aDAGNLN2jbC+oRJ8GlL2avNYm5FMUNaYhIWSqW89+n2pqHXRNGuq7axS6cMFnGa0qIWcBCaB6JBrO/6Ogij+HjkJC1IJWlUdUBGgtwHJYvqFd10mMu0qmBVZ7RLZ6jDQpqj11NC+LqVwWSUwPhppB5Tl/xTwuWSHUhHB9EvjWwb132nlBiCb2jolL/XRQnwSW84Fn5Cz4CUgR6tM0aZN5anVvTyW4+3KSd7WZdCPgSqBwz4aPyX+pCkEleSr2RoHMfm70NKQJrdZ1juuDLooeIqHTbCsQxtzrMP2jzxFIEf8MVRhUnl+YTOYEm+G2BsIjBCnEhdBbgRHl4tLc/3n3zVBPL6RPoPJ82GIRY/isofqRj5lSoTePnTNpRxBKyTueG6hnoxR+l5osNTJE4PLkwMVkNCkskE3AOgQFDAet4A+sUG0vXy6n2UXWCkoRwrYxhJbqlmBpBAyNTFsEewk6R8K+XHUttomlhi1C020LTRelt+vKfAcaWcsuMdBs70bTKjYNUWl1e9Kh+lrgrMyPsoElUjmfxCBVAdqq4m1H3atBRJ7XqKXgRWgLMfAa3WucHcSxJnhIjEXxYKCVQyuFyEXRWYy79VF7u2NtBX/LbGUgf/BQsCO6W6a1p/yk4mNkfq0wYiUroBX3SfaNm9sSLUeu0kL+n1ui/bgEoYVOFqRALS8gHzXWcpvkg6CBGwdWMiEKPXxFsPPyZ1k+/DSkQGpCuFHZKaBVgcxghvE+wZml/pCGf7WOqP4hDWTcrnA2Kx+cwt+0yTcfxn/70LYd4ctatgAAAABJRU5ErkJggg=="},78430:function(e,t,a){a.d(t,{A:function(){return c}});var l={};a.r(l),a.d(l,{ClassLevel:function(){return o},CourseDifficult:function(){return d},Gender:function(){return r},StudentActionType:function(){return u},StudentExpLevel:function(){return n},TeacherLevelType:function(){return s}});var i=a(52081);const o=new i.w("班级级别",[{id:0,name:"初级班",symbol:"LOWER"},{id:1,name:"培优班",symbol:"HIGH"},{id:2,name:"冲刺提分班",symbol:"INCREASE"},{id:3,name:"竞赛班",symbol:"MATH"}]),n=new i.w("学生经验等级",[{id:0,name:"初级学员",symbol:"LOWER"},{id:1,name:"中级学员",symbol:"NORMAL"},{id:2,name:"高级学员",symbol:"HIGH"},{id:3,name:"资深学员",symbol:"SENIOR"}]),r=new i.w("性别字典",[{id:1,name:"男",symbol:"MALE"},{id:0,name:"女",symbol:"FEMALE"}]),s=new i.w("教师职级",[{id:0,name:"初级教师",symbol:"LOWER"},{id:1,name:"中级教师",symbol:"NORMAL"},{id:2,name:"高级教师",symbol:"HIGH"}]),d=new i.w("课程难度",[{id:0,name:"容易",symbol:"EASY"},{id:1,name:"普通",symbol:"NORMAL"},{id:2,name:"困难",symbol:"DIFFICULT"}]),u=new i.w("学生行为",[{id:0,name:"充值",symbol:"RECHARGE"},{id:1,name:"购买课程",symbol:"BUY_COURSE"},{id:2,name:"上课签到",symbol:"SIGNIN_COURSE"},{id:3,name:"下课签退",symbol:"SIGNOUT_COURSE"},{id:4,name:"看视频课",symbol:"WATCH_VIDEO"},{id:5,name:"做作业",symbol:"DO_PAPER"},{id:6,name:"刷题",symbol:"REFRESH_EXERCISE"},{id:7,name:"献花",symbol:"PRESENT_FLOWER"},{id:8,name:"购买视频课",symbol:"BUY_VIDEO_COURSE"},{id:9,name:"购买鲜花",symbol:"BUY_FLOWER"},{id:10,name:"购买作业",symbol:"BUY_PAPER"}]);var p=a(21016),c={...p,...l}},79745:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var l=a(65451),i=(a(97042),a(63390),a(56768)),o=a(90144),n=a(71066),r=a(54607),s=(0,i.pM)({__name:"DataSelectDlg",props:{value:{},relativeTable:{},formConfig:{},extraData:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:a,onCloseThirdDialog:s}=(0,n.P)(t),d=(0,o.KR)(),u=(0,o.KR)({}),p=(0,o.KR)(""),c=(0,i.EW)(()=>({value:t.value||a.value.value,formConfig:t.formConfig||a.value.formConfig,relativeTable:t.relativeTable||a.value.relativeTable||{},extraData:t.extraData||a.value.extraData||{}})),m=()=>{t.dialog&&t.dialog.cancel()},g=()=>{t.dialog?t.dialog.submit(u.value):s(!0,c.value.value,u.value)},y=e=>{u.value=e};return(0,i.sV)(()=>{(0,i.dY)(()=>{p.value=d.value.offsetHeight+"px"})}),(e,t)=>{const a=l.S2;return(0,i.uX)(),(0,i.CE)("div",{ref_key:"formWrapper",ref:d,class:"form-wrapper"},[(0,i.bF)(a,null,{default:(0,i.k6)(()=>[(0,i.bF)(r.A,{ref:"onlineForm",height:(0,o.R1)(p),formConfig:(0,o.R1)(c).formConfig,selectedColumn:(0,o.R1)(c).relativeTable.relativeColumn,selectedValue:(0,o.R1)(c).value,extraData:(0,o.R1)(c).extraData,onRadioSelectChanged:y,onSubmit:g,onCancel:m},null,8,["height","formConfig","selectedColumn","selectedValue","extraData"])]),_:1})],512)}}}),d=a(71241);const u=(0,d.A)(s,[["__scopeId","data-v-3f71a158"]]);var p=u},80277:function(e,t,a){a.d(t,{A:function(){return p}});var l=a(65451),i=(a(97042),a(63390),a(18111),a(61701),a(56768)),o=a(90144),n=a(24232),r=a(31932);const s=["src"];var d=(0,i.pM)({__name:"OnlineCustomImage",props:{widget:{},value:{},src:{},fit:{},align:{default:"start"},width:{},height:{},radius:{default:5},round:{type:Boolean,default:!1}},setup(e){const t=e,{parseUploadData:a,getUploadFileUrl:d}=(0,r.v)(),u=(0,i.WQ)("form",()=>(console.error("OnlineCustomImage: form not injected"),{isEdit:!1})),p=(0,o.KR)([]),c=(0,i.EW)(()=>{let e=t.round?"50%":t.radius+"px";return{width:null!=t.width?t.width:"200px",height:null!=t.height?t.height:"200px","object-fit":t.fit,"border-radius":e}}),m=(0,i.EW)(()=>{let e={},t=u().flowData;return t&&(t.processDefinitionKey&&(e.processDefinitionKey=t.processDefinitionKey),t.processInstanceId&&(e.processInstanceId=t.processInstanceId),t.taskId&&(e.taskId=t.taskId)),e}),g=(0,i.EW)(()=>(console.log("imageUrl",p,t.src),Array.isArray(p.value)&&p.value.length>0?p.value[0].url:f(t.src)?t.src:y.value)),y=(0,i.EW)(()=>{if(t.value)return t.widget?.relation?"admin/online/onlineOperation/downloadOneToManyRelation/"+(t.widget.datasource||{}).variableName:"admin/online/onlineOperation/downloadDatasource/"+(t.widget?.datasource||{}).variableName;{let a;try{a=t.src?JSON.parse(t.src):void 0,a&&(a=d(a,{filename:a.filename}))}catch(e){console.warn(e),a=null}return a}});function f(e){return e&&/^data:image\/\w+;base64,/.test(e)}return(0,i.wB)(()=>t.value,e=>{console.log("CustomImage.value change",e),setTimeout(()=>{if(p.value=[],e){let l={...m.value,datasourceId:(t.widget?.datasource||{}).datasourceId,fieldName:t.widget?.column?.columnName,asImage:!0,dataId:u().getPrimaryData(t.widget)||""};t.widget?.relation&&(l.relationId=t.widget.relation.relationId);let i=JSON.parse(e);i=Array.isArray(i)?i.map(e=>({...e,downloadUri:y.value})):[],p.value=a(JSON.stringify(i),l)}},30)},{deep:!0,immediate:!0}),(e,t)=>{const a=l.S2;return(0,i.uX)(),(0,i.Wv)(a,{justify:e.align},{default:(0,i.k6)(()=>[(0,i.Lk)("img",{src:(0,o.R1)(g),style:(0,n.Tr)((0,o.R1)(c))},null,12,s)]),_:1},8,["justify"])}}});const u=d;var p=u},84325:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var l=a(65451),i=(a(97042),a(63390),a(25136)),o=(a(69957),a(14022)),n=(a(72343),a(44114),a(18111),a(22489),a(7588),a(61701),a(56768)),r=a(90144),s=a(24232),d=a(99540),u=a(27007),p=a(36947),c=a(60265),m=a(71066);const g={class:"dict-select-dlg"},y={class:"table-box"};var f=(0,n.pM)({__name:"dictSelectDlg",props:{value:{},dictInfo:{},multiple:{type:Boolean},props:{},igoreDictKeys:{},igoreSelect:{type:Boolean},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:a,onCloseThirdDialog:f}=(0,m.P)(t),v=(0,r.KR)(),h=(0,r.KR)(""),w=(0,r.KR)(),C=(0,n.EW)(()=>({value:t.value||a.value,props:t.props||null==a.value.props?t.props:a.value.props||{},dictInfo:t.dictInfo||a.dictInfo,igoreDictKeys:t.igoreDictKeys||a.value.igoreDictKeys,igoreSelect:t.igoreSelect||a.value.igoreSelect,multiple:t.multiple||null==a.value.multiple?t.multiple:a.value.multiple})),b=(0,n.EW)(()=>{if(null==C.value.dictInfo)return[];let e=C.value.dictInfo.dialogSetting,t=[];return null!=e&&null!=e.tableColumnList&&Object.keys(e.tableColumnList).forEach(a=>{let l=e.tableColumnList[a];null!=l&&l.isShow&&t.push({title:l.columnComment,field:a,columnName:a,dictId:l.dictId})}),t}),T=(0,n.EW)(()=>{let e=C.value.multiple?(w.value||[]).map(e=>e[C.value.props.value]):(w.value||{})[C.value.props.value];return{highlight:!0,checkStrictly:!0,checkRowKeys:C.value.multiple?e:void 0,checkRowKey:C.value.multiple?void 0:e,showHeader:!1}}),k=(0,n.EW)(()=>{if(null==C.value.dictInfo)return null;let e=C.value.dictInfo.dialogSetting;return null==e?null:e}),E=(0,n.EW)(()=>null==k.value?[]:k.value.filterFields||[]),R=(0,n.EW)(()=>null==C.value.dictInfo||null==x||null==x.dataList?[]:null==h.value||""===h.value?x.dataList:Array.isArray(E.value)&&0!==E.value.length?x.dataList.filter(e=>{let t=!1;for(let a=0;a<E.value.length;a++){let l=E.value[a],i=e[l+"_dictmap_name"]||e[l];if(null!=i&&i.toString().indexOf(h.value)>=0){t=!0;break}}return t}):x.dataList),S=(0,n.EW)(()=>{if(null==C.value.dictInfo||!C.value.dictInfo.treeFlag)return null;let e={transform:!0,rowField:C.value.props.value,parentField:C.value.dictInfo.parentKeyColumnName,childrenField:"children",expandAll:!0};return e}),D=({row:e})=>{if(C.value.multiple){const t=v.value.isCheckedByCheckboxRow(e);v.value.setCheckboxRow(e,!t),w.value||(w.value=[]),t?w.value=w.value.filter(t=>t[C.value.props.value]!==e[C.value.props.value]):w.value.push(e)}else v.value.setRadioRow(e),w.value=e},I=()=>{null!=v.value&&Array.isArray(x.dataList)&&setTimeout(()=>{if(v.value.clearRadioRow(),v.value.clearCheckboxRow(),C.value.multiple)v.value.setCheckboxRow(x.dataList.filter(e=>null!=(0,u.PH)(w.value,e[C.value.props.value],C.value.props.value)),!0);else{let e=(0,u.PH)(x.dataList,(w.value||{})[C.value.props.value],C.value.props.value);v.value.setRadioRow(e)}},50)},A=e=>{if(null==e&&(e={}),e={...e,dictId:C.value.dictInfo.dictId,dictRelations:b.value.map(e=>({dataIdColumn:e.columnName,dictId:""===e.dictId||null==e.dictId?void 0:e.dictId})).filter(e=>null!=e.dictId)},C.value.multiple&&C.value.igoreDictKeys&&C.value.igoreDictKeys.length>0&&(e.igoreDictKeys=C.value.igoreDictKeys),C.value.multiple&&C.value.igoreSelect&&Array.isArray(C.value.value)&&C.value.value.length>0){const t=C.value.dictInfo.keyColumnName,a=C.value.value.map(e=>e[t]);e.igoreDictKeys=a}return new Promise((t,a)=>{p.NZ.listTableDict(e).then(e=>{(e.data||[]).forEach(e=>{Object.keys(e).forEach(t=>{null!=e[t+"DictMap"]&&(e[t+"_dictmap_name"]=e[t+"DictMap"].name||e[t]),Array.isArray(e[t+"DictMapList"])&&(e[t+"_dictmap_name"]=e[t+"DictMapList"].map(e=>e.name).join(","))})}),t({dataList:e.data,totalCount:(e.data||[]).length}),(0,n.dY)(()=>{I()})}).catch(e=>{a(e)})})},W=()=>!0,L={loadTableData:A,verifyTableParameter:W,paged:!1},x=(0,r.Kh)((0,c.K)(L)),_=()=>{t.dialog?t.dialog.submit(w.value):f(!0,C.value.value,w.value)},F=()=>{null!=C.value.dictInfo&&x.refreshTable(!0,1)},N=({checked:e,row:t})=>{C.value.multiple?null==t?(w.value=[],e&&(w.value=x.dataList)):(null==w.value&&(w.value=[]),e?w.value.push(t):w.value=w.value.filter(e=>e[C.value.props.value]!==t[C.value.props.value])):w.value=t};return(0,n.sV)(()=>{Array.isArray(C.value.value)&&C.value.value.length>0&&(C.value.multiple?w.value=C.value.value.map(e=>({...e})):(console.log("单选",C.value.value),w.value={...C.value.value[0]})),F()}),(e,t)=>{const a=o.WK,u=i.S2,p=l.S2;return(0,n.uX)(),(0,n.CE)("div",g,[(0,n.bF)(p,{type:"flex",justify:"space-between",align:"middle",style:{"margin-bottom":"16px"}},{default:(0,n.k6)(()=>[(0,n.Lk)("div",null,[Array.isArray((0,r.R1)(E))&&(0,r.R1)(E).length>0?((0,n.uX)(),(0,n.Wv)(a,{key:0,modelValue:(0,r.R1)(h),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,r.i9)(h)?h.value=e:null),placeholder:"请输入模糊查询条件",clearable:!0,size:"default",style:{width:"300px"}},null,8,["modelValue"])):(0,n.Q3)("",!0)]),(0,n.bF)(u,{type:"primary",size:"default",onClick:_},{default:(0,n.k6)(()=>t[1]||(t[1]=[(0,n.eW)(" 确定 ")])),_:1,__:[1]})]),_:1}),(0,n.Lk)("div",y,[(0,n.bF)((0,r.R1)(d.CP),{ref_key:"table",ref:v,"row-id":(0,r.R1)(C).props.value,"tree-config":(0,r.R1)(S),data:(0,r.R1)(R),"show-overflow":"title","show-header-overflow":"title",height:"100%","row-config":{height:50,isHover:!0},"virtual-y-config":{enabled:!0,gt:20},"radio-config":{highlight:!0},"checkbox-config":(0,r.R1)(T),onRadioChange:N,onCheckboxAll:N,onCheckboxChange:N,onCellClick:D},{default:(0,n.k6)(()=>[(0,n.bF)((0,r.R1)(d.Wq),{type:(0,r.R1)(C).multiple?"checkbox":"radio",width:null!=(0,r.R1)(S)?90:50,"tree-node":null!=(0,r.R1)(S)},null,8,["type","width","tree-node"]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,r.R1)(b),e=>((0,n.uX)(),(0,n.Wv)((0,r.R1)(d.Wq),{key:e.field,title:e.title,field:e.field},{default:(0,n.k6)(({row:t})=>[(0,n.Lk)("span",null,(0,s.v_)(t[e.field+"_dictmap_name"]||t[e.field]),1)]),_:2},1032,["title","field"]))),128))]),_:1},8,["row-id","tree-config","data","checkbox-config"])])])}}}),v=a(71241);const h=(0,v.A)(f,[["__scopeId","data-v-0ae38a9e"]]);var w=h},84536:function(e,t,a){a.d(t,{A:function(){return y}});var l=a(91542),i=(a(97042),a(37985),a(56768)),o=a(24232),n=a(90144),r=a(44216),s=a(57477);const d=["placeholder","value","disabled","readonly","name"],u=["placeholder","value","disabled","readonly","name"],p={name:"InputNumberRange"};var c=(0,i.pM)({...p,props:{modelValue:{default:()=>[]},size:{default:"default"},disabled:{type:Boolean},readonly:{type:Boolean},prefixIcon:{},startPlaceholder:{},endPlaceholder:{},name:{default:""},rangeSeparator:{default:"-"},validateEvent:{type:Boolean,default:!0},clearable:{type:Boolean}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{form:a,formItem:p}=(0,r.j)();function c(e){if(!e)return!1;var t=/^\d+(\.\d+)?$/,a=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return!(!t.test(e)&&!a.test(e))}const m=t,g=e,y=(0,n.KR)(!1),f=(0,n.KR)(g.modelValue),v=(0,n.KR)(!1),h=(0,i.EW)(()=>g.size||p?.size),w=(0,i.EW)(()=>g.disabled||a?.disabled),C=(0,i.EW)(()=>{let e=g.clearable&&!w.value&&!g.readonly&&v.value&&null!=f.value&&f.value.length>0&&(null!=f.value[0]||null!=f.value[1]);return e}),b=e=>{let t=null;e.target&&(t=parseInt(e.target.value)),t&&(t=c(t.toString())?t:null),t=null==t||Number.isNaN(t)?null:t,f.value?f.value=[t,f.value[1]]:f.value=[t,null]},T=e=>{let t=null;e.target&&(t=parseInt(e.target.value)),t&&(t=c(t.toString())?t:null),t=null==t||Number.isNaN(t)?null:t,f.value?f.value=[f.value[0],t]:f.value=[null,t]},k=()=>{let e=f.value&&f.value[0];f.value?f.value[0]=e:f.value=[e,null],S(f.value)},E=()=>{let e=f.value&&f.value[1];f.value?f.value[1]=e:f.value=[null,e],S(f.value)},R=()=>{f.value=null,S(f.value)},S=e=>{m("update:modelValue",e),m("change",e)};return(0,i.wB)(()=>g.modelValue,e=>{f.value=e,p?.validate("change").catch(e=>{console.warn(e)})},{deep:!0}),(e,t)=>{const a=l.tk;return(0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["el-input el-date-editor el-range-editor el-input__wrapper el-input-number-range",[h.value?"el-range-editor--"+h.value:"",y.value?"is-active":"",{"is-disabled":w.value,"el-input--prefix":e.prefixIcon}]]),style:{height:"100%"},onMouseenter:t[4]||(t[4]=e=>v.value=!0),onMouseleave:t[5]||(t[5]=e=>v.value=!1)},[(0,i.Lk)("div",{class:(0,o.C4)(["el-input__icon el-range__icon",e.prefixIcon])},[(0,i.RG)(e.$slots,"prepend")],2),(0,i.Lk)("input",{autocomplete:"off",placeholder:e.startPlaceholder,value:f.value&&f.value[0],disabled:w.value,readonly:e.readonly,name:e.name&&e.name[0],onInput:b,onChange:k,onFocus:t[0]||(t[0]=e=>y.value=!0),onBlur:t[1]||(t[1]=e=>y.value=!1),class:"el-range-input el-input__wrappe",style:{"flex-grow":"1"}},null,40,d),(0,i.RG)(e.$slots,"range-separator",{},()=>[(0,i.Lk)("span",null,(0,o.v_)(e.rangeSeparator),1)]),(0,i.Lk)("input",{autocomplete:"off",placeholder:e.endPlaceholder,value:f.value&&f.value[1],disabled:w.value,readonly:e.readonly,name:e.name&&e.name[1],onInput:T,onChange:E,onFocus:t[2]||(t[2]=e=>y.value=!0),onBlur:t[3]||(t[3]=e=>y.value=!1),class:"el-range-input el-input__wrappe",style:{"flex-grow":"1"}},null,40,u),(0,i.bF)(a,{class:"el-input__icon el-range__close-icon",style:(0,o.Tr)([{"margin-right":"5px"},{visibility:C.value?"visible":"hidden"}]),onClick:R},{default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(s.CircleClose))]),_:1},8,["style"])],34)}}}),m=a(71241);const g=(0,m.A)(c,[["__scopeId","data-v-06172dd2"]]);var y=g},84602:function(e,t,a){a.d(t,{A:function(){return c}});var l=a(91542),i=(a(97042),a(37985),a(56768)),o=a(45130),n=a(90144),r=a(57477);const s={class:"active-widget-menu"};var d=(0,i.pM)({__name:"ActiveWidgetMenu",props:{widget:{},clone:{type:Function}},emits:["copy","delete"],setup(e,{emit:t}){const a=t,d=e,u=e=>d.clone&&"function"===typeof d.clone?d.clone(e):(console.warn("not found clone method"),null),p=()=>{const e=u(d.widget);e&&a("copy",e)},c=()=>{a("delete",d.widget)};return(e,t)=>{const a=l.tk;return(0,i.uX)(),(0,i.CE)("div",s,[null!=e.clone?((0,i.uX)(),(0,i.Wv)(a,{key:0,onClick:(0,o.D$)(p,["stop"])},{default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(r.CopyDocument))]),_:1})):(0,i.Q3)("",!0),(0,i.bF)(a,{style:{"margin-left":"3px"},onClick:(0,o.D$)(c,["stop"])},{default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(r.Delete))]),_:1})])}}}),u=a(71241);const p=(0,u.A)(d,[["__scopeId","data-v-d35d3fbc"]]);var c=p},85386:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var l=a(25136),i=(a(97042),a(69957),a(76408)),o=(a(87535),a(21929)),n=(a(98421),a(65451)),r=(a(63390),a(32465),a(14022)),s=(a(72343),a(44114),a(18111),a(22489),a(61701),a(56768)),d=a(45130),u=a(90144),p=a(61473),c=a(99540),m=a(60265),g=a(54428),y=a(27007),f=a(71066);const v={style:{width:"100%"}};var h=(0,s.pM)({__name:"DeptSelectDlg",props:{value:{},props:{default:()=>({label:"deptName",value:"deptId"})},multiple:{type:Boolean,default:!1},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:a,onCloseThirdDialog:h}=(0,f.P)(t),w=(0,u.KR)(),C=(0,u.Kh)({deptName:void 0}),b=(0,u.KR)(),T=(0,s.EW)(()=>({value:t.value||a.value.value,props:t.props||null==a.value.props?t.props:a.value.props||{},multiple:t.multiple||null==a.value.multiple?t.multiple:a.value.multiple})),k=(0,s.EW)(()=>{let e=T.value.multiple||Array.isArray(b.value)?(b.value||[]).map(e=>e[T.value.props.value]):(b.value||{})[T.value.props.value];return{highlight:!0,checkStrictly:!0,checkRowKeys:T.value.multiple?e:void 0,checkRowKey:T.value.multiple?void 0:e,showHeader:!1}}),E=()=>{null!=w.value&&Array.isArray(I.dataList)&&setTimeout(()=>{if(w.value.clearRadioRow(),w.value.clearCheckboxRow(),T.value.multiple||Array.isArray(b.value))w.value.setCheckboxRow(I.dataList.filter(e=>null!=(0,y.PH)(b.value,e[T.value.props.value],T.value.props.value)),!0);else{let e=(0,y.PH)(I.dataList,(b.value||{})[T.value.props.value],T.value.props.value);w.value.setRadioRow(e)}},50)},R=e=>(e.widgetType="upms_dept",e.filter={deptName:C.deptName},new Promise((t,a)=>{g.If.list(e).then(e=>{e.data.dataList=(0,y.BN)(e.data.dataList,"deptId"),t({dataList:e.data.dataList,totalCount:e.data.totalCount}),(0,s.dY)(()=>{E()})}).catch(e=>{a(e)})})),S=()=>!0,D={loadTableData:R,verifyTableParameter:S},I=(0,u.Kh)((0,m.K)(D)),A=()=>{t.dialog?t.dialog.submit(b.value):h(!0,T.value.value,b.value)},W=()=>{t.dialog&&t.dialog.cancel()},L=(e=!1)=>{e?I.refreshTable(!0,1):I.refreshTable()},x=({checked:e,row:t})=>{T.value.multiple?null==t?(b.value=[],e&&(b.value=I.dataList)):(null==b.value&&(b.value=[]),e?b.value.push(t):b.value=b.value.filter(e=>e[T.value.props.value]!==t[T.value.props.value])):b.value=t},_=({row:e})=>{if(T.value.multiple){const t=w.value.isCheckedByCheckboxRow(e);w.value.setCheckboxRow(e,!t),b.value||(b.value=[]),t?b.value=b.value.filter(t=>t[T.value.props.value]!==e[T.value.props.value]):b.value.push(e)}else w.value.setRadioRow(e),b.value=e};return(0,s.sV)(()=>{Array.isArray(T.value.value)&&T.value.value.length>0&&(T.value.multiple?b.value=T.value.value.map(e=>({...e})):b.value={...T.value.value[0]}),L(!0)}),(e,t)=>{const a=r.WK,m=o.xE,g=n.S2,y=o.US,f=i.uD,h=l.S2;return(0,s.uX)(),(0,s.CE)("div",v,[(0,s.bF)(y,{ref:"formSysDept",model:C,"label-width":"75px",size:"default","label-position":"right",onSubmit:t[2]||(t[2]=(0,d.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,s.bF)(g,{type:"flex",justify:"space-between"},{default:(0,s.k6)(()=>[(0,s.bF)(m,{label:"部门名称"},{default:(0,s.k6)(()=>[(0,s.bF)(a,{modelValue:C.deptName,"onUpdate:modelValue":t[0]||(t[0]=e=>C.deptName=e),style:{width:"200px"},clearable:!0,placeholder:"部门名称",onChange:t[1]||(t[1]=e=>L(!0))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"]),(0,s.bF)(g,null,{default:(0,s.k6)(()=>[(0,s.bF)(f,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(c.CP),{ref_key:"table",ref:w,"row-id":T.value.props.value,data:I.dataList,height:"460","show-overflow":"title","show-header-overflow":"title","row-config":{height:35,isHover:!0},"radio-config":{highlight:!0},"checkbox-config":k.value,"tree-config":{transform:!1,rowField:"deptId",parentField:"parentId",expandAll:!0},onRadioChange:x,onCheckboxAll:x,onCheckboxChange:x,onCellClick:_},{empty:(0,s.k6)(()=>t[3]||(t[3]=[(0,s.Lk)("div",{class:"table-empty unified-font"},[(0,s.Lk)("img",{src:p}),(0,s.Lk)("span",null,"暂无数据")],-1)])),default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(c.Wq),{type:T.value.multiple?"checkbox":"radio",width:50},null,8,["type"]),(0,s.bF)((0,u.R1)(c.Wq),{title:"部门名称",field:"deptName","tree-node":""})]),_:1},8,["row-id","data","checkbox-config"])]),_:1}),(0,s.bF)(f,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(g,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,s.k6)(()=>[(0,s.bF)(h,{onClick:W},{default:(0,s.k6)(()=>t[4]||(t[4]=[(0,s.eW)("取消")])),_:1,__:[4]}),(0,s.bF)(h,{type:"primary",onClick:A},{default:(0,s.k6)(()=>t[5]||(t[5]=[(0,s.eW)("确认选择")])),_:1,__:[5]})]),_:1})]),_:1})]),_:1})])}}}),w=a(71241);const C=(0,w.A)(h,[["__scopeId","data-v-55c2adfd"]]);var b=C},86449:function(e,t,a){a.d(t,{E:function(){return h},Ji:function(){return u},KG:function(){return y},M2:function(){return p},QL:function(){return g},TL:function(){return r},WB:function(){return T},XX:function(){return k},Yb:function(){return f},_f:function(){return s},al:function(){return m},gs:function(){return d},h3:function(){return b},iJ:function(){return o},n1:function(){return c},n_:function(){return n},qO:function(){return i},r2:function(){return v},rP:function(){return w},x0:function(){return E},y6:function(){return C}});var l=a(21016);function i(){const e={left:"4%",right:"4%",top:60,bottom:40,containLabel:!0};return JSON.parse(JSON.stringify(e))}function o(){const e={show:!1,position:"top",color:"#909399",fontSize:12,formatter:"{c}"};return JSON.parse(JSON.stringify(e))}function n(){const e={show:!0,trigger:"item",backgroundColor:"white",borderColor:"#909399",borderWidth:1,extraCssText:"box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);",padding:6,formatter:void 0,textStyle:{color:"#909399",fontSize:12}};return JSON.parse(JSON.stringify(e))}function r(){const e={show:!0,boundaryGap:!1,position:"bottom",type:"category",name:void 0,nameTextStyle:{color:void 0,fontSize:12},splitLine:{show:!1,lineStyle:{color:"#909399",width:1,type:"solid"}},axisLabel:{show:!0,color:void 0,rotate:0,fontSize:12,formatter:"{value}"}};return JSON.parse(JSON.stringify(e))}function s(){const e={show:!0,position:"left",yAxisValueAuto:!0,min:void 0,max:void 0,interval:void 0,type:"value",name:void 0,nameTextStyle:{color:void 0,fontSize:12},splitLine:{show:!0,lineStyle:{color:"#909399",width:1,type:"solid"}},axisLabel:{show:!0,color:void 0,rotate:0,fontSize:12,formatter:"{value}"},axisLine:{show:!1}};return JSON.parse(JSON.stringify(e))}function d(){const e={show:!0,text:"",left:"center",top:"top",bold:!1,italics:!1,textStyle:{color:"#333",fontSize:18}};return JSON.parse(JSON.stringify(e))}function u(){const e={show:!0,orient:"horizontal",left:"center",bottom:10,icon:"circle",textStyle:{color:"#333",fontSize:12}};return JSON.parse(JSON.stringify(e))}function p(){const e={type:"line",symbol:"emptyCircle",symbolSize:8,smooth:!0,lineStyle:{width:2,type:"solid"},stack:!1,step:void 0,areaStyle:!1};return JSON.parse(JSON.stringify(e))}function c(){const e={type:"bar",autoWidth:!0,barWidth:20,showBackground:!1,backgroundStyle:{color:"#B4B4B4",opacity:.2},stack:!1,lateral:!1};return JSON.parse(JSON.stringify(e))}function m(){const e={type:"pie",radius:"50%",centerX:50,centerY:50,radiusInner:"0%",radiusOuter:"70%",roseType:void 0,label:{show:!1},emphasis:{label:{show:!0},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}};return JSON.parse(JSON.stringify(e))}function g(){const e={name:"Funnel",type:"funnel",top:60,bottom:60,left:10,width:80,minSize:0,maxSize:100,sort:"descending",gap:2,itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{fontSize:20},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}};return JSON.parse(JSON.stringify(e))}function y(){const e={indicator:[],center:["50%","50%"],centerX:50,centerY:50,radius:80,startAngle:90,shape:"circle",splitNumber:4,splitArea:{areaStyle:{}},axisLine:{lineStyle:{color:"rgba(200,200,200, 0.8)"}},splitLine:{lineStyle:{color:"rgba(200,200,200, 0.8)"}},axisName:{show:!0,color:"#fff",fontSize:12,fontWeight:"normal",backgroundColor:"#666",borderRadius:3,padding:[3,5]}};return JSON.parse(JSON.stringify(e))}function f(){const e={name:"Radar",type:"radar",itemStyle:{borderColor:"",borderWidth:1},areaStyleOpacity:0,symbol:"circle",symbolSize:4,colorBy:"data",emphasis:{label:{fontSize:20},lineStyle:{width:2}}};return JSON.parse(JSON.stringify(e))}function v(){const e={name:"Gauge",type:"gauge",min:0,max:1e3,startAngle:220,endAngle:-40,splitNumber:5,radius:"100%",center:["50%","50%"],centerX:50,centerY:50,itemStyle:{borderColor:"#fff",borderWidth:1,shadowColor:"rgba(0,138,255,0.45)",shadowBlur:10,shadowOffsetX:2,shadowOffsetY:2},progress:{show:!0,roundCap:!0,width:4},axisLine:{roundCap:!0,lineStyle:{width:18,color:[[1,"#5470C6"]]}},axisTick:{splitNumber:2,lineStyle:{width:2,color:"#999"}},splitLine:{length:25,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:5,color:"#999",fontSize:12},emphasis:{label:{fontSize:20},lineStyle:{width:2}},detail:{backgroundColor:"transparent",width:"60%",lineHeight:40,height:40,borderRadius:8,fontSize:20,offsetCenter:[0,"35%"],offsetCenterX:0,offsetCenterY:35,valueAnimation:!0}};return JSON.parse(JSON.stringify(e))}function h(){const e={type:"scatter",symbolType:l.ScatterSymbolType.FIXED,itemSize:20,symbolSize:function(e){return e[2]}};return JSON.parse(JSON.stringify(e))}function w(e){const t=JSON.parse(JSON.stringify(e));return t.title&&("top"===t.title.top&&(t.title.top=10),"bottom"===t.title.top&&null==t.title.bottom&&(t.title.bottom=10,t.title.top=void 0),"left"===t.title.left&&(t.title.left=10),"right"===t.title.left&&(t.title.right=10,t.title.left=void 0)),t.legend&&("top"===t.legend.top&&(t.legend.top=10),"bottom"===t.legend.top&&null==t.legend.bottom&&(t.legend.bottom=10,t.legend.top=void 0),"left"===t.legend.left&&(t.legend.left=10),"right"===t.legend.left&&(t.legend.right=10,t.legend.left=void 0)),t}function C(){const e={defineBackColor:"#ECECEC",strokeWidth:12,color:"#F77712",showText:!0,textInside:!1,maxValue:100,textStyle:{text:"{percent}%",color:"#333333"}};return JSON.parse(JSON.stringify(e))}function b(){const e={defineBackColor:"#ECECEC",strokeWidth:12,color:"#F77712",width:200,strokeLinecap:"round",maxValue:100,textStyle:{text:"{percent}%",fontSize:33,color:"#525252",bold:!0,italics:!1}};return JSON.parse(JSON.stringify(e))}function T(){const e={icon:"",iconRadius:30,iconSize:60,mainTextStyle:{text:"",fontSize:14,color:"#333333",bold:!1,italics:!1},numTextStyle:{fontSize:30,color:"#333333",bold:!0,italics:!1},footTextStyle:{fontSize:14,textAlign:"left",color:"#999999"},footNumTextStyle:{fontSize:14,textAlign:"right",color:"#999999"}};return JSON.parse(JSON.stringify(e))}function k(){const e={icon:"",iconRadius:30,iconSize:60,mainTextStyle:{text:"",fontSize:14,color:"#333333",bold:!1,italics:!1},numTextStyle:{fontSize:30,color:"#333333",bold:!0,italics:!1},progress:{...C(),strokeWidth:8,textStyle:{...C().textStyle,text:"{percent}%",textPosition:"right",width:60,fontSize:14,color:"#999999",bold:!1,italics:!1}}};return JSON.parse(JSON.stringify(e))}function E(){const e={listIcon:"circle",listIconColor:"#FF7701",titleStyle:{text:"",fontSize:14,color:"#333333",bold:!0,italics:!1},textStyle:{fontSize:14,color:"#999999",bold:!1,italics:!1},timeStyle:{fontSize:12,color:"#333333"}};return JSON.parse(JSON.stringify(e))}},86555:function(e,t,a){a.d(t,{A:function(){return z}});var l=a(54880),i=(a(97042),a(51582),a(60713),a(69080)),o=(a(25374),a(92358)),n=(a(5954),a(24404),a(2403)),r=(a(63266),a(14022)),s=(a(72343),a(69225),a(65451)),d=(a(63390),a(25136)),u=(a(69957),a(11194)),p=(a(57583),a(44114),a(18111),a(22489),a(61701),a(18237),a(56768)),c=a(24232),m=a(90144),g=a(45130),y=a(57477),f=a(26695),v=a(164),h=a(81387),w=a(27007),C=a(37856),b=a(51351),T=a(60265),k=a(21016),E=a(53155),R=a(36525),S=a(31932),D=a(42933),I=a(82572),A=a(18384),W=a(69838),L=a(46954),x=a(11051);const _={style:{display:"flex",height:"40px","line-height":"40px"}},F={style:{"font-size":"18px",color:"#333","font-weight":"bold"}},N={class:"title"},O={class:"name"},B={class:"table-wrap"},M={class:"title"},X={class:"name"},V={key:0};var P=(0,p.pM)({__name:"index",props:{formConfig:{},height:{},masterTableData:{},isEdit:{type:Boolean,default:!1},isCopy:{type:Boolean},readOnly:{type:Boolean,default:!1},currentWidget:{},rowData:{},fullscreen:{type:Boolean,default:!1},mode:{default:"pc"},dialog:{},isSelect:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},dialogData:{},openEvent:{}},emits:["widgetClick","tableClick","radioSelectChanged","submit","cancel"],setup(e,{expose:t,emit:a}){const P=(0,h.rd)(),{fetchUpload:U}=(0,S.v)(),K=a,z=e,Q=(0,I.l5)(),{getDictDataList:G}=(0,L.o)(),Y=()=>{z.dialog?z.dialog.cancel():K("cancel")},j=()=>{if(z.dialog){if(z.isSelect){if(0==De.value.length)return f.nk.error("请选择数据");z.multiple?z.dialog.submit(De.value):z.dialog.submit(De.value[0])}}else K("submit")},H=(e=!1,t=void 0)=>{Ge.value=t,q.value.isEdit||(e?Qe.value.refreshTable(!0,1):Qe.value.refreshTable())},{isReady:J,dialogParams:q,form:$,formData:Z,getWidgetValue:ee,getWidgetProp:te,getWidgetVisible:ae,onValueChange:le,onWidgetValueChange:ie,getPrimaryData:oe,getDropdownParams:ne,checkOperationPermCode:re,checkOperationDisabled:se,checkOperationVisible:de,handlerScriptOperation:ue,cloneWidget:pe,handlerOperation:ce,loadOnlineFormConfig:me,getTableData:ge,setTableData:ye,initPage:fe,initFormWidgetList:ve,getIgnoreMaskFields:he,initWidgetLinkage:we,onPrint:Ce,onStartFlow:be,loadOnlineDictList:Te,showDialog:ke,showOnlineDialog:Ee,instanceData:Re}=(0,x.m)({props:z,router:P,formRef:void 0,close:Y,refresh:H});(0,p.Gt)("form",()=>({...$.value,mode:z.mode||"pc",isEdit:q.value.isEdit,readOnly:q.value.readOnly,formData:Z,getWidgetValue:ee,getWidgetProp:te,getWidgetVisible:ae,onValueChange:le,onWidgetValueChange:ie,getTableData:ge,setTableData:ye,getPrimaryData:oe,getDropdownParams:ne,checkOperationPermCode:re,checkOperationDisabled:se,checkOperationVisible:de,cloneWidget:pe,onPrint:Ce,onStartFlow:be,handlerScriptOperation:ue,handlerOperation:ce,getIgnoreMaskFields:he,getDictDataList:G,loadOnlineFormConfig:me,loadOnlineDictList:Te,isActive:e=>z.currentWidget===e,getWidgetObject:D.A.getWidgetObject,filter:{name:Ae.value},instanceData:()=>Re}));const Se=(0,m.KR)(),De=(0,m.KR)([]),Ie=(0,m.KR)(!1),Ae=(0,m.KR)(),We=(0,m.KR)(),Le=(0,p.EW)(()=>$.value.leftWidget),xe=(0,p.EW)(()=>$.value.tableWidget),_e=(0,p.EW)(()=>$.value.widgetList),Fe=(0,p.EW)(()=>$.value.operationList),Ne=(0,p.EW)(()=>{if(q.value.isEdit)return;let e=$.value.tableMap.get(xe.value.bindData.tableId);if(e&&Array.isArray(e.columnList))for(let t=0;t<e.columnList.length;t++){let a=e.columnList[t];if(a.primaryKey)return a.columnName}return null}),Oe=(0,p.EW)(()=>xe.value&&xe.value.props.treeFlag&&xe.value.props.parentIdColumn?{rowField:Ne.value,parentField:xe.value.props.parentIdColumn}:null),Be=(0,p.EW)(()=>xe.value&&null!=xe.value.props.groupColumn&&""!==xe.value.props.groupColumn),Me=e=>{xe.value.childWidgetList=e},Xe=e=>{if(null==e)return;if(e.bindData.dataType!==k.SysCustomWidgetBindDataType.Column||null==e.column)return;let t=e.column,a=ee(e);if(null==a||""===a||Array.isArray(a)&&0===a.length)return;const l={tableName:e.table.tableName,columnName:e.column.columnName,filterType:e.column.filterType,columnValue:e.column.filterType!==R.SysOnlineColumnFilterType.RANFGE_FILTER?a:void 0};return t.filterType===R.SysOnlineColumnFilterType.RANFGE_FILTER&&(l.columnValueStart=a[0],l.columnValueEnd=a[1]),l},Ve=()=>{let e=[];if(Array.isArray(_e.value)&&(e=_e.value.map(e=>Xe(e)).filter(e=>null!=e)),null!=Le.value){let t=Xe(Le.value);t&&e.push(t)}return e},Pe=()=>{if(We.value){let e=We.value;if(Array.isArray(We.value)&&(e=We.value[0]),e)return e.getSearchString()}return null},Ue=async e=>{let t=$.value.tableMap.get(xe.value.bindData.tableId);if(!t)throw console.warn("table is undefined tableId=",xe.value.bindData.tableId),new Error;e.datasourceId=t.datasource.datasourceId,e.filterDtoList=Ve(),null!=xe.value.relation&&null!=q.value.masterTableData&&(e.relationId=t.relation.relationId,e.filterDtoList.push({tableName:xe.value.table.tableName,columnName:xe.value.relation.slaveColumn.columnName,filterType:R.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(q.value.masterTableData||{})[xe.value.relation.masterColumn.columnName]})),null==xe.value.relation||z.dialog||(e.relationId=t.relation.relationId);let a,l=Pe();if(Array.isArray(xe.value.props.likeQueryColumn)&&xe.value.props.likeQueryColumn.length>0&&null!=l&&""!==l){let t=xe.value.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(e.filterDtoList)||(e.filterDtoList=[]),e.filterDtoList.push({columnName:t,filterType:14,columnValue:l})}if(null!=Ge.value&&(e.customFilterGroupList=Ge.value),e.ignoreMaskFields=he(xe.value),!Array.isArray(e.orderParam)||e.orderParam.length<=0){let{orderColumn:t,orderAsc:a}=xe.value.props;t&&(e.orderParam=[{fieldName:t,asc:!!a}])}if(q.value.isEdit||"function"!==typeof xe.value.eventInfo[k.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(e=await xe.value.eventInfo[k.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](e,Re)),z.isSelect&&z.openEvent&&(e=await z.openEvent(e,Re)),null==e)throw new Error("取消获取表格数据");return a=null!=t.relation?await(0,E.bE)(A.x+"/online/onlineOperation/listByOneToManyRelationId/"+t.datasource.variableName,e):await(0,E.bE)(A.x+"/online/onlineOperation/listByDatasourceId/"+t.datasource.variableName,e),q.value.isEdit||"function"!==typeof xe.value.eventInfo[k.OnlineFormEventType.AFTER_LOAD_TABLE_DATA]||(a.data.dataList=await xe.value.eventInfo[k.OnlineFormEventType.AFTER_LOAD_TABLE_DATA](a.data.dataList,Re)),xe.value&&xe.value.props.treeFlag&&xe.value.props.parentIdColumn&&(a.data.dataList=(0,w.BN)(a.data.dataList,Ne.value,xe.value.props.parentIdColumn)),De.value=[],{dataList:a.data.dataList,totalCount:a.data.totalCount}},Ke=()=>!0,ze={loadTableData:Ue,verifyTableParameter:Ke,paged:!Be.value&&(z.formConfig||q.value.formConfig).tableWidget.props.paged},Qe=(0,m.KR)((0,T.K)(ze)),Ge=(0,m.KR)([]),Ye=e=>{_e.value.push(e)},je=e=>{K("widgetClick",e)},He=e=>{v.s.confirm("是否删除此组件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=$.value.widgetList.indexOf(e);-1!==t&&$.value.widgetList.splice(t,1),je(null)}).catch(e=>{console.warn(e)})},Je=()=>{K("tableClick",xe.value)},qe=()=>{K("widgetClick",$.value.leftWidget)},$e=e=>{De.value=e},Ze=()=>{De.value.length<=0?f.nk.error("请选择要批量删除的数据！"):v.s.confirm("是否删除选中数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e,t=$.value.tableMap.get(xe.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataIdList:De.value.map(e=>e[Ne.value]).filter(e=>null!=e)};e=a.relationId?(0,E.bE)(A.x+"/online/onlineOperation/deleteBatchOneToManyRelation/"+t.datasource.variableName,a):(0,E.bE)(A.x+"/online/onlineOperation/deleteBatchDatasource/"+t.datasource.variableName,a),e.then(()=>{f.nk.success("删除成功！"),H(!0)}).catch(e=>{console.warn(e)})})},et=e=>{v.s.confirm("是否删除当前数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=$.value.tableMap.get(xe.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataId:e[Ne.value]},l=null;l=a.relationId?(0,E.bE)(A.x+"/online/onlineOperation/deleteOneToManyRelation/"+t.datasource.variableName,a):(0,E.bE)(A.x+"/online/onlineOperation/deleteDatasource/"+t.datasource.variableName,a),l.then(()=>{f.nk.success("删除成功！"),H(!0)}).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},tt=e=>{v.s.confirm("是否导出表格数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=$.value.tableMap.get(xe.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,filterDtoList:Ve(),exportInfoList:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder)};null!=xe.value.relation&&a.filterDtoList.push({tableName:xe.value.table.tableName,columnName:xe.value.relation.slaveColumn.columnName,filterType:R.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(q.value.masterTableData||{})[xe.value.relation.masterColumn.columnName]});let l,i=Pe();if(Array.isArray(xe.value.props.likeQueryColumn)&&xe.value.props.likeQueryColumn.length>0&&null!=i&&""!==i){let e=xe.value.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(a.filterDtoList)||(a.filterDtoList=[]),a.filterDtoList.push({columnName:e,filterType:14,columnValue:i})}if(q.value.isEdit||"function"!==typeof xe.value.eventInfo[k.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(a=await xe.value.eventInfo[k.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](a,Re)),null==a)throw new Error("取消导出表格数据");try{l=a.relationId?await(0,E.RG)(A.x+"/online/onlineOperation/exportByOneToManyRelationId/"+t.datasource.variableName,a,xe.value.showName+".xlsx"):await(0,E.RG)(A.x+"/online/onlineOperation/exportByDatasourceId/"+t.datasource.variableName,a,xe.value.showName+".xlsx"),f.nk.success("导出成功！")}catch(o){f.nk.error(o)}}).catch(e=>{console.warn(e)})},at=(e,t)=>{let a=$.value.tableMap.get(xe.value.bindData.tableId);if(null==t)return void f.nk.error("请选择要导入的文件！");if(null==a)return void f.nk.error("未找到数据源！");let l=A.x+"/online/onlineOperation/importDatasource/"+a.datasource.variableName,i={datasourceId:a.datasource.datasourceId,importColumnIds:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder).map(e=>e.columnId),duplicateVerifyColumns:(e.exportColumnList||[]).filter(e=>e.duplicateCheckColumn).map(e=>e.columnId),skipHeader:e.skipHeader,importFile:t};U(l,i).then(()=>{f.nk.success("导入成功！"),H(!0)}).catch(e=>{f.nk.error(e)})},lt=()=>{H(!0)},it=()=>{H(!0)},ot=e=>{Se.value&&Se.value.resetWidget(e)},nt=e=>{let t=rt(e);return t&&t.enabled},rt=e=>(0,w.PH)($.value.operationList,e,"type"),st=e=>{let t=rt(e);return!$.value.readOnly&&nt(e)&&de(t)},dt=e=>{let t=rt(e);return se(t)||!re(t)},ut=(e,t)=>{le(Le.value,e),ie(Le.value,e,t),(0,p.dY)(()=>{H(!0)})},pt=e=>(mt(rt(k.SysCustomWidgetOperationType.IMPORT),e),!1),ct=(e,t=null)=>{if(null==e)return;let a,l=$.value.tableMap.get(xe.value.bindData.tableId),i={datasourceId:l.datasource.datasourceId,relationId:(l.relation||{}).relationId,masterData:{},slaveData:{}};if(null!=e.relationId?i.slaveData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}):i.masterData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}),e.rowOperation){if(null==t||null==t[Ne.value])return void f.nk.error("请选择要更新的数据！");i.dataIdList=[t[Ne.value]]}else{if(De.value.length<=0)return void f.nk.error("请选择要更新的数据！");i.dataIdList=De.value.map(e=>e[Ne.value]).filter(e=>null!=e)}a=i.relationId?(0,E.bE)(A.x+"/online/onlineOperation/updateOneToManyRelationBatch/"+l.datasource.variableName,i):(0,E.bE)(A.x+"/online/onlineOperation/updateDatasourceBatch/"+l.datasource.variableName,i),a.then(t=>{f.nk.success(e.name+"成功！"),H(!0)}).catch(e=>{console.warn(e)})},mt=(e,t=null)=>{if(!q.value.isEdit)if(null!=e)if(e.type===k.SysCustomWidgetOperationType.BATCH_DELETE)Ze();else if(e.type===k.SysCustomWidgetOperationType.DELETE)t&&et(t);else if(e.type===k.SysCustomWidgetOperationType.EXPORT)tt(e);else if(e.type===k.SysCustomWidgetOperationType.IMPORT)at(e,t);else if(e.type===k.SysCustomWidgetOperationType.PRINT)Ce(e,t,De.value,xe.value.showName);else if(e.type===k.SysCustomWidgetOperationType.START_FLOW)be(e,t);else if(e.type===k.SysCustomWidgetOperationType.UPDATE)ct(e,t);else if(e.type===k.SysCustomWidgetOperationType.SCRIPT)ue(e,t).catch(e=>{console.warn(e)});else{let a=[];if(e.type===k.SysCustomWidgetOperationType.UPDATE_DIALOG)if(e.rowOperation){if(null==t)return void f.nk.error("请选择要更新的数据！");a=[t[Ne.value]]}else{if(De.value.length<=0)return void f.nk.error("请选择要更新的数据！");a=De.value.map(e=>e[Ne.value])}ce(e,{isEdit:q.value.isEdit,isUpdate:e.type===k.SysCustomWidgetOperationType.UPDATE_DIALOG,updateIdList:a,rowData:t,masterTableData:q.value.masterTableData||t,callback:()=>{H()}})}else console.warn("operation is null")},gt=e=>{De.value=[e],K("radioSelectChanged",e)};return t({resetWidget:ot}),(0,p.sV)(()=>{if(J.value=!1,!q.value.isEdit){if(!q.value.isEdit&&"function"===typeof $.value.eventInfo[k.OnlineFormEventType.AFTER_CREATE_FORM]){let e={formData:Z};$.value.eventInfo[k.OnlineFormEventType.AFTER_CREATE_FORM](e,Re)}it(),we()}J.value=!0}),(e,t)=>{const a=u.fR,f=d.S2,v=s.S2,h=l.bZ,w=r.WK,T=n.kA,E=l.Mb,R=o.j5,S=i.aQ,D=l.ZO,I=l.lX;return(0,p.bo)(((0,p.uX)(),(0,p.CE)("div",{class:(0,c.C4)(["online-advance-query-form",{"select-dialog":e.isSelect}])},[(0,m.R1)(q).fullscreen&&!(0,m.R1)(q).isEdit?((0,p.uX)(),(0,p.Wv)(I,{key:0},{default:(0,p.k6)(()=>[(0,p.bF)(h,{style:{height:"72px",background:"white"}},{default:(0,p.k6)(()=>[(0,p.bF)(v,{align:"middle",style:{"justify-content":"space-between",width:"100%",height:"100%"}},{default:(0,p.k6)(()=>[(0,p.Lk)("div",_,[t[12]||(t[12]=(0,p.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"BIQS",-1)),(0,p.bF)(a,{direction:"vertical",style:{height:"26px",margin:"7px 8px"}}),(0,p.Lk)("span",F,(0,c.v_)((0,m.R1)($).formName),1)]),(0,p.bF)(f,{link:"",size:"default",icon:(0,m.R1)(y.Close),style:{"font-size":"24px",color:"#909399"},onClick:Y},null,8,["icon"])]),_:1})]),_:1}),(0,p.bF)(D,{style:{width:"100%",padding:"25px",background:"#f9f9f9"}},{default:(0,p.k6)(()=>[(0,p.bF)(I,{style:{height:"calc(100vh - 122px)",padding:"25px",background:"white"}},{default:(0,p.k6)(()=>[null!=(0,m.R1)(Le)?((0,p.uX)(),(0,p.Wv)(E,{key:0,width:"265px",class:"left-panel",onClick:(0,g.D$)(qe,["stop"])},{default:(0,p.k6)(()=>[(0,p.Lk)("div",N,[(0,p.bF)(v,{align:"middle",style:{"flex-wrap":"nowrap"}},{default:(0,p.k6)(()=>[(0,p.Lk)("span",O,(0,c.v_)((0,m.R1)(Le).showName),1),(0,p.bF)(w,{class:"search round-search","prefix-icon":(0,m.R1)(y.Search),modelValue:(0,m.R1)(Ae),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,m.i9)(Ae)?Ae.value=e:null),clearable:"",size:(0,m.R1)(Q).defaultFormItemSize,style:{"border-radius":"16px"},placeholder:"输入"+(0,m.R1)(Le).showName},null,8,["prefix-icon","modelValue","size","placeholder"])]),_:1})]),(0,p.bF)(T,{class:"custom-scroll tree",style:{"flex-grow":"1"}},{default:(0,p.k6)(()=>[(0,p.Lk)("div",{class:(0,c.C4)(["widget-item",{active:(0,m.R1)(q).isEdit&&e.currentWidget===(0,m.R1)(Le)}])},[(0,p.bF)(C.A,{widget:(0,m.R1)(Le),ref:(0,m.R1)(Le).variableName,value:(0,m.R1)(ee)((0,m.R1)(Le)),onInput:t[1]||(t[1]=e=>(0,m.R1)(le)((0,m.R1)(Le),e)),onChange:ut},null,8,["widget","value"])],2)]),_:1})]),_:1})):(0,p.Q3)("",!0),(0,p.bF)(D,{class:"table-panel",style:{"margin-left":"15px"}},{default:(0,p.k6)(()=>[(0,p.bF)(v,{class:"query-filter-box",type:"flex",justify:"end",style:{"margin-bottom":"20px"}},{default:(0,p.k6)(()=>[st((0,m.R1)(k.SysCustomWidgetOperationType).BATCH_DELETE)?((0,p.uX)(),(0,p.Wv)(f,{key:0,class:"table-operation",size:(0,m.R1)(Q).defaultFormItemSize,type:rt((0,m.R1)(k.SysCustomWidgetOperationType).BATCH_DELETE)?.btnType,plain:rt((0,m.R1)(k.SysCustomWidgetOperationType).BATCH_DELETE)?.plain,disabled:dt((0,m.R1)(k.SysCustomWidgetOperationType).BATCH_DELETE),onClick:t[2]||(t[2]=e=>mt(rt((0,m.R1)(k.SysCustomWidgetOperationType).BATCH_DELETE))),icon:(0,m.R1)(y.Delete)},{default:(0,p.k6)(()=>[(0,p.eW)((0,c.v_)(rt((0,m.R1)(k.SysCustomWidgetOperationType).BATCH_DELETE)?.name||"批量删除"),1)]),_:1},8,["size","type","plain","disabled","icon"])):(0,p.Q3)("",!0),st((0,m.R1)(k.SysCustomWidgetOperationType).EXPORT)?((0,p.uX)(),(0,p.Wv)(f,{key:1,class:"table-operation",size:(0,m.R1)(Q).defaultFormItemSize,type:rt((0,m.R1)(k.SysCustomWidgetOperationType).EXPORT)?.btnType,plain:rt((0,m.R1)(k.SysCustomWidgetOperationType).EXPORT)?.plain,disabled:dt((0,m.R1)(k.SysCustomWidgetOperationType).EXPORT),onClick:t[3]||(t[3]=e=>mt(rt((0,m.R1)(k.SysCustomWidgetOperationType).EXPORT))),icon:(0,m.R1)(y.Download)},{default:(0,p.k6)(()=>[(0,p.eW)((0,c.v_)(rt((0,m.R1)(k.SysCustomWidgetOperationType).EXPORT)?.name||"导出"),1)]),_:1},8,["size","type","plain","disabled","icon"])):(0,p.Q3)("",!0),st((0,m.R1)(k.SysCustomWidgetOperationType).IMPORT)?((0,p.uX)(),(0,p.Wv)(R,{key:2,class:"table-operation",action:"",style:{display:"inline-block"},"show-file-list":!1,accept:".xlsx, .xls","before-upload":pt},{default:(0,p.k6)(()=>[(0,p.bF)(f,{size:(0,m.R1)(Q).defaultFormItemSize,type:rt((0,m.R1)(k.SysCustomWidgetOperationType).IMPORT)?.btnType,plain:rt((0,m.R1)(k.SysCustomWidgetOperationType).IMPORT)?.plain,disabled:dt((0,m.R1)(k.SysCustomWidgetOperationType).IMPORT),icon:"Upload"},{default:(0,p.k6)(()=>[(0,p.eW)((0,c.v_)(rt((0,m.R1)(k.SysCustomWidgetOperationType).IMPORT)?.name||"导入"),1)]),_:1},8,["size","type","plain","disabled"])]),_:1})):(0,p.Q3)("",!0),st((0,m.R1)(k.SysCustomWidgetOperationType).PRINT)?((0,p.uX)(),(0,p.Wv)(f,{key:3,class:"table-operation",size:(0,m.R1)(Q).defaultFormItemSize,type:rt((0,m.R1)(k.SysCustomWidgetOperationType).PRINT)?.btnType,plain:rt((0,m.R1)(k.SysCustomWidgetOperationType).PRINT)?.plain,disabled:dt((0,m.R1)(k.SysCustomWidgetOperationType).PRINT),onClick:t[4]||(t[4]=e=>mt(rt((0,m.R1)(k.SysCustomWidgetOperationType).PRINT)))},{default:(0,p.k6)(()=>[(0,p.eW)((0,c.v_)(rt((0,m.R1)(k.SysCustomWidgetOperationType).PRINT)?.name||"打印"),1)]),_:1},8,["size","type","plain","disabled"])):(0,p.Q3)("",!0),st((0,m.R1)(k.SysCustomWidgetOperationType).ADD)?((0,p.uX)(),(0,p.Wv)(f,{key:4,size:(0,m.R1)(Q).defaultFormItemSize,type:rt((0,m.R1)(k.SysCustomWidgetOperationType).ADD)?.btnType,plain:rt((0,m.R1)(k.SysCustomWidgetOperationType).ADD)?.plain,disabled:dt((0,m.R1)(k.SysCustomWidgetOperationType).ADD),onClick:t[5]||(t[5]=e=>mt(rt((0,m.R1)(k.SysCustomWidgetOperationType).ADD))),icon:(0,m.R1)(y.Plus)},{default:(0,p.k6)(()=>[(0,p.eW)((0,c.v_)(rt((0,m.R1)(k.SysCustomWidgetOperationType).ADD)?.name||"新建"),1)]),_:1},8,["size","type","plain","disabled","icon"])):(0,p.Q3)("",!0)]),_:1}),(0,m.R1)(_e).length>0||e.isEdit?((0,p.uX)(),(0,p.CE)("div",{key:0,class:"query-filter-box",style:(0,c.Tr)([{"margin-bottom":"10px"},{background:(0,m.R1)(q).isEdit?void 0:"#F6F7F9",border:(0,m.R1)(q).isEdit?"1px solid #e8eaec":"none"}])},[(0,p.bF)(W.A,{isEdit:(0,m.R1)(q).isEdit,ref_key:"filterBox",ref:Se,isAdvance:!0,itemWidth:(0,m.R1)($).filterItemWidth||350,widgetList:(0,m.R1)(_e),formData:(0,m.R1)(Z),operationList:(0,m.R1)(Fe),onWidgetClick:je,onSearch:t[6]||(t[6]=e=>H(!0)),onReset:lt,onCopy:Ye,onDelete:He,onOperationClick:mt},null,8,["isEdit","itemWidth","widgetList","formData","operationList"])],4)):(0,p.Q3)("",!0),(0,p.Lk)("div",B,[(0,p.Lk)("div",{class:(0,c.C4)(["query-table-box widget-item",{active:(0,m.R1)(q).isEdit&&e.currentWidget===(0,m.R1)(xe)}]),style:(0,c.Tr)([{"margin-top":"8px"},{padding:"16px 24px",backgroundColor:"white"}]),onClick:(0,g.D$)(Je,["stop"])},[(0,p.bF)(b.A,{ref_key:"tableRef",ref:We,dataList:(0,m.R1)(Qe).dataList,isEdit:(0,m.R1)(q).isEdit,widget:(0,m.R1)(xe),multiSelect:(0,m.R1)(Ie),operationList:(0,m.R1)(Fe),getTableIndex:(0,m.R1)(Qe).getTableIndex,sortChange:(0,m.R1)(Qe).onSortChange,onSelectChange:$e,treeConfig:(0,m.R1)(Oe),onRefresh:t[7]||(t[7]=e=>H(!1,e)),onOperationClick:mt,onWidgetClick:je,onUpdateChildWidgetList:Me},{pagination:(0,p.k6)(()=>[!(0,m.R1)(Be)&&(0,m.R1)(xe)&&(0,m.R1)(xe).props.paged&&null==(0,m.R1)(Oe)?((0,p.uX)(),(0,p.Wv)(v,{key:0,justify:"end",style:{"margin-top":"10px"}},{default:(0,p.k6)(()=>[(0,p.bF)(S,{total:(0,m.R1)(Qe).totalCount,"current-page":(0,m.R1)(Qe).currentPage,"page-size":(0,m.R1)(Qe).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,m.R1)(Qe).onCurrentPageChange,onSizeChange:(0,m.R1)(Qe).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})):(0,p.Q3)("",!0)]),_:1},8,["dataList","isEdit","widget","multiSelect","operationList","getTableIndex","sortChange","treeConfig"])],2)])]),_:1})]),_:1})]),_:1})]),_:1})):((0,p.uX)(),(0,p.Wv)(I,{key:1,style:(0,c.Tr)({height:e.height?e.height:"100%"})},{default:(0,p.k6)(()=>[null!=(0,m.R1)(Le)?((0,p.uX)(),(0,p.Wv)(E,{key:0,width:"265px",class:"left-panel",onClick:(0,g.D$)(qe,["stop"])},{default:(0,p.k6)(()=>[(0,p.Lk)("div",M,[(0,p.bF)(v,{align:"middle",style:{"flex-wrap":"nowrap"}},{default:(0,p.k6)(()=>[(0,p.Lk)("span",X,(0,c.v_)((0,m.R1)(Le).showName),1),(0,p.bF)(w,{class:"search round-search","prefix-icon":(0,m.R1)(y.Search),modelValue:(0,m.R1)(Ae),"onUpdate:modelValue":t[8]||(t[8]=e=>(0,m.i9)(Ae)?Ae.value=e:null),clearable:"",size:(0,m.R1)(Q).defaultFormItemSize,style:{"border-radius":"16px"},placeholder:"输入"+(0,m.R1)(Le).showName},null,8,["prefix-icon","modelValue","size","placeholder"])]),_:1})]),(0,p.bF)(T,{class:"custom-scroll tree",style:{"flex-grow":"1"}},{default:(0,p.k6)(()=>[(0,p.Lk)("div",{class:(0,c.C4)(["widget-item",{active:(0,m.R1)(q).isEdit&&e.currentWidget===(0,m.R1)(Le)}])},[(0,p.bF)(C.A,{widget:(0,m.R1)(Le),ref:(0,m.R1)(Le).variableName,value:(0,m.R1)(ee)((0,m.R1)(Le)),onInput:t[9]||(t[9]=e=>(0,m.R1)(le)((0,m.R1)(Le),e)),onChange:ut},null,8,["widget","value"])],2)]),_:1})]),_:1})):(0,p.Q3)("",!0),(0,p.bF)(D,{class:"table-panel",style:{overflow:"hidden","margin-left":"15px"}},{default:(0,p.k6)(()=>[(0,m.R1)(_e).length>0||e.isEdit?((0,p.uX)(),(0,p.CE)("div",{key:0,class:"query-filter-box",style:(0,c.Tr)({background:(0,m.R1)(q).isEdit?void 0:"#F6F7F9",border:(0,m.R1)(q).isEdit?"1px solid #e8eaec":"none"})},[(0,p.bF)(W.A,{isEdit:(0,m.R1)(q).isEdit,ref_key:"filterBox",ref:Se,isAdvance:!0,style:{"margin-bottom":"16px"},itemWidth:(0,m.R1)($).filterItemWidth||350,widgetList:(0,m.R1)(_e),formData:(0,m.R1)(Z),operationList:(0,m.R1)(Fe),onWidgetClick:je,onSearch:t[10]||(t[10]=e=>H(!0)),onReset:lt,onCopy:Ye,onDelete:He,onOperationClick:mt},null,8,["isEdit","itemWidth","widgetList","formData","operationList"])],4)):(0,p.Q3)("",!0),(0,p.Lk)("div",{class:(0,c.C4)(["query-table-box widget-item",{active:(0,m.R1)(q).isEdit&&e.currentWidget===(0,m.R1)(xe)}]),onClick:(0,g.D$)(Je,["stop"])},[(0,p.bF)(b.A,{ref_key:"tableRef",ref:We,dataList:(0,m.R1)(Qe).dataList,isEdit:(0,m.R1)(q).isEdit,widget:(0,m.R1)(xe),multiSelect:(0,m.R1)(Ie)||e.isSelect&&e.multiple,singleSelect:e.isSelect&&!e.multiple,isSelectDialog:e.isSelect,operationList:(0,m.R1)(Fe),getTableIndex:(0,m.R1)(Qe).getTableIndex,sortChange:(0,m.R1)(Qe).onSortChange,onSelectChange:$e,onRadioChange:gt,treeConfig:(0,m.R1)(Oe),onOperationClick:mt,onRefresh:t[11]||(t[11]=e=>H(!1,e)),onWidgetClick:je,onUpdateChildWidgetList:Me},{pagination:(0,p.k6)(()=>[!(0,m.R1)(Be)&&(0,m.R1)(xe)&&(0,m.R1)(xe).props.paged&&null==(0,m.R1)(Oe)?((0,p.uX)(),(0,p.Wv)(v,{key:0,justify:e.isSelect?"space-between":"end",style:{"margin-top":"10px"}},{default:(0,p.k6)(()=>[(0,p.bF)(S,{total:(0,m.R1)(Qe).totalCount,"current-page":(0,m.R1)(Qe).currentPage,"page-size":(0,m.R1)(Qe).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,m.R1)(Qe).onCurrentPageChange,onSizeChange:(0,m.R1)(Qe).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"]),e.isSelect?((0,p.uX)(),(0,p.CE)("div",V,[(0,p.bF)(f,{onClick:Y},{default:(0,p.k6)(()=>t[13]||(t[13]=[(0,p.eW)("取消")])),_:1,__:[13]}),(0,p.bF)(f,{type:"primary",onClick:j},{default:(0,p.k6)(()=>t[14]||(t[14]=[(0,p.eW)("确认选择")])),_:1,__:[14]})])):(0,p.Q3)("",!0)]),_:1},8,["justify"])):(0,p.Q3)("",!0)]),_:1},8,["dataList","isEdit","widget","multiSelect","singleSelect","isSelectDialog","operationList","getTableIndex","sortChange","treeConfig"])],2)]),_:1})]),_:1},8,["style"]))],2)),[[g.aG,(0,m.R1)(J)]])}}}),U=a(71241);const K=(0,U.A)(P,[["__scopeId","data-v-5d5c4ef5"]]);var z=K},88279:function(e,t,a){a.d(t,{E:function(){return n},a:function(){return o}});a(44114),a(18111),a(7588);const l={mobie:/^((\+?86)|(\(\+86\)))?(13[012356789][0-9]{8}|15[012356789][0-9]{8}|17[012356789][0-9]{8}|19[012356789][0-9]{8}|18[02356789][0-9]{8}|147[0-9]{8}|1349[0-9]{7})$/,english:/^[a-zA-Z]+$/,englishAndNumber:/^[a-zA-Z0-9]+$/};var i=a(21016);function o(e,t,a="blur"){if(t.propDataJson&&(t.data=JSON.parse(t.propDataJson)),null!=e&&null!=t&&null!=t.onlineRule&&null!=t.data)switch(t.onlineRule.ruleType){case i.SysOnlineRuleType.INTEGER_ONLY:return{type:"integer",message:t.data.message,trigger:a,transform:e=>Number(e)};case i.SysOnlineRuleType.DIGITAL_ONLY:return{type:"number",message:t.data.message,trigger:a,transform:e=>Number(e)};case i.SysOnlineRuleType.LETTER_ONLY:return{type:"string",pattern:l.english,message:t.data.message,trigger:a};case i.SysOnlineRuleType.EMAIL:return{type:"email",message:t.data.message,trigger:a};case i.SysOnlineRuleType.MOBILE:return{type:"string",pattern:l.mobie,message:t.data.message,trigger:a};case i.SysOnlineRuleType.RANGE:if(e){let l=-1===["Boolean","Date","String"].indexOf(e.objectFieldType);return{type:l?"number":"string",min:t.data.min,max:t.data.max,message:t.data.message,trigger:a}}break;case i.SysOnlineRuleType.CUSTOM:return{type:"string",pattern:new RegExp(t.onlineRule.pattern),message:t.data.message,trigger:a}}}function n(e,t,a="blur"){let l=[];return null==e||(e.nullable||l.push({required:!0,message:t+"不能为空",trigger:a}),null!=e.ruleList&&e.ruleList.length>0&&e.ruleList.forEach(t=>{let i=o(e,t,a);i&&l.push(i)})),l}},89001:function(e,t,a){a.d(t,{A:function(){return pt}});var l=a(65451),i=(a(97042),a(63390),a(91542)),o=(a(37985),a(76408)),n=(a(87535),a(11194)),r=(a(57583),a(56768)),s=a(24232),d=(0,r.pM)({__name:"index",props:{showLine:{type:Boolean,default:!0},showBorderLine:{type:Boolean,default:!1},lineColor:{default:"#409EFF"},lineWidth:{default:"3px"},lineRadius:{default:"3px"},fontColor:{default:"#303133"},fontSize:{default:14},fontWeight:{default:"normal"},backgroundColor:{default:void 0},titleAlign:{default:"left"},paddingTop:{default:0}},setup(e){const t=e,a=(0,r.EW)(()=>{const e=null!=t.backgroundColor&&""!==t.backgroundColor,a=t.paddingTop;let l=.8*t.fontSize;return t.showBorderLine&&!e&&(l=8),{backgroundColor:t.backgroundColor,"border-bottom":t.showBorderLine?"1px solid #DCDFE6":"none","padding-top":(e?.8*t.fontSize:a||0)+"px","padding-bottom":(t.showBorderLine||e?l:0)+"px","padding-left":(e?1.1*t.fontSize:0)+"px","padding-right":(e?1.1*t.fontSize:0)+"px"}});return(e,t)=>((0,r.uX)(),(0,r.CE)("div",{class:"custom-title",style:(0,s.Tr)(a.value)},[e.showLine?((0,r.uX)(),(0,r.CE)("div",{key:0,class:"title-line",style:(0,s.Tr)({backgroundColor:e.lineColor,width:e.lineWidth,height:e.fontSize-2+"px",borderRadius:e.lineRadius})},null,4)):(0,r.Q3)("",!0),(0,r.Lk)("div",{class:"title-text",style:(0,s.Tr)({color:e.fontColor,fontSize:e.fontSize+"px",justifyContent:e.titleAlign,fontWeight:e.fontWeight})},[(0,r.RG)(e.$slots,"default")],4)],4))}}),u=a(71241);const p=(0,u.A)(d,[["__scopeId","data-v-28c082cd"]]);var c=p,m=(a(18111),a(22489),a(90144)),g=a(45130),y=a(57477),f=a(37972),v=a(164),h=a(21929),w=a(21016),C=a(96329),b=a(70483),T=(0,r.pM)({__name:"OnlineCustomCellGroup",props:{widget:{},isEdit:{type:Boolean,default:!1},masterTableData:{}},emits:["widgetClick","update:widget"],setup(e,{emit:t}){const a=t,l=e,{childWidgetList:i,onWidgetClick:o}=(0,b.Q)(l,a);return(e,t)=>((0,r.uX)(),(0,r.Wv)((0,m.R1)(C.Qh),{inset:"",style:(0,s.Tr)({padding:(e.widget.props.padding?e.widget.props.padding:0)+"px"})},{default:(0,r.k6)(()=>[(0,r.bF)(pt,{value:(0,m.R1)(i),"onUpdate:value":t[0]||(t[0]=e=>(0,m.i9)(i)?i.value=e:null),isEdit:e.isEdit,onWidgetClick:(0,m.R1)(o)},null,8,["value","isEdit","onWidgetClick"])]),_:1},8,["style"]))}});const k=T;var E=k,R=a(84602),S=a(37856),D=a(85983),I=(a(32337),a(25136)),A=(a(69957),a(27007)),W=a(37157),L=a(54442);const x={class:"online-custom-list",style:{padding:"2px 4px"}};var _=(0,r.pM)({__name:"index",props:{dataList:{default:()=>[]},height:{default:"auto"},widget:{},isEdit:{type:Boolean,default:!1},masterTableData:{}},emits:["widgetClick","update:widget"],setup(e,{emit:t}){const a=(0,r.WQ)("form",()=>(console.error("OnlineCustomList: form not injected"),{isEdit:!1})),l=t,i=e;(0,r.Gt)("parentWidget",i.widget);const o=(0,r.EW)(()=>Array.isArray(i.widget.childWidgetList)&&i.widget.childWidgetList.length>0?i.widget.childWidgetList[0]:void 0),n=(0,r.EW)(()=>{switch(i.widget.props.card){case w.SysCustomWidgetType.ImageCard:return L.A;default:return""}}),s=e=>{l("widgetClick",e)},d=()=>{let e,t;switch(i.widget.props.card){case w.SysCustomWidgetType.ImageCard:e=W.A;break}return e&&(t=a().getWidgetObject(e),t.showName="listCard",t.variableName="listCard"+(new Date).getTime(),t.relation=void 0,t.datasource=void 0,t.column=void 0),t},u=e=>{let t=p(e);return t&&t.enabled},p=e=>(0,A.PH)(i.widget.operationList,e,"type"),c=e=>{let t=p(e);return!a().readOnly&&u(e)&&a().checkOperationVisible(t)};return(0,r.wB)(()=>i.widget.props?.card,()=>{let e=d(),t=i.widget;t.childWidgetList=[e]}),(0,r.wB)(()=>i.widget.bindData.tableId,()=>{let e=d(),t=i.widget;t.childWidgetList=[e]}),(0,r.sV)(()=>{if(!Array.isArray(i.widget.childWidgetList)||0===i.widget.childWidgetList.length){let e=d();if(e){let t=i.widget;t.childWidgetList=[e]}}}),(e,t)=>{const a=I.S2,l=D.x0;return(0,r.uX)(),(0,r.CE)("div",x,[c((0,m.R1)(w.SysCustomWidgetOperationType).ADD)?((0,r.uX)(),(0,r.Wv)(a,{key:0,class:"add-btn",size:"default",type:"success",plain:!0,icon:(0,m.R1)(y.Plus)},{default:(0,r.k6)(()=>t[0]||(t[0]=[(0,r.eW)("新增")])),_:1,__:[0]},8,["icon"])):(0,r.Q3)("",!0),e.isEdit?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,m.R1)(o)?((0,r.uX)(),(0,r.Wv)((0,r.$y)((0,m.R1)(n)),{key:0,class:"widget-item",style:{background:"#f6f7f9","border-radius":"8px"},isEdit:e.isEdit,widget:(0,m.R1)(o),supportEdit:c((0,m.R1)(w.SysCustomWidgetOperationType).EDIT)||c((0,m.R1)(w.SysCustomWidgetOperationType).DELETE),supportUpdate:c((0,m.R1)(w.SysCustomWidgetOperationType).EDIT),supportDelete:c((0,m.R1)(w.SysCustomWidgetOperationType).DELETE),onWidgetClick:s},null,40,["isEdit","widget","supportEdit","supportUpdate","supportDelete"])):((0,r.uX)(),(0,r.Wv)(l,{key:1,description:"请选择列表使用的卡片"}))],64)):(0,r.Q3)("",!0)])}}});const F=(0,u.A)(_,[["__scopeId","data-v-5ff89cfe"]]);var N=F,O=a(77195);a(38389),a(61688);const B={key:1,class:"info",style:{border:"1px solid #e8eaec"}},M={style:{width:"100px",height:"100px"}};var X=(0,r.pM)({__name:"OnlineCustomTabs",props:{widget:{},isEdit:{type:Boolean,default:!1},masterTableData:{}},emits:["widgetClick","update:widget"],setup(e,{emit:t}){const a=t,l=e,o=(0,m.KR)(),{childWidgetList:n,onWidgetClick:d}=(0,b.Q)(l,a);return(0,r.wB)(()=>l.widget.childWidgetList,()=>{Array.isArray(l.widget.childWidgetList)&&l.widget.childWidgetList.length>0&&(o.value=l.widget.childWidgetList[0].variableName)},{immediate:!0}),(e,t)=>{const a=O.v$,u=O.q,p=i.tk;return(0,r.uX)(),(0,r.CE)("div",{class:"table-draggable",style:(0,s.Tr)({"margin-bottom":(e.widget.props.paddingBottom||(e.widget.props.basicInfo||{}).paddingBottom||0)+"px"})},[(0,m.R1)(n).length>0?((0,r.uX)(),(0,r.Wv)(u,{key:0,modelValue:(0,m.R1)(o),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,m.i9)(o)?o.value=e:null),type:e.widget.props.type},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,m.R1)(n),t=>((0,r.uX)(),(0,r.Wv)(a,{key:t.variableName,label:t.showName,name:t.variableName,lazy:!0},{default:(0,r.k6)(()=>[(0,r.bF)(pt,{value:t.childWidgetList,"onUpdate:value":e=>t.childWidgetList=e,isEdit:e.isEdit,masterTableData:l.masterTableData,onWidgetClick:(0,m.R1)(d)},null,8,["value","onUpdate:value","isEdit","masterTableData","onWidgetClick"])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue","type"])):(0,r.Q3)("",!0),e.isEdit&&(e.widget.childWidgetList||[]).length<=0?((0,r.uX)(),(0,r.CE)("div",B,[(0,r.Lk)("div",M,[(0,r.bF)(p,null,{default:(0,r.k6)(()=>[(0,r.bF)((0,m.R1)(y.UploadFilled))]),_:1})]),t[1]||(t[1]=(0,r.Lk)("span",null,"请添加标签页",-1))])):(0,r.Q3)("",!0)],4)}}});const V=(0,u.A)(X,[["__scopeId","data-v-0431b887"]]);var P=V,U=(a(44114),a(20116),a(7588),a(61701),a(26695)),K=a(24687);const z=["table-key"],Q={class:"active-widget-drag"},G=["title","row","col","rowspan","colspan","align","valign","width","onClick"],Y={class:"widget-td-wrapper"};var j=(0,r.pM)({__name:"OnlineCustomTableContainer",props:{widget:{},isEdit:{type:Boolean,default:!1},masterTableData:{}},emits:["widgetClick","update:widget"],setup(e,{emit:t}){const a=t,l=e,o=(0,r.WQ)("form",()=>(console.error("OnlineCustomTableContainer: form not injected"),{isEdit:!1})),{propsWidget:n,childWidgetList:d,onWidgetClick:u}=(0,b.Q)(l,a),p=(0,m.KR)(),c=(0,m.KR)(),g=(0,m.KR)(),f=(0,m.KR)(n.value.props.table),v=(0,m.KR)([]),h=(0,m.Kh)({rowIndex:0,colIndex:0}),w=(0,m.Kh)({deleteRow:!0,deleteColumn:!0,mergeDownRow:!0,mergeRightColumn:!0,mergeCells:!0,splitCells:!0}),C=(0,m.Kh)({mouseDownHandler:null,isDrag:!1,startTd:null,endTd:null}),T=(0,m.KR)(!1),k=(0,m.KR)("table-container-"),E=e=>{if(e.preventDefault(),!l.isEdit)return;const t=g.value;t.style.left=e.clientX+"px",t.style.top=e.clientY+"px",t.classList.add("active"),window.document.body.clientHeight<t.clientHeight+e.clientY&&(t.style.top=window.document.body.clientHeight-t.clientHeight-10+"px")},R=e=>{console.log("tableContainer: drag add",e);let t=e.list[e.dragEvent.newDraggableIndex];t&&(t.props.span=24)},S=(e,t)=>v.value.length<=e||v.value[e].length<=t?null:v.value[e][t],D=(e,t)=>{const[a,l]=e,[i,o]=t;let n=[],r=[],s=S(a,l),d=S(i,o),u=Math.min(s.row,s.row+s.rowSpan-1,d.row,d.row+d.rowSpan-1),p=Math.max(s.row,s.row+s.rowSpan-1,d.row,d.row+d.rowSpan-1),c=Math.min(s.col,s.col+s.colSpan-1,d.col,d.col+d.colSpan-1),m=Math.max(s.col,s.col+s.colSpan-1,d.col,d.col+d.colSpan-1);for(let h=u;h<=p;h++)for(let e=c;e<=m;e++){let t,a,l=S(h,e);if(l){t=l.base?l.base.row:l.row,a=l.base?l.base.row+l.base.rowSpan:l.row+l.rowSpan;for(let e=Math.min(t,a);e<=Math.max(t,a);e++)n.push(e);t=l.base?l.base.col:l.col,a=l.base?l.base.col+l.base.colSpan:l.col+l.colSpan;for(let e=Math.min(t,a);e<=Math.max(t,a);e++)r.push(e)}}let g=Math.min(...n),y=Math.max(...n),f=Math.min(...r),v=Math.max(...r);return{rowMin:g,rowMax:y,colMin:f,colMax:v}},I=()=>{if(console.log("getSelectedRange mouse",C),!C.startTd||!C.endTd)return{rowMin:0,colMin:0,rowMax:0,colMax:0};let[e,t]=C.startTd,[a,l]=C.endTd;return D([e,t],[a,l])},A=()=>{w.deleteRow=v.value.length>1,w.deleteColumn=(()=>{let e=9999;return Object.values(f.value.render).forEach(t=>{e=Math.min(e,t.length)}),e>1})(),w.mergeDownRow=(()=>{let e=S(h.rowIndex,h.colIndex);return!!e&&e.row+e.rowSpan<v.value.length})(),w.mergeRightColumn=(()=>{let e=S(h.rowIndex,h.colIndex);return!!(v.value.length>0&&e)&&e.col+e.colSpan<v.value[0].length})(),w.splitCells=(()=>{let e=S(h.rowIndex,h.colIndex);return!!e&&(e.rowSpan>1||e.colSpan>1)})(),w.mergeCells=(()=>{const{rowMin:e,rowMax:t,colMin:a,colMax:l}=I();let i=S(e,a);return t-e-i.rowSpan>0||l-a-i.colSpan>0})()},W=()=>{g.value.classList.remove("active")},L=()=>{let e=[];for(let t=0;t<v.value.length;t++){e[t]=[];for(let a=0;a<v.value[t].length;a++)v.value[t][a].base?v.value[t][a].base.row===t&&v.value[t][a].base.col===a&&(e[t].push({rowIndex:t,colIndex:a,rowSpan:v.value[t][a].rowSpan,colSpan:v.value[t][a].colSpan,align:v.value[t][a].align,valign:v.value[t][a].valign,width:v.value[t][a].width,bgColor:v.value[t][a].bgColor}),a=a+v.value[t][a].colSpan-1):e[t].push({rowIndex:t,colIndex:a,rowSpan:1,colSpan:1,align:v.value[t][a].align,valign:v.value[t][a].valign,width:v.value[t][a].width,bgColor:v.value[t][a].bgColor})}f.value.render=e,A(),W()},x=(e,t=null)=>{let a=o().getWidgetObject(K.A);return a.showName=`cell_${e}${null!=t?"_"+t:""}`,a.variableName=`cell_${e}${null!=t?"_"+t:""}`,a["relation"]=void 0,a["datasource"]=void 0,a["column"]=void 0,a},_=(e,t)=>{const a=[];for(let l=0;l<t;l++)a.push(x(e,l)),a[l].childWidgetList=[];return a},F=(e,t)=>!!(n.value.childWidgetList&&n.value.childWidgetList[e]&&n.value.childWidgetList[e].childWidgetList[t]),N=e=>{if(!n.value.childWidgetList||0===n.value.childWidgetList.length){let t=[];for(let a=0;a<e.length;a++){const l=x(a);for(let t=0;t<e[a].length;t++)l.childWidgetList.push(x(a,t)),l.childWidgetList[t].childWidgetList=[];t.push(l)}d.value=t}},O=(e,t)=>{let a=[];for(let l=0;l<e;l++){let e=[],i=1,o=1;for(let a=0;a<t;a++)e.push({row:l,col:a,rowSpan:i,colSpan:o,width:null,align:"left",valign:"middle",bgColor:void 0});a.push(e)}a&&a.length>0&&N(a),v.value=a},B=e=>{e.rowIndex>=0&&(h.colIndex=e.colIndex,h.rowIndex=e.rowIndex)},M=(e,t)=>{null!=t&&(v.value=v.value.map(a=>{let l=a[e];return l&&(l.width=t.width,null!=t.align&&(l.align=t.align),null!=t.valign&&(l.valign=t.valign),l.bgColor=t.bgColor),a}),L())},X=e=>{if(!e)return{};for(var t,a=0,l={};t=e[a++];)l[t.toUpperCase()]=l[t]=1;return l},V=e=>e&&1===e.nodeType&&"body"===e.tagName.toLowerCase(),P=(e,t,a)=>{if(e&&!V(e)){e=a?e:e.parentNode;while(e){if(!t||t(e)||V(e))return t&&!t(e)&&V(e)?null:e;e=e.parentNode}}return null},j=(e,t,a,l=null)=>{const i=X(Array.isArray(t)?t:[t]);return P(e,function(e){return i[e.tagName]&&!(l&&l(e))},a)},H=e=>{if(!e)return;let t=j(e,"table",!0);if(!t)return void console.log("clearSelected,未找到table",e);let a=Array.from(t.getElementsByClassName("select-td-class"));a.forEach(e=>{e.classList.remove("select-td-class")})},J=e=>{for(let t=0;t<v.value.length;t++)for(let a=0;a<v.value[t].length;a++){let l=v.value[t][a];e(l)}},q=()=>{let e=[];J(t=>{e.push(t)});let t=e.filter(e=>!!e.base),a=[];t.forEach(e=>{let t=`${e.base.row}_${e.base.col}`;-1===a.indexOf(t)&&a.push(t)}),a.forEach(e=>{let[a,l]=e.split("_"),i=S(parseInt(a),parseInt(l)),o=t.filter(e=>e.base&&e.base.row===+a&&e.base.col===+l),n=0,r=9999,s=0,d=9999;o.forEach(e=>{n=e.col>n?e.col:n,r=e.col<r?e.col:r,s=e.row>s?e.row:s,d=e.row<d?e.row:d}),i.colSpan=n-r+1,i.rowSpan=s-d+1,1===o.length&&delete i.base})},$=e=>{let t=e||h.colIndex;if(v.value.length>0&&1===v.value[0].length)U.nk.warning("最后一列无法删除");else{if(v.value.length>0&&v.value[0].length>t)for(let e=0;e<v.value.length;e++){let a=S(e,t);if(Object.is(a,a.base)&&a.base.colSpan>1)for(let l=a.row;l<a.row+a.rowSpan;l++)for(let i=a.col+1;i<a.col+a.colSpan;i++){let a=S(l,i);a.base=v.value[e][t+1]}}for(let e=0;e<v.value.length;e++)v.value[e].splice(t,1),n.value.childWidgetList[e].childWidgetList.splice(t,1);for(let e=0;e<v.value.length;e++)for(let a=t;a<v.value[e].length;a++){let t=v.value[e][a];t.col--}C.startTd=null,C.endTd=null,q(),L()}},Z=()=>{let e=[];for(let a=0;a<v.value.length;a++)for(let t=0;t<v.value[a].length;t++){let l=v.value[a][t];e.push(l)}let t=e.filter(e=>e.colSpan>1||e.rowSpan>1);for(let a of t)a.range=[[a.row,a.col],[a.row+a.rowSpan-1,a.col+a.colSpan-1]];return t},ee=(e,t)=>{var a,l=!1,i=!1,o=!1,n=!1;return t.forEach(t=>{l||t.range[0][0]<=e.row&&e.row<=t.range[1][0]&&t.range[0][1]<=e.col&&e.col<=t.range[1][1]&&(l=!0,e.col===t.range[1][1]&&(i=!0),e.row===t.range[1][0]&&(o=!0),e.row===t.row&&(n=!0),a=t)}),{isInArea:l,isColBorder:i,isRowBorder:o,isMergeAreaFirstRow:n,mergeCell:a}},te=e=>{for(let t=0;t<v.value.length;t++){let a=v.value[t];for(let t=e;t<a.length;t++){let e=a[t];e.col++}}},ae=e=>{for(let t=e;t<v.value.length;t++){let e=v.value[t];for(let t=0;t<e.length;t++){let a=e[t];a.row++}}},le=()=>{let e=h.colIndex,t=Z();const a=S(h.rowIndex,h.colIndex),l=ee(a,t);l.isInArea&&(e=a.col+a.colSpan-1),t=Z();for(let i=0;i<v.value.length;i++){let a=v.value[i],l=a[e],o={row:l.row,col:l.col,rowSpan:l.rowSpan,colSpan:l.colSpan,base:l.base,valign:"middle",bgColor:void 0,width:null};const r=ee(o,t);r.isInArea&&r.isColBorder&&delete o.base,o.col++,o.colSpan=1,o.rowSpan=1;let s=x(i,o.col);s.childWidgetList=[],n.value.childWidgetList[i].childWidgetList.splice(e+1,0,s),a.splice(e+1,0,o)}te(e+2),q(),L()},ie=()=>{let e=h.rowIndex;if(1!==v.value.length){if(v.value.length>e)for(let t=0;t<v.value[e].length;t++){let a=S(e,t);if(Object.is(a,a.base)&&a.base.rowSpan>1)for(let l=a.row+1;l<a.row+a.rowSpan;l++)for(let i=a.col;i<a.col+a.colSpan;i++){let a=S(l,i);a.base=v.value[e+1][t]}}v.value.splice(e,1),n.value.childWidgetList.splice(e,1);for(let t=e;t<v.value.length;t++){let e=v.value[t];for(let t=0;t<e.length;t++){let a=e[t];a.row--}}C.startTd=null,C.endTd=null,q(),L()}else U.nk.warning("最后一行无法删除")},oe=()=>{let e=h.rowIndex,t=Z();const a=S(h.rowIndex,h.colIndex),l=ee(a,t);l.isInArea&&(e=a.row+a.rowSpan-1);let i=[];for(let n=0;n<v.value[e].length;n++){let t=v.value[e][n];i.push({row:t.row,col:t.col,rowSpan:t.rowSpan,colSpan:t.colSpan,base:t.base})}let o=x(e+1);o.childWidgetList=_(e+1,v.value[e].length),n.value.childWidgetList.splice(e+1,0,o),v.value.splice(e+1,0,i);for(let n=0;n<i.length;n++){const e=ee(i[n],t);e.isInArea&&e.isRowBorder&&delete i[n].base,i[n].row++,i[n].colSpan=1,i[n].rowSpan=1}ae(e+2),q(),L()},ne=()=>{let e=S(h.rowIndex,h.colIndex),t=S(e.row,e.col+e.colSpan);if(!t)return;let a=!0;if((t.base&&!e.base&&t.base.rowSpan>1||!t.base&&e.base&&e.base.rowSpan>1||t.base&&e.base&&e.base.row+e.base.rowSpan!==t.base.row+t.base.rowSpan)&&(a=!1),!a)return void U.nk.warning("目标单元格数量不同，无法合并");e.base=e;let l=[];const i=e=>{if(t.colSpan>1){let a=t.colSpan;for(let i=t.col;i<t.col+a;i++){let a=S(t.row,i);a.base=e,a.colSpan=1,l.push(...n.value.childWidgetList[a.row].childWidgetList[i].childWidgetList.splice(0))}}else t.base=e,l.push(...n.value.childWidgetList[t.row].childWidgetList[t.col].childWidgetList.splice(0));n.value.childWidgetList[e.row].childWidgetList[e.col].childWidgetList.push(...l)};i(e),q(),L()},re=()=>{let e=S(h.rowIndex,h.colIndex),t=S(e.row+e.rowSpan,e.col);if(!t)return;let a=!0;if((t.base&&!e.base&&t.base.colSpan>1||!t.base&&e.base&&e.base.colSpan>1||t.base&&e.base&&e.base.col+e.base.colSpan!==t.base.col+t.base.colSpan)&&(a=!1),!a)return void U.nk.warning("目标单元格数量不同，无法合并");e.base=e;let l=[];const i=e=>{if(t.rowSpan>1||t.colSpan>1){let a=t.rowSpan,i=t.colSpan;for(let o=t.row;o<t.row+a;o++)for(let a=t.col;a<t.col+i;a++){let t=S(o,a);t.base=e,t.rowSpan=1,t.colSpan=1,l.push(...n.value.childWidgetList[o].childWidgetList[a].childWidgetList.splice(0))}}else t.base=e,l.push(...n.value.childWidgetList[t.row].childWidgetList[t.col].childWidgetList.splice(0));n.value.childWidgetList[e.row].childWidgetList[e.col].childWidgetList.push(...l)};i(e),q(),L()},se=()=>{let e=S(h.rowIndex,h.colIndex);if(!e.base)return;let t=e.base.row,a=e.base.row+e.base.rowSpan,l=e.base.col,i=e.base.col+e.base.colSpan;for(let o=t;o<a;o++)for(let e=l;e<i;e++){let t=S(o,e);t.rowSpan=1,t.colSpan=1,delete t.base,delete t.color}e.rowSpan=1,e.colSpan=1,q(),L()},de=e=>{if(!e.target)return void console.error("mergeCells: target is null",e);const{rowMin:t,rowMax:a,colMin:l,colMax:i}=I();let o=[];for(let n=t;n<a;n++)for(let e=l;e<i;e++){let t=S(n,e);t.base&&delete t.base}const r=S(t,l);for(let s=t;s<a;s++)for(let e=l;e<i;e++){let t=S(s,e);t.base=r,o.push(...n.value.childWidgetList[s].childWidgetList[e].childWidgetList.splice(0))}n.value.childWidgetList[r.row].childWidgetList[r.col].childWidgetList.push(...o),H(e.target.parentNode.previousElementSibling.firstElementChild),C.startTd=[t,l],C.endTd=C.startTd,ge(e.target.parentNode.previousElementSibling.firstElementChild),q(),L()},ue=()=>{n.value.props.actions={},n.value.props.actions.indexData=v.value,n.value.props.actions.setSource=B,n.value.props.actions.setColumn=M,n.value.props.actions.deleteColumns=$,n.value.props.actions.insertColumns=le,n.value.props.actions.deleteRows=ie,n.value.props.actions.insertRows=oe,n.value.props.actions.mergeRightColumn=ne,n.value.props.actions.mergeDownRow=re,n.value.props.actions.splitCells=se,n.value.props.actions.current=()=>h},pe=()=>{const e=()=>{let e=0;return Object.values(f.value.render).forEach(t=>{if(t.length>0){const a=t[t.length-1],l=a.colIndex+a.colSpan;e=Math.max(e,l)}}),e},t=()=>{let e=0;return Object.keys(f.value.render).forEach(t=>{let a=f.value.render[t];for(let l=0;l<a.length;l++){let i=+t+a[l].rowSpan;e=Math.max(e,i)}}),e},a=(e,{rowMin:t,rowMax:a,colMin:l,colMax:i})=>{for(let o=t;o<a;o++)for(let t=l;t<i;t++){let a=S(o,t);a.base=e}};O(t(),e()),Object.keys(f.value.render).forEach(e=>{let t=f.value.render[e];t.forEach(e=>{let t=v.value[e.rowIndex][e.colIndex];if(t.width=e.width,t.align=e.align,t.valign=e.valign,t.bgColor=e.bgColor,e.colSpan>1||e.rowSpan>1){let t=S(e.rowIndex,e.colIndex);t.colSpan=e.colSpan,t.rowSpan=e.rowSpan}})});for(let l=0;l<v.value.length;l++)for(let e=0;e<v.value[l].length;e++){let t=S(l,e);if(t.colSpan>1||t.rowSpan>1){let e=D([t.row,t.col],[t.row+t.rowSpan-1,t.col+t.colSpan-1]);a(t,e)}}},ce=(e,t)=>{if(null!=C.startTd&&null!=C.endTd){let a=Math.min(C.startTd[0],C.endTd[0]),l=Math.max(C.startTd[0],C.endTd[0]),i=Math.min(C.startTd[1],C.endTd[1]),o=Math.max(C.startTd[1],C.endTd[1]);return e>=a&&e<=l&&t>=i&&t<=o}return!1},me=e=>{if(console.log("mouseClickOnWidget",e),!e.target)return void console.warn("mouseClickOnWidget target is null");let t=e.target,a=Array.from(t.classList);if(-1!==a.indexOf("table-container-cell"))return!1;if(-1!==a.indexOf("custom-block-draggable")){for(let t=0;t<(e.path||[]).length;t++){let t=e.path[0],a=Array.from(t.classList);if(-1!==a.indexOf("online-custom-block"))return-1===a.indexOf("cell-custom-block")}return!1}return!0},ge=e=>{const{rowMin:t,rowMax:a,colMin:l,colMax:i}=I();let o=j(e,"table",!0);if(!o)return void console.log("not found table",e);let n=Array.from(o.getElementsByTagName("td"));for(let r=t;r<a;r++)for(let e=l;e<i;e++){let t=n.find(t=>t.getAttribute("row")===r.toString()&&t.getAttribute("col")===e.toString());t&&t.classList.add("select-td-class")}},ye=e=>{if(e.target){if(T.value){const t=j(e.target,"td",!0);if(!t)return void console.warn("not found table",e.target);let a=parseInt(t.getAttribute("row")),l=parseInt(t.getAttribute("col"));H(e.target),C.endTd=[a,l],ge(e.target)}}else console.error("target is null",e)},fe=e=>{if(console.log("mouseDown",e.target),!l.isEdit||!e.target)return;let t=j(e.target,"td",!0);if(!t)return void console.error("not found td",e.target);let a=parseInt(t.getAttribute("row")),i=parseInt(t.getAttribute("col")),o=0===e.button||2===e.button&&!ce(a,i);if(o)e.target&&H(e.target),h.rowIndex=a,h.colIndex=i,C.startTd=null,C.endTd=null,W(),A();else if(2===e.button){let a=j(e.target,"table",!0);if(!a)return void console.error("not found table",e.target);let l=Array.from(a.getElementsByTagName("td"));if(l){let a=l.find(e=>e.classList&&Array.from(e.classList||[]).indexOf("select-td-class")>-1);a||(H(e.target),t.classList.add("select-td-class"))}}me(e)||(e.preventDefault(),T.value=!1,0===e.button&&(H(e.target),t.classList.add("select-td-class"),C.startTd=[a,i],C.endTd=[a,i],ge(e.target),C.mouseDownHandler&&(clearTimeout(C.mouseDownHandler),C.mouseDownHandler=null),C.mouseDownHandler=setTimeout(()=>{T.value=!0,c.value.addEventListener("mouseover",ye)},50)))},ve=e=>{l.isEdit&&0===e.button&&(C.isDrag=!1,A(),C.mouseDownHandler&&clearTimeout(C.mouseDownHandler),c.value.removeEventListener("mouseover",ye))};return(0,r.KC)(()=>{ue()}),(0,r.sV)(()=>{k.value=k.value+(new Date).getTime(),Object.values(f.value.render).length>0?pe():0===v.value.length&&(O(2,3),L()),(0,r.dY)(()=>{c.value.addEventListener("mousedown",fe),c.value.addEventListener("mouseup",ve)})}),(0,r.wB)(v,()=>{if(n.value.props.actions){const e={...n.value};e.props.actions.indexData=v.value,n.value=e}},{deep:!0,immediate:!0}),(0,r.wB)(()=>l.widget.props.actions,e=>{0===Object.keys(e).length&&ue()},{deep:!0,immediate:!0}),(e,t)=>{const a=i.tk;return(0,r.uX)(),(0,r.CE)("div",{class:"table-container-wrapper","table-key":(0,m.R1)(k)},[(0,r.Lk)("div",Q,[(0,r.bF)(a,null,{default:(0,r.k6)(()=>[(0,r.bF)((0,m.R1)(y.Rank))]),_:1})]),(0,r.Lk)("div",{ref_key:"myTableWrapper",ref:p,class:"widget-table-wrapper",onContextmenu:E,style:(0,s.Tr)({background:e.widget.props.backgroundColor})},[(0,m.R1)(v).length>0?((0,r.uX)(),(0,r.CE)("table",{key:0,ref_key:"myTable",ref:c,class:"widget-table",cellspacing:"0",cellpadding:"0",border:"0"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,m.R1)(f).render,(t,a)=>((0,r.uX)(),(0,r.CE)("tr",{key:a},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t,(t,a)=>((0,r.uX)(),(0,r.CE)("td",{key:a,class:(0,s.C4)(["table-container-cell",{"select-td-class":t.rowIndex===(0,m.R1)(h).rowIndex&&t.colIndex===(0,m.R1)(h).colIndex&&e.isEdit}]),style:(0,s.Tr)({border:"1px solid "+e.widget.props.borderColor,backgroundColor:t.bgColor}),title:t.index,row:t.rowIndex,col:t.colIndex,rowspan:t.rowSpan,colspan:t.colSpan,align:t.align,valign:t.valign,width:t.width,onClick:e=>B(t)},[(0,r.Lk)("div",Y,[F(t.rowIndex,t.colIndex)?((0,r.uX)(),(0,r.Wv)(pt,{key:0,class:"cell-custom-block",isEdit:e.isEdit,onDragAdd:R,value:e.widget.childWidgetList[t.rowIndex].childWidgetList[t.colIndex].childWidgetList,"onUpdate:value":a=>e.widget.childWidgetList[t.rowIndex].childWidgetList[t.colIndex].childWidgetList=a,onWidgetClick:(0,m.R1)(u)},null,8,["isEdit","value","onUpdate:value","onWidgetClick"])):(0,r.Q3)("",!0)])],14,G))),128))]))),128))],512)):(0,r.Q3)("",!0)],36),(0,r.Lk)("div",{ref_key:"tableMenu",ref:g,class:"menu",onClick:W},[(0,r.Lk)("div",{style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:oe}," 向下插入行 ",32),(0,r.Lk)("div",{style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:le}," 向右插入列 ",32),(0,m.R1)(w).deleteRow?((0,r.uX)(),(0,r.CE)("div",{key:0,style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:ie}," 删除行 ",32)):(0,r.Q3)("",!0),(0,m.R1)(w).deleteColumn?((0,r.uX)(),(0,r.CE)("div",{key:1,style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:t[0]||(t[0]=()=>$())}," 删除列 ",32)):(0,r.Q3)("",!0),(0,m.R1)(w).mergeRightColumn?((0,r.uX)(),(0,r.CE)("div",{key:2,style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:ne}," 向右合并 ",32)):(0,r.Q3)("",!0),(0,m.R1)(w).mergeDownRow?((0,r.uX)(),(0,r.CE)("div",{key:3,style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:re}," 向下合并 ",32)):(0,r.Q3)("",!0),(0,m.R1)(w).splitCells?((0,r.uX)(),(0,r.CE)("div",{key:4,style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:se}," 拆分单元格 ",32)):(0,r.Q3)("",!0),(0,m.R1)(w).mergeCells?((0,r.uX)(),(0,r.CE)("div",{key:5,style:{"line-height":"30px",cursor:"pointer"},class:"menu__item",onMousedown:de}," 合并单元格 ",32)):(0,r.Q3)("",!0)],512)],8,z)}}});const H=(0,u.A)(j,[["__scopeId","data-v-00b50de8"]]);var J=H,q=a(38840),$=(a(95304),a(32465),a(60265)),Z=a(51351),ee=(0,r.pM)({__name:"OnlineCardTable",props:{value:{default:()=>[]},widget:{default:void 0}},emits:["input"],setup(e,{emit:t}){const a=t,i=e,n=(0,r.WQ)("form",()=>(console.error("OnlineCardTable: form not injected"),{isEdit:!1})),d=(0,m.KR)([]),u=(0,m.KR)(!1),p=()=>Promise.resolve({dataList:i.value,totalCount:i.value.length}),c=()=>!0,g={loadTableData:p,verifyTableParameter:c},y=(0,m.Kh)((0,$.K)(g)),f=()=>{y.refreshTable(!0,1)},h=(e,t,a)=>{let{rowData:l,nextRow:o,isNew:n,isDirty:r}=a;if(null==l.__cascade_add_id__){let t=(new Date).getTime();e.__cascade_add_id__=t,l.__cascade_add_id__=t}D(y.dataList.map(e=>null!=l.__cascade_add_id__?l.__cascade_add_id__===e.__cascade_add_id__?l:e:l[i.widget.primaryColumnName]===e[i.widget.primaryColumnName]?l:e))};(0,r.wB)(()=>i.value,()=>{f()},{deep:!0,immediate:!0});const C=e=>{null!=e&&("object"===typeof e&&D([...y.dataList,{...e,__cascade_add_id__:(new Date).getTime()}]),Array.isArray(e)&&D([...y.dataList,...e.map((e,t)=>({...e,__cascade_add_id__:(new Date).getTime()+t}))]))},b=()=>{D([])},T=(e,t)=>{null!=i.widget.relation&&(null==e?(console.log("新增记录",t,i,y),e=t[i.widget.relation.variableName],D([...y.dataList,{...e,__cascade_add_id__:(new Date).getTime()}])):(console.log("更新记录",t,i,y),e=t[i.widget.relation.variableName],D(y.dataList.map(t=>null!=e&&null!=e.__cascade_add_id__?e.__cascade_add_id__===t.__cascade_add_id__?e:t:null!=e&&e[i.widget.primaryColumnName]===t[i.widget.primaryColumnName]?e:t))))},k=e=>{d.value=e},E=(e,t)=>{if(e.type===w.SysCustomWidgetOperationType.BATCH_DELETE)R(e);else if(e.type===w.SysCustomWidgetOperationType.DELETE&&null!=t)S(t);else if(e.type===w.SysCustomWidgetOperationType.SCRIPT)n().handlerScriptOperation(e,t).then(()=>{f(!0)}).catch(e=>{console.warn(e)});else if(e.type===w.SysCustomWidgetOperationType.SELECT_DIALOG){if(n().showSelectDialog){const a=n().isEdit?void 0:n().getMasterTableData?n().getMasterTableData():void 0,l=e.eventInfo;n().showSelectDialog(e.selectFormId,{rowData:t,masterTableData:a,formData:n().formData},{multiSelect:e.multiSelect,dialogWidth:e.dialogWidth,dialogHeight:e.dialogHeight},n().isEdit?void 0:l[w.OnlineFormEventType.DIALOG_OPEN],n().isEdit?void 0:l[w.OnlineFormEventType.DIALOG_SUBMIT])}}else n().handlerOperation(e,{isEdit:n().isEdit,saveData:!1,widget:i.widget,rowData:t,masterTableData:n().getMasterTableData?n().getMasterTableData():void 0,callback:e=>{T(t,e)}})},R=e=>{console.log("onBatchDelete operation",e),d.value.length<=0?U.nk.error("请选择要批量删除的数据！"):v.s.confirm("是否删除选中数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(y.dataList.filter(e=>{let t=(0,A.PH)(d.value,e[i.widget.primaryColumnName],i.widget.primaryColumnName);return null==t&&null!=e.__cascade_add_id__&&(t=(0,A.PH)(d.value,e.__cascade_add_id__,"__cascade_add_id__")),null==t}))})},S=e=>{v.s.confirm("是否删除当前数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(y.dataList.filter(t=>null!=e.__cascade_add_id__?e.__cascade_add_id__!==t.__cascade_add_id__:e[i.widget.primaryColumnName]!==t[i.widget.primaryColumnName]))}).catch(e=>{console.warn(e)})},D=e=>{n().isEdit||"function"!==typeof i.widget.eventInfo[w.OnlineFormEventType.AFTER_LOAD_TABLE_DATA]||(console.log("afterLoadTableData",e,n().formData),e=i.widget.eventInfo[w.OnlineFormEventType.AFTER_LOAD_TABLE_DATA](e,n().instanceData())),a("input",e)};return(0,r.sV)(()=>{n().tableInstance&&(n().tableInstance[i?.widget?.variableName]={handlerEditOperate:T,addTableData:C,clearTableData:b})}),(e,t)=>{const a=o.uD,i=l.S2,n=q.Ik;return(0,r.uX)(),(0,r.Wv)(n,{class:"online-card-table base-card",shadow:"never","body-style":{padding:"0px"}},{default:(0,r.k6)(()=>[(0,r.bF)(i,null,{default:(0,r.k6)(()=>[(0,r.bF)(a,{span:24,style:(0,s.Tr)({height:null!=e.widget.props.height?e.widget.props.height-53+"px":void 0})},{default:(0,r.k6)(()=>[(0,r.bF)(Z.A,{dataList:(0,m.R1)(y).dataList,widget:e.widget,height:e.widget.props.height?e.widget.props.height-53:200,border:"default",multiSelect:(0,m.R1)(u),operationList:e.widget.operationList,getTableIndex:(0,m.R1)(y).getTableIndex,sortChange:(0,m.R1)(y).onSortChange,saveRow:h,supportCustomQuery:!1,rowKey:"__cascade_add_id__",onSelectChange:k,onOperationClick:E},null,8,["dataList","widget","height","multiSelect","operationList","getTableIndex","sortChange"])]),_:1},8,["style"])]),_:1})]),_:1})}}});const te=(0,u.A)(ee,[["__scopeId","data-v-4c213623"]]);var ae=te,le=a(4311),ie=(a(25393),a(82572)),oe=a(81387),ne=a(61617);const re=["onClick"],se={class:"flow-count-card-item-content"},de={class:"count"},ue={class:"title"};var pe=(0,r.pM)({__name:"index",props:{disabled:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:t}){const i=(0,ie.l5)(),o=(0,oe.rd)(),n=e,{getMenuList:d,setCurrentMenuId:u,setCurrentMenu:p}=i,c=(0,m.KR)([{icon:a(95829),count:0,title:"待办任务",router:"formMyTask"},{icon:a(52912),count:0,title:"已办任务",router:"formMyApprovedTask"},{icon:a(68308),count:0,title:"我发起的",router:"flowMyStartedTask"},{icon:a(13538),count:0,title:"我的抄送",router:"formFlowMessage",query:{type:"copyMessage"}},{icon:a(73974),count:0,title:"我的催办",router:"formFlowMessage",query:{type:"remindingMessage"}}]),g=e=>{if(n.disabled)return;let t=(0,A.Ee)(d,e.router,"formRouterName");t&&p(t),o.push({name:e.router,query:e.query})},y=()=>{ne.wI.getFlowCountStats({}).then(e=>{e&&e.data&&(c.value[0].count=e.data.runtimeTaskCount||0,c.value[1].count=e.data.historicTaskCount||0,c.value[2].count=e.data.allMyWorkOrderCount||0,c.value[3].count=e.data.copyMessageCount||0,c.value[4].count=e.data.remindingMessageCount||0)}).catch(e=>{console.error("Error fetching status counts:",e)})};return(0,r.sV)(()=>{y()}),(e,t)=>{const a=le.Zq,i=l.S2,o=q.Ik;return(0,r.uX)(),(0,r.Wv)(o,{class:"flow-count-status-card"},{header:(0,r.k6)(()=>t[0]||(t[0]=[(0,r.Lk)("div",{class:"header"},[(0,r.Lk)("i",{class:"online-icon icon-flow-count-card"}),(0,r.Lk)("span",{style:{"margin-left":"8px"}},"我的审批")],-1)])),default:(0,r.k6)(()=>[(0,r.bF)(i,{type:"flex",justify:"space-between",align:"middle"},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,m.R1)(c),(e,t)=>((0,r.uX)(),(0,r.CE)("div",{class:"flow-count-card-item",key:t,onClick:t=>g(e)},[(0,r.bF)(a,{class:"flow-count-card-item-icon",src:e.icon,fit:"contain",style:{width:"64px",height:"64px"}},null,8,["src"]),(0,r.Lk)("div",se,[(0,r.Lk)("div",de,(0,s.v_)(e.count),1),(0,r.Lk)("div",ue,(0,s.v_)(e.title),1)])],8,re))),128))]),_:1})]),_:1})}}});const ce=(0,u.A)(pe,[["__scopeId","data-v-7cfb0498"]]);var me=ce;const ge={class:"base-card-header table-draggable"},ye=["onClick"],fe=["onClick"],ve=["onClick"],he=["onClick"],we=["onClick"],Ce=["onClick"],be=["onClick"],Te={key:1,class:"info"},ke={style:{width:"100px",height:"100px"}},Ee={name:"OnlineBaseCard"};var Re=(0,r.pM)({...Ee,props:{showBorder:{type:Boolean,default:!0},height:{},masterTableData:{},widget:{},isEdit:{type:Boolean,default:!1}},emits:["widgetClick","update:widget"],setup(e,{emit:t}){const a=t,d=e,u=(0,r.WQ)("form",()=>(console.error("OnlineCustomBaseCard: form not injected"),{isEdit:!1})),p=(0,r.WQ)("isTableChild",!1),{childWidgetList:v,onWidgetClick:C,onDeleteWidget:T,onCopyWidget:k}=(0,b.Q)(d,a),E=(0,r.EW)(()=>{let e=d.height;return null!=d.height&&""!==d.height||(e=d.isEdit&&d.widget.childWidgetList.length<=0?"150px":"0px"),{"min-height":e}}),D=e=>{let t=d.value[e.newIndex];e.newIndex===(d.value||[]).length&&(t=d.value[e.newIndex-1]),t&&(t.isTableExpand=p),a("update:value",v.value)},I=e=>{if(e.widgetType===w.SysCustomWidgetType.Table)return{}},A=e=>({"margin-bottom":(e.props.paddingBottom||0)+"px",padding:d.isEdit?"5px":void 0,border:d.isEdit?"1px solid #e8eaec":void 0}),W=e=>u().getWidgetValue(e),L=e=>{let t=e.relatedContext.element?e.relatedContext.element.widgetType:void 0;return t!==w.SysCustomWidgetType.Block&&t!==w.SysCustomWidgetType.Card},x=(e,t)=>u().onValueChange(e,t),_=(e,t,a)=>u().onWidgetValueChange(e,t,a);return(e,t)=>{const a=(0,r.g2)("OnlineExpandTable"),b=(0,r.g2)("OnlineBaseCard",!0),F=c,N=n.fR,O=h.xE,B=o.uD,M=i.tk,X=l.S2,V=q.Ik;return(0,r.uX)(),(0,r.Wv)(V,{class:"online-base-card form-card base-card",shadow:e.widget.props.shadow,"body-style":{padding:(null==e.widget.props.padding?15:e.widget.props.padding)+"px"},style:(0,s.Tr)({"margin-bottom":(e.widget.props.paddingBottom||(e.widget.props.basicInfo||{}).paddingBottom||0)+"px"})},{header:(0,r.k6)(()=>[(0,r.Lk)("div",ge,[(0,r.Lk)("span",null,(0,s.v_)(e.widget.showName),1),t[1]||(t[1]=(0,r.Lk)("div",{class:"base-card-operation"},null,-1))])]),default:(0,r.k6)(()=>[(0,r.bF)(X,null,{default:(0,r.k6)(()=>[(0,r.bF)(B,{span:24},{default:(0,r.k6)(()=>[(0,r.bF)(X,{gutter:(0,m.R1)(u)().gutter},{default:(0,r.k6)(()=>[((0,r.uX)(),(0,r.Wv)((0,r.$y)(e.isEdit?(0,m.R1)(f.MA):"el-row"),{class:(0,s.C4)("pc"===(0,m.R1)(u)().mode||e.isEdit?"el-row":""),gutter:(0,m.R1)(u)().gutter,draggable:".custom-widget-item",modelValue:(0,m.R1)(v),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,m.i9)(v)?v.value=e:null),group:"componentsGroup",style:(0,s.Tr)([(0,m.R1)(E),{position:"relative",overflow:"hidden",width:"100%"}]),disabled:!e.isEdit,move:L,onAdd:D},{default:(0,r.k6)(()=>[(0,m.R1)(v).length>0?((0,r.uX)(!0),(0,r.CE)(r.FK,{key:0},(0,r.pI)((0,m.R1)(v),t=>((0,r.uX)(),(0,r.Wv)(B,{class:(0,s.C4)(["custom-widget-item",{active:e.isEdit&&(0,m.R1)(u)().isActive(t)}]),key:t.variableName,span:t.props.span,style:(0,s.Tr)({display:e.isEdit||(0,m.R1)(u)().getWidgetVisible(t)?void 0:"none"})},{default:(0,r.k6)(()=>[(0,r.Lk)("div",{class:(0,s.C4)(["widget-item",{active:e.isEdit&&(0,m.R1)(u)().isActive(t)}])},[t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Table?((0,r.uX)(),(0,r.CE)("div",{key:0,style:(0,s.Tr)([I(t),{"margin-bottom":"18px"}])},[null!=(0,m.R1)(p)&&(0,m.R1)(p)?((0,r.uX)(),(0,r.Wv)(a,{key:1,ref_for:!0,ref:t.variableName,isEdit:e.isEdit,widget:t,masterTableData:d.masterTableData,onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},null,8,["isEdit","widget","masterTableData","onClick"])):((0,r.uX)(),(0,r.Wv)(ae,{key:0,widget:t,value:(0,m.R1)(u)().getTableData(t),onInput:e=>(0,m.R1)(u)().setTableData(t,e),onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},null,8,["widget","value","onInput","onClick"]))],4)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Block?((0,r.uX)(),(0,r.CE)("div",{key:1,style:(0,s.Tr)(A(t)),onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},[(0,r.bF)(pt,{value:t.childWidgetList,"onUpdate:value":e=>t.childWidgetList=e,isEdit:e.isEdit,masterTableData:d.masterTableData,onWidgetClick:(0,m.R1)(C)},null,8,["value","onUpdate:value","isEdit","masterTableData","onWidgetClick"])],12,ye)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Card?((0,r.uX)(),(0,r.CE)("div",{key:2,onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},[(0,r.bF)(b,{widget:t,isEdit:e.isEdit,masterTableData:d.masterTableData,onWidgetClick:(0,m.R1)(C)},null,8,["widget","isEdit","masterTableData","onWidgetClick"])],8,fe)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Tabs?((0,r.uX)(),(0,r.CE)("div",{key:3,onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},[(0,r.bF)(P,{widget:t,isEdit:e.isEdit,masterTableData:d.masterTableData,onWidgetClick:(0,m.R1)(C)},null,8,["widget","isEdit","masterTableData","onWidgetClick"])],8,ve)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Text?((0,r.uX)(),(0,r.CE)("div",{key:4,onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:W(t)||t.props.text,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),onWidgetClick:(0,m.R1)(C)},null,8,["widget","isEdit","value","style","onWidgetClick"])],8,he)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Image?((0,r.uX)(),(0,r.CE)("div",{key:5,onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:W(t),src:t.props.src,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),onWidgetClick:(0,m.R1)(C)},null,8,["widget","isEdit","value","src","style","onWidgetClick"])],8,we)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Title?((0,r.uX)(),(0,r.CE)("div",{key:6,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},[(0,r.bF)(F,{showLine:t.props.showLine,showBorderLine:t.props.showBorderLine,backgroundColor:t.props.backgroundColor,lineColor:t.props.lineColor,lineWidth:t.props.lineWidth,fontColor:t.props.fontColor,fontSize:t.props.fontSize,titleAlign:t.props.titleAlign,lineRadius:t.props.lineRadius,fontWeight:t.props.fontWeight,paddingTop:t.props.paddingTop},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)(t.showName),1)]),_:2},1032,["showLine","showBorderLine","backgroundColor","lineColor","lineWidth","fontColor","fontSize","titleAlign","lineRadius","fontWeight","paddingTop"])],12,Ce)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Divider?((0,r.uX)(),(0,r.CE)("div",{key:7,onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},[(0,r.bF)(N,{"content-position":t.props.contentPosition},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)(t.showName),1)]),_:2},1032,["content-position"])],8,be)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).FlowCountStatusCard?((0,r.uX)(),(0,r.Wv)(me,{key:8,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),disabled:e.isEdit,onWidgetClick:(0,m.R1)(C)},null,8,["style","disabled","onWidgetClick"])):((0,r.uX)(),(0,r.Wv)(O,{key:9,label:t.showName,prop:(0,m.R1)(u)().getWidgetVisible(t)?t.propString:void 0,onClick:(0,g.D$)(e=>(0,m.R1)(C)(t),["stop"])},{default:(0,r.k6)(()=>[(0,r.bF)(S.A,{widget:t,value:W(t),onInput:e=>x(t,e),onChange:(e,a)=>_(t,e,a)},null,8,["widget","value","onInput","onChange"])]),_:2},1032,["label","prop","onClick"])),e.isEdit&&(0,m.R1)(u)().isActive(t)?((0,r.uX)(),(0,r.Wv)(R.A,{key:10,widget:t,clone:(0,m.R1)(u)().cloneWidget,onCopy:(0,m.R1)(k),onDelete:e=>(0,m.R1)(T)(t)},null,8,["widget","clone","onCopy","onDelete"])):(0,r.Q3)("",!0)],2)]),_:2},1032,["class","span","style"]))),128)):e.isEdit?((0,r.uX)(),(0,r.CE)("div",Te,[(0,r.Lk)("div",ke,[(0,r.bF)(M,null,{default:(0,r.k6)(()=>[(0,r.bF)((0,m.R1)(y.UploadFilled))]),_:1})]),t[2]||(t[2]=(0,r.Lk)("span",null,"请拖入组件进行编辑",-1))])):(0,r.Q3)("",!0)]),_:1},40,["class","gutter","modelValue","style","disabled"]))]),_:1},8,["gutter"])]),_:1})]),_:1})]),_:1},8,["shadow","body-style","style"])}}});const Se=(0,u.A)(Re,[["__scopeId","data-v-bc951606"]]);var De=Se,Ie=a(69080),Ae=(a(25374),a(18237),a(53155)),We=a(18384),Le=a(31932),xe=a(36525),_e=(0,r.pM)({__name:"OnlineExpandTable",props:{widget:{},masterTableData:{}},setup(e){const{fetchUpload:t}=(0,Le.v)(),a=((0,oe.rd)(),e),i=(0,r.WQ)("form",()=>({isEdit:!1})),o=(0,m.KR)([]),n=(0,m.KR)([]),s=(0,r.EW)(()=>{let e=i().tableMap.get(a.widget.bindData.tableId);if(e&&Array.isArray(e.columnList))for(let t=0;t<e.columnList.length;t++){let a=e.columnList[t];if(a.primaryKey)return a.columnName}return null}),d=(0,r.EW)(()=>a.widget&&a.widget.props.treeFlag&&a.widget.props.parentIdColumn?{rowField:s.value,parentField:a.widget.props.parentIdColumn}:null),u=(e=!1,t=void 0)=>{n.value=t,i().isEdit||(e?D.refreshTable(!0,1):D.refreshTable())},p=(0,m.KR)(),c=()=>{if(p.value){let e=p.value;if(Array.isArray(p.value)&&(e=p.value[0].value),e)return e.getSearchString()}return null},g=async e=>{if(i().isEdit)return{dataList:[],totalCount:0};try{let t=i().tableMap.get(a.widget.bindData.tableId);if(!t)throw console.warn("table is undefined tableId=",a.widget.bindData.tableId),new Error;e.datasourceId=t.datasource.datasourceId,e.filterDtoList=[],null!=a.widget.relation&&(e.relationId=t.relation.relationId,e.filterDtoList.push({tableName:a.widget.table.tableName,columnName:a.widget.relation.slaveColumn.columnName,filterType:xe.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(a.masterTableData||{})[a.widget.relation.masterColumn.columnName]}));let l,r=c();if(Array.isArray(a.widget.props.likeQueryColumn)&&a.widget.props.likeQueryColumn.length>0&&null!=r&&""!==r){let t=a.widget.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(e.filterDtoList)||(e.filterDtoList=[]),e.filterDtoList.push({columnName:t,filterType:14,columnValue:r})}if(null!=n.value&&(e.customFilterGroupList=n.value),e.ignoreMaskFields=i().getIgnoreMaskFields(a.widget),i()&&i().getIgnoreMaskFields&&(e.ignoreMaskFields=i().getIgnoreMaskFields(a.widget)),i().isEdit||"function"!==typeof a.widget.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(e=await a.widget.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](e,i().instanceData())),null==e)throw new Error;return l=null!=t.relation?await(0,Ae.bE)(We.x+"/online/onlineOperation/listByOneToManyRelationId/"+t.datasource.variableName,e):await(0,Ae.bE)(We.x+"/online/onlineOperation/listByDatasourceId/"+t.datasource.variableName,e),i().isEdit||"function"!==typeof a.widget.eventInfo[w.OnlineFormEventType.AFTER_LOAD_TABLE_DATA]||(l.data.dataList=await a.widget.eventInfo[w.OnlineFormEventType.AFTER_LOAD_TABLE_DATA](l.data.dataList,i().instanceData())),a.widget&&a.widget.props.treeFlag&&a.widget.props.parentIdColumn&&(l.data.dataList=(0,A.BN)(l.data.dataList,s.value,a.widget.props.parentIdColumn)),o.value=[],{dataList:l.data.dataList,totalCount:l.data.totalCount}}catch(t){throw console.error(t),t}},y=()=>!0,f=e=>{o.value=e},h=(e,t)=>{if(!i().isEdit)if(e.type===w.SysCustomWidgetOperationType.BATCH_DELETE)b();else if(e.type===w.SysCustomWidgetOperationType.DELETE)t&&T(t);else if(e.type===w.SysCustomWidgetOperationType.EXPORT)E(e);else if(e.type===w.SysCustomWidgetOperationType.IMPORT)k(e,t);else if(e.type===w.SysCustomWidgetOperationType.PRINT)i().onPrint(e,t,o.value,a.widget.showName);else if(e.type===w.SysCustomWidgetOperationType.START_FLOW)console.log("启动流程"),i().onStartFlow(e,t);else if(e.type===w.SysCustomWidgetOperationType.UPDATE)C(e,t);else if(e.type===w.SysCustomWidgetOperationType.SCRIPT)i().handlerScriptOperation(e,t).then(()=>{u(!0)}).catch(e=>{console.warn(e)});else{let l=[];if(e.type===w.SysCustomWidgetOperationType.UPDATE_DIALOG)if(e.rowOperation){if(null==t)return void U.nk.error("请选择要更新的数据！");l=[t[s.value]]}else{if(o.value.length<=0)return void U.nk.error("请选择要更新的数据！");l=o.value.map(e=>e[s.value])}i().handlerOperation(e,{isEdit:i().isEdit,isUpdate:e.type===w.SysCustomWidgetOperationType.UPDATE_DIALOG,updateIdList:l,rowData:t,masterTableData:a.masterTableData||t,callback:()=>{u()}})}},C=(e,t=null)=>{if(null==e)return;let l,n=i().tableMap.get(a.widget.bindData.tableId),r={datasourceId:n.datasource.datasourceId,relationId:(n.relation||{}).relationId,masterData:{},slaveData:{}};if(null!=e.relationId?r.slaveData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}):r.masterData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}),e.rowOperation){if(null==t)return void U.nk.error("请选择要更新的数据！");r.dataIdList=[t[s.value]]}else{if(o.value.length<=0)return void U.nk.error("请选择要更新的数据！");r.dataIdList=o.value.map(e=>e[s.value])}l=r.relationId?(0,Ae.bE)(We.x+"/online/onlineOperation/updateOneToManyRelationBatch/"+n.datasource.variableName,r):(0,Ae.bE)(We.x+"/online/onlineOperation/updateDatasourceBatch/"+n.datasource.variableName,r),l.then(t=>{U.nk.success(e.name+"成功！"),u(!0)}).catch(e=>{console.warn(e)})},b=()=>{o.value.length<=0?U.nk.error("请选择要批量删除的数据！"):v.s.confirm("是否删除选中数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e,t=i().tableMap.get(a.widget.bindData.tableId),l={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataIdList:o.value.map(e=>e[s.value])};e=l.relationId?(0,Ae.bE)(We.x+"/online/onlineOperation/deleteBatchOneToManyRelation/"+t.datasource.variableName,l):(0,Ae.bE)(We.x+"/online/onlineOperation/deleteBatchDatasource/"+t.datasource.variableName,l),e.then(()=>{U.nk.success("删除成功！"),u(!0)}).catch(e=>{console.warn(e)})})},T=e=>{v.s.confirm("是否删除当前数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=i().tableMap.get(a.widget.bindData.tableId),l={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataId:e[s.value]},o=null;o=l.relationId?(0,Ae.bE)(We.x+"/online/onlineOperation/deleteOneToManyRelation/"+t.datasource.variableName,l):(0,Ae.bE)(We.x+"/online/onlineOperation/deleteDatasource/"+t.datasource.variableName,l),o.then(()=>{U.nk.success("删除成功！"),u(!0)}).catch(e=>{console.warn(e)})}).catch(()=>{})},k=(e,l)=>{console.log(e,l);let o=i().tableMap.get(a.widget.bindData.tableId);if(null==l)return void U.nk.error("请选择要导入的文件！");if(null==o)return void U.nk.error("未找到数据源！");let n="/admin/online/onlineOperation/importDatasource/"+o.datasource.variableName,r={datasourceId:o.datasource.datasourceId,importColumnIds:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder).map(e=>e.columnId),duplicateVerifyColumns:(e.exportColumnList||[]).filter(e=>e.duplicateCheckColumn).map(e=>e.columnId),skipHeader:e.skipHeader,importFile:l};t(n,r).then(()=>{U.nk.success("导入成功！"),u(!0)}).catch(e=>{U.nk.error(e)})},E=e=>{v.s.confirm("是否导出表格数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=i().tableMap.get(a.widget.bindData.tableId),l={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,filterDtoList:[],exportInfoList:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder)};null!=a.widget.relation&&l.filterDtoList.push({tableName:a.widget.table.tableName,columnName:a.widget.relation.slaveColumn.columnName,filterType:xe.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(a.masterTableData||{})[a.widget.relation.masterColumn.columnName]});let o=c();if(Array.isArray(a.widget.props.likeQueryColumn)&&a.widget.props.likeQueryColumn.length>0&&null!=o&&""!==o){let e=a.widget.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(l.filterDtoList)||(l.filterDtoList=[]),l.filterDtoList.push({columnName:e,filterType:14,columnValue:o})}if(i().isEdit||"function"!==typeof a.widget.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(l=await a.widget.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](l,i().instanceData())),null==l)throw new Error;try{l.relationId?await(0,Ae.RG)(We.x+"/online/onlineOperation/exportByOneToManyRelationId/"+t.datasource.variableName,l,a.widget.showName+".xlsx"):await(0,Ae.RG)(We.x+"/online/onlineOperation/exportByDatasourceId/"+t.datasource.variableName,l,a.widget.showName+".xlsx"),U.nk.success("导出成功！")}catch(n){U.nk.error(n)}})};let R=!a.widget.props.treeFlag&&a.widget.props.paged;const S={loadTableData:g,verifyTableParameter:y,paged:R},D=(0,m.Kh)((0,$.K)(S));return(0,r.sV)(()=>{D.refreshTable()}),(e,t)=>{const a=Ie.aQ,o=l.S2;return(0,r.uX)(),(0,r.Wv)(Z.A,{ref_key:"table",ref:p,dataList:(0,m.R1)(D).dataList,style:{height:"100%",padding:"0px !important"},isEdit:(0,m.R1)(i)().isEdit,widget:e.widget,border:"full",operationList:e.widget.operationList,getTableIndex:(0,m.R1)(D).getTableIndex,sortChange:(0,m.R1)(D).onSortChange,onSelectChange:f,treeConfig:(0,m.R1)(d),onOperationClick:h,onRefresh:t[0]||(t[0]=e=>u(!1,e))},{pagination:(0,r.k6)(()=>[e.widget&&e.widget.props.paged&&null==(0,m.R1)(d)?((0,r.uX)(),(0,r.Wv)(o,{key:0,type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,r.k6)(()=>[(0,r.bF)(a,{total:(0,m.R1)(D).totalCount,"current-page":(0,m.R1)(D).currentPage,"page-size":(0,m.R1)(D).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,m.R1)(D).onCurrentPageChange,onSizeChange:(0,m.R1)(D).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})):(0,r.Q3)("",!0)]),_:1},8,["dataList","isEdit","widget","operationList","getTableIndex","sortChange","treeConfig"])}}});const Fe=_e;var Ne=Fe,Oe=a(2878);const Be=["onClick"],Me=["onClick"],Xe=["onClick"],Ve=["onClick"],Pe=["onClick"],Ue=["onClick"],Ke=["onClick"],ze=["onClick"],Qe=["onClick"],Ge=["onClick"],Ye=["onClick"],je=["onClick"],He=["onClick"],Je=["onClick"],qe=["onClick"],$e=["onClick"],Ze=["onClick"],et=["onClick"],tt=["onClick"],at=["onClick"],lt=["onClick"],it=["onClick"],ot=["onClick"],nt=["onClick"],rt={key:1,class:"info mover"},st={style:{width:"100px",height:"100px"}};var dt=(0,r.pM)({__name:"OnlineCustomBlock",props:{value:{default:()=>[]},showBorder:{type:Boolean,default:!0},isEdit:{type:Boolean,default:!1},height:{},isTableExpand:{type:Boolean},masterTableData:{},getSubWidgetValue:{}},emits:["widgetClick","dragAdd","update:value","change"],setup(e,{emit:t}){const a=t,d=e,u=(0,r.WQ)("form",()=>(console.error("OnlineCustomBlock: form not injected"),{isEdit:!1})),p=(0,r.WQ)("isTableChild",!1),C=(0,r.EW)(()=>{let e=d.height;return null!=d.height&&""!==d.height||(e=d.isEdit&&I.value.length<=0?"150px":"0px"),{}}),b=e=>{let t=d.value[e.newIndex];e.newIndex===(d.value||[]).length&&(t=d.value[e.newIndex-1]),t&&(t.isTableExpand=p),a("update:value",I.value)},T=e=>{if(e.widgetType===w.SysCustomWidgetType.Table)return{"margin-bottom":(e.props.paddingBottom||0)+"px"}},k=e=>({"margin-bottom":(e.props.paddingBottom||(e.props.basicInfo||{}).paddingBottom||0)+"px",padding:d.isEdit?"5px":void 0,border:d.isEdit?"1px solid #e8eaec":void 0}),D=e=>({"margin-bottom":(e.props.paddingBottom||(e.props.basicInfo||{}).paddingBottom||0)+"px"}),I=(0,m.IJ)(d.value);(0,r.wB)(()=>d.value,e=>{I.value=e});const A=(e=null)=>{a("widgetClick",e)},W=()=>{a("change",I.value),a("update:value",I.value)},x=e=>{console.log("block dragMove",e);let t=e.relatedContext.element?e.relatedContext.element.widgetType:void 0;return t!==w.SysCustomWidgetType.Block&&t!==w.SysCustomWidgetType.Card},_=e=>{let t=[...I.value,e];I.value=t,a("change",t),a("update:value",t)},F=e=>{v.s.confirm("是否删除此组件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=I.value.filter(t=>t!==e);I.value=t,a("change",t),a("update:value",t),A(null)}).catch(e=>{console.warn(e)})},O=e=>null!=d.getSubWidgetValue?d.getSubWidgetValue(e):u().getWidgetValue(e),B=(e,t)=>{if(!(t instanceof Event))return u().onValueChange(e,t)},M=(e,t,a)=>u().onWidgetValueChange(e,t,a);return(0,r.sV)(()=>{console.log("Block Block Block => form",u())}),(e,t)=>{const a=(0,r.g2)("OnlineCustomBlock",!0),v=c,X=n.fR,V=o.uD,U=i.tk,K=l.S2;return(0,r.uX)(),(0,r.Wv)(K,{class:"online-custom-block",gutter:(0,m.R1)(u)().gutter},{default:(0,r.k6)(()=>[(0,r.bF)(V,{span:24},{default:(0,r.k6)(()=>[((0,r.uX)(),(0,r.Wv)((0,r.$y)(e.isEdit?(0,m.R1)(f.MA):"el-row"),{class:(0,s.C4)(["custom-block-draggable","pc"===(0,m.R1)(u)().mode||e.isEdit?"el-row":""]),gutter:(0,m.R1)(u)().gutter,draggable:".custom-widget-item",modelValue:(0,m.R1)(I),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,m.i9)(I)?I.value=e:null),group:"componentsGroup",ghostClass:"ghost",chosenClass:"chosen",style:(0,s.Tr)([(0,m.R1)(C),{position:"relative",overflow:"hidden",width:"100%"}]),disabled:!e.isEdit,move:x,onSort:W,onAdd:b},{default:(0,r.k6)(()=>[Array.isArray((0,m.R1)(I))&&(0,m.R1)(I).length>0?((0,r.uX)(!0),(0,r.CE)(r.FK,{key:0},(0,r.pI)((0,m.R1)(I),t=>((0,r.uX)(),(0,r.Wv)(V,{class:(0,s.C4)(["custom-widget-item",{active:e.isEdit&&(0,m.R1)(u)().isActive(t)}]),style:(0,s.Tr)({display:e.isEdit||(0,m.R1)(u)().getWidgetVisible(t)?void 0:"none"}),key:t.variableName,span:t.props.span||(t.props.basicInfo||{}).span},{default:(0,r.k6)(()=>[e.isEdit||(0,m.R1)(u)().getWidgetVisible(t)?((0,r.uX)(),(0,r.CE)("div",{key:0,class:(0,s.C4)(["widget-item",{active:e.isEdit&&(0,m.R1)(u)().isActive(t)}]),onClick:(0,g.D$)(e=>A(t),["stop"])},[t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Table?((0,r.uX)(),(0,r.CE)("div",{key:0,style:(0,s.Tr)(T(t))},[null!=(0,m.R1)(p)&&(0,m.R1)(p)?((0,r.uX)(),(0,r.Wv)(Ne,{key:1,ref_for:!0,ref:t.variableName,isEdit:e.isEdit,widget:t,masterTableData:e.masterTableData,onClick:(0,g.D$)(e=>A(t),["stop"])},null,8,["isEdit","widget","masterTableData","onClick"])):((0,r.uX)(),(0,r.Wv)(ae,{key:0,widget:t,ref_for:!0,ref:t.variableName,value:(0,m.R1)(u)().getTableData(t),onInput:e=>(0,m.R1)(u)().setTableData(t,e),onClick:(0,g.D$)(e=>A(t),["stop"])},null,8,["widget","value","onInput","onClick"]))],4)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Block?((0,r.uX)(),(0,r.CE)("div",{key:1,style:(0,s.Tr)(k(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(a,{ref_for:!0,ref:t.variableName,value:t.childWidgetList,"onUpdate:value":e=>t.childWidgetList=e,isEdit:e.isEdit,onWidgetClick:A},null,8,["value","onUpdate:value","isEdit"])],12,Me)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Card?((0,r.uX)(),(0,r.CE)("div",{key:2,onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(De,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,onWidgetClick:A},null,8,["widget","isEdit"])],8,Xe)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Tabs?((0,r.uX)(),(0,r.CE)("div",{key:3,onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(P,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,masterTableData:d.masterTableData,onWidgetClick:A},null,8,["widget","isEdit","masterTableData"])],8,Ve)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).TableContainer?((0,r.uX)(),(0,r.CE)("div",{key:4,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(J,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,onWidgetClick:A},null,8,["widget","isEdit"])],12,Pe)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).CellGroup?((0,r.uX)(),(0,r.CE)("div",{key:5,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px","margin-top":(t.props.paddingTop||0)+"px",background:"#F6F7F9"}),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(E,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,onWidgetClick:A},null,8,["widget","isEdit"])],12,Ue)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).LineChart?((0,r.uX)(),(0,r.CE)("div",{key:6,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:O(t),onInput:e=>B(t,e),onChange:(e,a)=>M(t,e,a),onWidgetClick:A},null,8,["widget","isEdit","value","onInput","onChange"])],12,Ke)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).BarChart?((0,r.uX)(),(0,r.CE)("div",{key:7,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:O(t),onInput:e=>B(t,e),onChange:(e,a)=>M(t,e,a),onWidgetClick:A},null,8,["widget","isEdit","value","onInput","onChange"])],12,ze)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).PieChart?((0,r.uX)(),(0,r.CE)("div",{key:8,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:O(t),onInput:e=>B(t,e),onChange:(e,a)=>M(t,e,a),onWidgetClick:A},null,8,["widget","isEdit","value","onInput","onChange"])],12,Qe)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).ScatterChart?((0,r.uX)(),(0,r.CE)("div",{key:9,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:O(t),onInput:e=>B(t,e),onChange:(e,a)=>M(t,e,a),onWidgetClick:A},null,8,["widget","isEdit","value","onInput","onChange"])],12,Ge)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).PivotTable?((0,r.uX)(),(0,r.CE)("div",{key:10,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,Ye)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).DataViewTable?((0,r.uX)(),(0,r.CE)("div",{key:11,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,je)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Carousel?((0,r.uX)(),(0,r.CE)("div",{key:12,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,He)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).RichText?((0,r.uX)(),(0,r.CE)("div",{key:13,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,Je)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).GaugeChart?((0,r.uX)(),(0,r.CE)("div",{key:14,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,qe)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).RadarChart?((0,r.uX)(),(0,r.CE)("div",{key:15,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,$e)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).FunnelChart?((0,r.uX)(),(0,r.CE)("div",{key:16,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,Ze)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).ProgressBar?((0,r.uX)(),(0,r.CE)("div",{key:17,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,et)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).ProgressCircle?((0,r.uX)(),(0,r.CE)("div",{key:18,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,tt)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).DataCard?((0,r.uX)(),(0,r.CE)("div",{key:19,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,at)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).DataProgressCard?((0,r.uX)(),(0,r.CE)("div",{key:20,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,lt)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).CommonList?((0,r.uX)(),(0,r.CE)("div",{key:21,style:(0,s.Tr)(D(t)),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:void 0,onWidgetClick:A},null,8,["widget","isEdit"])],12,it)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Text?((0,r.uX)(),(0,r.CE)("div",{key:22,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"})},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:O(t)||t.props.text,onWidgetClick:A},null,8,["widget","isEdit","value"])],4)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Image?((0,r.uX)(),(0,r.CE)("div",{key:23,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"})},[(0,r.bF)(S.A,{ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,value:O(t),src:t.props.src,onWidgetClick:A},null,8,["widget","isEdit","value","src"])],4)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Title?((0,r.uX)(),(0,r.CE)("div",{key:24,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(v,{showLine:t.props.showLine,showBorderLine:t.props.showBorderLine,backgroundColor:t.props.backgroundColor,lineColor:t.props.lineColor,lineWidth:t.props.lineWidth,fontColor:t.props.fontColor,fontSize:t.props.fontSize,titleAlign:t.props.titleAlign,lineRadius:t.props.lineRadius,fontWeight:t.props.fontWeight,paddingTop:t.props.paddingTop},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)(t.showName),1)]),_:2},1032,["showLine","showBorderLine","backgroundColor","lineColor","lineWidth","fontColor","fontSize","titleAlign","lineRadius","fontWeight","paddingTop"])],12,ot)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).Divider?((0,r.uX)(),(0,r.CE)("div",{key:25,onClick:(0,g.D$)(e=>A(t),["stop"])},[(0,r.bF)(X,{"content-position":t.props.contentPosition},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)(t.showName),1)]),_:2},1032,["content-position"])],8,nt)):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).ImageCard?((0,r.uX)(),(0,r.Wv)(L.A,{key:26,ref_for:!0,ref:t.variableName,widget:t,isEdit:e.isEdit,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),onWidgetClick:A},null,8,["widget","isEdit","style"])):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).QueryList?((0,r.uX)(),(0,r.Wv)(Oe.A,{key:27,widget:t,isEdit:e.isEdit,onWidgetClick:A},null,8,["widget","isEdit"])):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).List?((0,r.uX)(),(0,r.Wv)(N,{key:28,widget:t,isEdit:e.isEdit,onWidgetClick:A},null,8,["widget","isEdit"])):t.widgetType===(0,m.R1)(w.SysCustomWidgetType).FlowCountStatusCard?((0,r.uX)(),(0,r.Wv)(me,{key:29,style:(0,s.Tr)({"margin-bottom":(t.props.paddingBottom||0)+"px"}),disabled:e.isEdit,onWidgetClick:A},null,8,["style","disabled"])):((0,r.uX)(),(0,r.Wv)((0,r.$y)("pc"===(0,m.R1)(u)().mode?(0,m.R1)(h.xE):"div"),{key:30,label:t.showName,inset:"",prop:(0,m.R1)(u)().getWidgetVisible(t)?t.propString:void 0,class:(0,s.C4)({"mobile-item":"mobile"===(0,m.R1)(u)().mode,"rich-input":t.widgetType===(0,m.R1)(w.SysCustomWidgetType).RichEditor}),"label-width":null==t.showName||""===t.showName?(e.isEdit,"0px"):void 0,onClick:(0,g.D$)(e=>A(t),["stop"])},{default:(0,r.k6)(()=>[(0,r.bF)(S.A,{widget:t,ref_for:!0,ref:t.variableName,value:O(t),onInput:e=>B(t,e),onChange:(e,a)=>M(t,e,a)},null,8,["widget","value","onInput","onChange"])]),_:2},1032,["label","prop","class","label-width","onClick"])),e.isEdit&&(0,m.R1)(u)().isActive(t)?((0,r.uX)(),(0,r.Wv)(R.A,{key:31,widget:t,clone:(0,m.R1)(u)().cloneWidget,onCopy:_,onDelete:e=>F(t)},null,8,["widget","clone","onDelete"])):(0,r.Q3)("",!0)],10,Be)):(0,r.Q3)("",!0)]),_:2},1032,["style","class","span"]))),128)):e.isEdit?((0,r.uX)(),(0,r.CE)("div",rt,[(0,r.Lk)("div",st,[(0,r.bF)(U,null,{default:(0,r.k6)(()=>[(0,r.bF)((0,m.R1)(y.UploadFilled))]),_:1})]),t[1]||(t[1]=(0,r.Lk)("span",null,"请拖入组件进行编辑",-1))])):(0,r.Q3)("",!0)]),_:1},40,["class","gutter","modelValue","style","disabled"]))]),_:1})]),_:1},8,["gutter"])}}});const ut=(0,u.A)(dt,[["__scopeId","data-v-751f37d2"]]);var pt=ut},91324:function(e,t,a){a.d(t,{A:function(){return O}});var l=a(54880),i=(a(97042),a(51582),a(60713),a(69080)),o=(a(25374),a(69225),a(65451)),n=(a(63390),a(25136)),r=(a(69957),a(11194)),s=(a(57583),a(44114),a(18111),a(22489),a(61701),a(18237),a(56768)),d=a(24232),u=a(90144),p=a(45130),c=a(26695),m=a(164),g=a(57477),y=a(81387),f=a(27007),v=a(51351),h=a(60265),w=a(21016),C=a(36525),b=a(53155),T=a(18384),k=a(31932),E=a(71066),R=a(42933),S=a(46954),D=a(11051),I=a(69838);const A={style:{display:"flex",height:"40px","line-height":"40px"}},W={style:{"font-size":"18px",color:"#333","font-weight":"bold"}},L={class:"online-query-form",style:{height:"calc(100vh - 122px)",padding:"25px",background:"white"}},x={key:0};var _=(0,s.pM)({__name:"index",props:{formConfig:{},height:{},masterTableData:{},isEdit:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1},currentWidget:{},fullscreen:{type:Boolean,default:!1},mode:{default:"pc"},dialog:{},isSelect:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},dialogData:{},openEvent:{},thirdParamsString:{},dialogKey:{}},emits:["widgetClick","tableClick"],setup(e,{emit:t}){const a=(0,y.rd)(),_=t,F=e,{onCloseThirdDialog:N}=(0,E.P)(F),{fetchUpload:O}=(0,k.v)(),B=(0,u.KR)(!1),M=(0,u.KR)([]),X=(0,s.EW)(()=>j.value.tableWidget),V=(0,s.EW)(()=>j.value.widgetList),P=(0,s.EW)(()=>X.value&&null!=X.value.props.groupColumn&&""!==X.value.props.groupColumn),U=()=>{F.dialog?F.dialog.cancel():N(!1)},K=()=>{if(F.dialog){if(F.isSelect){if(0==M.value.length)return c.nk.error("请选择数据");F.multiple?F.dialog.submit(M.value):F.dialog.submit(M.value[0])}}else N(!1)},z=(e=!1,t=void 0)=>{we.value=t,Y.value.isEdit||(e?Le.refreshTable(!0,1):Le.refreshTable())},{getDictDataList:Q}=(0,S.o)(),{isReady:G,dialogParams:Y,form:j,formData:H,getWidgetValue:J,getWidgetProp:q,getWidgetVisible:$,onValueChange:Z,onWidgetValueChange:ee,getDropdownParams:te,checkOperationPermCode:ae,checkOperationDisabled:le,checkOperationVisible:ie,cloneWidget:oe,handlerOperation:ne,handlerScriptOperation:re,loadOnlineFormConfig:se,getIgnoreMaskFields:de,onPrint:ue,initPage:pe,initFormWidgetList:ce,initWidgetLinkage:me,onStartFlow:ge,loadOnlineDictList:ye,showDialog:fe,showOnlineDialog:ve,instanceData:he}=(0,D.m)({props:F,router:a,formRef:void 0,close:U,refresh:z});(0,s.Gt)("form",()=>({...j.value,mode:F.mode||"pc",isEdit:F.isEdit,readOnly:F.readOnly,formData:H,getWidgetValue:J,getWidgetProp:q,getWidgetVisible:$,onValueChange:Z,onWidgetValueChange:ee,getDropdownParams:te,checkOperationPermCode:ae,checkOperationDisabled:le,checkOperationVisible:ie,cloneWidget:oe,onPrint:ue,onStartFlow:ge,handlerScriptOperation:re,handlerOperation:ne,getIgnoreMaskFields:de,showDialog:fe,getDictDataList:Q,loadOnlineFormConfig:se,loadOnlineDictList:ye,getTableData:()=>[],isActive:e=>F.currentWidget===e,getWidgetObject:R.A.getWidgetObject,instanceData:()=>he}));const we=(0,u.KR)([]),Ce=e=>{j.value.widgetList=e},be=e=>{X.value.childWidgetList=e},Te=()=>Array.isArray(V.value)?V.value.map(e=>{if(e.bindData.dataType!==w.SysCustomWidgetBindDataType.Column||null==e.column)return null;let t=e.column,a=J(e);if(null==a||""===a||Array.isArray(a)&&0===a.length)return null;let l={tableName:e.table.tableName,columnName:e.column.columnName,filterType:e.column.filterType,columnValue:e.column.filterType!==C.SysOnlineColumnFilterType.RANFGE_FILTER?a:void 0};return t.filterType===C.SysOnlineColumnFilterType.RANFGE_FILTER&&(l.columnValueStart=a[0],l.columnValueEnd=a[1]),l}).filter(e=>null!=e):[],ke=(0,u.KR)(),Ee=()=>{if(ke.value){let e=ke.value;if(Array.isArray(ke.value)&&(e=ke.value[0].value),e)return e.getSearchString()}return null},Re=async e=>{let t=j.value.tableMap.get(X.value.bindData.tableId);if(!t)throw console.warn("table is undefined tableId=",X.value.bindData.tableId),new Error;e.datasourceId=t.datasource.datasourceId,e.filterDtoList=Te(),null!=X.value.relation&&(e.relationId=t.relation.relationId,e.filterDtoList.push({tableName:X.value.table.tableName,columnName:X.value.relation.slaveColumn.columnName,filterType:C.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(Y.value.masterTableData||{})[X.value.relation.masterColumn.columnName]}));let a,l=Ee();if(Array.isArray(X.value.props.likeQueryColumn)&&X.value.props.likeQueryColumn.length>0&&null!=l&&""!==l){let t=X.value.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(e.filterDtoList)||(e.filterDtoList=[]),e.filterDtoList.push({columnName:t,filterType:14,columnValue:l})}if(null!=we.value&&(e.customFilterGroupList=we.value),e.ignoreMaskFields=de(X.value),!Array.isArray(e.orderParam)||e.orderParam.length<=0){let{orderColumn:t,orderAsc:a}=X.value.props;t&&(e.orderParam=[{fieldName:t,asc:!!a}])}if(Y.value.isEdit||"function"!==typeof X.value.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(e=await X.value.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](e,he)),F.isSelect&&F.openEvent&&(e=await F.openEvent(e,he)),null==e)throw new Error;return a=null!=t.relation?await(0,b.bE)(T.x+"/online/onlineOperation/listByOneToManyRelationId/"+t.datasource.variableName,e):await(0,b.bE)(T.x+"/online/onlineOperation/listByDatasourceId/"+t.datasource.variableName,e),Y.value.isEdit||"function"!==typeof X.value.eventInfo[w.OnlineFormEventType.AFTER_LOAD_TABLE_DATA]||(a.data.dataList=await X.value.eventInfo[w.OnlineFormEventType.AFTER_LOAD_TABLE_DATA](a.data.dataList,he)),X.value&&X.value.props.treeFlag&&X.value.props.parentIdColumn&&(a.data.dataList=(0,f.BN)(a.data.dataList,Ne.value,X.value.props.parentIdColumn)),M.value=[],{dataList:a.data.dataList,totalCount:a.data.totalCount}},Se=()=>!0,De=(0,s.EW)(()=>X.value&&X.value.props.treeFlag&&X.value.props.parentIdColumn?{rowField:Ne.value,parentField:X.value.props.parentIdColumn}:null);let Ie=!0;const Ae=Y.value.formConfig?.tableWidget;Ie=!(Ae&&Ae.props&&Ae.props.treeFlag&&Ae.props.parentIdColumn)&&Ae?.props?.paged;const We={loadTableData:Re,verifyTableParameter:Se,paged:!P.value&&Ie},Le=(0,u.Kh)((0,h.K)(We)),xe=()=>{_("tableClick",X.value)},_e=e=>{_("widgetClick",e)},Fe=(0,s.EW)(()=>j.value.operationList),Ne=(0,s.EW)(()=>{if(Y.value.isEdit)return;let e=j.value.tableMap.get(X.value.bindData.tableId);if(e&&Array.isArray(e.columnList))for(let t=0;t<e.columnList.length;t++){let a=e.columnList[t];if(a.primaryKey)return a.columnName}return null}),Oe=e=>{V.value.push(e)},Be=e=>{m.s.confirm("是否删除此组件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=j.value.widgetList.indexOf(e);-1!==t&&j.value.widgetList.splice(t,1),_e(null)}).catch(e=>{console.warn(e)})},Me=e=>{M.value=e},Xe=e=>{M.value=[e]},Ve=()=>{M.value.length<=0?c.nk.error("请选择要批量删除的数据！"):m.s.confirm("是否删除选中数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e,t=j.value.tableMap.get(X.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataIdList:M.value.map(e=>e[Ne.value]).filter(e=>null!=e)};e=a.relationId?(0,b.bE)(T.x+"/online/onlineOperation/deleteBatchOneToManyRelation/"+t.datasource.variableName,a):(0,b.bE)(T.x+"/online/onlineOperation/deleteBatchDatasource/"+t.datasource.variableName,a),e.then(()=>{c.nk.success("删除成功！"),z(!0)}).catch(e=>{console.warn(e)})})},Pe=e=>{m.s.confirm("是否删除当前数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=j.value.tableMap.get(X.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,dataId:e[Ne.value]},l=null;l=a.relationId?(0,b.bE)(T.x+"/online/onlineOperation/deleteOneToManyRelation/"+t.datasource.variableName,a):(0,b.bE)(T.x+"/online/onlineOperation/deleteDatasource/"+t.datasource.variableName,a),l.then(()=>{c.nk.success("删除成功！"),z(!0)}).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},Ue=(e,t)=>{console.log(e,t);let a=j.value.tableMap.get(X.value.bindData.tableId);if(null==t)return void c.nk.error("请选择要导入的文件！");if(null==a)return void c.nk.error("未找到数据源！");let l=T.x+"/online/onlineOperation/importDatasource/"+a.datasource.variableName,i={datasourceId:a.datasource.datasourceId,importColumnIds:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder).map(e=>e.columnId),duplicateVerifyColumns:(e.exportColumnList||[]).filter(e=>e.duplicateCheckColumn).map(e=>e.columnId),skipHeader:e.skipHeader,importFile:t};O(l,i).then(()=>{c.nk.success("导入成功！"),z(!0)}).catch(e=>{c.nk.error(e)})},Ke=e=>{m.s.confirm("是否导出表格数据？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=j.value.tableMap.get(X.value.bindData.tableId),a={datasourceId:t.datasource.datasourceId,relationId:(t.relation||{}).relationId,filterDtoList:Te(),exportInfoList:(e.exportColumnList||[]).sort((e,t)=>e.showOrder-t.showOrder)};null!=X.value.relation&&a.filterDtoList.push({tableName:X.value.table.tableName,columnName:X.value.relation.slaveColumn.columnName,filterType:C.SysOnlineColumnFilterType.EQUAL_FILTER,columnValue:(Y.value.masterTableData||{})[X.value.relation.masterColumn.columnName]});let l=Ee();if(Array.isArray(X.value.props.likeQueryColumn)&&X.value.props.likeQueryColumn.length>0&&null!=l&&""!==l){let e=X.value.props.likeQueryColumn.map(e=>e.join(".")).join(",");Array.isArray(a.filterDtoList)||(a.filterDtoList=[]),a.filterDtoList.push({columnName:e,filterType:14,columnValue:l})}if(Y.value.isEdit||"function"!==typeof X.value.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA]||(a=await X.value.eventInfo[w.OnlineFormEventType.BEFORE_LOAD_TABLE_DATA](a,he)),null==a)throw new Error;try{a.relationId?await(0,b.RG)(T.x+"/online/onlineOperation/exportByOneToManyRelationId/"+t.datasource.variableName,a,X.value.showName+".xlsx"):await(0,b.RG)(T.x+"/online/onlineOperation/exportByDatasourceId/"+t.datasource.variableName,a,X.value.showName+".xlsx"),c.nk.success("导出成功！")}catch(i){c.nk.error(i)}})},ze=(e,t=null)=>{if(null==e)return;let a,l=j.value.tableMap.get(X.value.bindData.tableId),i={datasourceId:l.datasource.datasourceId,relationId:(l.relation||{}).relationId,masterData:{},slaveData:{}};if(null!=e.relationId?i.slaveData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}):i.masterData=e.updateColumnList.reduce((e,t)=>(e[t.updateColumnName]=t.updateValue,e),{}),e.rowOperation){if(null==t||null==t[Ne.value])return void c.nk.error("请选择要更新的数据！");i.dataIdList=[t[Ne.value]]}else{if(M.value.length<=0)return void c.nk.error("请选择要更新的数据！");i.dataIdList=M.value.map(e=>e[Ne.value]).filter(e=>null!=e)}a=i.relationId?(0,b.bE)(T.x+"/online/onlineOperation/updateOneToManyRelationBatch/"+l.datasource.variableName,i):(0,b.bE)(T.x+"/online/onlineOperation/updateDatasourceBatch/"+l.datasource.variableName,i),a.then(t=>{c.nk.success(e.name+"成功！"),z(!0)}).catch(e=>{console.warn(e)})},Qe=(e,t)=>{if(!Y.value.isEdit)if(e.type===w.SysCustomWidgetOperationType.BATCH_DELETE)Ve();else if(e.type===w.SysCustomWidgetOperationType.DELETE)t&&Pe(t);else if(e.type===w.SysCustomWidgetOperationType.EXPORT)Ke(e);else if(e.type===w.SysCustomWidgetOperationType.IMPORT)Ue(e,t);else if(e.type===w.SysCustomWidgetOperationType.PRINT)ue(e,t,M.value,X.value.showName);else if(e.type===w.SysCustomWidgetOperationType.START_FLOW)console.log("启动流程"),ge(e,t);else if(e.type===w.SysCustomWidgetOperationType.UPDATE)ze(e,t);else if(e.type===w.SysCustomWidgetOperationType.SCRIPT)re(e,t).catch(e=>{console.warn(e)});else{let a=[];if(e.type===w.SysCustomWidgetOperationType.UPDATE_DIALOG)if(e.rowOperation){if(null==t)return void c.nk.error("请选择要更新的数据！");a=[t[Ne.value]]}else{if(M.value.length<=0)return void c.nk.error("请选择要更新的数据！");a=M.value.map(e=>e[Ne.value])}ne(e,{isEdit:Y.value.isEdit,isUpdate:e.type===w.SysCustomWidgetOperationType.UPDATE_DIALOG,updateIdList:a,rowData:t,masterTableData:Y.value.masterTableData||t,callback:()=>{z()}})}},Ge=()=>{z(!0)},Ye=()=>{z(!0)};return(0,s.sV)(()=>{G.value=!1,Y.value.isEdit||(j.value.eventInfo&&"function"===typeof j.value.eventInfo[w.OnlineFormEventType.AFTER_CREATE_FORM]&&j.value.eventInfo[w.OnlineFormEventType.AFTER_CREATE_FORM](he),Ye(),me()),G.value=!0}),(e,t)=>{const a=r.fR,c=n.S2,m=o.S2,y=l.bZ,f=i.aQ,h=l.ZO,w=l.lX;return(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{class:(0,d.C4)(["online-query-form",{"select-dialog":e.isSelect}]),style:(0,d.Tr)({height:e.height?e.height:"100%"})},[(0,u.R1)(Y).fullscreen&&!(0,u.R1)(Y).isEdit?((0,s.uX)(),(0,s.Wv)(w,{key:0},{default:(0,s.k6)(()=>[(0,s.bF)(y,{style:{height:"72px",background:"white"}},{default:(0,s.k6)(()=>[(0,s.bF)(m,{type:"flex",align:"middle",style:{"justify-content":"space-between",width:"100%",height:"100%"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",A,[t[4]||(t[4]=(0,s.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"BIQS",-1)),(0,s.bF)(a,{direction:"vertical",style:{height:"26px",margin:"7px 8px"}}),(0,s.Lk)("span",W,(0,d.v_)((0,u.R1)(j).formName),1)]),(0,s.bF)(c,{link:"",size:"default",icon:(0,u.R1)(g.Close),style:{"font-size":"24px",color:"#909399"},onClick:U},null,8,["icon"])]),_:1})]),_:1}),(0,s.bF)(h,{style:{width:"100%",padding:"25px",background:"#f9f9f9"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",L,[(0,s.bF)(I.A,{class:"query-filter-box",isEdit:(0,u.R1)(Y).isEdit,ref:"filterBox",itemWidth:(0,u.R1)(j).filterItemWidth||350,style:(0,d.Tr)({"margin-bottom":(0,u.R1)(Y).isEdit?"10px":"0px"}),widgetList:(0,u.R1)(V),formData:(0,u.R1)(H),operationList:(0,u.R1)(Fe),onWidgetClick:_e,onSearch:t[0]||(t[0]=e=>z(!0)),onReset:Ge,onCopy:Oe,onDelete:Be,onOperationClick:Qe,"onUpdate:widgetList":Ce},null,8,["isEdit","itemWidth","style","widgetList","formData","operationList"]),(0,s.Lk)("div",{class:(0,d.C4)(["query-table-box custom-widget-item widget-item",{active:(0,u.R1)(Y).isEdit&&e.currentWidget===(0,u.R1)(X)}]),style:(0,d.Tr)([{"margin-top":"8px"},{padding:(0,u.R1)(Y).isEdit&&e.currentWidget===(0,u.R1)(X)?"2px":"0px"}]),onClick:(0,p.D$)(xe,["stop"])},[(0,s.bF)(v.A,{ref_key:"table",ref:ke,dataList:(0,u.R1)(Le).dataList,isEdit:(0,u.R1)(Y).isEdit,widget:(0,u.R1)(X),multiSelect:(0,u.R1)(B),operationList:(0,u.R1)(Fe),getTableIndex:(0,u.R1)(Le).getTableIndex,sortChange:(0,u.R1)(Le).onSortChange,onSelectChange:Me,treeConfig:(0,u.R1)(De),onRefresh:t[1]||(t[1]=e=>z(!1,e)),onOperationClick:Qe,onWidgetClick:_e,onUpdateChildWidgetList:be},null,8,["dataList","isEdit","widget","multiSelect","operationList","getTableIndex","sortChange","treeConfig"])],6),(0,u.R1)(X)&&(0,u.R1)(X).props.paged&&null==(0,u.R1)(De)&&!(0,u.R1)(P)?((0,s.uX)(),(0,s.Wv)(m,{key:0,type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,s.k6)(()=>[(0,s.bF)(f,{total:(0,u.R1)(Le).totalCount,"current-page":(0,u.R1)(Le).currentPage,"page-size":(0,u.R1)(Le).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,u.R1)(Le).onCurrentPageChange,onSizeChange:(0,u.R1)(Le).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})):(0,s.Q3)("",!0)])]),_:1})]),_:1})):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.bF)(I.A,{class:"query-filter-box",isEdit:(0,u.R1)(Y).isEdit,ref:"filterBox",itemWidth:(0,u.R1)(j).filterItemWidth||350,style:{"margin-bottom":"16px"},widgetList:(0,u.R1)(V),formData:(0,u.R1)(H),operationList:(0,u.R1)(Fe),onWidgetClick:_e,onSearch:t[2]||(t[2]=e=>z(!0)),onReset:Ge,onCopy:Oe,onDelete:Be,onOperationClick:Qe,"onUpdate:widgetList":Ce},null,8,["isEdit","itemWidth","widgetList","formData","operationList"]),(0,s.Lk)("div",{class:(0,d.C4)(["query-table-box custom-widget-item widget-item",{active:(0,u.R1)(Y).isEdit&&e.currentWidget===(0,u.R1)(X)}]),style:(0,d.Tr)({padding:(0,u.R1)(Y).isEdit?"0":""}),onClick:(0,p.D$)(xe,["stop"])},[(0,s.bF)(v.A,{ref_key:"table",ref:ke,dataList:(0,u.R1)(Le).dataList,style:{height:"100%"},isEdit:(0,u.R1)(Y).isEdit,widget:(0,u.R1)(X),multiSelect:(0,u.R1)(B)||e.isSelect&&e.multiple,singleSelect:e.isSelect&&!e.multiple,isSelectDialog:e.isSelect,operationList:(0,u.R1)(Fe),getTableIndex:(0,u.R1)(Le).getTableIndex,sortChange:(0,u.R1)(Le).onSortChange,onSelectChange:Me,onRadioChange:Xe,treeConfig:(0,u.R1)(De),onOperationClick:Qe,onRefresh:t[3]||(t[3]=e=>z(!1,e)),onWidgetClick:_e,onUpdateChildWidgetList:be},{pagination:(0,s.k6)(()=>[(0,u.R1)(X)&&(0,u.R1)(X).props.paged&&null==(0,u.R1)(De)&&!(0,u.R1)(P)?((0,s.uX)(),(0,s.Wv)(m,{key:0,type:"flex",justify:e.isSelect?"space-between":"end",style:{"margin-top":"16px"}},{default:(0,s.k6)(()=>[(0,s.bF)(f,{total:(0,u.R1)(Le).totalCount,"current-page":(0,u.R1)(Le).currentPage,"page-size":(0,u.R1)(Le).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,u.R1)(Le).onCurrentPageChange,onSizeChange:(0,u.R1)(Le).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"]),e.isSelect?((0,s.uX)(),(0,s.CE)("div",x,[(0,s.bF)(c,{onClick:U},{default:(0,s.k6)(()=>t[5]||(t[5]=[(0,s.eW)("取消")])),_:1,__:[5]}),(0,s.bF)(c,{type:"primary",onClick:K},{default:(0,s.k6)(()=>t[6]||(t[6]=[(0,s.eW)("确认选择")])),_:1,__:[6]})])):(0,s.Q3)("",!0)]),_:1},8,["justify"])):(0,s.Q3)("",!0),e.isSelect&&(null!=(0,u.R1)(De)||(0,u.R1)(P))?((0,s.uX)(),(0,s.Wv)(m,{key:1,type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.bF)(c,{onClick:U},{default:(0,s.k6)(()=>t[7]||(t[7]=[(0,s.eW)("取消")])),_:1,__:[7]}),(0,s.bF)(c,{type:"primary",onClick:K},{default:(0,s.k6)(()=>t[8]||(t[8]=[(0,s.eW)("确认选择")])),_:1,__:[8]})])]),_:1})):(0,s.Q3)("",!0)]),_:1},8,["dataList","isEdit","widget","multiSelect","singleSelect","isSelectDialog","operationList","getTableIndex","sortChange","treeConfig"])],6)],64))],6)),[[p.aG,(0,u.R1)(G)]])}}}),F=a(71241);const N=(0,F.A)(_,[["__scopeId","data-v-b5aa6e10"]]);var O=N},95829:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABDCAYAAAAoCNNNAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAaeSURBVHgB5ZxNcBNlGMf/75ukLS1CcoGLjoHRkzIt6gH1QCoeaOlM483h0uKM4wmRg3Y6OkN6YJgCM4BHGbX1wMiJ4gByABsOKhen7aAnHah64mtSIKUl6b7r8ywkZtOk2d28m27gN9NpPjbb3X+f73c3AqvIzkOZeOnzi8OxWawSAj6TTGWiix3oCgt0mgpd9FIX/dU4TERR+Yjm6L1ZE5iFqWaUlOm2eUxPpGJz8BFfhOCTX1qLAdNEEnzi1U7aDSbSCGEskseVCR8sR6sQO49kEiHgAB10Av4yZgiMX/w0loYmtAjRQAHskJUYEiM6BKlLiCQFu3wY3zZcgOWMRQyM1OMyEh7pO5rZRyJMBUAEZjAfwo3ew5kD8IhriwiQFVSG3CWisMetdbgSghTvog+coYdxBJtZcpVuN2I4do2e0TtJITCJ4IvAxMlVpnpGM0mnH3BkEbuOZgagMIZmxAwNnh9aN15rs5pCsCVIETqDJoYsuftcjRS7ohBPAuOUlspwdZmjkr37wmex6WobVI0RlgghignNLwIT5SCfoNK/2gZVhVgK4RiaIzA6Jd6xBlVdvKIQXCyRKTmOuE2DQKJn9O4nld8q4ymKC9WYoxpja3mNscwi8lKldImwYZ3E1x+tw+632+CWQ++vxZcDz6GjVfukIJqTltvbsAnB1gAhB6CJd19twUYSY8crLXDLlhfC2LwhZP3ohtJpso865tLXbEJY1vCMQNMyW4NWFEK3NQQeCpylVhEuPHhsDZ67cguOCQXmH5m299jXnfr7rfuq6n4rve8VZSjOjGl+XBQCUvbDhCf4QDm4bVz//wFf+2cJ1/5dKj7f9nIE+3vaHe3vg6/u255/QwG3lOu3DHw8/gD1IqQcoCIrlabBsHXkvYfvDNaTKayguL4+a3IDB1AOphqItrcbVr1kHb0wRQJNRrm7eEUgtJ1/P96bkNvhA4U4UR4vAoZlEeHkwUxX3oeeYvPGEE5OLuDsb4+sWLHtpYjjz/a/3opjPz60apAN/rtclFfcwrmIQeM3/UULZ4jPkx24cdsgn2515dMsxNW/8sgumtZjv5EhI0FHJ7rgExxAvQZRNxZUN0p0SSFkJ5qQ+ZzOuCPiUkeDxWY8v9i4gHjznrJqCV0IKTrD5uPpTV3wQe397oGu3F6Tq3/mtWciWq3XkzFu0X/p8r0cmpR448rBgKPFlrnK29/b3jDX4Nrk5E8L0IkWi3iTGqpGicBwbaH770nrEp068WGcVhNdvcYTZjlY+nptkk64tedU/StlDV0zCQuThFCmmpFC+lZd6oJjAscGdon+N1otK+QUyqn78u/1ZSvTNO+FhQi+RbAIl+hkv6DehQc85ex+qw0HJ+a9F1nCnCZHM6cRYFgAtgSegJWKwG5SgPsZHv17nnjLyJRURiiNAHPql0XsoAlY+UkOn85apXYp3O16QS0ZM5KvdtWROfyATZ0r1v7XnLXibBlu06pJgZI1eJKD1FkEkEJm4CGPU9y6B8XINP+2hJCGnEAAya7Q0XLWqJQt3NY0JIR1NY0lxLnhWBoBzB6F/26lFv/Dd9ZY8eP6TXumuH7beeZgtyhcSVMsz0ylTiBgsBD8H+asUQ4vIZzeu97mNhw8S7NJbVTx2qqiEC0t8ngQrYL7ChaiPEMwHW12N/iBtnMzp1BKjhUeF4WY2B+bC6JVcBXJ2aBSuizl1M+LFS1nBcZK7w+xdS5erULn2KycwjSclyN5mY/H/Gz+LAr/XLqWw/D3WSteuMEwMFL6fFmI7R29m6KBrutrmrno2fK8v6345T9ytvVUrwgTI+eGYinba+UbJY9lorkcpoR4qi4kK8KZ4sJQbFP568uaeo4VUmEPnlKqnVvF6QbXFQLBC5z1YrnEcOUrcFcsw3YdyUwG9nYEt5hInx+KdVd7e8V5VySM99in0OTwORg13H1FITheKIXuZhaDj53PodY9pY46FF42lxKTzZZJnIrAOG7Vmk0MNyIwjmfivEPeMSkXyJbdBgXGhwvY6uYWa08LEn2jmZQp4PmOOj+pVDU6+hw8EjRXYVfgYqlanVCLupeo2DqoJxxYRUHmyApOeLGCUvTcEs0XY0kMNlgQS4DsAo6nNXyTgN6b5NldQkjQTvcB8Gf1jAIhdccT2YdqPK3xqxR8W73lm2Ul5HZTqGTdZTqfPHAFCmmvMaAWDVvG7juUSSAkO5Va2iSlfJGyTpQCXLx0G3KrWTJ3qmbV31KGb8BQM9lHmE77/CUazH9cOaRQZY9rzgAAAABJRU5ErkJggg=="},96027:function(e,t,a){a.d(t,{A:function(){return te}});var l=a(9267),i=(a(97042),a(48493),a(64193)),o=(a(35132),a(14204),a(25136)),n=(a(69957),a(4311)),r=(a(25393),a(91542)),s=(a(37985),a(18111),a(22489),a(61701),a(56768)),d=a(90144),u=a(24232),p=a(57477),c=a(21016),m=a.p+"img/file-error.3b3e1a81.png",g=a(89277),y=a(27007),f=a(94460),v=a.n(f),h=(0,s.pM)({__name:"Pdf",props:{fileUrl:{}},emits:["error","success"],setup(e,{emit:t}){const a=t,l=(0,d.KR)(!1),i=e=>{a("error",e)},o=()=>{a("success")};return(0,s.sV)(()=>{l.value=!0}),(e,t)=>((0,s.uX)(),(0,s.Wv)((0,d.R1)(v()),{src:e.fileUrl,style:{height:"100%"},onError:i,onRendered:o},null,8,["src"]))}});const w=h;var C=w,b=a(20424),T=a.n(b);const k={style:{width:"100%",height:"100%"}};var E=(0,s.pM)({__name:"Word",props:{fileUrl:{}},emits:["error","success"],setup(e,{emit:t}){const a=t,l=e=>{a("error",e)},i=()=>{a("success")};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",k,[(0,s.bF)((0,d.R1)(T()),{style:{width:"100%",height:"100%"},src:e.fileUrl,onError:l,onRendered:i},null,8,["src"])]))}});const R=E;var S=R,D=a(97293),I=a.n(D);const A={style:{width:"100%",height:"100%"}};var W=(0,s.pM)({__name:"Excel",props:{fileUrl:{}},emits:["error","success"],setup(e,{emit:t}){const a=t,l=e=>{a("error",e)},i=()=>{a("success")};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",A,[(0,s.bF)((0,d.R1)(I()),{style:{width:"100%",height:"100%"},src:e.fileUrl,onError:l,onRendered:i},null,8,["src"])]))}});const L=W;var x=L;const _=["poster"],F=["src"];var N=(0,s.pM)({__name:"Video",props:{fileUrl:{},posterUrl:{}},emits:["error","play","pause","ended","loadedmetadata"],setup(e,{emit:t}){const a=t,l=(0,d.KR)(null),i=()=>{a("error",d.KR)},o=()=>{a("play",d.KR)},n=()=>{a("pause",d.KR)},r=()=>{a("ended",d.KR)},u=()=>{a("loadedmetadata",d.KR)};return(0,s.sV)(()=>{l.value?.addEventListener("error",i),l.value?.addEventListener("play",o),l.value?.addEventListener("pause",n),l.value?.addEventListener("ended",r),l.value?.addEventListener("loadedmetadata",u)}),(0,s.hi)(()=>{l.value?.removeEventListener("error",i),l.value?.removeEventListener("play",o),l.value?.removeEventListener("pause",n),l.value?.removeEventListener("ended",r),l.value?.removeEventListener("loadedmetadata",u)}),(e,t)=>((0,s.uX)(),(0,s.CE)("video",{ref_key:"video",ref:l,controls:"",poster:e.posterUrl},[(0,s.Lk)("source",{src:e.fileUrl},null,8,F),t[0]||(t[0]=(0,s.eW)(" Your browser does not support the video tag. "))],8,_))}});const O=N;var B=O;const M={class:"preview-dialog"},X={class:"preview-content"},V={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",padding:"0px 150px"}},P={class:"file-item"},U={class:"file-header"},K={class:"preview-box"},z={key:0,class:"error-box",style:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",height:"100%",width:"100%"}},Q=["src"],G={key:1,style:{width:"100%",height:"100%"}},Y={class:"error-box",style:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",height:"100%",width:"100%"}},j=["src"],H={key:2,class:"error-box",style:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",height:"100%",width:"100%"}},J=["src"],q={key:0,class:"menu-box"};var $=(0,s.pM)({__name:"Dialog",props:{visible:{type:Boolean,default:!1},fileList:{default:()=>[]},defaultIndex:{default:0},readonly:{type:Boolean,default:!1}},emits:["close","delete","download"],setup(e,{emit:t}){const a=e,f=t,{downloadFile:v}=(0,g.m)(),h=(0,d.KR)(!1),w=(0,d.KR)([]),b=(e,t)=>{e.error=!0,w.value=[...w.value]},T=()=>{f("close")},k=e=>e&&e.type?e.type:(0,y.ti)(e.name),E=e=>{switch(e.type){case c.EnumFileType.PDF:return C;case c.EnumFileType.WORD:return S;case c.EnumFileType.EXCEL:return x;case c.EnumFileType.VIDEO:return B;default:return null}},R=e=>{v(e.url,e.name),f("download",e)};return(0,s.wB)(()=>a.fileList,e=>{w.value=e.map(e=>({...e,type:k(e),error:!1}))},{immediate:!0}),(0,s.sV)(()=>{setTimeout(()=>{h.value=!0},400)}),(e,t)=>{const a=r.tk,g=n.Zq,y=o.S2,f=i.vJ,v=i.eP,C=l.kZ;return(0,s.uX)(),(0,s.Wv)(C,{width:"80vw",modelValue:e.visible,top:"15vh","append-to-body":!0,class:"dialog-preview","show-close":!1,"destroy-on-close":!0,onClose:T},{default:(0,s.k6)(()=>[(0,s.Lk)("div",M,[(0,s.Lk)("div",X,[(0,s.bF)(v,{ref:"carousel","initial-index":e.defaultIndex,height:"100%",autoplay:!1,arrow:(0,d.R1)(w).length>1?"hover":"never",style:(0,u.Tr)([{display:"flex",height:"100%"},{width:(0,d.R1)(h)?"100%":"0px"}]),"indicator-position":"none"},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,d.R1)(w),(l,i)=>((0,s.uX)(),(0,s.Wv)(f,{key:l.url},{default:(0,s.k6)(()=>[(0,s.Lk)("div",V,[(0,s.Lk)("div",P,[(0,s.Lk)("div",U,[(0,s.Lk)("span",null,(0,u.v_)(l.name),1),(0,s.bF)(a,{style:{cursor:"pointer"},onClick:T},{default:(0,s.k6)(()=>[(0,s.bF)((0,d.R1)(p.Close))]),_:1})]),(0,s.Lk)("div",K,[l.error?((0,s.uX)(),(0,s.CE)("div",z,[(0,s.Lk)("img",{src:(0,d.R1)(m),alt:"error"},null,8,Q),t[0]||(t[0]=(0,s.Lk)("span",null,"加载失败",-1))])):((0,s.uX)(),(0,s.CE)("div",G,[l.type===(0,d.R1)(c.EnumFileType).IMAGE?((0,s.uX)(),(0,s.Wv)(g,{key:0,src:l.url,style:{width:"100%",height:"100%"},fit:"contain"},{error:(0,s.k6)(()=>[(0,s.Lk)("div",Y,[(0,s.Lk)("img",{src:(0,d.R1)(m),alt:"error"},null,8,j),t[1]||(t[1]=(0,s.Lk)("span",null,"加载失败",-1))])]),_:2},1032,["src"])):null!=E(l)?((0,s.uX)(),(0,s.Wv)((0,s.$y)(E(l)),{key:1,style:{width:"100%",height:"100%"},"file-url":l.url,time:(e.defaultIndex,10),onError:e=>b(l,e)},null,40,["file-url","time","onError"])):((0,s.uX)(),(0,s.CE)("div",H,[(0,s.Lk)("img",{src:(0,d.R1)(m),alt:"error"},null,8,J),t[2]||(t[2]=(0,s.Lk)("span",null,"暂不支持预览",-1))]))]))])]),e.readonly?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",q,[(0,s.RG)(e.$slots,"default"),(0,s.bF)(y,{type:"primary",size:"default",style:{width:"80px"},onClick:e=>R(l)},{default:(0,s.k6)(()=>t[3]||(t[3]=[(0,s.eW)(" 下载 ")])),_:2,__:[3]},1032,["onClick"])]))])]),_:2},1024))),128))]),_:3},8,["initial-index","arrow","style"])])])]),_:3},8,["modelValue"])}}}),Z=a(71241);const ee=(0,Z.A)($,[["__scopeId","data-v-3c8c1151"]]);var te=ee},96399:function(e,t,a){a.d(t,{A:function(){return m}});var l=a(85415),i=(a(97042),a(22243),a(7409),a(18111),a(22489),a(7588),a(61701),a(56768)),o=a(90144),n=a(27007),r=a(31372),s=a(36947),d=a(84325),u=(0,i.pM)({__name:"index",props:{modelValue:{},size:{default:"default"},disabled:{type:Boolean,default:!1},placeholder:{default:"请选择"},clearable:{type:Boolean,default:!0},collapseTags:{type:Boolean,default:!0},widget:{},igoreSelect:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1}},emits:["update:modelValue","change","blur","focus"],setup(e,{emit:t}){const a=t,u=e,p=(0,i.WQ)("form",()=>(console.error("OnlineCardTable: form not injected"),{isEdit:!1})),c=(0,o.KR)([]),m=(0,o.KR)(),g=(0,o.KR)((0,n.yk)()),y=(0,i.EW)(()=>{let e,t=u.widget?.column?.dictInfo;if(null!=t&&"string"===typeof t.dictDataJson)try{let a=JSON.parse(t.dictDataJson);e=a.dialogSetting}catch(a){console.error("JSON parse error:",a)}return t?{dictId:t.dictId,dictName:t.dictName,valueColumnName:t.valueColumnName,keyColumnName:t.keyColumnName,parentKeyColumnName:t.parentKeyColumnName,treeFlag:t.treeFlag,dialogSetting:e}:null}),f=((0,i.WQ)("formData",()=>(console.error("OnlineCardTable: formData not injected"),{})),(0,i.EW)(()=>null==y.value?{label:"label",value:"value"}:{label:y.value.valueColumnName,value:y.value.keyColumnName})),v=e=>{null!=y.value&&(u.multiple?((e||[]).forEach(e=>{null!=e[y.value.keyColumnName]&&(e[y.value.keyColumnName]=e[y.value.keyColumnName].toString())}),c.value=e,m.value=(e||[]).map(e=>e[y.value.keyColumnName])):(null!=e&&null!=e[y.value.keyColumnName]&&(e[y.value.keyColumnName]=e[y.value.keyColumnName].toString()),c.value=[e],m.value=e[y.value.keyColumnName]),b(e))},h=e=>{c.value=c.value.filter(t=>t[f.value.value]!==e),m.value=c.value.map(e=>e[f.value.value]),b(c.value)},w=e=>{e&&!p().isEdit&&r.l.show("字典数据选择",d["default"],{area:["1000px","650px"],offset:"100px"},{value:c.value,dictInfo:y.value,multiple:u.multiple,props:f.value,igoreSelect:u.widget?.props?.igoreSelect,path:"thirdDictSelect/"+g.value},{width:"1000px",height:"650px",pathName:"/thirdParty/thirdDictSelect"}).then(e=>{v(e)}).catch(()=>{})},C=()=>{c.value=[],m.value=void 0,b(null)},b=e=>{let t=null;null!=e&&(t=u.multiple?e.map(e=>({id:e[f.value.value],name:e[f.value.label],dictAllData:e})):{id:e[f.value.value],name:e[f.value.label],dictAllData:e}),a("update:modelValue",m.value),a("change",m.value,e,t)},T=()=>{if(null==y.value||""===u.modelValue||null==u.modelValue)return;let e=Array.isArray(u.modelValue)?u.modelValue:[u.modelValue];if(0===e.length)return;let t={dictId:y.value.dictId,dictKeys:e};s.NZ.listTableDictByIds(t).then(e=>{e.data.length>0&&(e.data.forEach(e=>{null!=e[y.value.keyColumnName]&&(e[y.value.keyColumnName]=e[y.value.keyColumnName].toString())}),c.value=e.data,m.value=u.modelValue)}).catch(e=>{console.error("Error loading table data:",e)})};return(0,i.wB)(()=>u.modelValue,e=>{null!=e&&""!==e?T():C()},{immediate:!0}),(e,t)=>{const n=l.P9,r=l.AV;return(0,i.uX)(),(0,i.CE)("div",{class:"dict-select",key:(0,o.R1)(g)},[(0,i.bF)(r,{"model-value":(0,o.R1)(m),style:{width:"100%"},multiple:e.multiple,"collapse-tags":e.collapseTags,disabled:e.disabled,size:e.size,clearable:e.clearable,placeholder:e.placeholder,teleported:!1,"popper-class":"data-select-popper",onVisibleChange:w,onClear:C,onRemoveTag:h,onFocus:t[0]||(t[0]=()=>a("focus")),onBlur:t[1]||(t[1]=()=>a("blur"))},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,o.R1)(c),e=>((0,i.uX)(),(0,i.Wv)(n,{key:e[(0,o.R1)(f).value],label:e[(0,o.R1)(f).label],value:e[(0,o.R1)(f).value]},null,8,["label","value"]))),128))]),_:1},8,["model-value","multiple","collapse-tags","disabled","size","clearable","placeholder"])])}}}),p=a(71241);const c=(0,p.A)(u,[["__scopeId","data-v-d87609b0"]]);var m=c}}]);