"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1967],{1579:function(e,a,t){t.r(a),t.d(a,{default:function(){return I}});var l=t(25136),r=(t(97042),t(69957),t(21929)),o=(t(98421),t(65451)),n=(t(63390),t(14022)),i=(t(72343),t(76408)),d=(t(87535),t(32465),t(18888)),u=(t(3172),t(56768)),s=t(90144),p=t(45130),c=t(26695),g=t(27007),m=t(34894),h=t(99080),v=t(71066),f=t(82572);const A={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var b=(0,u.pM)({__name:"editReportPageGroup",props:{groupId:{},groupList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const a=(0,f.l5)(),t=e,{thirdParams:b,onCloseThirdDialog:k}=(0,v.P)(t),I=(0,u.EW)(()=>a.defaultFormItemSize||b.value.defaultFormItemSize?.value),R=(0,s.KR)(),y=(0,s.KR)({ReportPageGroup:{groupId:void 0,groupName:void 0,parentId:void 0,isDatasourceInit:!1}}),P={"ReportPageGroup.groupName":[{required:!0,message:"请输入分组名称",trigger:"blur"}]},x=(0,u.EW)(()=>({groupId:t.groupId||b.value.groupId,groupList:t.groupList||b.value.groupList||[]})),C=(0,u.EW)(()=>null!=x.value.groupId),w=()=>Promise.resolve({dataList:x.value.groupList}),_={loadData:w,isTree:!0,idKey:"id",parentIdKey:"parentId"},F=(0,s.Kh)({formFilter:{},formFilterCopy:{},menuBlock:{isInit:!1},parentId:{impl:(0,h.B)(_),value:[]},isInit:!1}),z=()=>{t.dialog?t.dialog.cancel():k(!1)},N=()=>{R.value.validate(e=>{if(!e)return;let a={reportPageGroupDto:{groupId:x.value.groupId,groupName:y.value.ReportPageGroup.groupName,parentId:y.value.ReportPageGroup.parentId,appId:y.value.ReportPageGroup.appId}},l=C.value?m.xr.update(a):m.xr.add(a);l.then(()=>{c.nk.success("保存成功"),t.dialog?t.dialog.submit(!0):k(!0,!0)}).catch(e=>{console.warn(e)})})},S=e=>{y.value.ReportPageGroup.parentId=Array.isArray(e)?e[e.length-1]:void 0},E=()=>{G().then(()=>{F.isInit||F.parentId.impl.onVisibleChange(!0).then(e=>{F.parentId.value=(0,g.Zi)(e,y.value.ReportPageGroup.parentId,"groupId")}).catch(e=>{console.warn(e)}),F.isInit=!0}).catch(e=>{console.warn(e)})},G=()=>new Promise((e,a)=>{if(!y.value.ReportPageGroup.isDatasourceInit&&C.value){if(null==x.value.groupId)return B(),void a();let t={groupId:x.value.groupId};m.xr.view(t).then(a=>{y.value.ReportPageGroup={...a.data,isDatasourceInit:!0},e(!0)}).catch(e=>{a(e)})}else y.value.ReportPageGroup.isDatasourceInit=!0,e(!0)}),B=()=>{y.value={ReportPageGroup:{groupId:void 0,groupName:void 0,parentId:void 0,isDatasourceInit:!1}}},L=()=>{E()};return(0,u.sV)(()=>{L()}),(e,a)=>{const t=d._m,c=r.xE,g=i.uD,m=n.WK,h=o.S2,v=r.US,f=l.S2;return(0,u.uX)(),(0,u.CE)("div",A,[(0,u.bF)(v,{ref_key:"form",ref:R,model:(0,s.R1)(y),class:"full-width-input form-box",rules:P,style:{width:"100%"},"label-width":"100px",size:(0,s.R1)(I),"label-position":"right",onSubmit:a[2]||(a[2]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(h,{gutter:20},{default:(0,u.k6)(()=>[(0,u.bF)(g,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"所属分组"},{default:(0,u.k6)(()=>[(0,u.bF)(t,{class:"input-item",modelValue:(0,s.R1)(F).parentId.value,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,s.R1)(F).parentId.value=e),disabled:(0,s.R1)(C),options:(0,s.R1)(F).parentId.impl.dropdownList,filterable:"",clearable:!0,"show-all-levels":!1,placeholder:"所属分组",props:{value:"groupId",label:"groupName",checkStrictly:!0},onVisibleChange:(0,s.R1)(F).parentId.impl.onVisibleChange,onChange:S},null,8,["modelValue","disabled","options","onVisibleChange"])]),_:1})]),_:1}),(0,u.bF)(g,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"分组名称",prop:"ReportPageGroup.groupName"},{default:(0,u.k6)(()=>[(0,u.bF)(m,{class:"input-item",modelValue:(0,s.R1)(y).ReportPageGroup.groupName,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,s.R1)(y).ReportPageGroup.groupName=e),clearable:!0,placeholder:"分组名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(h,{class:"menu-box",type:"flex",justify:"end"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{size:(0,s.R1)(I),plain:!0,onClick:z},{default:(0,u.k6)(()=>a[4]||(a[4]=[(0,u.eW)(" 取消 ")])),_:1,__:[4]},8,["size"]),(0,u.bF)(f,{type:"primary",size:(0,s.R1)(I),onClick:a[3]||(a[3]=e=>N())},{default:(0,u.k6)(()=>a[5]||(a[5]=[(0,u.eW)(" 保存 ")])),_:1,__:[5]},8,["size"])]),_:1})])}}});const k=b;var I=k},41967:function(e,a,t){t.r(a),t.d(a,{default:function(){return R}});var l=t(70944),r=t(65451),o=(t(97042),t(63390),t(69080)),n=(t(25374),t(25136)),i=(t(69957),t(18111),t(61701),t(56768)),d=t(90144),u=t(164),s=t(26695),p=t(27007),c=t(49742),g=t(34894),m=t(31372),h=t(60265),v=t(82572),f=t(1579),A=t(4178),b=(0,i.pM)({__name:"index",setup(e,{expose:a}){const t=(0,v.l5)(),b=(0,i.WQ)("mainContextHeight",200),k=(0,i.WQ)("documentClientHeight",200),I=(0,d.KR)(),R=(0,d.KR)([]),y=()=>new Promise((e,a)=>{g.xr.list({}).then(a=>{R.value=a.data,e(a.data)}).catch(e=>{a(e)})}),P={title:"页面分组",supportAdd:!0,supportEdit:!0,supportDelete:!0,addText:"新建分组",keyColumnName:"groupId",nameColumnName:"groupName",loadFunction:y},x={title:"统计页面",supportAdd:!0,addText:"新建页面"},C=(0,d.KR)(),w=(0,d.KR)(),_=(0,d.KR)(!1),F=e=>new Promise((a,t)=>{null!=C.value?(e.reportPageDtoFilter={groupId:C.value.groupId},g.aS.list(e).then(e=>{a({dataList:e.data.dataList,totalCount:e.data.totalCount})}).catch(e=>{t(e)})):a({dataList:[],totalCount:0})}),z=()=>!0,N={loadTableData:F,verifyTableParameter:z,paged:!0},S=(0,d.Kh)((0,h.K)(N)),E=(0,i.EW)(()=>Array.isArray(R.value)?(0,p.BN)(R.value.map(e=>({...e})),"groupId"):[]),G=e=>{m.l.show(e?"编辑分组":"新建分组",f["default"],{area:["600px"]},{groupId:(e||{}).groupId,groupList:E.value,path:"thirdEditReportPageGroup"},{width:"600px",height:"400px",pathName:"/thirdParty/thirdEditReportPageGroup"}).then(()=>{I.value.refreshGroup()}).catch(e=>{console.warn(e)})},B=e=>{u.s.confirm("是否删除此分组？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>g.xr.delete({groupId:e.groupId})).then(()=>{s.nk.success("删除成功！"),I.value.refreshGroup()}).catch(e=>{console.warn(e)})},L=e=>{C.value=e,D(!0)},D=(e=!1)=>{e?S.refreshTable(!0,1):S.refreshTable()},T=(e=null)=>{m.l.show("编辑报表页面",A["default"],{area:["100vw","100vh"],skin:"fullscreen-dialog"},{pageId:(e||{}).pageId,groupList:E.value,path:"thirdEditReportPage",clientHeight:k},{fullscreen:!0,pathName:"/thirdParty/thirdEditReportPage"}).then(()=>{D(!0)}).catch(e=>{D(!0),console.warn(e)})},K=e=>{u.s.confirm("是否删除此报表？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>g.aS.delete({pageId:e.pageId})).then(()=>{s.nk.success("删除成功！"),D(!0)}).catch(e=>{console.warn(e)})},W=()=>{_.value=!1,w.value=void 0,D(!0)};return a({onCloseEdit:W}),(e,a)=>{const u=(0,i.g2)("vxe-column"),s=n.S2,p=o.aQ,g=r.S2,m=l.A;return(0,i.uX)(),(0,i.Wv)(c.A,{class:"form-report-page",ref_key:"pageForm",ref:I,height:(0,d.R1)(b),treePanel:P,tablePanel:x,onEditGroupItem:G,onDeleteGroupItem:B,onRefreshTable:L,onAddTableItem:a[0]||(a[0]=e=>T())},{table:(0,i.k6)(()=>[(0,i.bF)(m,{style:{"padding-bottom":"16px"},data:(0,d.R1)(S).dataList,size:(0,d.R1)(t).defaultFormItemSize,"header-cell-class-name":"table-header-gray",height:"auto",hasExtend:!1,"seq-config":{startIndex:((0,d.R1)(S).currentPage-1)*(0,d.R1)(S).pageSize}},{pagination:(0,i.k6)(()=>[(0,i.bF)(g,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,i.k6)(()=>[(0,i.bF)(p,{total:(0,d.R1)(S).totalCount,"current-page":(0,d.R1)(S).currentPage,"page-size":(0,d.R1)(S).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,d.R1)(S).onCurrentPageChange,onSizeChange:(0,d.R1)(S).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),default:(0,i.k6)(()=>[(0,i.bF)(u,{title:"序号",type:"seq",width:"50px",index:(0,d.R1)(S).getTableIndex},null,8,["index"]),(0,i.bF)(u,{title:"页面名称",field:"pageName"}),(0,i.bF)(u,{title:"页面编码",field:"pageCode"}),(0,i.bF)(u,{title:"操作",width:"100px"},{default:(0,i.k6)(e=>[(0,i.bF)(s,{link:"",type:"primary",size:(0,d.R1)(t).defaultFormItemSize,onClick:a=>T(e.row)},{default:(0,i.k6)(()=>a[1]||(a[1]=[(0,i.eW)(" 编辑 ")])),_:2,__:[1]},1032,["size","onClick"]),(0,i.bF)(s,{link:"",type:"danger",size:(0,d.R1)(t).defaultFormItemSize,onClick:a=>K(e.row)},{default:(0,i.k6)(()=>a[2]||(a[2]=[(0,i.eW)(" 删除 ")])),_:2,__:[2]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size","seq-config"])]),_:1},8,["height"])}}}),k=t(71241);const I=(0,k.A)(b,[["__scopeId","data-v-785c5268"]]);var R=I},49742:function(e,a,t){t.d(a,{A:function(){return z}});var l=t(54880),r=(t(97042),t(51582),t(60713),t(24404),t(38840)),o=(t(95304),t(2403)),n=(t(63266),t(50942)),i=(t(8696),t(65451)),d=(t(63390),t(25136)),u=(t(69957),t(18111),t(61701),t(56768)),s=t(24232),p=t(45130),c=t(90144),g=t(66717),m=t(56439),h=t(57477),v=t(27007),f=t(82572);const A={class:"base-card-header"},b={class:"header-title"},k={class:"base-card-operation"},I=["title"],R={class:"module-node-menu",style:{"padding-right":"9px"}},y={class:"base-card-header"},P={class:"header-title"},x={class:"base-card-operation"},C={class:"advance-table-box"};var w=(0,u.pM)({__name:"index",props:{height:{},treePanel:{},tablePanel:{}},emits:["editGroupItem","refreshTable","deleteGroupItem","addTableItem"],setup(e,{expose:a,emit:t}){const w=t,_=e,F=(0,f.l5)(),z=(0,c.KR)(),N=(0,c.KR)(),S=(0,c.KR)([]),E=()=>{"function"===typeof _.treePanel.loadFunction&&_.treePanel.loadFunction().then(e=>{S.value=(0,v.BN)(e.map(e=>({...e})),_.treePanel.keyColumnName),null!=N.value&&(N.value=(0,v.PH)(e,N.value[_.treePanel.keyColumnName],_.treePanel.keyColumnName)),null==N.value&&(N.value=e[0]),setTimeout(()=>{z.value&&N.value&&z.value.setCurrentKey(N.value[_.treePanel.keyColumnName])},50)}).catch(e=>{console.warn(e)})},G=()=>{E()},B=e=>{w("editGroupItem",e)},L=e=>{N.value=e},D=e=>{w("deleteGroupItem",e)},T=()=>{w("addTableItem")};return a({refreshGroup:G}),(0,u.wB)(N,(e,a)=>{e!=a&&w("refreshTable",e)},{deep:!0}),(0,u.sV)(()=>{E()}),(e,a)=>{const t=d.S2,v=i.S2,f=n.qk,w=o.kA,_=r.Ik,N=l.Mb,E=l.ZO,K=l.lX;return(0,u.uX)(),(0,u.Wv)(K,{class:"advance-query-form advance-query advance-box"},{default:(0,u.k6)(()=>[(0,u.bF)(N,{width:"300px",style:{"background-color":"white"}},{default:(0,u.k6)(()=>[(0,u.bF)(_,{class:"base-card",shadow:"never",style:{height:"100%",border:"none"}},{header:(0,u.k6)(()=>[(0,u.Lk)("div",A,[(0,u.Lk)("span",b,(0,s.v_)(e.treePanel.title),1),(0,u.Lk)("div",k,[(0,u.bF)(t,{class:"advance-icon-btn",onClick:a[0]||(a[0]=e=>G()),style:{width:"40px",height:"32px",padding:"0"}},{default:(0,u.k6)(()=>a[3]||(a[3]=[(0,u.Lk)("img",{src:g,alt:"",style:{"vertical-align":"middle"}},null,-1)])),_:1,__:[3]}),e.treePanel.supportAdd?((0,u.uX)(),(0,u.Wv)(t,{key:0,class:"advance-icon-btn",style:{width:"40px",height:"32px",padding:"0"},onClick:a[1]||(a[1]=e=>B(null))},{default:(0,u.k6)(()=>a[4]||(a[4]=[(0,u.Lk)("img",{src:m,alt:"",style:{"vertical-align":"middle"}},null,-1)])),_:1,__:[4]})):(0,u.Q3)("",!0)])])]),default:(0,u.k6)(()=>[(0,u.bF)(w,{style:(0,s.Tr)({height:e.height-130+"px"}),class:"custom-scroll"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{ref_key:"groupTree",ref:z,data:S.value,"node-key":e.treePanel.keyColumnName,onNodeClick:L,"highlight-current":!0,"default-expand-all":!0,"auto-expand-parent":!0,"expand-on-click-node":!1},{default:(0,u.k6)(({data:a})=>[(0,u.bF)(v,{class:"tree-node-item module-node-item",type:"flex",justify:"space-between",align:"middle"},{default:(0,u.k6)(()=>[(0,u.Lk)("span",{class:"node-text",title:a[e.treePanel.nameColumnName]},(0,s.v_)(a[e.treePanel.nameColumnName]),9,I),(0,u.Lk)("div",R,[e.treePanel.supportEdit?((0,u.uX)(),(0,u.Wv)(t,{key:0,link:"",type:"primary",onClick:(0,p.D$)(e=>B(a),["stop"]),icon:(0,c.R1)(h.Edit)},null,8,["onClick","icon"])):(0,u.Q3)("",!0),e.treePanel.supportDelete?((0,u.uX)(),(0,u.Wv)(t,{key:1,link:"",type:"danger",onClick:(0,p.D$)(e=>D(a),["stop"]),icon:(0,c.R1)(h.Delete)},null,8,["onClick","icon"])):(0,u.Q3)("",!0)])]),_:2},1024)]),_:1},8,["data","node-key"])]),_:1},8,["style"])]),_:1})]),_:1}),(0,u.bF)(E,{class:"table-panel"},{default:(0,u.k6)(()=>[(0,u.bF)(_,{class:"base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none"}},{header:(0,u.k6)(()=>[(0,u.Lk)("div",y,[(0,u.Lk)("span",P,(0,s.v_)(e.tablePanel.title),1),(0,u.Lk)("div",x,[(0,u.RG)(e.$slots,"tableFilter"),e.tablePanel.supportAdd?((0,u.uX)(),(0,u.Wv)(t,{key:0,type:"primary",style:{"margin-left":"20px"},size:(0,c.R1)(F).defaultFormItemSize,icon:(0,c.R1)(h.Plus),onClick:a[2]||(a[2]=e=>T())},{default:(0,u.k6)(()=>[(0,u.eW)((0,s.v_)(e.tablePanel.addText),1)]),_:1},8,["size","icon"])):(0,u.Q3)("",!0)])])]),default:(0,u.k6)(()=>[(0,u.Lk)("div",C,[(0,u.RG)(e.$slots,"table")])]),_:3})]),_:3}),(0,u.RG)(e.$slots,"default")]),_:3})}}}),_=t(71241);const F=(0,_.A)(w,[["__scopeId","data-v-41d1c047"]]);var z=F},56439:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAKdJREFUOE9j/P//PzMDBYARnwGNjY3Mt2/f5liyZMlXXHbgNcDU1DSKgYHB+vTp09lkGWBmZhb3798/+zNnziSPBANMTExaGRgYzNH8KsHAwCDAwMBwA03845kzZ4JBYvBYsLCw0P7//78IssI/f/64MzAw6LOwsHQhizMzM385duzYWRQDsIXySIsFbGFgZWVl/ufPH/VTp04tIislEpNJ8WYmYgwAALTpjBHjM6aDAAAAAElFTkSuQmCC"},66717:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAUhJREFUOE+1k69LBEEUx79vznLZYrgg2E5hZ14w2cViMvgDBINBrDaLRTD4D4hB8NdVsYjdIsjMLqzXhAsXNGxeD3SerHjL3noexx1OnZnP+7w33yGMuWjM++gLqNfrU9VqdUNE5rICRBR3Op3LOI7ffgpOAPj43isbMPMugCMAN0T0lO2LiAawAmBPRBIAi8657V8ArfW0Uqrhvd8JwzAswrXWulKpNESkDaBtrd3qazBoJhlEKfUI4HokQAZn5gsREefcZo+BMWbZe/8SRdHzIAtm3gewYK1d6gEw8x2AB2vt4SBAEASzSqkZ59xt2eCciD67vQ2bj/wZmfkMwLqIzDvnolEBNSKqee9XyxBjTKCUOkiSZK3Var13C+QGxphTAPdENAng+K8gWWtPinbFJObx7BflNE2vms3ma7m1//lMww4wO/cF492DEX93tXEAAAAASUVORK5CYII="}}]);