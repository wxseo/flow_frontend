"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[617,1066],{21013:function(e,t,s){s.d(t,{A:function(){return i}});var r=s(55583),a=s(18384);class i extends r.w{static getUserList(e,t){return super.post(a.x+"/upms/sysUser/list",e,t)}static addUser(e,t){return super.post(a.x+"/upms/sysUser/add",e,t)}static updateUser(e,t){return super.post(a.x+"/upms/sysUser/update",e,t)}static deleteUser(e,t){return super.post(a.x+"/upms/sysUser/delete",e,t)}static viewMenu(e,t){return super.post(a.x+"/upms/sysMenu/view",e,t)}static syncAzureUser(e){return super.post(a.x+"/upms/sysUser/syncAzureUser",e)}static getUser(e,t){return super.get(a.x+"/upms/sysUser/view",e,t)}static resetUserPassword(e,t){return super.post(a.x+"/upms/sysUser/resetPassword",e,t)}static listSysPermWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysPermWithDetail",e,t)}static listSysPermCodeWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysPermCodeWithDetail",e,t)}static listSysMenuWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysMenuWithDetail",e,t)}}},54428:function(e,t,s){s.d(t,{v9:function(){return n},n5:function(){return u},lE:function(){return g},_4:function(){return h},C7:function(){return p},If:function(){return f},qY:function(){return l},ek:function(){return c},$z:function(){return d},$D:function(){return D},S_:function(){return x},fe:function(){return o},sV:function(){return m},r0:function(){return y.A}});s(18111),s(61701);var r=s(55583),a=s(52081),i=s(18384);class n extends r.w{static dictSysRole(e,t){return new Promise((s,r)=>{super.get(i.x+"/upms/sysRole/listDict",e,t).then(e=>{const t=new a.w("角色字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictGlobalDict(e,t){return new Promise((s,r)=>{super.get(i.x+"/upms/globalDict/listDict",e,t).then(e=>{const t=new a.w("编码字典",(e.data||[]).map(e=>({...e,disabled:1===e.status})));s(t)}).catch(e=>{r(e)})})}static dictGlobalDictByIds(e,t){return new Promise((s,r)=>{super.get(i.x+"/upms/globalDict/listDictByIds",e,t).then(e=>{const t=new a.w("编码字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictAllMenu(e,t){return new Promise((s,r)=>{super.get(i.x+"/upms/sysMenu/listDict",e,t).then(e=>{const t=new a.w("菜单字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysMenu(e,t){return new Promise((s,r)=>{super.get(i.x+"/upms/sysMenu/listMenuDict",e,t).then(e=>{const t=new a.w("菜单字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictDeptPost(e,t){return new Promise((s,r)=>{super.get(i.x+"/upms/sysDept/listSysDeptPostWithRelation",e,t).then(e=>{s(e.data)}).catch(e=>{r(e)})})}static dictSysPost(e,t){return new Promise((s,r)=>{super.get(i.x+"/upms/sysPost/listDict",e,t).then(e=>{const t=new a.w("岗位字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictReportDblink(e,t){return new Promise((s,r)=>{super.get(i.x+"/report/reportDblink/listDict",e,t).then(e=>{const t=new a.w("数据库链接",e.data);s(t)}).catch(e=>{r(e)})})}static dictReportDict(e,t){return new Promise((s,r)=>{super.get(i.x+"/report/reportDict/listDict",e,t).then(e=>{const t=new a.w("字典管理",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysUser(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysUser/listDict",e,t).then(e=>{let t=new a.w("用户字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysDept(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysDept/listDict",e,t).then(e=>{let t=new a.w("部门字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysDeptByParentId(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysDept/listDictByParentId",e,t).then(e=>{let t=new a.w("部门字典",e.data);s(t)}).catch(e=>{r(e)})})}}class u extends r.w{static listSysLoginUser(e,t){return super.post(i.x+"/upms/loginUser/list",e,t)}static deleteSysLoginUser(e,t){return super.post(i.x+"/upms/loginUser/delete",e,t)}}class o extends r.w{static getMenuPermList(e,t){return super.post(i.x+"/upms/sysMenu/list",e,t)}static addMenu(e,t){return super.post(i.x+"/upms/sysMenu/add",e,t)}static updateMenu(e,t){return super.post(i.x+"/upms/sysMenu/update",e,t)}static deleteMenu(e,t){return super.post(i.x+"/upms/sysMenu/delete",e,t)}static viewMenu(e,t){return super.get(i.x+"/upms/sysMenu/view",e,t)}static listMenuPermCode(e,t){return super.get(i.x+"/upms/sysMenu/listMenuPerm",e,t)}static listSysPermByMenuIdWithDetail(e,t){return super.get(i.x+"/upms/sysMenu/listSysPermWithDetail",e,t)}static listSysUserByMenuIdWithDetail(e,t){return super.get(i.x+"/upms/sysMenu/listSysUserWithDetail",e,t)}}class l extends r.w{static updateSysConf(e,t){return super.post(i.x+"/upms/sysConf/update",e,t)}static getSysConf(e,t){return super.get(i.x+"/upms/sysConf/view",e,t)}}class p extends r.w{static getPermCodeList(e,t){return super.get(i.x+"/upms/login/getAllPermCodes",e,t)}}class c extends r.w{static add(e,t){return super.post(i.x+"/upms/sysDataPerm/add",e,t)}static update(e,t){return super.post(i.x+"/upms/sysDataPerm/update",e,t)}static delete(e,t){return super.post(i.x+"/upms/sysDataPerm/delete",e,t)}static list(e,t){return super.post(i.x+"/upms/sysDataPerm/list",e,t)}static view(e,t){return super.get(i.x+"/upms/sysDataPerm/view",e,t)}static listDataPermUser(e,t){return super.post(i.x+"/upms/sysDataPerm/listDataPermUser",e,t)}static addDataPermUser(e,t){return super.post(i.x+"/upms/sysDataPerm/addDataPermUser",e,t)}static deleteDataPermUser(e,t){return super.post(i.x+"/upms/sysDataPerm/deleteDataPermUser",e,t)}static listNotInDataPermUser(e,t){return super.post(i.x+"/upms/sysDataPerm/listNotInDataPermUser",e,t)}}class d extends r.w{static list(e,t){return super.post(i.x+"/upms/sysDept/list",e,t)}static view(e,t){return super.get(i.x+"/upms/sysDept/view",e,t)}static export(e,t){return super.download(i.x+"/upms/sysDept/export",e,t)}static add(e,t){return super.post(i.x+"/upms/sysDept/add",e,t)}static update(e,t){return super.post(i.x+"/upms/sysDept/update",e,t)}static delete(e,t){return super.post(i.x+"/upms/sysDept/delete",e,t)}static listNotInSysDeptPost(e,t){return super.post(i.x+"/upms/sysDept/listNotInSysDeptPost",e,t)}static listSysDeptPost(e,t){return super.post(i.x+"/upms/sysDept/listSysDeptPost",e,t)}static addSysDeptPost(e,t){return super.post(i.x+"/upms/sysDept/addSysDeptPost",e,t)}static updateSysDeptPost(e,t){return super.post(i.x+"/upms/sysDept/updateSysDeptPost",e,t)}static deleteSysDeptPost(e,t){return super.post(i.x+"/upms/sysDept/deleteSysDeptPost",e,t)}static viewSysDeptPost(e,t){return super.get(i.x+"/upms/sysDept/viewSysDeptPost",e,t)}}class m extends r.w{static getRoleList(e,t){return super.post(i.x+"/upms/sysRole/list",e,t)}static getRole(e,t){return super.get(i.x+"/upms/sysRole/view",e,t)}static deleteRole(e,t){return super.post(i.x+"/upms/sysRole/delete",e,t)}static addRole(e,t){return super.post(i.x+"/upms/sysRole/add",e,t)}static updateRole(e,t){return super.post(i.x+"/upms/sysRole/update",e,t)}static listRoleUser(e,t){return super.post(i.x+"/upms/sysRole/listUserRole",e,t)}static listNotInUserRole(e,t){return super.post(i.x+"/upms/sysRole/listNotInUserRole",e,t)}static addRoleUser(e,t){return super.post(i.x+"/upms/sysRole/addUserRole",e,t)}static deleteRoleUser(e,t){return super.post(i.x+"/upms/sysRole/deleteUserRole",e,t)}}var y=s(21013);class x extends r.w{static list(e,t){return super.post(i.x+"/upms/sysPost/list",e,t)}static view(e,t){return super.get(i.x+"/upms/sysPost/view",e,t)}static add(e,t){return super.post(i.x+"/upms/sysPost/add",e,t)}static update(e,t){return super.post(i.x+"/upms/sysPost/update",e,t)}static delete(e,t){return super.post(i.x+"/upms/sysPost/delete",e,t)}}class g extends r.w{static list(e,t){return super.post(i.x+"/mobile/mobileEntry/list",e,t)}static view(e,t){return super.get(i.x+"/mobile/mobileEntry/view",e,t)}static add(e,t){return super.post(i.x+"/mobile/mobileEntry/add",e,t)}static update(e,t){return super.post(i.x+"/mobile/mobileEntry/update",e,t)}static delete(e,t){return super.post(i.x+"/mobile/mobileEntry/delete",e,t)}static uploadImage(e,t){return super.post(i.x+"/mobile/mobileEntry/uploadImage",e,t)}static downloadImage(e,t){return super.post(i.x+"/mobile/mobileEntry/downloadImage",e,t)}}var w=s(53155);class D{static list(e,t){return(0,w.bE)(i.x+"/upms/globalDict/list",e,t)}static listAll(e,t){return(0,w.Jt)(i.x+"/upms/globalDict/listAll",e,t)}static add(e,t){return(0,w.bE)(i.x+"/upms/globalDict/add",e,t)}static update(e,t){return(0,w.bE)(i.x+"/upms/globalDict/update",e,t)}static delete(e,t){return(0,w.bE)(i.x+"/upms/globalDict/delete",e,t)}static addItem(e,t){return(0,w.bE)(i.x+"/upms/globalDict/addItem",e,t)}static updateItem(e,t){return(0,w.bE)(i.x+"/upms/globalDict/updateItem",e,t)}static updateItemStatus(e,t){return(0,w.bE)(i.x+"/upms/globalDict/updateItemStatus",e,t)}static deleteItem(e,t){return(0,w.bE)(i.x+"/upms/globalDict/deleteItem",e,t)}static reloadCachedData(e,t){return(0,w.Jt)(i.x+"/upms/globalDict/reloadCachedData",e,t)}}class h extends r.w{static listSysOperationLog(e,t){return super.post(i.x+"/upms/sysOperationLog/list",e,t)}}class f extends r.w{static list(e,t){return super.post(i.x+"/commonext/bizwidget/list",e,t)}static viewByIds(e,t){return super.post(i.x+"/commonext/bizwidget/view",e,t)}}},71066:function(e,t,s){s.d(t,{P:function(){return u},i:function(){return o}});var r=s(81387),a=s(27007),i=s(56768),n=s(90144);const u=e=>{console.log("接收到的第三方参数",e);const t=(0,n.KR)(0),s=(0,i.EW)(()=>{let t={};try{e.thirdParamsString&&(t=JSON.parse(e.thirdParamsString))}catch(s){console.log(s),t={}}return t});console.log("thirdParams",s);const r=(r,a,i)=>{console.log("onCloseThirdDialog",a,i),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:t.value,dialogKey:e.dialogKey,path:s.value.path,rowData:a?JSON.parse(JSON.stringify(a)):void 0,data:i?JSON.parse(JSON.stringify(i)):void 0,isSuccess:r}},"*")},u=(e,s)=>{switch(e){case"setToken":s.token&&(0,a.WG)(s.token);break;case"dialogIndex":t.value=s;break;case"refreshData":break;case"message":break}},o=e=>{u(e.data.type,e.data.data)};return(0,i.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",o,!1)}),(0,i.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",o)}),{thirdParams:s,onCloseThirdDialog:r}},o=()=>{let e;const t=(0,r.lq)(),s=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==t.path.indexOf("/thirdParty/")&&((0,i.sV)(()=>{(0,a.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),s()},18e4))}),(0,i.hi)(()=>{e&&clearInterval(e)}))}},93879:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var r=s(65451),a=(s(97042),s(63390),s(25136)),i=(s(19784),s(69957),s(18111),s(20116),s(7588),s(56768)),n=s(45130),u=s(90144),o=s(24232),l=s(57477),p=s(26695),c=s(47887),d=s(64772),m=s(22414),y=s(71066);const x={class:"process-viewer",style:{height:"640px"}},g={style:{position:"absolute",top:"0",left:"0",width:"100%"}};var w=(0,i.pM)({__name:"userTaskSelectDlg",props:{xml:{},finishedInfo:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:s,onCloseThirdDialog:w}=(0,y.P)(t),D=(0,u.KR)(),h=(0,u.KR)(),f=(0,u.KR)(1),b=(0,u.KR)(!0);let v=null,P=(0,u.KR)();const R=(0,u.KR)(),k=(0,u.KR)(m.DiagramType.ORDINARY),S=(0,i.EW)(()=>({xml:t.xml||s.value.xml,finishedInfo:t.finishedInfo||s.value.finishedInfo})),I=()=>{f.value=1,v?.get("canvas").zoom("fit-viewport","auto")},U=(e=.1)=>{let t=Math.floor(100*f.value+100*e)/100;if(t>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");f.value=t,v?.get("canvas").zoom(f.value)},M=(e=.1)=>{let t=Math.floor(100*f.value-100*e)/100;if(t<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");f.value=t,v?.get("canvas").zoom(f.value)},E=()=>{D.value&&(D.value.innerHTML=""),v&&v.destroy(),v=null},L=e=>{null!=e&&null!=e.businessObject&&"bpmn:Process"!==e.type&&("bpmn:UserTask"===e.type?(P.value={taskId:e.businessObject.id,taskName:e.businessObject.name},t.dialog?t.dialog.submit(P.value):w(!0,void 0,P.value)):p.nk.warning("请选择用户任务节点！"))},C=e=>{if(R.value=e,b.value||!R.value||!v)return;let{finishedSequenceFlowSet:t,finishedTaskSet:s,unfinishedTaskSet:r}=R.value;const a=v.get("canvas"),i=v.get("elementRegistry");Array.isArray(t)&&t.forEach(e=>{if(null!=e){let t=i.get(e);if(null!=t){a.addMarker(e,"success");const s=t.businessObject.conditionExpression;s&&a.addMarker(e,"condition-expression")}}}),Array.isArray(s)&&s.forEach(e=>{if(null!=e){let t=i.get(e);t&&a.addMarker(e,"success")}}),Array.isArray(r)&&r.forEach(e=>{if(null!=e){let t=i.get(e);t&&a.addMarker(e,"current")}})},O=async e=>{if(E(),e)try{v=new c.A({container:D.value}),v?.on("element.click",({element:e})=>{L(e)}),b.value=!0,await(v?.importXML(e));const t=v?.get("elementRegistry").find(e=>"bpmn:Process"===e.type);t?.businessObject?.extensionElements?.values&&t.businessObject.extensionElements.values.forEach(e=>{"flowable:properties"!==e.$type&&"flowable:properties"!==e.$type||(e.values||e.$children).forEach(e=>{"$OrangeDiagramType"===e.name&&(k.value=e.value||0)})})}catch(t){console.error(t),E()}finally{b.value=!1,(0,i.dY)(()=>{C(S.value.finishedInfo)})}};return(0,i.hi)(()=>{E()}),(0,i.wB)(()=>S.value.xml,e=>{setTimeout(()=>{O(e).then(()=>{I()}).catch(e=>{console.warn(e)})},30)},{immediate:!0}),(e,t)=>{const s=a.S2,p=a.fg,c=r.S2;return(0,i.uX)(),(0,i.CE)("div",x,[(0,i.bo)((0,i.Lk)("div",{class:"process-canvas",style:{height:"100%"},ref_key:"processCanvas",ref:D},null,512),[[n.aG,!(0,u.R1)(b)&&(0,u.R1)(k)==(0,u.R1)(m.DiagramType).ORDINARY]]),!(0,u.R1)(b)&&(0,u.R1)(v)&&(0,u.R1)(k)==(0,u.R1)(m.DiagramType).DINGDING?((0,i.uX)(),(0,i.Wv)(d.A,{key:0,bpmnModeler:(0,u.R1)(v),onElementClick:L,readonly:!0,finishedInfo:(0,u.R1)(S).finishedInfo},null,8,["bpmnModeler","finishedInfo"])):(0,i.Q3)("",!0),(0,i.Lk)("defs",{ref_key:"customDefs",ref:h},t[3]||(t[3]=[(0,i.Lk)("marker",{id:"sequenceflow-end-white-success",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"},[(0,i.Lk)("path",{class:"success-arrow",d:"M 1 5 L 11 10 L 1 15 Z",style:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"}})],-1),(0,i.Lk)("marker",{id:"conditional-flow-marker-white-success",viewBox:"0 0 20 20",refX:"-1",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"},[(0,i.Lk)("path",{class:"success-conditional",d:"M 0 10 L 8 6 L 16 10 L 8 14 Z",style:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"}})],-1)]),512),(0,i.bo)((0,i.Lk)("div",g,[(0,i.bF)(c,{type:"flex",justify:"end"},{default:(0,i.k6)(()=>[(0,i.bF)(p,{key:"scale-control",size:"default"},{default:(0,i.k6)(()=>[(0,i.bF)(s,{size:"default",type:"default",plain:!0,disabled:(0,u.R1)(f)<=.3,icon:(0,u.R1)(l.ZoomOut),onClick:t[0]||(t[0]=e=>M())},null,8,["disabled","icon"]),(0,i.bF)(s,{size:"default",type:"default",style:{width:"90px"}},{default:(0,i.k6)(()=>[(0,i.eW)((0,o.v_)(Math.floor(10*(0,u.R1)(f)*10)+"%"),1)]),_:1}),(0,i.bF)(s,{size:"default",type:"default",plain:!0,disabled:(0,u.R1)(f)>=3.9,icon:(0,u.R1)(l.ZoomIn),onClick:t[1]||(t[1]=e=>U())},null,8,["disabled","icon"]),(0,i.bF)(s,{size:"default",type:"default",icon:(0,u.R1)(l.ScaleToOriginal),onClick:t[2]||(t[2]=e=>I())},null,8,["icon"]),(0,i.RG)(e.$slots,"default")]),_:3})]),_:3})],512),[[n.aG,(0,u.R1)(k)==(0,u.R1)(m.DiagramType).ORDINARY]])])}}});const D=w;var h=D}}]);