"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,1720],{21720:function(e,a,t){t.r(a),t.d(a,{default:function(){return h}});var l=t(25136),o=(t(97042),t(69957),t(21929)),r=(t(98421),t(65451)),i=(t(63390),t(76408)),s=(t(87535),t(32465),t(14022)),n=(t(72343),t(56768)),d=t(90144),u=t(45130),c=t(71066),g=t(82572);const m={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var f=(0,n.pM)({__name:"EditFormField",props:{rowData:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const a=(0,g.l5)(),t=e,f=(0,n.EW)(()=>a.defaultFormItemSize||p.value.defaultFormItemSize?.value),{thirdParams:p,onCloseThirdDialog:h}=(0,c.P)(t),v=(0,d.KR)(),w=(0,d.KR)({fieldName:void 0}),b={fieldName:[{required:!0,message:"字段名称不能为空",trigger:"blur"}]},k=()=>{t.dialog?t.dialog.cancel():h(!1)},y=()=>{v.value.validate(e=>{e&&(t.dialog?t.dialog.submit(w.value.fieldName):h(!0,D.value.rowData,w.value.fieldName))})},D=(0,n.EW)(()=>({rowData:t.rowData||p.value.rowData}));return(0,n.sV)(()=>{D.value.rowData&&(w.value={...D.value.rowData})}),(e,a)=>{const t=s.WK,c=o.xE,g=i.uD,p=r.S2,h=o.US,D=l.S2;return(0,n.uX)(),(0,n.CE)("div",m,[(0,n.bF)(h,{ref_key:"form",ref:v,model:(0,d.R1)(w),class:"full-width-input form-box",rules:b,style:{width:"100%"},"label-width":"80px",size:(0,d.R1)(f),"label-position":"right",onSubmit:a[1]||(a[1]=(0,u.D$)(()=>{},["prevent"]))},{default:(0,n.k6)(()=>[(0,n.bF)(p,null,{default:(0,n.k6)(()=>[(0,n.bF)(g,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(c,{label:"字段名称",prop:"fieldName"},{default:(0,n.k6)(()=>[(0,n.bF)(t,{class:"input-item",modelValue:(0,d.R1)(w).fieldName,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,d.R1)(w).fieldName=e),clearable:!0,placeholder:"表单自定义字段名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,n.bF)(p,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{size:(0,d.R1)(f),plain:!0,onClick:k},{default:(0,n.k6)(()=>a[2]||(a[2]=[(0,n.eW)(" 取消 ")])),_:1,__:[2]},8,["size"]),(0,n.bF)(D,{type:"primary",size:(0,d.R1)(f),onClick:y},{default:(0,n.k6)(()=>a[3]||(a[3]=[(0,n.eW)(" 保存 ")])),_:1,__:[3]},8,["size"])]),_:1})])}}});const p=f;var h=p},71066:function(e,a,t){t.d(a,{P:function(){return s},i:function(){return n}});var l=t(81387),o=t(27007),r=t(56768),i=t(90144);const s=e=>{console.log("接收到的第三方参数",e);const a=(0,i.KR)(0),t=(0,r.EW)(()=>{let a={};try{e.thirdParamsString&&(a=JSON.parse(e.thirdParamsString))}catch(t){console.log(t),a={}}return a});console.log("thirdParams",t);const l=(l,o,r)=>{console.log("onCloseThirdDialog",o,r),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:a.value,dialogKey:e.dialogKey,path:t.value.path,rowData:o?JSON.parse(JSON.stringify(o)):void 0,data:r?JSON.parse(JSON.stringify(r)):void 0,isSuccess:l}},"*")},s=(e,t)=>{switch(e){case"setToken":t.token&&(0,o.WG)(t.token);break;case"dialogIndex":a.value=t;break;case"refreshData":break;case"message":break}},n=e=>{s(e.data.type,e.data.data)};return(0,r.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",n,!1)}),(0,r.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",n)}),{thirdParams:t,onCloseThirdDialog:l}},n=()=>{let e;const a=(0,l.lq)(),t=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==a.path.indexOf("/thirdParty/")&&((0,r.sV)(()=>{(0,o.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),t()},18e4))}),(0,r.hi)(()=>{e&&clearInterval(e)}))}}}]);