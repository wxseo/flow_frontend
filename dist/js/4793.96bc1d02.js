"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,4793],{34436:function(e,l,t){t.d(l,{wc:function(){return r}});var a=t(24232);const n=100,u=600,r={beforeMount(e,l){const t=l.value,{interval:r=n,delay:o=u}=(0,a.Tn)(t)?{}:t;let i,s;const d=()=>(0,a.Tn)(t)?t():t.handler(),m=()=>{s&&(clearTimeout(s),s=void 0),i&&(clearInterval(i),i=void 0)};e.addEventListener("mousedown",e=>{0===e.button&&(m(),d(),document.addEventListener("mouseup",()=>m(),{once:!0}),s=setTimeout(()=>{i=setInterval(()=>{d()},r)},o))})}}},53629:function(e,l,t){t.d(l,{W:function(){return s},c:function(){return d}});var a=t(16032),n=t(47378),u=t(53845),r=t(12235),o=t(58501),i=t(92056);const s=(0,n.b_)({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.MAX_SAFE_INTEGER},min:{type:Number,default:Number.MIN_SAFE_INTEGER},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:u.mU,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||(0,r.Et)(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...(0,o.l)(["ariaLabel"]),inputmode:{type:(0,n.jq)(String),default:void 0}}),d={[i.YU]:(e,l)=>l!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[i.qs]:e=>(0,r.Et)(e)||(0,a.A)(e),[i.l4]:e=>(0,r.Et)(e)||(0,a.A)(e)}},71066:function(e,l,t){t.d(l,{P:function(){return o},i:function(){return i}});var a=t(81387),n=t(27007),u=t(56768),r=t(90144);const o=e=>{console.log("接收到的第三方参数",e);const l=(0,r.KR)(0),t=(0,u.EW)(()=>{let l={};try{e.thirdParamsString&&(l=JSON.parse(e.thirdParamsString))}catch(t){console.log(t),l={}}return l});console.log("thirdParams",t);const a=(a,n,u)=>{console.log("onCloseThirdDialog",n,u),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:l.value,dialogKey:e.dialogKey,path:t.value.path,rowData:n?JSON.parse(JSON.stringify(n)):void 0,data:u?JSON.parse(JSON.stringify(u)):void 0,isSuccess:a}},"*")},o=(e,t)=>{switch(e){case"setToken":t.token&&(0,n.WG)(t.token);break;case"dialogIndex":l.value=t;break;case"refreshData":break;case"message":break}},i=e=>{o(e.data.type,e.data.data)};return(0,u.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",i,!1)}),(0,u.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",i)}),{thirdParams:t,onCloseThirdDialog:a}},i=()=>{let e;const l=(0,a.lq)(),t=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==l.path.indexOf("/thirdParty/")&&((0,u.sV)(()=>{(0,n.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),t()},18e4))}),(0,u.hi)(()=>{e&&clearInterval(e)}))}},77649:function(e,l,t){t.d(l,{lq:function(){return I}});var a=t(56768),n=t(90144),u=t(24232),r=t(45130),o=t(16032),i=t(14022),s=t(91542),d=t(57477),m=t(53629),c=t(99077),p=t(34436),v=t(36268),b=t(93513),f=t(44216),h=t(12235),g=t(86894),y=t(37207),N=t(92056);const R=(0,a.pM)({name:"ElInputNumber"}),w=(0,a.pM)({...R,props:m.W,emits:m.c,setup(e,{expose:l,emit:t}){const m=e,{t:c}=(0,v.Ym)(),R=(0,b.DU)("input-number"),w=(0,n.KR)(),k=(0,n.Kh)({currentValue:m.modelValue,userInput:null}),{formItem:E}=(0,f.j)(),I=(0,a.EW)(()=>(0,h.Et)(m.modelValue)&&m.modelValue<=m.min),V=(0,a.EW)(()=>(0,h.Et)(m.modelValue)&&m.modelValue>=m.max),_=(0,a.EW)(()=>{const e=C(m.step);return(0,h.b0)(m.precision)?Math.max(C(m.modelValue),e):(e>m.precision&&(0,g.U)("InputNumber","precision should not be less than the decimal places of step"),m.precision)}),x=(0,a.EW)(()=>m.controls&&"right"===m.controlsPosition),W=(0,y.NV)(),F=(0,y.CB)(),S=(0,a.EW)(()=>{if(null!==k.userInput)return k.userInput;let e=k.currentValue;if((0,o.A)(e))return"";if((0,h.Et)(e)){if(Number.isNaN(e))return"";(0,h.b0)(m.precision)||(e=e.toFixed(m.precision))}return e}),A=(e,l)=>{if((0,h.b0)(l)&&(l=_.value),0===l)return Math.round(e);let t=String(e);const a=t.indexOf(".");if(-1===a)return e;const n=t.replace(".","").split(""),u=n[a+l];if(!u)return e;const r=t.length;return"5"===t.charAt(r-1)&&(t=`${t.slice(0,Math.max(0,r-1))}6`),Number.parseFloat(Number(t).toFixed(l))},C=e=>{if((0,o.A)(e))return 0;const l=e.toString(),t=l.indexOf(".");let a=0;return-1!==t&&(a=l.length-t-1),a},D=(e,l=1)=>(0,h.Et)(e)?e>=Number.MAX_SAFE_INTEGER&&1===l?((0,g.U)("InputNumber","The value has reached the maximum safe integer limit."),e):e<=Number.MIN_SAFE_INTEGER&&-1===l?((0,g.U)("InputNumber","The value has reached the minimum safe integer limit."),e):A(e+m.step*l):k.currentValue,T=()=>{if(m.readonly||F.value||V.value)return;const e=Number(S.value)||0,l=D(e);U(l),t(N.qs,k.currentValue),B()},K=()=>{if(m.readonly||F.value||I.value)return;const e=Number(S.value)||0,l=D(e,-1);U(l),t(N.qs,k.currentValue),B()},L=(e,l)=>{const{max:a,min:n,step:r,precision:i,stepStrictly:s,valueOnClear:d}=m;a<n&&(0,g.$)("InputNumber","min should not be greater than max.");let c=Number(e);if((0,o.A)(e)||Number.isNaN(c))return null;if(""===e){if(null===d)return null;c=(0,u.Kg)(d)?{min:n,max:a}[d]:d}return s&&(c=A(Math.round(c/r)*r,i),c!==e&&l&&t(N.l4,c)),(0,h.b0)(i)||(c=A(c,i)),(c>a||c<n)&&(c=c>a?a:n,l&&t(N.l4,c)),c},U=(e,l=!0)=>{var a;const n=k.currentValue,u=L(e);l?n===u&&e||(k.userInput=null,t(N.l4,u),n!==u&&t(N.YU,u,n),m.validateEvent&&(null==(a=null==E?void 0:E.validate)||a.call(E,"change").catch(e=>(0,g.U)(e))),k.currentValue=u):t(N.l4,u)},M=e=>{k.userInput=e;const l=""===e?null:Number(e);t(N.qs,l),U(l,!1)},P=e=>{const l=""!==e?Number(e):"";((0,h.Et)(l)&&!Number.isNaN(l)||""===e)&&U(l),B(),k.userInput=null},X=()=>{var e,l;null==(l=null==(e=w.value)?void 0:e.focus)||l.call(e)},$=()=>{var e,l;null==(l=null==(e=w.value)?void 0:e.blur)||l.call(e)},z=e=>{t("focus",e)},q=e=>{var l,a;k.userInput=null,null===k.currentValue&&(null==(l=w.value)?void 0:l.input)&&(w.value.input.value=""),t("blur",e),m.validateEvent&&(null==(a=null==E?void 0:E.validate)||a.call(E,"blur").catch(e=>(0,g.U)(e)))},B=()=>{k.currentValue!==m.modelValue&&(k.currentValue=m.modelValue)},G=e=>{document.activeElement===e.target&&e.preventDefault()};return(0,a.wB)(()=>m.modelValue,(e,l)=>{const t=L(e,!0);null===k.userInput&&t!==l&&(k.currentValue=t)},{immediate:!0}),(0,a.sV)(()=>{var e;const{min:l,max:a,modelValue:n}=m,u=null==(e=w.value)?void 0:e.input;if(u.setAttribute("role","spinbutton"),Number.isFinite(a)?u.setAttribute("aria-valuemax",String(a)):u.removeAttribute("aria-valuemax"),Number.isFinite(l)?u.setAttribute("aria-valuemin",String(l)):u.removeAttribute("aria-valuemin"),u.setAttribute("aria-valuenow",k.currentValue||0===k.currentValue?String(k.currentValue):""),u.setAttribute("aria-disabled",String(F.value)),!(0,h.Et)(n)&&null!=n){let e=Number(n);Number.isNaN(e)&&(e=null),t(N.l4,e)}u.addEventListener("wheel",G,{passive:!1})}),(0,a.$u)(()=>{var e,l;const t=null==(e=w.value)?void 0:e.input;null==t||t.setAttribute("aria-valuenow",`${null!=(l=k.currentValue)?l:""}`)}),l({focus:X,blur:$}),(e,l)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,u.C4)([(0,n.R1)(R).b(),(0,n.R1)(R).m((0,n.R1)(W)),(0,n.R1)(R).is("disabled",(0,n.R1)(F)),(0,n.R1)(R).is("without-controls",!e.controls),(0,n.R1)(R).is("controls-right",(0,n.R1)(x))]),onDragstart:(0,r.D$)(()=>{},["prevent"])},[e.controls?(0,a.bo)(((0,a.uX)(),(0,a.CE)("span",{key:0,role:"button","aria-label":(0,n.R1)(c)("el.inputNumber.decrease"),class:(0,u.C4)([(0,n.R1)(R).e("decrease"),(0,n.R1)(R).is("disabled",(0,n.R1)(I))]),onKeydown:(0,r.jR)(K,["enter"])},[(0,a.RG)(e.$slots,"decrease-icon",{},()=>[(0,a.bF)((0,n.R1)(s.tk),null,{default:(0,a.k6)(()=>[(0,n.R1)(x)?((0,a.uX)(),(0,a.Wv)((0,n.R1)(d.ArrowDown),{key:0})):((0,a.uX)(),(0,a.Wv)((0,n.R1)(d.Minus),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[(0,n.R1)(p.wc),K]]):(0,a.Q3)("v-if",!0),e.controls?(0,a.bo)(((0,a.uX)(),(0,a.CE)("span",{key:1,role:"button","aria-label":(0,n.R1)(c)("el.inputNumber.increase"),class:(0,u.C4)([(0,n.R1)(R).e("increase"),(0,n.R1)(R).is("disabled",(0,n.R1)(V))]),onKeydown:(0,r.jR)(T,["enter"])},[(0,a.RG)(e.$slots,"increase-icon",{},()=>[(0,a.bF)((0,n.R1)(s.tk),null,{default:(0,a.k6)(()=>[(0,n.R1)(x)?((0,a.uX)(),(0,a.Wv)((0,n.R1)(d.ArrowUp),{key:0})):((0,a.uX)(),(0,a.Wv)((0,n.R1)(d.Plus),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[(0,n.R1)(p.wc),T]]):(0,a.Q3)("v-if",!0),(0,a.bF)((0,n.R1)(i.WK),{id:e.id,ref_key:"input",ref:w,type:"number",step:e.step,"model-value":(0,n.R1)(S),placeholder:e.placeholder,readonly:e.readonly,disabled:(0,n.R1)(F),size:(0,n.R1)(W),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,inputmode:e.inputmode,onKeydown:[(0,r.jR)((0,r.D$)(T,["prevent"]),["up"]),(0,r.jR)((0,r.D$)(K,["prevent"]),["down"])],onBlur:q,onFocus:z,onInput:M,onChange:P},(0,a.eX)({_:2},[e.$slots.prefix?{name:"prefix",fn:(0,a.k6)(()=>[(0,a.RG)(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:(0,a.k6)(()=>[(0,a.RG)(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","inputmode","onKeydown"])],42,["onDragstart"]))}});var k=(0,c.A)(w,[["__file","input-number.vue"]]),E=t(25376);const I=(0,E.GU)(k)},84793:function(e,l,t){t.r(l),t.d(l,{default:function(){return w}});var a=t(25136),n=(t(97042),t(69957),t(21929)),u=(t(98421),t(77649)),r=(t(87603),t(14022)),o=(t(72343),t(76408)),i=(t(87535),t(32465),t(18888)),s=(t(3172),t(85415)),d=(t(22243),t(7409),t(65451)),m=(t(63390),t(18111),t(22489),t(20116),t(61701),t(56768)),c=t(90144),p=t(45130),v=t(24232),b=t(27007),f=t(92380),h=t(71066),g=t(82572);const y={key:1};var N=(0,m.pM)({__name:"editDataViewTableColumn",props:{rowData:{},columnList:{},dataset:{},supportColumnWidth:{type:Boolean,default:!1},defaultFormItemSize:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,g.l5)(),t=e,N=(0,m.EW)(()=>l.defaultFormItemSize),{thirdParams:R,onCloseThirdDialog:w}=(0,h.P)(t),k=(0,c.KR)(),E=(0,c.KR)({columnId:void 0,columnName:void 0,columnWidth:void 0}),I={columnId:[{required:!0,message:"字段名称不能为空",trigger:"blur"}],showName:[{required:!0,message:"显示名称不能为空",trigger:"blur"}]},V=(0,m.EW)(()=>W.value.dataset.datasetType===f.DatasetType.API),_=(0,m.EW)(()=>{let e=W.value.columnList.map(e=>({...e}));return(0,b.BN)(e,"columnId")}),x=(0,m.EW)(()=>null==E.value.columnId||""===E.value.columnId?[]:(0,b.Zi)(_.value,E.value.columnId,"columnId")),W=(0,m.EW)(()=>({rowData:t.rowData||R.value.rowData,dataset:t.dataset||R.value.dataset||{},supportColumnWidth:R&&null!=R.value.supportColumnWidth?R.value.supportColumnWidth:t.supportColumnWidth,columnList:(t.columnList||R.value.columnList||[]).map(e=>({...e,children:void 0}))})),F=()=>{t.dialog?t.dialog.cancel():w(!1)},S=()=>{k.value.validate(e=>{e&&(t.dialog?t.dialog.submit(E.value):w(!0,W.value.rowData,E.value))})},A=e=>{E.value.columnId=Array.isArray(e)?e[e.length-1]:void 0},C=e=>{let l=(0,b.PH)(W.value.columnList,Array.isArray(e)?e[e.length-1]:e,"columnId");if(Array.isArray(e)&&e.length>0){let l=e.map((e,l)=>{let t=null;return l>0&&(t=W.value.columnList.find(l=>l.columnId===e)),t}).filter(e=>null!=e);E.value.columnName=l.map(e=>e.columnName)}else null!=l&&(E.value.columnName=l.columnName)};return(0,m.sV)(()=>{null!=W.value.rowData&&(E.value={...W.value.rowData})}),(e,l)=>{const t=d.S2,b=s.P9,f=s.AV,h=i._m,g=n.xE,R=o.uD,w=r.WK,D=u.lq,T=n.US,K=a.S2;return(0,m.uX)(),(0,m.Wv)(t,{class:"form-edit-widget-categroy-column third-party-dlg"},{default:(0,m.k6)(()=>[(0,m.bF)(T,{ref_key:"formEditWidgetCategroyColumn",ref:k,model:(0,c.R1)(E),class:"full-width-input form-box",rules:I,style:{width:"100%"},"label-width":"80px",size:(0,c.R1)(N),"label-position":"right",onSubmit:l[3]||(l[3]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,m.k6)(()=>[(0,m.bF)(t,{gutter:20},{default:(0,m.k6)(()=>[(0,m.bF)(R,{span:24},{default:(0,m.k6)(()=>[(0,m.bF)(g,{label:"字段名称",prop:"columnId"},{default:(0,m.k6)(()=>[(0,c.R1)(V)?((0,m.uX)(),(0,m.CE)("div",y,[(0,m.bF)(h,{options:(0,c.R1)(_),placeholder:"",clearable:"",modelValue:(0,c.R1)(x),"onUpdate:modelValue":A,disabled:null!=(0,c.R1)(W).rowData,props:{label:"columnName",value:"columnId"},onChange:C},{default:(0,m.k6)(({data:e})=>[(0,m.bF)(t,{type:"flex",justify:"space-between",align:"middle"},{default:(0,m.k6)(()=>[(0,m.Lk)("span",null,(0,v.v_)(e.columnName),1)]),_:2},1024)]),_:1},8,["options","modelValue","disabled"])])):((0,m.uX)(),(0,m.Wv)(f,{key:0,modelValue:(0,c.R1)(E).columnId,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.R1)(E).columnId=e),placeholder:"",clearable:"",disabled:null!=(0,c.R1)(W).rowData,onChange:C},{default:(0,m.k6)(()=>[((0,m.uX)(!0),(0,m.CE)(m.FK,null,(0,m.pI)((0,c.R1)(W).columnList,e=>((0,m.uX)(),(0,m.Wv)(b,{key:e.columnId,label:e.columnName,value:e.columnId,disabled:e.disabled},{default:(0,m.k6)(()=>[(0,m.bF)(t,{type:"flex",justify:"space-between",align:"middle"},{default:(0,m.k6)(()=>[(0,m.Lk)("span",null,(0,v.v_)(e.columnName),1)]),_:2},1024)]),_:2},1032,["label","value","disabled"]))),128))]),_:1},8,["modelValue","disabled"]))]),_:1})]),_:1}),(0,m.bF)(R,{span:24},{default:(0,m.k6)(()=>[(0,m.bF)(g,{label:"显示名称",prop:"showName"},{default:(0,m.k6)(()=>[(0,m.bF)(w,{modelValue:(0,c.R1)(E).showName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.R1)(E).showName=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,m.bF)(R,{span:24},{default:(0,m.k6)(()=>[(0,m.bF)(g,{label:"表格列宽",prop:"columnWidth"},{default:(0,m.k6)(()=>[(0,m.bF)(D,{class:"input-item",modelValue:(0,c.R1)(E).columnWidth,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.R1)(E).columnWidth=e),placeholder:"表格列宽"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,m.bF)(t,{class:"no-scroll menu-box",type:"flex",justify:"end"},{default:(0,m.k6)(()=>[(0,m.bF)(K,{size:(0,c.R1)(N),plain:!0,onClick:F},{default:(0,m.k6)(()=>l[4]||(l[4]=[(0,m.eW)(" 取消 ")])),_:1,__:[4]},8,["size"]),(0,m.bF)(K,{type:"primary",size:(0,c.R1)(N),onClick:S},{default:(0,m.k6)(()=>l[5]||(l[5]=[(0,m.eW)(" 保存 ")])),_:1,__:[5]},8,["size"])]),_:1})]),_:1})}}});const R=N;var w=R},87603:function(e,l,t){t(97042),t(72343)}}]);