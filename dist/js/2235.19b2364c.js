"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,2235],{3829:function(e,t,a){a.d(t,{x:function(){return i},z:function(){return n}});var o=a(47378),r=a(1211);const n=(0,o.b_)({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:r.I},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),i={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent}},6301:function(e,t,a){a.d(t,{A:function(){return c}});var o=a(60168),r=a(39578),n=function(){return r.A.Date.now()},i=n,l=a(10754),s="Expected a function",u=Math.max,d=Math.min;function p(e,t,a){var r,n,p,c,v,f,g=0,m=!1,h=!1,b=!0;if("function"!=typeof e)throw new TypeError(s);function k(t){var a=r,o=n;return r=n=void 0,g=t,c=e.apply(o,a),c}function I(e){return g=e,v=setTimeout(D,t),m?k(e):c}function y(e){var a=e-f,o=e-g,r=t-a;return h?d(r,p-o):r}function R(e){var a=e-f,o=e-g;return void 0===f||a>=t||a<0||h&&o>=p}function D(){var e=i();if(R(e))return C(e);v=setTimeout(D,y(e))}function C(e){return v=void 0,b&&r?k(e):(r=n=void 0,c)}function w(){void 0!==v&&clearTimeout(v),g=0,r=f=n=v=void 0}function _(){return void 0===v?c:C(i())}function T(){var e=i(),a=R(e);if(r=arguments,n=this,f=e,a){if(void 0===v)return I(f);if(h)return clearTimeout(v),v=setTimeout(D,t),k(f)}return void 0===v&&(v=setTimeout(D,t)),c}return t=(0,l.A)(t)||0,(0,o.A)(a)&&(m=!!a.leading,h="maxWait"in a,p=h?u((0,l.A)(a.maxWait)||0,t):p,b="trailing"in a?!!a.trailing:b),T.cancel=w,T.flush=_,T}var c=p},10754:function(e,t,a){a.d(t,{A:function(){return h}});var o=/\s/;function r(e){var t=e.length;while(t--&&o.test(e.charAt(t)));return t}var n=r,i=/^\s+/;function l(e){return e?e.slice(0,n(e)+1).replace(i,""):e}var s=l,u=a(60168),d=a(18095),p=NaN,c=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=parseInt;function m(e){if("number"==typeof e)return e;if((0,d.A)(e))return p;if((0,u.A)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,u.A)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=s(e);var a=v.test(e);return a||f.test(e)?g(e.slice(2),a?2:8):c.test(e)?p:+e}var h=m},12687:function(e,t,a){a.d(t,{u:function(){return h}});var o=a(56768),r=a(24232),n=a(90144),i=a(45130),l=a(91542),s=a(57477),u=a(3829),d=a(99077),p=a(37207),c=a(93513);const v=(0,o.pM)({name:"ElTag"}),f=(0,o.pM)({...v,props:u.z,emits:u.x,setup(e,{emit:t}){const a=e,u=(0,p.NV)(),d=(0,c.DU)("tag"),v=(0,o.EW)(()=>{const{type:e,hit:t,effect:o,closable:r,round:n}=a;return[d.b(),d.is("closable",r),d.m(e||"primary"),d.m(u.value),d.m(o),d.is("hit",t),d.is("round",n)]}),f=e=>{t("close",e)},g=e=>{t("click",e)},m=e=>{var t,a,o;(null==(o=null==(a=null==(t=null==e?void 0:e.component)?void 0:t.subTree)?void 0:a.component)?void 0:o.bum)&&(e.component.subTree.component.bum=null)};return(e,t)=>e.disableTransitions?((0,o.uX)(),(0,o.CE)("span",{key:0,class:(0,r.C4)((0,n.R1)(v)),style:(0,r.Tr)({backgroundColor:e.color}),onClick:g},[(0,o.Lk)("span",{class:(0,r.C4)((0,n.R1)(d).e("content"))},[(0,o.RG)(e.$slots,"default")],2),e.closable?((0,o.uX)(),(0,o.Wv)((0,n.R1)(l.tk),{key:0,class:(0,r.C4)((0,n.R1)(d).e("close")),onClick:(0,i.D$)(f,["stop"])},{default:(0,o.k6)(()=>[(0,o.bF)((0,n.R1)(s.Close))]),_:1},8,["class","onClick"])):(0,o.Q3)("v-if",!0)],6)):((0,o.uX)(),(0,o.Wv)(i.eB,{key:1,name:`${(0,n.R1)(d).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:m},{default:(0,o.k6)(()=>[(0,o.Lk)("span",{class:(0,r.C4)((0,n.R1)(v)),style:(0,r.Tr)({backgroundColor:e.color}),onClick:g},[(0,o.Lk)("span",{class:(0,r.C4)((0,n.R1)(d).e("content"))},[(0,o.RG)(e.$slots,"default")],2),e.closable?((0,o.uX)(),(0,o.Wv)((0,n.R1)(l.tk),{key:0,class:(0,r.C4)((0,n.R1)(d).e("close")),onClick:(0,i.D$)(f,["stop"])},{default:(0,o.k6)(()=>[(0,o.bF)((0,n.R1)(s.Close))]),_:1},8,["class","onClick"])):(0,o.Q3)("v-if",!0)],6)]),_:3},8,["name"]))}});var g=(0,d.A)(f,[["__file","tag.vue"]]),m=a(25376);const h=(0,m.GU)(g)},31112:function(e,t,a){a(97042)},71066:function(e,t,a){a.d(t,{P:function(){return l},i:function(){return s}});var o=a(81387),r=a(27007),n=a(56768),i=a(90144);const l=e=>{console.log("接收到的第三方参数",e);const t=(0,i.KR)(0),a=(0,n.EW)(()=>{let t={};try{e.thirdParamsString&&(t=JSON.parse(e.thirdParamsString))}catch(a){console.log(a),t={}}return t});console.log("thirdParams",a);const o=(o,r,n)=>{console.log("onCloseThirdDialog",r,n),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:t.value,dialogKey:e.dialogKey,path:a.value.path,rowData:r?JSON.parse(JSON.stringify(r)):void 0,data:n?JSON.parse(JSON.stringify(n)):void 0,isSuccess:o}},"*")},l=(e,a)=>{switch(e){case"setToken":a.token&&(0,r.WG)(a.token);break;case"dialogIndex":t.value=a;break;case"refreshData":break;case"message":break}},s=e=>{l(e.data.type,e.data.data)};return(0,n.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",s,!1)}),(0,n.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",s)}),{thirdParams:a,onCloseThirdDialog:o}},s=()=>{let e;const t=(0,o.lq)(),a=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==t.path.indexOf("/thirdParty/")&&((0,n.sV)(()=>{(0,r.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),a()},18e4))}),(0,n.hi)(()=>{e&&clearInterval(e)}))}},79628:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var o=a(25136),r=(a(97042),a(69957),a(21929)),n=(a(98421),a(65451)),i=(a(63390),a(14022)),l=(a(72343),a(76408)),s=(a(87535),a(32465),a(18888)),u=(a(3172),a(56768)),d=a(90144),p=a(45130),c=a(26695),v=a(99080),f=a(27007),g=a(34894),m=a(71066),h=a(82572);const b={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var k=(0,u.pM)({__name:"editReportDatasetGroup",props:{groupId:{},groupList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,h.l5)(),a=e,{thirdParams:k,onCloseThirdDialog:I}=(0,m.P)(a),y=(0,u.EW)(()=>t.defaultFormItemSize||k.value.defaultFormItemSize?.value),R=(0,d.KR)(),D={"ReportDatasetGroup.groupName":[{required:!0,message:"请输入分组名称",trigger:"blur"}]},C=(0,d.KR)({ReportDatasetGroup:{groupId:void 0,groupName:void 0,parentId:void 0,isDatasourceInit:!1}}),w=(0,u.EW)(()=>({groupId:a.groupId||k.value.groupId,groupList:a.groupList||k.value.groupList||[]})),_=(0,u.EW)(()=>!!w.value.groupId),T=()=>Promise.resolve({dataList:w.value.groupList||[]}),S={loadData:T,isTree:!0,idKey:"id",parentIdKey:"parentId"},F=(0,d.Kh)({formFilter:{},formFilterCopy:{},menuBlock:{isInit:!1},parentId:{impl:(0,v.B)(S),value:[]},isInit:!1}),G=()=>{a.dialog?a.dialog.cancel():I(!1)},x=e=>{C.value.ReportDatasetGroup.parentId=Array.isArray(e)?e[e.length-1]:void 0},N=()=>{E().then(()=>{F.isInit||F.parentId.impl.onVisibleChange(!0).then(e=>{F.parentId.value=(0,f.Zi)(e,C.value.ReportDatasetGroup.parentId,"groupId")}).catch(e=>{console.warn(e)}),F.isInit=!0}).catch(e=>{console.warn(e)})},A=()=>{R.value.validate(e=>{if(!e)return;let t={reportDatasetGroupDto:{groupId:w.value.groupId,groupName:C.value.ReportDatasetGroup.groupName,parentId:C.value.ReportDatasetGroup.parentId,appId:C.value.ReportDatasetGroup.appId}},o=_.value?g.AX.update(t):g.AX.add(t);o.then(()=>{c.nk.success("保存成功"),a.dialog?a.dialog.submit(!0):I(!0)}).catch(e=>{console.warn(e)})})},E=()=>new Promise((e,t)=>{if(!C.value.ReportDatasetGroup.isDatasourceInit&&_.value){if(null==w.value.groupId)return V(),void t();let a={groupId:w.value.groupId};g.AX.view(a).then(t=>{C.value.ReportDatasetGroup={...t.data,isDatasourceInit:!0},e(t)}).catch(e=>{t(e)})}else C.value.CourseSection&&(C.value.CourseSection.isDatasourceInit=!0),e(!0)}),V=()=>{C.value={ReportDatasetGroup:{groupId:void 0,groupName:void 0,parentId:void 0,appId:void 0,createTime:void 0,createUserId:void 0,updateTime:void 0,updateUserId:void 0,isDatasourceInit:!1}}},W=()=>{N()};return(0,u.sV)(()=>{W()}),(e,t)=>{const a=s._m,c=r.xE,v=l.uD,f=i.WK,g=n.S2,m=r.US,h=o.S2;return(0,u.uX)(),(0,u.CE)("div",b,[(0,u.bF)(m,{ref_key:"form",ref:R,model:(0,d.R1)(C),class:"full-width-input form-box",rules:D,style:{width:"100%"},"label-width":"80px",size:(0,d.R1)(y),"label-position":"right",onSubmit:t[2]||(t[2]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(g,{gutter:20},{default:(0,u.k6)(()=>[(0,u.bF)(v,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"所属分组"},{default:(0,u.k6)(()=>[(0,u.bF)(a,{class:"input-item",modelValue:(0,d.R1)(F).parentId.value,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,d.R1)(F).parentId.value=e),disabled:(0,d.R1)(_),options:(0,d.R1)(F).parentId.impl.dropdownList,filterable:"",clearable:!0,"show-all-levels":!1,placeholder:"所属分组",props:{value:"groupId",label:"groupName",checkStrictly:!0},onVisibleChange:(0,d.R1)(F).parentId.impl.onVisibleChange,onChange:x},null,8,["modelValue","disabled","options","onVisibleChange"])]),_:1})]),_:1}),(0,u.bF)(v,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"分组名称",prop:"ReportDatasetGroup.groupName"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"input-item",modelValue:(0,d.R1)(C).ReportDatasetGroup.groupName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,d.R1)(C).ReportDatasetGroup.groupName=e),clearable:!0,placeholder:"分组名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(g,{class:"menu-box"},{default:(0,u.k6)(()=>[(0,u.bF)(v,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(g,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,u.k6)(()=>[(0,u.bF)(h,{size:(0,d.R1)(y),plain:!0,onClick:G},{default:(0,u.k6)(()=>t[3]||(t[3]=[(0,u.eW)(" 取消 ")])),_:1,__:[3]},8,["size"]),(0,u.bF)(h,{type:"primary",size:(0,d.R1)(y),onClick:A},{default:(0,u.k6)(()=>t[4]||(t[4]=[(0,u.eW)(" 保存 ")])),_:1,__:[4]},8,["size"])]),_:1})]),_:1})]),_:1})])}}});const I=k;var y=I}}]);