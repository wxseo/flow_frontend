"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[9682],{59682:function(e,l,i){i.r(l),i.d(l,{default:function(){return S}});var n=i(54880),o=(i(97042),i(51582),i(60713),i(2403)),r=(i(63266),i(21929)),a=(i(98421),i(11194)),t=(i(57583),i(17851)),d=(i(68489),i(62436),i(77649)),u=(i(87603),i(14022)),b=(i(72343),i(76408)),p=(i(87535),i(32465),i(85415)),k=(i(22243),i(7409),i(69225),i(65451)),s=(i(63390),i(25136)),c=(i(69957),i(56768)),f=i(45130),m=i(90144),D=i(26695),g=i(34894),_=i(21016),h=i(82572),y=i(71066),v=(0,c.pM)({__name:"editReportDblink",props:{dblink:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const l=(0,h.l5)(),i=e,{thirdParams:v,onCloseThirdDialog:F}=(0,y.P)(i),V=(0,c.EW)(()=>l.defaultFormItemSize),S={dblinkId:void 0,dblinkName:void 0,dblinkDescription:void 0,dblinkType:void 0,configuration:{host:void 0,database:void 0,username:void 0,password:void 0,jdbcString:void 0,serviceId:void 0,port:void 0,schema:void 0,sid:!0,initialPoolSize:5,minPoolSize:5,maxPoolSize:50},isDatasourceInit:!1},T=(0,m.KR)(),z=(0,m.Kh)({reportDblink:S}),I={"reportDblink.dblinkName":[{required:!0,message:"请输入名称",trigger:"blur"}],"reportDblink.configuration.host":[{required:!0,message:"请输入服务器地址",trigger:"blur"}],"reportDblink.configuration.database":[{required:!0,message:"请输入数据库名",trigger:"blur"}],"reportDblink.configuration.username":[{required:!0,message:"请输入用户名",trigger:"blur"}],"reportDblink.configuration.password":[{required:!0,message:"请输入密码",trigger:"blur"}],"reportDblink.configuration.port":[{required:!0,message:"请输入端口号",trigger:"blur"}],"reportDblink.configuration.initialPoolSize":[{required:!0,message:"请输入初始连接数",trigger:"blur"}],"reportDblink.configuration.minPoolSize":[{required:!0,message:"请输入最小连接数",trigger:"blur"}],"reportDblink.configuration.maxPoolSize":[{required:!0,message:"请输入最大连接数",trigger:"blur"}],"reportDblink.dblinkType":[{required:!0,message:"请输入类型",trigger:"blur"}],"reportDblink.configuration.serviceId":[{required:!0,message:"请输入服务名 / SID",trigger:"blur"}]},P=(0,c.EW)(()=>({dblink:i.dblink||v.value.dblink})),R=()=>{i.dialog?i.dialog.cancel():F(!1)},x=(e=!1)=>new Promise((l,i)=>{g.fh.testConnection({dblinkId:z.reportDblink.dblinkId}).then(i=>{e&&D.nk.success("连接成功！"),l(i)}).catch(e=>{i(e)})}),w=()=>{if(null==P.value.dblink)return;let e={dblinkId:P.value.dblink.dblinkId};g.fh.view(e).then(e=>{e.data.configuration=JSON.parse(e.data.configuration),z.reportDblink={...e.data,isDatasourceInit:!0}}).catch(e=>{console.warn(e)})},W=()=>{T.value.validate(e=>{if(!e)return;let l={reportDblinkDto:{dblinkId:(P.value.dblink||{}).dblinkId,dblinkName:z.reportDblink.dblinkName,dblinkDescription:z.reportDblink.dblinkDescription,dblinkType:z.reportDblink.dblinkType,configuration:JSON.stringify(z.reportDblink.configuration)}},n=P.value.dblink?g.fh.update(l):g.fh.add(l);n.then(e=>(D.nk.success("保存成功"),null==P.value.dblink&&(z.reportDblink.dblinkId=e.data),x(!1))).then(()=>{i.dialog?i.dialog.submit(!0):F(!0)}).catch(e=>{console.warn(e)})})},U=()=>{z.reportDblink=S};return(0,c.wB)(()=>P.value.dblink,e=>{null==e?U():w()},{deep:!0,immediate:!0}),(e,l)=>{const i=s.S2,D=k.S2,g=n.bZ,h=p.P9,y=p.AV,v=r.xE,F=b.uD,S=u.WK,P=d.lq,w=t.ll,U=t.MQ,Q=a.fR,C=r.US,E=o.kA,X=n.ZO,q=n.lX;return(0,c.uX)(),(0,c.Wv)(q,{class:"edit-report-dblink"},{default:(0,c.k6)(()=>[(0,c.bF)(g,{class:"step-header",style:{overflow:"hidden",height:"72px",background:"white","border-bottom":"1px solid #ebeef5"}},{default:(0,c.k6)(()=>[(0,c.bF)(D,{type:"flex",justify:"space-between",align:"middle",style:{height:"100%"}},{default:(0,c.k6)(()=>[l[20]||(l[20]=(0,c.Lk)("div",{class:"title",style:{display:"flex",width:"200px",height:"40px","line-height":"40px"}},[(0,c.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"数据库链接")],-1)),(0,c.bF)(D,{type:"flex",justify:"end"},{default:(0,c.k6)(()=>[(0,c.bF)(i,{size:V.value,type:"primary",onClick:W},{default:(0,c.k6)(()=>l[17]||(l[17]=[(0,c.eW)(" 保存 ")])),_:1,__:[17]},8,["size"]),(0,c.bF)(i,{size:V.value,type:"success",disabled:null==z.reportDblink.dblinkId,onClick:l[0]||(l[0]=()=>x(!0).catch(e=>{}))},{default:(0,c.k6)(()=>l[18]||(l[18]=[(0,c.eW)(" 测试链接 ")])),_:1,__:[18]},8,["size","disabled"]),(0,c.bF)(i,{size:V.value,onClick:R},{default:(0,c.k6)(()=>l[19]||(l[19]=[(0,c.eW)("退出")])),_:1,__:[19]},8,["size"])]),_:1})]),_:1,__:[20]})]),_:1}),(0,c.bF)(X,{style:{padding:"15px","background-color":"#f9f9f9"}},{default:(0,c.k6)(()=>[(0,c.bF)(D,{type:"flex",justify:"center",style:{height:"100%"}},{default:(0,c.k6)(()=>[(0,c.bF)(E,{style:{height:"calc(100vh - 90px)"},class:"custom-scroll edit-box"},{default:(0,c.k6)(()=>[(0,c.bF)(C,{ref_key:"form",ref:T,model:z,class:"full-width-input",rules:I,style:{width:"100%",padding:"20px"},"label-width":"110px",size:V.value,"label-position":"right",onSubmit:l[16]||(l[16]=(0,f.D$)(()=>{},["prevent"]))},{default:(0,c.k6)(()=>[(0,c.bF)(D,{gutter:20},{default:(0,c.k6)(()=>[(0,c.bF)(F,{span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"数据库类型",prop:"reportDblink.dblinkType"},{default:(0,c.k6)(()=>[(0,c.bF)(y,{class:"input-item",modelValue:z.reportDblink.dblinkType,"onUpdate:modelValue":l[1]||(l[1]=e=>z.reportDblink.dblinkType=e),clearable:!0,filterable:"",placeholder:"数据源类型"},{default:(0,c.k6)(()=>[((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)((0,m.R1)(_.DblinkType).getList(),e=>((0,c.uX)(),(0,c.Wv)(h,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,c.bF)(F,{span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"数据库名称",prop:"reportDblink.dblinkName"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.dblinkName,"onUpdate:modelValue":l[2]||(l[2]=e=>z.reportDblink.dblinkName=e),clearable:!0,placeholder:"数据源名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,c.bF)(F,{span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"数据库描述",prop:"reportDblink.dblinkDescription"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.dblinkDescription,"onUpdate:modelValue":l[3]||(l[3]=e=>z.reportDblink.dblinkDescription=e),clearable:!0,placeholder:"数据源描述"},null,8,["modelValue"])]),_:1})]),_:1}),null!=z.reportDblink.dblinkType?((0,c.uX)(),(0,c.Wv)(F,{key:0,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"服务器地址",prop:"reportDblink.configuration.host"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.configuration.host,"onUpdate:modelValue":l[4]||(l[4]=e=>z.reportDblink.configuration.host=e),clearable:!0,placeholder:"服务器地址"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),null!=z.reportDblink.dblinkType?((0,c.uX)(),(0,c.Wv)(F,{key:1,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"服务器端口号",prop:"reportDblink.configuration.port"},{default:(0,c.k6)(()=>[(0,c.bF)(P,{class:"input-item",modelValue:z.reportDblink.configuration.port,"onUpdate:modelValue":l[5]||(l[5]=e=>z.reportDblink.configuration.port=e),controls:!1,clearable:!0,placeholder:"端口号"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),null!=z.reportDblink.dblinkType&&z.reportDblink.dblinkType!==(0,m.R1)(_.DblinkType).ORACLE?((0,c.uX)(),(0,c.Wv)(F,{key:2,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"数据库名称",prop:"reportDblink.configuration.database"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.configuration.database,"onUpdate:modelValue":l[6]||(l[6]=e=>z.reportDblink.configuration.database=e),clearable:!0,placeholder:"数据库名"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),null!=z.reportDblink.dblinkType?((0,c.uX)(),(0,c.Wv)(F,{key:3,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"数据库用户",prop:"reportDblink.configuration.username"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.configuration.username,"onUpdate:modelValue":l[7]||(l[7]=e=>z.reportDblink.configuration.username=e),clearable:!0,placeholder:"用户名"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),null!=z.reportDblink.dblinkType?((0,c.uX)(),(0,c.Wv)(F,{key:4,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"用户密码",prop:"reportDblink.configuration.password"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.configuration.password,"onUpdate:modelValue":l[8]||(l[8]=e=>z.reportDblink.configuration.password=e),clearable:!0,placeholder:"密码"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).MYSQL||z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).DORIS||z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).POSTGRESQL||z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).OPENGAUSS||z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).SQL_SERVER?((0,c.uX)(),(0,c.Wv)(F,{key:5,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"JDBC额外参数",prop:"reportDblink.configuration.jdbcString"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.configuration.jdbcString,"onUpdate:modelValue":l[9]||(l[9]=e=>z.reportDblink.configuration.jdbcString=e),clearable:!0,placeholder:"JDBC额外参数"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).ORACLE?((0,c.uX)(),(0,c.Wv)(F,{key:6,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"服务名 / SID",prop:"reportDblink.configuration.sid"},{default:(0,c.k6)(()=>[(0,c.bF)(U,{modelValue:z.reportDblink.configuration.sid,"onUpdate:modelValue":l[10]||(l[10]=e=>z.reportDblink.configuration.sid=e)},{default:(0,c.k6)(()=>[(0,c.bF)(w,{value:!0},{default:(0,c.k6)(()=>l[21]||(l[21]=[(0,c.eW)("SID")])),_:1,__:[21]}),(0,c.bF)(w,{value:!1},{default:(0,c.k6)(()=>l[22]||(l[22]=[(0,c.eW)("服务名")])),_:1,__:[22]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).ORACLE?((0,c.uX)(),(0,c.Wv)(F,{key:7,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"服务名 / SID",prop:"reportDblink.configuration.serviceId"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.configuration.serviceId,"onUpdate:modelValue":l[11]||(l[11]=e=>z.reportDblink.configuration.serviceId=e),clearable:!0,placeholder:"服务名 / SID"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).POSTGRESQL||z.reportDblink.dblinkType===(0,m.R1)(_.DblinkType).OPENGAUSS?((0,c.uX)(),(0,c.Wv)(F,{key:8,span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"数据库 Schema",prop:"reportDblink.configuration.schema"},{default:(0,c.k6)(()=>[(0,c.bF)(S,{class:"input-item",modelValue:z.reportDblink.configuration.schema,"onUpdate:modelValue":l[12]||(l[12]=e=>z.reportDblink.configuration.schema=e),clearable:!0,placeholder:"数据库 Schema"},null,8,["modelValue"])]),_:1})]),_:1})):(0,c.Q3)("",!0),(0,c.bF)(F,{span:24},{default:(0,c.k6)(()=>[(0,c.bF)(Q,null,{default:(0,c.k6)(()=>l[23]||(l[23]=[(0,c.eW)("高级设置")])),_:1,__:[23]})]),_:1}),(0,c.bF)(F,{span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"初始连接数",prop:"reportDblink.configuration.initialPoolSize"},{default:(0,c.k6)(()=>[(0,c.bF)(P,{class:"input-item",modelValue:z.reportDblink.configuration.initialPoolSize,"onUpdate:modelValue":l[13]||(l[13]=e=>z.reportDblink.configuration.initialPoolSize=e),controls:!1,clearable:!0,placeholder:"初始连接数"},null,8,["modelValue"])]),_:1})]),_:1}),(0,c.bF)(F,{span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"最小连接数",prop:"reportDblink.configuration.minPoolSize"},{default:(0,c.k6)(()=>[(0,c.bF)(P,{class:"input-item",modelValue:z.reportDblink.configuration.minPoolSize,"onUpdate:modelValue":l[14]||(l[14]=e=>z.reportDblink.configuration.minPoolSize=e),controls:!1,clearable:!0,placeholder:"最小连接数"},null,8,["modelValue"])]),_:1})]),_:1}),(0,c.bF)(F,{span:24},{default:(0,c.k6)(()=>[(0,c.bF)(v,{label:"最大连接数",prop:"reportDblink.configuration.maxPoolSize"},{default:(0,c.k6)(()=>[(0,c.bF)(P,{class:"input-item",modelValue:z.reportDblink.configuration.maxPoolSize,"onUpdate:modelValue":l[15]||(l[15]=e=>z.reportDblink.configuration.maxPoolSize=e),controls:!1,clearable:!0,placeholder:"最大连接数"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),F=i(71241);const V=(0,F.A)(v,[["__scopeId","data-v-31e3ea54"]]);var S=V},68489:function(e,l,i){i(97042)}}]);