"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,4325],{3736:function(e,t,n){n.d(t,{A:function(){return a}});var l=n(55583),i=n(18384);class a extends l.w{static list(e,t){return super.post(i.x+"/online/onlineApiGroup/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineApiGroup/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineApiGroup/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineApiGroup/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineApiGroup/delete",e,t)}static listAll(e={},t){return super.post(i.x+"/online/onlineApiGroup/listAll",e,t)}}},36947:function(e,t,n){n.d(t,{aq:function(){return p},hp:function(){return s},PC:function(){return u},yu:function(){return a},S1:function(){return o},k$:function(){return g},NZ:function(){return v},Pr:function(){return r},Uz:function(){return d},jk:function(){return c}});var l=n(55583),i=n(18384);class a extends l.w{static list(e,t){return super.post(i.x+"/online/onlineDblink/list",e,t)}static listDblinkTables(e,t){return super.get(i.x+"/online/onlineDblink/listDblinkTables",e,t)}static listDblinkTableColumns(e,t){return super.get(i.x+"/online/onlineDblink/listDblinkTableColumns",e,t)}static view(e,t){return super.get(i.x+"/online/onlineDblink/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineDblink/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineDblink/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineDblink/delete",e,t)}static testConnection(e,t){return super.get(i.x+"/online/onlineDblink/testConnection",e,t)}}class o extends l.w{static list(e,t){return super.post(i.x+"/online/onlineDict/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineDict/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineDict/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineDict/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineDict/delete",e,t)}static listAllGlobalDict(e,t){return super.post(i.x+"/online/onlineDict/listAllGlobalDict",e,t)}}class r extends l.w{static list(e,t){return super.post(i.x+"/online/onlinePage/list",e,t)}static listAllPageAndForm(e,t){return super.post(i.x+"/online/onlinePage/listAllPageAndForm",e,t)}static view(e,t){return super.get(i.x+"/online/onlinePage/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlinePage/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlinePage/update",e,t)}static updatePublished(e,t){return super.post(i.x+"/online/onlinePage/updatePublished",e,t)}static delete(e,t){return super.post(i.x+"/online/onlinePage/delete",e,t)}static updateStatus(e,t){return super.post(i.x+"/online/onlinePage/updateStatus",e,t)}static listOnlinePageDatasource(e,t){return super.post(i.x+"/online/onlinePage/listOnlinePageDatasource",e,t)}static listNotInOnlinePageDatasource(e,t){return super.post(i.x+"/online/onlinePage/listNotInOnlinePageDatasource",e,t)}static addOnlinePageDatasource(e,t){return super.post(i.x+"/online/onlinePage/addOnlinePageDatasource",e,t)}static deleteOnlinePageDatasource(e,t){return super.post(i.x+"/online/onlinePage/deleteOnlinePageDatasource",e,t)}static updateOnlinePageDatasource(e,t){return super.post(i.x+"/online/onlinePage/updateOnlinePageDatasource",e,t)}static viewOnlinePageDatasource(e,t){return super.get(i.x+"/online/onlinePage/viewOnlinePageDatasource",e,t)}static getDblinkIdByPageId(e,t){return super.get(i.x+"/online/onlinePage/getDblinkIdByPageId",e,t)}}class u extends l.w{static list(e,t){return super.post(i.x+"/online/onlineDatasourceRelation/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineDatasourceRelation/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineDatasourceRelation/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineDatasourceRelation/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineDatasourceRelation/delete",e,t)}}class s extends l.w{static list(e,t){return super.post(i.x+"/online/onlineDatasource/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineDatasource/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineDatasource/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineDatasource/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineDatasource/delete",e,t)}}class p extends l.w{static list(e,t){return super.post(i.x+"/online/onlineColumn/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineColumn/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineColumn/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineColumn/update",e,t)}static refreshColumn(e,t){return super.post(i.x+"/online/onlineColumn/refresh",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineColumn/delete",e,t)}static listOnlineColumnRule(e,t){return super.post(i.x+"/online/onlineColumn/listOnlineColumnRule",e,t)}static listNotInOnlineColumnRule(e,t){return super.post(i.x+"/online/onlineColumn/listNotInOnlineColumnRule",e,t)}static addOnlineColumnRule(e,t){return super.post(i.x+"/online/onlineColumn/addOnlineColumnRule",e,t)}static deleteOnlineColumnRule(e,t){return super.post(i.x+"/online/onlineColumn/deleteOnlineColumnRule",e,t)}static updateOnlineColumnRule(e,t){return super.post(i.x+"/online/onlineColumn/updateOnlineColumnRule",e,t)}static viewOnlineColumnRule(e,t){return super.post(i.x+"/online/onlineColumn/viewOnlineColumnRule",e,t)}}class d extends l.w{static list(e,t){return super.post(i.x+"/online/onlineRule/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineRule/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineRule/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineRule/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineRule/delete",e,t)}}class c extends l.w{static list(e,t){return super.post(i.x+"/online/onlineVirtualColumn/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineVirtualColumn/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineVirtualColumn/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineVirtualColumn/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineVirtualColumn/delete",e,t)}}class v extends l.w{static listDict(e,t){return super.post(i.x+"/online/onlineOperation/listDict",e,t)}static listByDatasourceId(e,t){return super.post(i.x+"/online/onlineOperation/listByDatasourceId",e,t)}static listByOneToManyRelationId(e,t){return super.post(i.x+"/online/onlineOperation/listByOneToManyRelationId",e,t)}static addDatasource(e,t){return super.post(i.x+"/online/onlineOperation/addDatasource",e,t)}static addOneToManyRelation(e,t){return super.post(i.x+"/online/onlineOperation/addOneToManyRelation",e,t)}static updateDatasource(e,t){return super.post(i.x+"/online/onlineOperation/updateDatasource",e,t)}static updateOneToManyRelation(e,t){return super.post(i.x+"/online/onlineOperation/updateOneToManyRelation",e,t)}static viewByDatasourceId(e,t){return super.get(i.x+"/online/onlineOperation/viewByDatasourceId",e,t)}static viewByOneToManyRelationId(e,t){return super.get(i.x+"/online/onlineOperation/viewByOneToManyRelationId",e,t)}static deleteDatasource(e,t){return super.post(i.x+"/online/onlineOperation/deleteDatasource",e,t)}static deleteOneToManyRelation(e,t){return super.post(i.x+"/online/onlineOperation/deleteOneToManyRelation",e,t)}static getColumnRuleCode(e,t){return super.get(i.x+"/online/onlineOperation/getColumnRuleCode",e,t)}static getPrintTemplate(e,t){return super.post(i.x+"/report/reportPrint/listAll",e,t)}static listTableDict(e,t){return super.post(i.x+"/online/onlineOperation/listTableDict",e,t)}static listTableDictByIds(e,t){return super.post(i.x+"/online/onlineOperation/listTableDictByIds",e,t)}}class g extends l.w{static list(e,t){return super.post(i.x+"/online/onlineForm/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineForm/view",e,t)}static render(e,t){return super.get(i.x+"/online/onlineForm/render",e,t)}static add(e,t){return super.post(i.x+"/online/onlineForm/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineForm/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineForm/delete",e,t)}static clone(e,t){return super.post(i.x+"/online/onlineForm/clone",e,t)}static saveFormUserExt(e,t){return super.post(i.x+"/online/onlineForm/saveFormUserExt",e,t)}}n(83283),n(3736)},71066:function(e,t,n){n.d(t,{P:function(){return r},i:function(){return u}});var l=n(81387),i=n(27007),a=n(56768),o=n(90144);const r=e=>{console.log("接收到的第三方参数",e);const t=(0,o.KR)(0),n=(0,a.EW)(()=>{let t={};try{e.thirdParamsString&&(t=JSON.parse(e.thirdParamsString))}catch(n){console.log(n),t={}}return t});console.log("thirdParams",n);const l=(l,i,a)=>{console.log("onCloseThirdDialog",i,a),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:t.value,dialogKey:e.dialogKey,path:n.value.path,rowData:i?JSON.parse(JSON.stringify(i)):void 0,data:a?JSON.parse(JSON.stringify(a)):void 0,isSuccess:l}},"*")},r=(e,n)=>{switch(e){case"setToken":n.token&&(0,i.WG)(n.token);break;case"dialogIndex":t.value=n;break;case"refreshData":break;case"message":break}},u=e=>{r(e.data.type,e.data.data)};return(0,a.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",u,!1)}),(0,a.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",u)}),{thirdParams:n,onCloseThirdDialog:l}},u=()=>{let e;const t=(0,l.lq)(),n=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==t.path.indexOf("/thirdParty/")&&((0,a.sV)(()=>{(0,i.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),n()},18e4))}),(0,a.hi)(()=>{e&&clearInterval(e)}))}},83283:function(e,t,n){n.d(t,{A:function(){return a}});var l=n(55583),i=n(18384);class a extends l.w{static testScript(e,t){return super.post(i.x+"/online/onlineApi/testScript",e,t)}static list(e,t){return super.post(i.x+"/online/onlineApi/list",e,t)}static view(e,t){return super.get(i.x+"/online/onlineApi/view",e,t)}static add(e,t){return super.post(i.x+"/online/onlineApi/add",e,t)}static update(e,t){return super.post(i.x+"/online/onlineApi/update",e,t)}static delete(e,t){return super.post(i.x+"/online/onlineApi/delete",e,t)}static deleteBatch(e,t){return super.post(i.x+"/online/onlineApi/deleteBatch",e,t)}}},84325:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var l=n(65451),i=(n(97042),n(63390),n(25136)),a=(n(69957),n(14022)),o=(n(72343),n(44114),n(18111),n(22489),n(7588),n(61701),n(56768)),r=n(90144),u=n(24232),s=n(99540),p=n(27007),d=n(36947),c=n(60265),v=n(71066);const g={class:"dict-select-dlg"},x={class:"table-box"};var m=(0,o.pM)({__name:"dictSelectDlg",props:{value:{},dictInfo:{},multiple:{type:Boolean},props:{},igoreDictKeys:{},igoreSelect:{type:Boolean},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:n,onCloseThirdDialog:m}=(0,v.P)(t),f=(0,r.KR)(),h=(0,r.KR)(""),w=(0,r.KR)(),D=(0,o.EW)(()=>({value:t.value||n.value,props:t.props||null==n.value.props?t.props:n.value.props||{},dictInfo:t.dictInfo||n.dictInfo,igoreDictKeys:t.igoreDictKeys||n.value.igoreDictKeys,igoreSelect:t.igoreSelect||n.value.igoreSelect,multiple:t.multiple||null==n.value.multiple?t.multiple:n.value.multiple})),y=(0,o.EW)(()=>{if(null==D.value.dictInfo)return[];let e=D.value.dictInfo.dialogSetting,t=[];return null!=e&&null!=e.tableColumnList&&Object.keys(e.tableColumnList).forEach(n=>{let l=e.tableColumnList[n];null!=l&&l.isShow&&t.push({title:l.columnComment,field:n,columnName:n,dictId:l.dictId})}),t}),C=(0,o.EW)(()=>{let e=D.value.multiple?(w.value||[]).map(e=>e[D.value.props.value]):(w.value||{})[D.value.props.value];return{highlight:!0,checkStrictly:!0,checkRowKeys:D.value.multiple?e:void 0,checkRowKey:D.value.multiple?void 0:e,showHeader:!1}}),R=(0,o.EW)(()=>{if(null==D.value.dictInfo)return null;let e=D.value.dictInfo.dialogSetting;return null==e?null:e}),b=(0,o.EW)(()=>null==R.value?[]:R.value.filterFields||[]),k=(0,o.EW)(()=>null==D.value.dictInfo||null==K||null==K.dataList?[]:null==h.value||""===h.value?K.dataList:Array.isArray(b.value)&&0!==b.value.length?K.dataList.filter(e=>{let t=!1;for(let n=0;n<b.value.length;n++){let l=b.value[n],i=e[l+"_dictmap_name"]||e[l];if(null!=i&&i.toString().indexOf(h.value)>=0){t=!0;break}}return t}):K.dataList),O=(0,o.EW)(()=>{if(null==D.value.dictInfo||!D.value.dictInfo.treeFlag)return null;let e={transform:!0,rowField:D.value.props.value,parentField:D.value.dictInfo.parentKeyColumnName,childrenField:"children",expandAll:!0};return e}),P=({row:e})=>{if(D.value.multiple){const t=f.value.isCheckedByCheckboxRow(e);f.value.setCheckboxRow(e,!t),w.value||(w.value=[]),t?w.value=w.value.filter(t=>t[D.value.props.value]!==e[D.value.props.value]):w.value.push(e)}else f.value.setRadioRow(e),w.value=e},I=()=>{null!=f.value&&Array.isArray(K.dataList)&&setTimeout(()=>{if(f.value.clearRadioRow(),f.value.clearCheckboxRow(),D.value.multiple)f.value.setCheckboxRow(K.dataList.filter(e=>null!=(0,p.PH)(w.value,e[D.value.props.value],D.value.props.value)),!0);else{let e=(0,p.PH)(K.dataList,(w.value||{})[D.value.props.value],D.value.props.value);f.value.setRadioRow(e)}},50)},A=e=>{if(null==e&&(e={}),e={...e,dictId:D.value.dictInfo.dictId,dictRelations:y.value.map(e=>({dataIdColumn:e.columnName,dictId:""===e.dictId||null==e.dictId?void 0:e.dictId})).filter(e=>null!=e.dictId)},D.value.multiple&&D.value.igoreDictKeys&&D.value.igoreDictKeys.length>0&&(e.igoreDictKeys=D.value.igoreDictKeys),D.value.multiple&&D.value.igoreSelect&&Array.isArray(D.value.value)&&D.value.value.length>0){const t=D.value.dictInfo.keyColumnName,n=D.value.value.map(e=>e[t]);e.igoreDictKeys=n}return new Promise((t,n)=>{d.NZ.listTableDict(e).then(e=>{(e.data||[]).forEach(e=>{Object.keys(e).forEach(t=>{null!=e[t+"DictMap"]&&(e[t+"_dictmap_name"]=e[t+"DictMap"].name||e[t]),Array.isArray(e[t+"DictMapList"])&&(e[t+"_dictmap_name"]=e[t+"DictMapList"].map(e=>e.name).join(","))})}),t({dataList:e.data,totalCount:(e.data||[]).length}),(0,o.dY)(()=>{I()})}).catch(e=>{n(e)})})},T=()=>!0,S={loadTableData:A,verifyTableParameter:T,paged:!1},K=(0,r.Kh)((0,c.K)(S)),F=()=>{t.dialog?t.dialog.submit(w.value):m(!0,D.value.value,w.value)},_=()=>{null!=D.value.dictInfo&&K.refreshTable(!0,1)},L=({checked:e,row:t})=>{D.value.multiple?null==t?(w.value=[],e&&(w.value=K.dataList)):(null==w.value&&(w.value=[]),e?w.value.push(t):w.value=w.value.filter(e=>e[D.value.props.value]!==t[D.value.props.value])):w.value=t};return(0,o.sV)(()=>{Array.isArray(D.value.value)&&D.value.value.length>0&&(D.value.multiple?w.value=D.value.value.map(e=>({...e})):(console.log("单选",D.value.value),w.value={...D.value.value[0]})),_()}),(e,t)=>{const n=a.WK,p=i.S2,d=l.S2;return(0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(d,{type:"flex",justify:"space-between",align:"middle",style:{"margin-bottom":"16px"}},{default:(0,o.k6)(()=>[(0,o.Lk)("div",null,[Array.isArray((0,r.R1)(b))&&(0,r.R1)(b).length>0?((0,o.uX)(),(0,o.Wv)(n,{key:0,modelValue:(0,r.R1)(h),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,r.i9)(h)?h.value=e:null),placeholder:"请输入模糊查询条件",clearable:!0,size:"default",style:{width:"300px"}},null,8,["modelValue"])):(0,o.Q3)("",!0)]),(0,o.bF)(p,{type:"primary",size:"default",onClick:F},{default:(0,o.k6)(()=>t[1]||(t[1]=[(0,o.eW)(" 确定 ")])),_:1,__:[1]})]),_:1}),(0,o.Lk)("div",x,[(0,o.bF)((0,r.R1)(s.CP),{ref_key:"table",ref:f,"row-id":(0,r.R1)(D).props.value,"tree-config":(0,r.R1)(O),data:(0,r.R1)(k),"show-overflow":"title","show-header-overflow":"title",height:"100%","row-config":{height:50,isHover:!0},"virtual-y-config":{enabled:!0,gt:20},"radio-config":{highlight:!0},"checkbox-config":(0,r.R1)(C),onRadioChange:L,onCheckboxAll:L,onCheckboxChange:L,onCellClick:P},{default:(0,o.k6)(()=>[(0,o.bF)((0,r.R1)(s.Wq),{type:(0,r.R1)(D).multiple?"checkbox":"radio",width:null!=(0,r.R1)(O)?90:50,"tree-node":null!=(0,r.R1)(O)},null,8,["type","width","tree-node"]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,r.R1)(y),e=>((0,o.uX)(),(0,o.Wv)((0,r.R1)(s.Wq),{key:e.field,title:e.title,field:e.field},{default:(0,o.k6)(({row:t})=>[(0,o.Lk)("span",null,(0,u.v_)(t[e.field+"_dictmap_name"]||t[e.field]),1)]),_:2},1032,["title","field"]))),128))]),_:1},8,["row-id","tree-config","data","checkbox-config"])])])}}}),f=n(71241);const h=(0,f.A)(m,[["__scopeId","data-v-0ae38a9e"]]);var w=h}}]);