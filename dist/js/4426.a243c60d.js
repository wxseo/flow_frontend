"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[4426],{68489:function(l,e,i){i(97042)},94426:function(l,e,i){i.r(e),i.d(e,{default:function(){return S}});var n=i(54880),a=(i(97042),i(51582),i(60713),i(2403)),o=(i(63266),i(21929)),t=(i(98421),i(11194)),u=(i(57583),i(17851)),d=(i(68489),i(62436),i(77649)),b=(i(87603),i(14022)),r=(i(72343),i(76408)),k=(i(87535),i(32465),i(85415)),f=(i(22243),i(7409),i(69225),i(65451)),s=(i(63390),i(25136)),p=(i(69957),i(18111),i(22489),i(56768)),c=i(45130),m=i(90144),g=i(26695),D=i(61617),w=i(21016),_=i(71066),y=i(82572),h=(0,p.pM)({__name:"editFlowDblink",props:{dblink:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(l){const e=(0,y.l5)(),i=l,{thirdParams:h,onCloseThirdDialog:F}=(0,_.P)(i),V=(0,p.EW)(()=>e.defaultFormItemSize||h.value.defaultFormItemSize?.value),S={configuration:{sid:!0,initialPoolSize:5,minPoolSize:5,maxPoolSize:50},isDatasourceInit:!1},v=(0,m.KR)(),T=(0,m.Kh)({flowDblink:S}),z={"flowDblink.dblinkName":[{required:!0,message:"请输入名称",trigger:"blur"}],"flowDblink.configuration.host":[{required:!0,message:"请输入服务器地址",trigger:"blur"}],"flowDblink.configuration.database":[{required:!0,message:"请输入数据库名称",trigger:"blur"}],"flowDblink.configuration.username":[{required:!0,message:"请输入用户名",trigger:"blur"}],"flowDblink.configuration.password":[{required:!0,message:"请输入密码",trigger:"blur"}],"flowDblink.configuration.port":[{required:!0,message:"请输入端口号",trigger:"blur"}],"flowDblink.configuration.initialPoolSize":[{required:!0,message:"请输入初始连接数",trigger:"blur"}],"flowDblink.configuration.minPoolSize":[{required:!0,message:"请输入最小连接数",trigger:"blur"}],"flowDblink.configuration.maxPoolSize":[{required:!0,message:"请输入最大连接数",trigger:"blur"}],"flowDblink.dblinkType":[{required:!0,message:"请输入类型",trigger:"blur"}],"flowDblink.configuration.serviceId":[{required:!0,message:"请输入服务名 / SID",trigger:"blur"}]},I=(0,p.EW)(()=>({dblink:i.dblink||h.value.dblink})),P=(0,p.EW)(()=>w.DblinkType.getList().filter(l=>l.id!==w.DblinkType.CLICK_HOUS&&l.id!==w.DblinkType.DORIS)),x=()=>{i.dialog?i.dialog.cancel():F(!1)},W=(l=!1)=>new Promise((e,i)=>{D.V7.testConnection({dblinkId:T.flowDblink.dblinkId}).then(i=>{l&&g.nk.success("连接成功！"),e(i)}).catch(l=>{i(l)})}),R=()=>{if(null==I.value.dblink)return;let l={dblinkId:I.value.dblink.dblinkId};D.V7.view(l).then(l=>{l.data.configuration=JSON.parse(l.data.configuration),T.flowDblink={...l.data,isDatasourceInit:!0}}).catch(l=>{console.warn(l)})},U=()=>{v.value.validate(l=>{if(!l)return;let e={flowDblinkDto:{dblinkId:(I.value.dblink||{}).dblinkId,dblinkName:T.flowDblink.dblinkName,dblinkDescription:T.flowDblink.dblinkDescription,dblinkType:T.flowDblink.dblinkType,configuration:JSON.stringify(T.flowDblink.configuration)}},n=I.value.dblink?D.V7.update(e):D.V7.add(e);n.then(l=>(console.log("dblink saved",l),g.nk.success("保存成功"),null==I.value.dblink&&(T.flowDblink.dblinkId=l.data),W(!1))).then(()=>{i.dialog?i.dialog.submit(!0):F(!0)}).catch(l=>{console.warn(l)})})},C=()=>{T.flowDblink=S};return(0,p.wB)(()=>I.value.dblink,l=>{null==l?C():R()},{deep:!0,immediate:!0}),(l,e)=>{const i=s.S2,g=f.S2,D=n.bZ,_=k.P9,y=k.AV,h=o.xE,F=r.uD,S=b.WK,I=d.lq,R=u.ll,C=u.MQ,E=t.fR,Q=o.US,X=a.kA,q=n.ZO,O=n.lX;return(0,p.uX)(),(0,p.Wv)(O,{class:"edit-flow-dblink"},{default:(0,p.k6)(()=>[(0,p.bF)(D,{class:"step-header",style:{overflow:"hidden",height:"72px",background:"white","border-bottom":"1px solid #ebeef5"}},{default:(0,p.k6)(()=>[(0,p.bF)(g,{type:"flex",justify:"space-between",align:"middle",style:{height:"100%"}},{default:(0,p.k6)(()=>[e[20]||(e[20]=(0,p.Lk)("div",{class:"title",style:{display:"flex",width:"200px",height:"40px","line-height":"40px"}},[(0,p.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"数据库链接")],-1)),(0,p.bF)(g,{type:"flex",justify:"end"},{default:(0,p.k6)(()=>[(0,p.bF)(i,{size:V.value,type:"primary",onClick:U},{default:(0,p.k6)(()=>e[17]||(e[17]=[(0,p.eW)(" 保存 ")])),_:1,__:[17]},8,["size"]),(0,p.bF)(i,{size:V.value,type:"success",disabled:null==T.flowDblink.dblinkId,onClick:e[0]||(e[0]=()=>W(!0).catch(l=>{}))},{default:(0,p.k6)(()=>e[18]||(e[18]=[(0,p.eW)(" 测试链接 ")])),_:1,__:[18]},8,["size","disabled"]),(0,p.bF)(i,{size:V.value,onClick:x},{default:(0,p.k6)(()=>e[19]||(e[19]=[(0,p.eW)("退出")])),_:1,__:[19]},8,["size"])]),_:1})]),_:1,__:[20]})]),_:1}),(0,p.bF)(q,{style:{padding:"15px","background-color":"#f9f9f9"}},{default:(0,p.k6)(()=>[(0,p.bF)(g,{type:"flex",justify:"center",style:{height:"100%"}},{default:(0,p.k6)(()=>[(0,p.bF)(X,{style:{height:"calc(100vh - 90px)"},class:"custom-scroll edit-box"},{default:(0,p.k6)(()=>[(0,p.bF)(Q,{ref_key:"form",ref:v,model:T,class:"full-width-input",rules:z,style:{width:"100%",padding:"20px"},"label-width":"110px",size:V.value,"label-position":"right",onSubmit:e[16]||(e[16]=(0,c.D$)(()=>{},["prevent"]))},{default:(0,p.k6)(()=>[(0,p.bF)(g,{gutter:20},{default:(0,p.k6)(()=>[(0,p.bF)(F,{span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"数据库类型",prop:"flowDblink.dblinkType"},{default:(0,p.k6)(()=>[(0,p.bF)(y,{class:"input-item",modelValue:T.flowDblink.dblinkType,"onUpdate:modelValue":e[1]||(e[1]=l=>T.flowDblink.dblinkType=l),clearable:!0,filterable:"",placeholder:"数据源类型"},{default:(0,p.k6)(()=>[((0,p.uX)(!0),(0,p.CE)(p.FK,null,(0,p.pI)(P.value,l=>((0,p.uX)(),(0,p.Wv)(_,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,p.bF)(F,{span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"数据库名称",prop:"flowDblink.dblinkName"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.dblinkName,"onUpdate:modelValue":e[2]||(e[2]=l=>T.flowDblink.dblinkName=l),clearable:!0,placeholder:"数据源名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,p.bF)(F,{span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"数据库描述",prop:"flowDblink.dblinkDescription"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.dblinkDescription,"onUpdate:modelValue":e[3]||(e[3]=l=>T.flowDblink.dblinkDescription=l),clearable:!0,placeholder:"数据源描述"},null,8,["modelValue"])]),_:1})]),_:1}),null!=T.flowDblink.dblinkType?((0,p.uX)(),(0,p.Wv)(F,{key:0,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"服务器地址",prop:"flowDblink.configuration.host"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.configuration.host,"onUpdate:modelValue":e[4]||(e[4]=l=>T.flowDblink.configuration.host=l),clearable:!0,placeholder:"服务器地址"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),null!=T.flowDblink.dblinkType?((0,p.uX)(),(0,p.Wv)(F,{key:1,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"服务器端口号",prop:"flowDblink.configuration.port"},{default:(0,p.k6)(()=>[(0,p.bF)(I,{class:"input-item",modelValue:T.flowDblink.configuration.port,"onUpdate:modelValue":e[5]||(e[5]=l=>T.flowDblink.configuration.port=l),controls:!1,clearable:!0,placeholder:"端口号"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),null!=T.flowDblink.dblinkType&&T.flowDblink.dblinkType!==(0,m.R1)(w.DblinkType).ORACLE?((0,p.uX)(),(0,p.Wv)(F,{key:2,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"数据库名称",prop:"flowDblink.configuration.database"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.configuration.database,"onUpdate:modelValue":e[6]||(e[6]=l=>T.flowDblink.configuration.database=l),clearable:!0,placeholder:"数据库名称"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),null!=T.flowDblink.dblinkType?((0,p.uX)(),(0,p.Wv)(F,{key:3,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"数据库用户",prop:"flowDblink.configuration.username"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.configuration.username,"onUpdate:modelValue":e[7]||(e[7]=l=>T.flowDblink.configuration.username=l),clearable:!0,placeholder:"用户名"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),null!=T.flowDblink.dblinkType?((0,p.uX)(),(0,p.Wv)(F,{key:4,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"用户密码",prop:"flowDblink.configuration.password"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.configuration.password,"onUpdate:modelValue":e[8]||(e[8]=l=>T.flowDblink.configuration.password=l),clearable:!0,placeholder:"密码"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).MYSQL||T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).POSTGRESQL||T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).OPENGAUSS||T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).SQL_SERVER?((0,p.uX)(),(0,p.Wv)(F,{key:5,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"JDBC额外参数",prop:"flowDblink.configuration.jdbcString"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.configuration.jdbcString,"onUpdate:modelValue":e[9]||(e[9]=l=>T.flowDblink.configuration.jdbcString=l),clearable:!0,placeholder:"JDBC额外参数"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).ORACLE?((0,p.uX)(),(0,p.Wv)(F,{key:6,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"服务名 / SID",prop:"flowDblink.configuration.sid"},{default:(0,p.k6)(()=>[(0,p.bF)(C,{modelValue:T.flowDblink.configuration.sid,"onUpdate:modelValue":e[10]||(e[10]=l=>T.flowDblink.configuration.sid=l)},{default:(0,p.k6)(()=>[(0,p.bF)(R,{value:!0},{default:(0,p.k6)(()=>e[21]||(e[21]=[(0,p.eW)("SID")])),_:1,__:[21]}),(0,p.bF)(R,{value:!1},{default:(0,p.k6)(()=>e[22]||(e[22]=[(0,p.eW)("服务名")])),_:1,__:[22]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).ORACLE?((0,p.uX)(),(0,p.Wv)(F,{key:7,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"服务名 / SID",prop:"flowDblink.configuration.serviceId"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.configuration.serviceId,"onUpdate:modelValue":e[11]||(e[11]=l=>T.flowDblink.configuration.serviceId=l),clearable:!0,placeholder:"服务名 / SID"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).POSTGRESQL||T.flowDblink.dblinkType===(0,m.R1)(w.DblinkType).OPENGAUSS?((0,p.uX)(),(0,p.Wv)(F,{key:8,span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"数据库 Schema",prop:"flowDblink.configuration.schema"},{default:(0,p.k6)(()=>[(0,p.bF)(S,{class:"input-item",modelValue:T.flowDblink.configuration.schema,"onUpdate:modelValue":e[12]||(e[12]=l=>T.flowDblink.configuration.schema=l),clearable:!0,placeholder:"数据库 Schema"},null,8,["modelValue"])]),_:1})]),_:1})):(0,p.Q3)("",!0),(0,p.bF)(F,{span:24},{default:(0,p.k6)(()=>[(0,p.bF)(E,null,{default:(0,p.k6)(()=>e[23]||(e[23]=[(0,p.eW)("高级设置")])),_:1,__:[23]})]),_:1}),(0,p.bF)(F,{span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"初始连接数",prop:"flowDblink.configuration.initialPoolSize"},{default:(0,p.k6)(()=>[(0,p.bF)(I,{class:"input-item",modelValue:T.flowDblink.configuration.initialPoolSize,"onUpdate:modelValue":e[13]||(e[13]=l=>T.flowDblink.configuration.initialPoolSize=l),controls:!1,clearable:!0,placeholder:"初始连接数"},null,8,["modelValue"])]),_:1})]),_:1}),(0,p.bF)(F,{span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"最小连接数",prop:"flowDblink.configuration.minPoolSize"},{default:(0,p.k6)(()=>[(0,p.bF)(I,{class:"input-item",modelValue:T.flowDblink.configuration.minPoolSize,"onUpdate:modelValue":e[14]||(e[14]=l=>T.flowDblink.configuration.minPoolSize=l),controls:!1,clearable:!0,placeholder:"最小连接数"},null,8,["modelValue"])]),_:1})]),_:1}),(0,p.bF)(F,{span:24},{default:(0,p.k6)(()=>[(0,p.bF)(h,{label:"最大连接数",prop:"flowDblink.configuration.maxPoolSize"},{default:(0,p.k6)(()=>[(0,p.bF)(I,{class:"input-item",modelValue:T.flowDblink.configuration.maxPoolSize,"onUpdate:modelValue":e[15]||(e[15]=l=>T.flowDblink.configuration.maxPoolSize=l),controls:!1,clearable:!0,placeholder:"最大连接数"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),F=i(71241);const V=(0,F.A)(h,[["__scopeId","data-v-b48d4336"]]);var S=V}}]);