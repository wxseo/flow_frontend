"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1566],{13180:function(e,t,a){a.d(t,{D:function(){return i}});var l=a(90144);const i=e=>{const t=(0,l.KR)([]),a=(0,l.KR)(e),i=(a,l)=>{l&&l.length>0?t.value=1==e?[l[l.length-1]]:l:t.value=[]};return{fileList:t,onFileChange:i,maxCount:a}}},14908:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAjpJREFUWEftmIFVwjAQhu0E4gTCBOoE1gmECewG4gTqBOIEwgY4gTiBbCAjyAT1/3kXX0jTNi0X7Xs27/UVaJL7+C93uSY56nhLqvjyPB/i+TUu3s+V/8sa821wvSZJwru3lQIC7hYjZspQZdNNAfnse+gFBNwDOt//Epwx8whI2t1rBUBx66fVa4HPdAcvzcYlw+vGmnTkutsHaKu3wIBMk8qdC4LMLciCij7AJQYwMNiuALiKDJhi/jexwYAZ2/Z8gAS6/CPAdwAS+Kf1gHXLA2vQdrGOgph0AFd8GeMS+ac1MFuMKWQCVUAB+QDIwAQQfmMyZ1IPaRtAjuyO2oBTTP4kBnYpAQaoylkInfS5sJXUBqRyczHE7WkDA0wLBA9pVDCLpmAIQdM+qgo2NR7SvwcMUamqj7qCmJABkZv6TVKPXZFU8TARr6IFCWAYgS9i4A7GZvjNLi5CBD1xknyKQaZYOGwncdzRPUDKI3mPW90uH3Lbw425cBgg39Ld7tTXYABEoy49YCO5PJ3/l4ISEEwJDIwJF7ykHr6ihgbJJGYe9JVbTLzmHSbE43uvlqoull3DVMVj7gqys5gasQ6wkIhVAeust3neA7ZRLVqQHArjG9/GxXZ1wlTC79GaUyEVzoK6cHjEvJqKAkGHR0y4TCXHMogKah+9GY+wCjInt1t+5pui7a6yA0w7IUdzrzPxrr50jVUdAWfozAFGyVigVC4rW+shh+jmJDQGIJfO2nVrrYtjkLSd8xsAF8o4yub23AAAAABJRU5ErkJggg=="},38840:function(e,t,a){a.d(t,{Ik:function(){return c}});var l=a(56768),i=a(24232),r=a(90144),n=a(84565),o=a(99077),d=a(93513);const s=(0,l.pM)({name:"ElCard"}),u=(0,l.pM)({...s,props:n.b,setup(e){const t=(0,d.DU)("card");return(e,a)=>((0,l.uX)(),(0,l.CE)("div",{class:(0,i.C4)([(0,r.R1)(t).b(),(0,r.R1)(t).is(`${e.shadow}-shadow`)])},[e.$slots.header||e.header?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,i.C4)([(0,r.R1)(t).e("header"),e.headerClass])},[(0,l.RG)(e.$slots,"header",{},()=>[(0,l.eW)((0,i.v_)(e.header),1)])],2)):(0,l.Q3)("v-if",!0),(0,l.Lk)("div",{class:(0,i.C4)([(0,r.R1)(t).e("body"),e.bodyClass]),style:(0,i.Tr)(e.bodyStyle)},[(0,l.RG)(e.$slots,"default")],6),e.$slots.footer||e.footer?((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,i.C4)([(0,r.R1)(t).e("footer"),e.footerClass])},[(0,l.RG)(e.$slots,"footer",{},()=>[(0,l.eW)((0,i.v_)(e.footer),1)])],2)):(0,l.Q3)("v-if",!0)],2))}});var p=(0,o.A)(u,[["__file","card.vue"]]),m=a(25376);const c=(0,m.GU)(p)},62357:function(e,t,a){a.r(t),a.d(t,{default:function(){return Tt}});var l=a(54880),i=(a(97042),a(51582),a(60713),a(69225),a(65451)),r=(a(63390),a(25136)),n=(a(69957),a(18111),a(61701),a(56768)),o=a(90144),d=a(24232),s=a(26695),u=a(57632),p=a(85285),m=a(34894),c=a(92380),f=a(71066),v=a(21929),h=(a(98421),a(85415)),g=(a(22243),a(7409),a(17851)),y=(a(68489),a(20709),a(18888)),b=(a(3172),a(76408)),k=(a(87535),a(32465),a(14022)),R=(a(72343),a(45130)),I=a(27007),T=a(99080),A=a(82572);const L={class:"form-single-fragment",style:{position:"relative"}};var C=(0,n.pM)({__name:"editTemplateBasicInfo",props:{templateInfo:{},reportPrintGroupList:{default:()=>[]}},setup(e,{expose:t}){const a=(0,A.l5)(),l=e,r=(0,n.EW)(()=>l.templateInfo&&null!=l.templateInfo.printId),s=(0,o.KR)(),u=(0,o.KR)({printId:void 0,printName:void 0,printVariable:"",printType:1,groupId:void 0,landscape:!1,paperType:c.PrintPaperType.A4,customHeight:void 0,customWidth:void 0,topMargin:5,bottomMargin:5,leftMargin:5,rightMargin:5,templateType:c.PrintTemplateType.EXCEL,paramList:[],fragmentJson:[]}),p={printName:[{required:!0,message:"请输入模版名称",trigger:"blur"}],groupId:[{required:!0,message:"请选择所属分组",trigger:"blur"}],printVariable:[{required:!0,message:"请输入模版标识",trigger:"blur"},{type:"string",pattern:/^[A-Za-z0-9]+$/,message:"模版标识只允许输入字母和数字",trigger:"blur"},{type:"string",pattern:/^[A-Za-z][A-Za-z0-9]+$/,message:"模版标识不能以数字开头",trigger:"blur"}],landscape:[{required:!0,message:"请选择打印方向",trigger:"blur"}],paperType:[{required:!0,message:"请选择纸张大小",trigger:"blur"}],customWidth:[{required:!0,message:"自定义宽度不能为空",trigger:"blur"}],customHeight:[{required:!0,message:"自定义高度不能为空",trigger:"blur"}],topMargin:[{required:!0,message:"请输入上边距",trigger:"blur"}],bottomMargin:[{required:!0,message:"请输入下边距",trigger:"blur"}],leftMargin:[{required:!0,message:"请输入左边距",trigger:"blur"}],rightMargin:[{required:!0,message:"请输入右边距",trigger:"blur"}]},m=()=>Promise.resolve({dataList:l.reportPrintGroupList}),f={loadData:m,isTree:!0},C=(0,o.Kh)({groupId:{impl:(0,T.B)(f),value:[]}}),w=e=>{u.value.groupId=Array.isArray(e)?e[e.length-1]:void 0},P=()=>new Promise((e,t)=>{s.value.validate(a=>{a?e(u.value):t()})});t({getBasicInfo:P});const F=e=>{e&&null!=e.printId?(u.value.printName=e.printName,u.value.groupId=e.groupId,u.value.printVariable=e.printVariable,u.value.printType=e.printType,u.value.landscape=(e.printJson||{}).landscape,u.value.paperType=(e.printJson||{}).paperType,u.value.customWidth=(e.printJson||{}).customWidth,u.value.customHeight=(e.printJson||{}).customHeight,u.value.topMargin=(e.printJson||{}).topMargin,u.value.bottomMargin=(e.printJson||{}).bottomMargin,u.value.leftMargin=(e.printJson||{}).leftMargin,u.value.rightMargin=(e.printJson||{}).rightMargin,u.value.paramList=(e.paramJson||[]).map(e=>e.variableName),u.value.templateType=(e.printJson||{}).templateType||c.PrintTemplateType.EXCEL,u.value.fragmentJson=e.fragmentJson||[]):u.value={printId:void 0,printName:void 0,printVariable:"",printType:1,groupId:void 0,landscape:!1,paperType:c.PrintPaperType.A4,customWidth:void 0,customHeight:void 0,topMargin:5,bottomMargin:5,leftMargin:5,rightMargin:5,templateType:c.PrintTemplateType.EXCEL,paramList:[],fragmentJson:[]},C.groupId.value=[],C.groupId.impl.onVisibleChange(!0).then(e=>{C.groupId.value=(0,I.Zi)(e,u.value.groupId,"groupId")}).catch(e=>{console.warn(e)})};return(0,n.wB)(()=>l.templateInfo,e=>{F(e)},{immediate:!0}),(e,t)=>{const l=k.WK,m=v.xE,f=b.uD,I=y._m,T=g.Zh,A=g.MQ,P=h.P9,F=h.AV,_=i.S2,x=v.US;return(0,n.uX)(),(0,n.CE)("div",L,[(0,n.bF)(x,{ref_key:"form",ref:s,model:(0,o.R1)(u),class:"full-width-input",rules:p,style:{width:"100%"},"label-width":"92px",size:(0,o.R1)(a).defaultFormItemSize,onSubmit:t[6]||(t[6]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,n.k6)(()=>[(0,n.bF)(_,{gutter:20},{default:(0,n.k6)(()=>[(0,n.bF)(f,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(m,{label:"模版名称",prop:"printName"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{class:"input-item",modelValue:(0,o.R1)(u).printName,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.R1)(u).printName=e),clearable:!0,placeholder:"模版名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,n.bF)(f,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(m,{label:"模版标识",prop:"printVariable"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{class:"input-item",modelValue:(0,o.R1)(u).printVariable,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.R1)(u).printVariable=e),clearable:!0,placeholder:"只能输入英文字符和数字"},null,8,["modelValue"])]),_:1})]),_:1}),(0,n.bF)(f,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(m,{label:"所属分组",prop:"groupId"},{default:(0,n.k6)(()=>[(0,n.bF)(I,{class:"input-item",modelValue:(0,o.R1)(C).groupId.value,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.R1)(C).groupId.value=e),options:(0,o.R1)(C).groupId.impl.dropdownList,filterable:"",clearable:!0,"show-all-levels":!1,placeholder:"所属分组",props:{value:"groupId",label:"groupName",checkStrictly:!0},onVisibleChange:(0,o.R1)(C).groupId.impl.onVisibleChange,onChange:w},null,8,["modelValue","options","onVisibleChange"])]),_:1})]),_:1}),(0,n.bF)(f,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(m,{label:"模版类型",prop:"templateType"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{modelValue:(0,o.R1)(u).templateType,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.R1)(u).templateType=e),disabled:(0,o.R1)(r),onChange:t[4]||(t[4]=e=>(0,o.R1)(u).fragmentJson=[])},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(c.PrintTemplateType).getList(),e=>((0,n.uX)(),(0,n.Wv)(T,{key:e.id,value:e.id},{default:(0,n.k6)(()=>[(0,n.eW)((0,d.v_)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,n.bF)(f,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(m,{label:"输入参数"},{default:(0,n.k6)(()=>[(0,n.bF)(F,{modelValue:(0,o.R1)(u).paramList,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,o.R1)(u).paramList=e),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:""},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(u).paramList,e=>((0,n.uX)(),(0,n.Wv)(P,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])])}}});const w=C;var P=w,F=a(77195),_=(a(38389),a(61688),a(2403)),x=(a(63266),a(12687)),E=(a(31112),a(3740)),N=(a(42899),a(44114),a(22489),a(7588),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(54428));const D={class:"left-menu"};function V(e,t){return(0,n.uX)(),(0,n.CE)("div",D,t[0]||(t[0]=[(0,n.Lk)("div",{class:"left-menu-item active"},[(0,n.Lk)("i",{class:"online-icon icon-component"}),(0,n.Lk)("span",{style:{"margin-top":"4px"}},"模版")],-1)]))}var S=a(71241);const J={},W=(0,S.A)(J,[["render",V],["__scopeId","data-v-08b337d6"]]);var M=W,O=a(38840),B=(a(95304),a(91542)),X=(a(37985),a(77649)),U=(a(87603),a(18237),a(57477)),z=a(164),K=a(63019),Q=a(7502),j=a(71962),G=a(4271),q=a(37383),H=a(43393);const Y={class:"left-panel"},Z={class:"base-card-header"},$={style:{margin:"0 10px"}};var ee=(0,n.pM)({__name:"leftPanel",props:{printInfo:{},xs:{default:()=>({})},datasetGroupList:{default:()=>[]},datasetList:{default:()=>[]},datasetRelationList:{default:()=>[]}},setup(e,{expose:t}){const a=(0,Q.s)(),l=e,u=(0,o.KR)(!1),p=(0,o.KR)(),m=(0,o.KR)({}),f={value:"id",label:"name",disabled:"disabled",checkStrictly:!0},g={value:"columnName",label:"name",disabled:"disabled"},T=(0,n.EW)(()=>(0,I.BN)(l.datasetGroupList.map(e=>({...e})),"id","parentId")),A=(0,n.EW)(()=>(0,I.BN)(L.value.map(e=>({...e})),"id","parentId")),L=(0,n.EW)(()=>{if(w.value.length<=0)return[];if(m.value&&!m.value.loop)return w.value;{let e=new Set;return w.value.forEach(t=>{e.add(t.datasetId)}),w.value.concat(l.datasetRelationList.filter(t=>(t.parentId=t.masterDatasetId,e.has(t.masterDatasetId)&&t.relationType===c.ReportRelationType.ONE_TO_MANY)))}}),C=(0,n.EW)(()=>(0,H.Z4)(P.value?.columnList,"Array",!1)),w=(0,n.EW)(()=>{if(null==m.value||!Array.isArray(m.value.bindGroupPath)||m.value.bindGroupPath.length<=0)return[];let e=m.value.bindGroupPath[m.value.bindGroupPath.length-1];return(l.datasetList||[]).filter(t=>t.groupId===e)}),P=(0,n.EW)(()=>null==m.value||null==m.value.datasetId||""===m.value.datasetId?null:(0,I.PH)(L.value,m.value.datasetId,"id")),F=(0,n.EW)(()=>null==P.value?null:m.value&&m.value.loop&&null!=m.value.relationId&&""!==m.value.relationId?(0,I.PH)(L.value,m.value.relationId,"id"):null);(0,n.sV)(()=>{x()});const x=()=>{Array.isArray(l.printInfo.fragmentJson)&&l.printInfo.fragmentJson.length>0&&(p.value=l.printInfo.fragmentJson[0].fragmentId)},N=e=>{if(!m.value)return{};m.value.datasetFilterParams=(e||[]).map(e=>({paramName:e.paramName,filterValueType:e.filterValueType,paramValue:e.paramValue}))},D=(e,t)=>{m.value?null==e?m.value.filterParams.push({paramId:t.paramId,required:t.required,paramName:t.paramName,filterType:t.filterType,filterValueType:t.filterValueType,paramDictId:t.paramDictId,paramValue:t.paramValue,relationId:t.relationId}):m.value.filterParams=m.value.filterParams.map(e=>e.paramId===t.paramId?{paramId:t.paramId,required:t.required,paramName:t.paramName,filterType:t.filterType,filterValueType:t.filterValueType,paramDictId:t.paramDictId,paramValue:t.paramValue,relationId:t.relationId}:e):console.warn("currentFragment.value is null")},V=(e,t)=>{m.value?t?(null==e?m.value.orderParam.push({...t}):m.value.orderParam=m.value.orderParam.map(a=>a.fieldName===e.fieldName?{...t}:a),m.value.orderParam=m.value.orderParam.sort((e,t)=>e.showOrder-t.showOrder)):console.warn("res is null or undefined. may be callback with thirdparty by cacel"):console.warn("currentFragment.value is null")},S=()=>{m.value={fragmentId:void 0,showName:void 0,loop:!1,bindGroupPath:[],bindPath:[],bindColumnPath:[],datasetId:void 0,relationId:void 0,startRow:void 0,rowSpan:void 0,filterParams:[],orderParam:[],datasetFilterParams:[]},u.value=!0},J=()=>{let e=null==m.value?.fragmentId;ve(m.value,e)&&(re(m.value)?z.s.confirm("段落占据行区域变化会导致失效的区域中单元格绑定的数据被清空，是否继续保存？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{te(!0)}).catch(e=>{console.warn(e)}):te())},W=()=>{m.value&&(m.value.bindGroupPath=[]),M()},M=()=>{m.value&&(m.value.bindPath=[],m.value.bindColumnPath=[]),ee()},ee=()=>{m.value&&(m.value.datasetId=m.value.bindPath[0],m.value.relationId=m.value.bindPath[1],m.value.bindColumnPath=[],m.value.orderParam=[],m.value.filterParams=[])},te=(e=!1)=>{let t=null==m.value?.fragmentId;if(e&&!t){let e=ne(m.value);Array.isArray(e)&&e.forEach(e=>{l.xs.setRangeShow(e),l.xs.clearRange()})}const a=l.printInfo;t?(Array.isArray(a.fragmentJson)||(a.fragmentJson=[]),m.value&&(m.value.fragmentId=(new Date).getTime(),a.fragmentJson.push(ie(m.value)),p.value=m.value.fragmentId)):a.fragmentJson=l.printInfo.fragmentJson.map(e=>m.value&&e.fragmentId===m.value.fragmentId?ie(m.value):e),u.value=!1,s.nk.success("段落保存成功")},ae=()=>{z.s.confirm("删除段落会清空所有段落内部单元格，是否删除此段落？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=l.printInfo;e.fragmentJson=l.printInfo.fragmentJson.filter(e=>e.fragmentId!==m.value?.fragmentId);let t=pe(m.value);l.xs.setRangeShow(t),l.xs.clearRange(),p.value=void 0}).catch(e=>{console.warn(e)})},le=()=>{u.value=!1;let e=(0,I.PH)(l.printInfo.fragmentJson,p.value,"fragmentId");m.value=null==e?{}:ie(e)||{}},ie=e=>null==e?null:{...e,orderParam:(e.orderParam||[]).map(e=>({...e})),filterParams:(e.filterParams||[]).map(e=>({...e})),datasetFilterParams:(e.datasetFilterParams||[]).map(e=>({...e}))},re=e=>{if(e&&Array.isArray(l.printInfo.fragmentJson)){let t=(0,I.PH)(l.printInfo.fragmentJson,e.fragmentId,"fragmentId");if(null!=t){let a=e.startRow,l=e.startRow+e.rowSpan-1,i=t.startRow,r=t.startRow+t.rowSpan-1;if(a>i||l<r)return!0}}return!1},ne=e=>{if(e&&Array.isArray(l.printInfo.fragmentJson)){let t=(0,I.PH)(l.printInfo.fragmentJson,e.fragmentId,"fragmentId");if(null!=t){let a=e.startRow,l=e.startRow+e.rowSpan-1,i=t.startRow,r=t.startRow+t.rowSpan-1;if(a>i||l<r){let e=[];return a>i&&e.push({row:[i-1,a-2],column:[0,fe()-1]}),l<r&&e.push({row:[l,r-1],column:[0,fe()-1]}),e}}}},oe=()=>{a.show("数据集参数",j["default"],{area:["900px","650px"]},{datasetParamList:(P.value||{}).datasetParamList,datasetFilterParams:m.value?.datasetFilterParams,formParamList:l.printInfo.paramJson.map(e=>e.variableName),validFilterValueType:[c.FilterValueKind.PRINT_INPUT_PARAM,c.FilterValueKind.INPUT_DATA],path:"thirdSetReportDatasetParam"},{width:"900px",height:"400px",pathName:"/thirdParty/thirdSetReportDatasetParam"}).then(e=>{N(e)}).catch(e=>{console.warn(e)})},de=e=>{z.s.confirm("是否删除此数据集参数？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{m.value&&(m.value.datasetFilterParams=m.value.datasetFilterParams.filter(t=>t.paramName!==e.paramName))}).catch(e=>{console.warn(e)})},se=e=>{z.s.confirm("是否删除此排序？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{m.value&&(m.value.orderParam=m.value.orderParam.filter(t=>t!==e))}).catch(e=>{console.warn(e)})},ue=(e=null)=>{(0,H.C_)(P.value,F.value,m.value?.loop).then(t=>{a.show("过滤字段",G["default"],{area:["600px"]},{rowData:e,columnList:t.filterColumnTree,formParamList:l.printInfo.paramJson.map(e=>e.variableName),validFilterValueType:[c.FilterValueKind.DICT_DATA,c.FilterValueKind.COLUMN_DATA,c.FilterValueKind.PRINT_INPUT_PARAM,c.FilterValueKind.INNER_VARIABLE,c.FilterValueKind.INPUT_DATA],path:"thirdEditReportColumnFilter"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditReportColumnFilter"}).then(t=>{t&&D(e,t)}).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},pe=e=>null==e?null:{row:[Number.parseInt(e.startRow)-1,Number.parseInt(e.startRow)+Number.parseInt(e.rowSpan)-2],column:[0,fe()-1]},me=e=>{z.s.confirm("是否删除此过滤条件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{m.value&&(m.value.filterParams=m.value.filterParams.filter(t=>t!==e))}).catch(e=>{console.warn(e)})},ce=(e=null)=>{(0,H.C_)(P.value,F.value,m.value?.loop).then(t=>{a.show("排序",q["default"],{area:["600px"]},{rowData:e,columnList:t.orderColumnList,usedColumnList:(m.value?.orderParam||[]).filter(t=>!e||t.fieldName!==e.fieldName).map(e=>e.fieldName),maxOrder:(m.value?.orderParam||[]).reduce((e,t)=>Math.max(e,t.showOrder||0),0),path:"thirdEditReportColumnOrder"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditReportColumnOrder"}).then(t=>{V(e,t)}).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},fe=()=>26,ve=(e,t)=>{if(!e||null==e.showName||""===e.showName)return s.nk.error("段落名称不能为空！"),!1;if(!Array.isArray(e.bindPath)||e.bindPath.length<=0)return s.nk.error("段落绑定数据不能为空！"),!1;if(e.loop&&(P.value||{}).datasetType===c.DatasetType.API&&(!Array.isArray(e.bindColumnPath)||e.bindColumnPath.length<=0))return s.nk.error("段落绑定字段不能为空！"),!1;if(null==e.startRow||""===e.startRow)return s.nk.error("起始行不能为空！"),!1;if(null==e.rowSpan||""===e.rowSpan)return s.nk.error("行跨度不能为空！"),!1;if(Array.isArray(l.printInfo.fragmentJson)){let t=e.startRow,a=e.startRow+e.rowSpan-1;for(let i=0;i<l.printInfo.fragmentJson.length;i++){let r=l.printInfo.fragmentJson[i];if(r.fragmentId===e.fragmentId)continue;let n=r.startRow+r.rowSpan-1;if(!(a<r.startRow||t>n))return s.nk.error("当前段落所需行区域与段落【"+r.showName+"】重叠，请重新输入！"),!1}}return!0},he=()=>!u.value||(s.nk.error("段落正在编辑，不能保存！"),!1);return(0,n.wB)(()=>p.value,()=>{let e=(0,I.PH)(l.printInfo.fragmentJson,p.value,"fragmentId");m.value=null==e?{}:ie(e)||{};let t=pe(m.value);t&&setTimeout(()=>{l.xs.setRangeShow(t)},50)}),(0,n.wB)(()=>P.value,()=>{P.value&&(0,H.hw)(P.value)}),t({checkValidate:he}),(e,t)=>{const a=h.P9,l=h.AV,s=r.S2,I=i.S2,L=k.WK,w=v.xE,F=b.uD,x=E.qi,N=y._m,D=X.lq,V=B.tk,z=_.kA,Q=v.US,j=O.Ik;return(0,n.uX)(),(0,n.CE)("div",Y,[(0,n.bF)(j,{class:"base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none","flex-grow":"1"}},{header:(0,n.k6)(()=>[(0,n.Lk)("div",Z,[(0,n.bF)(I,{type:"flex",justify:"space-between",align:"middle",style:{"flex-wrap":"nowrap",width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(l,{modelValue:(0,o.R1)(p),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.i9)(p)?p.value=e:null),style:{width:"100%","margin-right":"10px"},size:"default",placeholder:"请选择段落",disabled:(0,o.R1)(u)},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.printInfo.fragmentJson,e=>((0,n.uX)(),(0,n.Wv)(a,{key:e.fragmentId,label:e.showName,value:e.fragmentId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),(0,o.R1)(u)?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(s,{key:0,size:"default",icon:(0,o.R1)(U.Plus),circle:"",title:"新建",onClick:S},null,8,["icon"])),(0,o.R1)(u)?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(s,{key:1,size:"default",icon:(0,o.R1)(U.Document),circle:"",title:"编辑",onClick:t[1]||(t[1]=e=>u.value=!0)},null,8,["icon"])),(0,o.R1)(u)?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(s,{key:2,size:"default",icon:(0,o.R1)(U.Delete),circle:"",title:"删除",onClick:ae},null,8,["icon"])),(0,o.R1)(u)?((0,n.uX)(),(0,n.Wv)(s,{key:3,size:"default",icon:(0,o.R1)(U.Check),circle:"",title:"保存",onClick:J},null,8,["icon"])):(0,n.Q3)("",!0),(0,o.R1)(u)?((0,n.uX)(),(0,n.Wv)(s,{key:4,size:"default",icon:(0,o.R1)(U.Close),circle:"",title:"取消",onClick:le},null,8,["icon"])):(0,n.Q3)("",!0)]),_:1})])]),default:(0,n.k6)(()=>[(0,n.bF)(I,{class:"edit-box",style:{width:"100%","margin-right":"10px"}},{default:(0,n.k6)(()=>[(0,n.bF)(F,{span:24,style:{padding:"16px"}},{default:(0,n.k6)(()=>[(0,n.bF)(Q,{class:"chart-attribute","label-position":"top","label-width":"70px",disabled:!(0,o.R1)(u),size:"default",onSubmit:t[13]||(t[13]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,n.k6)(()=>[(0,n.bF)(z,{style:{height:"calc(100vh - 200px)",width:"100%"},class:"custom-scroll"},{default:(0,n.k6)(()=>[(0,n.bF)(I,{gutter:10},{default:(0,n.k6)(()=>[(0,n.bF)(F,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(w,{label:"段落名称"},{default:(0,n.k6)(()=>[(0,n.bF)(L,{modelValue:(0,o.R1)(m).showName,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.R1)(m).showName=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,n.bF)(F,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(w,{label:"是否迭代"},{default:(0,n.k6)(()=>[(0,n.bF)(x,{modelValue:(0,o.R1)(m).loop,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.R1)(m).loop=e),disabled:null!=(0,o.R1)(m).fragmentId,onChange:W},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,n.bF)(F,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(w,{label:"数据分组"},{default:(0,n.k6)(()=>[((0,n.uX)(),(0,n.Wv)(N,{modelValue:(0,o.R1)(m).bindGroupPath,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,o.R1)(m).bindGroupPath=e),key:"groud_"+(0,o.R1)(m).fragmentId,style:{width:"100%"},disabled:null!=(0,o.R1)(m).fragmentId,options:(0,o.R1)(T),props:f,onChange:M},null,8,["modelValue","disabled","options"]))]),_:1})]),_:1}),(0,n.bF)(F,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(w,{label:"绑定数据"},{default:(0,n.k6)(()=>[((0,n.uX)(),(0,n.Wv)(N,{modelValue:(0,o.R1)(m).bindPath,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,o.R1)(m).bindPath=e),key:"data_"+(0,o.R1)(m).fragmentId,style:{width:"100%"},disabled:null!=(0,o.R1)(m).fragmentId,options:(0,o.R1)(A),props:f,onChange:ee},null,8,["modelValue","disabled","options"]))]),_:1})]),_:1}),((0,o.R1)(P)||{}).datasetType===(0,o.R1)(c.DatasetType).SQL||((0,o.R1)(P)||{}).datasetType===(0,o.R1)(c.DatasetType).API?((0,n.uX)(),(0,n.Wv)(F,{key:0,span:24},{default:(0,n.k6)(()=>[(0,n.bF)(K.A,{label:"数据集参数",data:(0,o.R1)(m).datasetFilterParams,disabled:!(0,o.R1)(u),onAdd:t[6]||(t[6]=e=>oe()),onEdit:t[7]||(t[7]=e=>oe()),onDelete:de,prop:{label:"paramName",value:"paramName"}},{default:(0,n.k6)(e=>[(0,n.Lk)("span",null,(0,d.v_)(e.data.paramName),1),t[14]||(t[14]=(0,n.Lk)("span",{style:{margin:"0 10px"}},"等于",-1)),(0,n.Lk)("span",null,(0,d.v_)(e.data.paramValue),1)]),_:1},8,["data","disabled"])]),_:1})):(0,n.Q3)("",!0),((0,o.R1)(P)||{}).datasetType===(0,o.R1)(c.DatasetType).API&&((0,o.R1)(m)||{}).loop?((0,n.uX)(),(0,n.Wv)(F,{key:1,span:24},{default:(0,n.k6)(()=>[(0,n.bF)(w,{label:"绑定字段"},{default:(0,n.k6)(()=>[((0,n.uX)(),(0,n.Wv)(N,{modelValue:(0,o.R1)(m).bindColumnPath,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,o.R1)(m).bindColumnPath=e),key:"column_"+(0,o.R1)(m).fragmentId,style:{width:"100%"},options:(0,o.R1)(C),props:g},null,8,["modelValue","options"]))]),_:1})]),_:1})):(0,n.Q3)("",!0),(0,n.bF)(F,{span:12},{default:(0,n.k6)(()=>[(0,n.bF)(w,{label:"起始行"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{modelValue:(0,o.R1)(m).startRow,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,o.R1)(m).startRow=e),"controls-position":"right",min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),(0,n.bF)(F,{span:12},{default:(0,n.k6)(()=>[(0,n.bF)(w,{label:"行跨度"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{modelValue:(0,o.R1)(m).rowSpan,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,o.R1)(m).rowSpan=e),"controls-position":"right",min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),((0,o.R1)(P)||{}).datasetType!==(0,o.R1)(c.DatasetType).API?((0,n.uX)(),(0,n.Wv)(F,{key:2,span:24},{default:(0,n.k6)(()=>[(0,n.bF)(K.A,{label:"过滤器",data:(0,o.R1)(m).filterParams,disabled:!(0,o.R1)(u),onAdd:t[11]||(t[11]=e=>ue()),onEdit:ue,onDelete:me,prop:{label:"paramName",value:"paramId"}},{default:(0,n.k6)(e=>[(0,n.Lk)("span",null,(0,d.v_)((e.data||{}).paramName),1),(0,n.Lk)("span",$,(0,d.v_)((0,o.R1)(c.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,n.Lk)("span",null,(0,d.v_)((e.data||{}).filterValueType===(0,o.R1)(c.FilterValueKind).INNER_VARIABLE?(0,o.R1)(c.CustomDateValueType).getValue((e.data||{}).paramValue):(e.data||{}).paramValue),1)]),_:1},8,["data","disabled"])]),_:1})):(0,n.Q3)("",!0),((0,o.R1)(P)||{}).datasetType!==(0,o.R1)(c.DatasetType).API?((0,n.uX)(),(0,n.Wv)(F,{key:3,span:24},{default:(0,n.k6)(()=>[(0,n.bF)(K.A,{label:"排序",data:(0,o.R1)(m).orderParam,disabled:!(0,o.R1)(u),onAdd:t[12]||(t[12]=e=>ce()),onEdit:ce,onDelete:se,prop:{label:"fieldName",value:"fieldName"}},{right:(0,n.k6)(e=>[e.data.asc?((0,n.uX)(),(0,n.Wv)(I,{key:0,type:"flex",align:"middle",style:{"margin-right":"5px","font-size":"12px",color:"#878d9f"}},{default:(0,n.k6)(()=>[(0,n.bF)(V,null,{default:(0,n.k6)(()=>[(0,n.bF)((0,o.R1)(U.SortUp))]),_:1}),t[15]||(t[15]=(0,n.Lk)("span",null,"正序",-1))]),_:1,__:[15]})):(0,n.Q3)("",!0),e.data.asc?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(I,{key:1,type:"flex",align:"middle",style:{"margin-right":"5px","font-size":"12px",color:"#878d9f"}},{default:(0,n.k6)(()=>[(0,n.bF)(V,null,{default:(0,n.k6)(()=>[(0,n.bF)((0,o.R1)(U.SortDown))]),_:1}),t[16]||(t[16]=(0,n.Lk)("span",null,"倒序",-1))]),_:1,__:[16]}))]),_:1},8,["data","disabled"])]),_:1})):(0,n.Q3)("",!0)]),_:1})]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})])}}});const te=(0,S.A)(ee,[["__scopeId","data-v-0f779925"]]);var ae=te,le=a(66874);const ie={class:"left-box",id:"left-box-container"},re={class:"x-spread-sheet-footer"},ne={class:"attribute-panel"},oe={style:{"flex-grow":"0","flex-shrink":"0","min-width":"100px"}},de=["title"];var se=(0,n.pM)({__name:"editTemplateTable",props:{printInfo:{}},setup(e,{expose:t}){const a=["rgba(83,109,186,0.5)","rgba(165,200,148,0.5)","rgba(250,200,88,0.5)","rgba(238,102,102,0.5)","rgba(115,192,222,0.5)","rgba(59,162,114,0.5)","rgba(252,132,82,0.5)","rgba(154,96,180,0.5)","rgba(234,124,204,0.5)"],l=e,s=(0,o.KR)(),u=(0,o.KR)({}),p=(0,o.KR)({cellType:void 0,position:void 0,cell:void 0,value:void 0,datasetId:void 0,relationId:void 0,bindDataset:void 0,imageSourceType:c.PrintCellImageSourceType.COLUMN}),f=(0,o.KR)([]),g=(0,o.KR)([]),T=(0,o.KR)([]),A=(0,o.KR)([]),L=(0,o.KR)(100);let C=null;const w=(0,n.EW)(()=>{if(null==C||!Array.isArray(C.bindGroupPath)||C.bindGroupPath.length<=0)return[];let e=C.bindGroupPath[C.bindGroupPath.length-1];return(f.value||[]).filter(t=>t.groupId===e&&t.datasetType!==c.DatasetType.API)}),P=(0,n.EW)(()=>{if(w.value.length<=0)return[];if(C?.loop){let e=new Set;return w.value.forEach(t=>{e.add(t.datasetId)}),w.value.concat(T.value.filter(t=>(t.parentId=t.masterDatasetId,e.has(t.masterDatasetId)&&t.relationType===c.ReportRelationType.ONE_TO_MANY)))}return w.value}),D=e=>{let t=null;if(Array.isArray(l.printInfo.fragmentJson)&&l.printInfo.fragmentJson.length>0)for(let a=0;a<l.printInfo.fragmentJson.length;a++){let i=l.printInfo.fragmentJson[a];if(i&&e>=Number.parseInt(i.startRow)-1&&e<=Number.parseInt(i.startRow)+Number.parseInt(i.rowSpan)-2){t={index:a,fragment:i};break}}return t},V=(0,n.EW)(()=>{if(p.value.position&&Array.isArray(l.printInfo.fragmentJson)){let e=D(p.value.position.r);return e?e.fragment:null}return null}),S=(0,n.EW)(()=>null==V.value?null:(0,I.PH)(f.value,V.value.datasetId,"datasetId")),J=(0,n.EW)(()=>{if(null==V.value)return null;let e=[];if(V.value.loop&&null!=V.value.relationId){let t=(0,I.PH)(T.value,V.value.relationId,"id");null!=t&&e.push(t)}else{let t=(0,I.PH)(f.value,V.value.datasetId,"id");null!=t&&(e.push(t),e.push(...T.value.filter(e=>e.masterDatasetId===V.value.datasetId&&e.relationType===c.ReportRelationType.ONE_TO_ONE)))}return e}),W=(0,n.EW)(()=>p.value&&V.value?p.value.bindDataset!==V.value.datasetId?(0,I.PH)(T.value,p.value.bindDataset,"id"):(0,I.PH)(f.value,p.value.bindDataset,"id"):null),O=(0,n.EW)(()=>{if(!S.value)return[];let e=(W.value||{}).columnList||[];return S.value.datasetType===c.DatasetType.API?p.value.cellType===c.PrintCellType.IMAGE&&p.value.imageSourceType===c.PrintCellImageSourceType.COLUMN?e.map(e=>({...e,disabled:"Array"!==e.fieldType&&"Object"!==e.fieldType&&!e.image})):e:p.value.cellType===c.PrintCellType.IMAGE&&p.value.imageSourceType===c.PrintCellImageSourceType.COLUMN?(e||[]).filter(e=>e.image):e}),B=(0,n.EW)(()=>{if(null==V.value)return[];let e=(0,I.BN)(O.value.map(e=>({...e})),"columnId","parentId");if(V.value.loop){let t=V.value.bindColumnPath[V.value.bindColumnPath.length-1],a=(0,I.Ee)(e,t,"columnName","children");return a?[a]:[]}{let e=(0,H.Z4)(O.value,"Object",!0);return e}}),X=()=>{u.value.addRow(null,L.value)},U=()=>s.value.checkValidate(),z=e=>{if(Array.isArray(e)){let t=[],a=!0,l=B.value;for(let i=0;i<e.length;i++){let r=e[i],n=(0,I.PH)(l,r,"id");if(null==n)return void(a=!1);t.push(n),l=n.children}return a?t:null}return(0,I.PH)(O.value,e,"id")},K=(e=void 0)=>{if(p.value&&p.value.position&&e){let t,a=e,l=z(e),i=Array.isArray(l)?l[l.length-1]:l;p.value.cellType===c.PrintCellType.COLUMN||p.value.cellType===c.PrintCellType.BARCODE||p.value.cellType===c.PrintCellType.QRCODE?a=null==p.value.columnName?void 0:JSON.stringify({cellType:p.value.cellType,value:e,datasetId:(V.value||{}).datasetId,relationId:(S.value||{}).datasetType!==c.DatasetType.API?p.value.relationId:void 0,columnName:p.value.columnName,fieldType:i?i.fieldType:void 0,barCodeType:p.value.cellType===c.PrintCellType.BARCODE||p.value.cellType===c.PrintCellType.QRCODE?p.value.barCodeType:void 0,barCodeShowWords:p.value.cellType===c.PrintCellType.BARCODE?p.value.barCodeShowWords:void 0,datasetType:(S.value||{}).datasetType}):p.value.cellType===c.PrintCellType.IMAGE&&(a=null==p.value.columnName?void 0:JSON.stringify({cellType:p.value.cellType,imageSourceType:p.value.imageSourceType,value:e,datasetId:(V.value||{}).datasetId,relationId:(S.value||{}).datasetType!==c.DatasetType.API?p.value.relationId:void 0,columnName:p.value.columnName,fieldType:i?i.fieldType:void 0,barCodeType:void 0,barCodeShowWords:void 0,datasetType:(S.value||{}).datasetType})),console.log(e),null==e||""===e?t="":-1!==[c.PrintCellType.COLUMN,c.PrintCellType.BARCODE,c.PrintCellType.QRCODE,c.PrintCellType.IMAGE].indexOf(p.value.cellType)&&(t=Array.isArray(e)?e.join(" / "):e,""!==t&&(t=`{${t}}`)),console.log(e,t,"]]]]]"),u.value.setCellValue(p.value.position.r,p.value.position.c,{...p.value.cell,v:null==a?"":a,text:t})}},Q=()=>{if(V.value&&p.value){const e={...p.value};p.value.columnName=void 0,p.value.cellType===c.PrintCellType.BARCODE?e.barCodeType=c.PrintQRCodeType.CODE_128:p.value.cellType===c.PrintCellType.QRCODE?e.barCodeType=c.PrintQRCodeType.QR_CODE:e.barCodeType=void 0,e.barCodeShowWords=!1,!V.value.loop&&e.value&&(e.relationId=void 0),p.value=e}K()},j=(e,t=!1)=>{V.value.loop?p.value.relationId=e:e===V.value.datasetId?(p.value.datasetId=e,p.value.relationId=void 0):p.value.relationId=e,t||(p.value.columnName=void 0,K(p.value.columnName))},G=()=>u.value.getData(),q=(e,t)=>{console.log("getFragmentByRange",e,t,l.printInfo);let a=[];if(Array.isArray(l.printInfo.fragmentJson)&&l.printInfo.fragmentJson.length>0)for(let i=0;i<l.printInfo.fragmentJson.length;i++){let r=l.printInfo.fragmentJson[i],n=Number.parseInt(r.startRow)-1,o=Number.parseInt(r.startRow)+Number.parseInt(r.rowSpan)-2;if(n>t)break;n<=t&&o>=e&&a.push({index:i,fragment:r,startRow:n,endRow:o})}return a};t({getSheetData:G,getFragmentByRange:q,checkValidate:U,getDatasetRelation:P});const Y=()=>{A.value=[],N.v9.dictReportDict({}).then(e=>{A.value=e.getList()}).catch(e=>{console.warn(e)})},Z=()=>{m.AX.listAll({}).then(e=>{g.value=(e.data.reportDatasetGroupList||[]).map(e=>({...e,id:e.groupId,name:e.groupName})),f.value=(e.data.reportDatasetList||[]).map(e=>{try{let t=JSON.parse(e.datasetInfo);e.datasetParamList=t.paramList}catch(t){e.datasetParamList=[]}return{...e,id:e.datasetId,name:e.datasetName,columnList:void 0}}),T.value=(e.data.reportDatasetRelationList||[]).map(e=>({...e,id:e.relationId,name:e.variableName,columnList:void 0}))}).catch(e=>{console.warn(e)})};return(0,n.xo)(()=>{console.log("before unmount",u.value)}),(0,n.sV)(()=>{Y(),Z();const e=document.getElementById("left-box-container"),t={height:()=>e?e.clientHeight-50:void 0,width:()=>e?.clientWidth},i=e=>{let t=D(e);return null!=t?{fillStyle:a[t.index%a.length]}:null};let r=new le.A("#x-spread-sheet",{view:t,leftFixHeaderRender:i,row:{len:30,height:25},showBottomBar:!1});u.value=r,l.printInfo.sheetDataJson&&l.printInfo.sheetDataJson.length>0&&u.value.setData(l.printInfo.sheetDataJson),u.value.on("cell-selected",(e,t,a)=>{let l,i,r={columnName:void 0,fieldType:void 0,datasetId:void 0,relationId:void 0,bindDataset:void 0,imageSourceType:c.PrintCellImageSourceType.COLUMN,datasetType:void 0};if(null!=e)try{i=JSON.parse(e.v),l=null!=i&&null!=i.value?i.value:e.v,null==i||i.cellType!==c.PrintCellType.COLUMN&&i.cellType!==c.PrintCellType.BARCODE&&i.cellType!==c.PrintCellType.QRCODE&&i.cellType!==c.PrintCellType.IMAGE||(r={columnName:i.columnName,fieldType:i.fieldType,datasetId:i.datasetId,relationId:i.relationId,bindDataset:i.relationId||i.datasetId,imageSourceType:i.imageSourceType||c.PrintCellImageSourceType.COLUMN,barCodeType:i.barCodeType||(i.cellType===c.PrintCellType.QRCODE?c.PrintQRCodeType.QR_CODE:c.PrintBarCodeType.CODE_128),barCodeShowWords:i.barCodeShowWords||!1,datasetType:i.datasetType})}catch(n){i=null,l=e.v}p.value={position:{r:t,c:a},cellType:(i||{}).cellType||c.PrintCellType.COLUMN,cell:e,value:l,...r}}),u.value.on("cell-edited",(e,t,a)=>{if(p.value.position.r+"-"+p.value.position.c===t+"-"+a){`{${e}}`!==p.value.columnName&&void 0!==p.value.columnName&&(p.value.columnName=void 0,p.value.datasetType=void 0,p.value.fieldType=void 0,p.value.relationId=void 0,p.value.value=void 0);let t={...p.value.cell,text:e};t.v&&delete t.v,console.log(t),u.value.setCellValue(p.value.position.r,p.value.position.c,t)}})}),(0,n.wB)(()=>W.value,e=>{e&&(0,H.hw)(e).catch(e=>{console.warn(e)})}),(0,n.wB)(()=>J.value,()=>{p.value&&null==p.value.bindDataset&&J.value&&(p.value.bindDataset=(J.value[0]||{}).id,j(p.value.bindDataset,!0))}),(e,t)=>{const a=r.S2,l=k.WK,m=v.xE,I=h.P9,A=h.AV,C=E.qi,w=x.u,P=i.S2,N=y._m,D=_.kA,W=v.US,U=b.uD,z=F.v$,G=F.q;return(0,n.uX)(),(0,n.Wv)(P,{type:"flex",class:"print-template-edit"},{default:(0,n.k6)(()=>[(0,n.bF)(M),(0,n.bF)(ae,{xs:(0,o.R1)(u),ref_key:"refLeftPanel",ref:s,printInfo:e.printInfo,datasetList:(0,o.R1)(f),datasetGroupList:(0,o.R1)(g),datasetRelationList:(0,o.R1)(T)},null,8,["xs","printInfo","datasetList","datasetGroupList","datasetRelationList"]),(0,n.Lk)("div",ie,[t[16]||(t[16]=(0,n.Lk)("div",{class:"x-spread-sheet-container"},[(0,n.Lk)("div",{id:"x-spread-sheet"})],-1)),(0,n.Lk)("div",re,[(0,n.bF)(a,{onClick:X,size:"default"},{default:(0,n.k6)(()=>t[13]||(t[13]=[(0,n.eW)("添加")])),_:1,__:[13]}),(0,n.bF)(l,{style:{width:"60px","margin-left":"10px"},size:"default",modelValue:(0,o.R1)(L),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.i9)(L)?L.value=e:null),placeholder:""},null,8,["modelValue"]),t[14]||(t[14]=(0,n.Lk)("span",null,"行",-1)),t[15]||(t[15]=(0,n.Lk)("span",{class:"x-spread-sheet-footer-tip"},"(在底添加)",-1))])]),(0,n.bF)(P,{class:"edit-box"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",ne,[(0,n.bF)(G,{modelValue:"cell"},{default:(0,n.k6)(()=>[(0,n.bF)(z,{label:"单元格",name:"cell"},{label:(0,n.k6)(()=>t[17]||(t[17]=[(0,n.Lk)("span",null,"单元格",-1)])),default:(0,n.k6)(()=>[(0,n.bF)(U,{span:24,style:{padding:"0px 16px"}},{default:(0,n.k6)(()=>[(0,n.bF)(W,{class:"chart-attribute","label-position":"top","label-width":"70px",size:"default",onSubmit:t[12]||(t[12]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,n.k6)(()=>[(0,n.bF)(D,{style:{height:"calc(100vh - 132px)"},class:"custom-scroll"},{default:(0,n.k6)(()=>[(0,n.bF)(m,{class:"view-attribute-item mt-10",label:"所属段落",style:{"padding-top":"16px"}},{default:(0,n.k6)(()=>[(0,n.bF)(l,{value:((0,o.R1)(V)||{}).showName,readonly:""},null,8,["value"])]),_:1}),(0,n.bF)(m,{class:"view-attribute-item",label:"单元格类型"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{modelValue:(0,o.R1)(p).cellType,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.R1)(p).cellType=e),style:{width:"100%"},onChange:Q},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(c.PrintCellType).getList(),e=>((0,n.uX)(),(0,n.Wv)(I,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).IMAGE?((0,n.uX)(),(0,n.Wv)(m,{key:0,class:"view-attribute-item",label:"图片来源"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{modelValue:(0,o.R1)(p).imageSourceType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.R1)(p).imageSourceType=e),placeholder:"",style:{width:"100%"}},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(c.PrintCellImageSourceType).getList(),e=>((0,n.uX)(),(0,n.Wv)(I,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,n.Q3)("",!0),(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).BARCODE?((0,n.uX)(),(0,n.Wv)(m,{key:1,class:"view-attribute-item",label:"条形码类型"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{modelValue:(0,o.R1)(p).barCodeType,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.R1)(p).barCodeType=e),placeholder:"",style:{width:"100%"},onChange:t[4]||(t[4]=e=>K((0,o.R1)(p).columnName))},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(c.PrintBarCodeType).getList(),e=>((0,n.uX)(),(0,n.Wv)(I,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,n.Q3)("",!0),(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).BARCODE?((0,n.uX)(),(0,n.Wv)(m,{key:2,class:"view-attribute-item",label:"显示文字"},{default:(0,n.k6)(()=>[(0,n.bF)(C,{modelValue:(0,o.R1)(p).barCodeShowWords,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,o.R1)(p).barCodeShowWords=e),onChange:t[6]||(t[6]=e=>K((0,o.R1)(p).columnName))},null,8,["modelValue"])]),_:1})):(0,n.Q3)("",!0),(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).QRCODE?((0,n.uX)(),(0,n.Wv)(m,{key:3,class:"view-attribute-item",label:"二维码类型"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{modelValue:(0,o.R1)(p).barCodeType,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,o.R1)(p).barCodeType=e),placeholder:"",style:{width:"100%"},onChange:t[8]||(t[8]=e=>K((0,o.R1)(p).columnName))},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(c.PrintQRCodeType).getList(),e=>((0,n.uX)(),(0,n.Wv)(I,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,n.Q3)("",!0),(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).COLUMN||(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).BARCODE||(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).QRCODE||(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).IMAGE&&(0,o.R1)(p).imageSourceType===(0,o.R1)(c.PrintCellImageSourceType).COLUMN?((0,n.uX)(),(0,n.Wv)(m,{key:4,class:"view-attribute-item",label:"单元格数据集"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{modelValue:(0,o.R1)(p).bindDataset,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,o.R1)(p).bindDataset=e),placeholder:"",style:{width:"100%"},onChange:j},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(J),e=>((0,n.uX)(),(0,n.Wv)(I,{key:e.id,label:e.name,value:e.id},{default:(0,n.k6)(()=>[(0,n.bF)(P,{type:"flex",justify:"space-between",align:"middle"},{default:(0,n.k6)(()=>[(0,n.Lk)("span",null,(0,d.v_)(e.name),1),(0,n.bF)(w,{size:"default",type:e.id===(0,o.R1)(V).datasetId?"success":"primary"},{default:(0,n.k6)(()=>[(0,n.eW)((0,d.v_)(e.id===(0,o.R1)(V).datasetId?"主数据集":(0,o.R1)(c.ReportRelationType).getValue(e.relationType)),1)]),_:2},1032,["type"])]),_:2},1024)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,n.Q3)("",!0),(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).COLUMN||(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).BARCODE||(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).QRCODE||(0,o.R1)(p).cellType===(0,o.R1)(c.PrintCellType).IMAGE&&(0,o.R1)(p).imageSourceType===(0,o.R1)(c.PrintCellImageSourceType).COLUMN?((0,n.uX)(),(0,n.Wv)(m,{key:5,class:"view-attribute-item",label:"单元格字段"},{default:(0,n.k6)(()=>[((0,o.R1)(S)||{}).datasetType!==(0,o.R1)(c.DatasetType).API?((0,n.uX)(),(0,n.Wv)(A,{key:0,modelValue:(0,o.R1)(p).columnName,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,o.R1)(p).columnName=e),placeholder:"",style:{width:"100%"},"popper-options":{placement:"bottom-end"},clearable:"",onChange:K},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,o.R1)(O),e=>((0,n.uX)(),(0,n.Wv)(I,{key:e.id,label:e.name,value:e.id},{default:(0,n.k6)(()=>[(0,n.bF)(P,{type:"flex",justify:"space-between",align:"middle"},{default:(0,n.k6)(()=>[(0,n.Lk)("span",oe,(0,d.v_)(e.name),1),(0,n.Lk)("span",{style:{overflow:"hidden","max-width":"300px","margin-left":"10px","text-overflow":"ellipsis","white-space":"nowrap"},title:e.columnComment},(0,d.v_)(e.columnComment),9,de)]),_:2},1024)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])):((0,n.uX)(),(0,n.Wv)(N,{key:1,modelValue:(0,o.R1)(p).columnName,"onUpdate:modelValue":t[11]||(t[11]=e=>(0,o.R1)(p).columnName=e),style:{width:"100%"},clearable:"",placeholder:"",options:(0,o.R1)(B),props:{value:"id",label:"name"},onChange:K},null,8,["modelValue","options"]))]),_:1})):(0,n.Q3)("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}});const ue=(0,S.A)(se,[["__scopeId","data-v-fa289356"]]);var pe=ue,me=a(92358),ce=(a(5954),a(20116),a(14603),a(47566),a(98721),a(99540)),fe=a(8588),ve=a(31932),he=a(13180),ge=a(28360),ye=a(11923),be=a(18384);const ke={class:"main-box"},Re={class:"upload-box"},Ie={key:0,class:"el-upload__text"},Te=["href"];var Ae=(0,n.pM)({__name:"editTemplateWord",props:{printInfo:{default:()=>({printId:void 0,wordTemplate:void 0,fragmentJson:[]})},dialog:{default:void 0}},setup(e){const t=(0,A.l5)(),{getUploadHeaders:a,getUploadActionUrl:l,fileListToJson:u,parseUploadData:p,getPictureList:c}=(0,ve.v)(),{Delete:f,Search:v,Edit:h,Plus:g,Refresh:y,Picture:b,Dialog:k,mainContextHeight:T,clientHeight:L,checkPermCodeExist:C,parseParams:w,parseArrayParams:P,formatDateByStatsType:F,getDateRangeFilter:_}=(0,fe.x)(),E=e,N=(0,o.Kh)({datasetGroupList:[],datasetList:[]}),D=(0,he.D)(1),{fileList:V,maxCount:S}=D,J=(0,n.EW)(()=>E.printInfo.fragmentJson.filter(e=>{let t=N.datasetList.find(t=>t.datasetId===e.datasetId);return console.log(t),e.datasetPath=(t||{}).datasetName||"",!0})),W=(0,n.EW)(()=>{let e=new Map;N.datasetGroupList.forEach(t=>{e.set(t.groupId,t)});let t=[];N.datasetList.forEach(a=>{let l=a.parentId;while(l){t.push(l);let a=e.get(l);l=a?a.parentId:null}});let a=N.datasetGroupList.filter(e=>-1!==t.indexOf(e.id)).concat(N.datasetList);return a=(0,I.BN)(a,"id","parentId"),console.log(a),a}),M=()=>{m.AX.listAll({}).then(e=>{N.datasetGroupList=(e.data.reportDatasetGroupList||[]).map(e=>({...e,id:e.groupId,name:e.groupName})),N.datasetList=(e.data.reportDatasetList||[]).map(e=>{try{let t=JSON.parse(e.datasetInfo);e.datasetParamList=t.paramList}catch(t){e.datasetParamList=[]}return{...e,parentId:e.groupId,id:e.datasetId,name:e.datasetName,columnList:void 0,isDataset:!0}})}).catch(e=>{console.error(e)})},O=e=>{k.show(e?"编辑数据集":"新增数据集",ge["default"],{area:["500px","600px"]},{rowData:e,printInfo:E.printInfo,datasetTree:W.value,path:"thirdPrintEditTemplateWord"},{width:"500px",height:"600px",pathName:"/thirdParty/thirdPrintEditTemplateWord"}).then(t=>{e?E.printInfo.fragmentJson=E.printInfo.fragmentJson.map(a=>a===e?t:a):E.printInfo.fragmentJson.push(t)}).catch(e=>{console.error(e)})},X=e=>{z.s.confirm("确定删除该数据集吗？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{E.printInfo.fragmentJson=E.printInfo.fragmentJson.filter(t=>t!==e)}).catch(()=>{})},K=e=>{let t=N.datasetList.find(t=>t.datasetId===e.datasetId);k.show("字段管理",ye["default"],{area:["1400px","800px"]},{datasetInfo:{datasetId:e.datasetId,name:e.datasetPath},datasetRelationList:((t||{}).relationList||[]).map(e=>({datasetId:e.slaveDatasetId,relationId:e.relationId,name:e.variableName})),datasetColumnInfo:e.datasetColumnInfo,path:"thirdPrintEditTemplateWordColumn"},{width:"1400px",height:"800px",pathName:"/thirdParty/thirdPrintEditTemplateWordColumn"}).then(t=>{e.datasetColumnInfo=t}).catch(e=>{console.error(e)})},Q=(e,t,a)=>{e.success?(t.downloadUri=e.data.downloadUri,t.filename=e.data.filename,t.uploadPath=e.data.uploadPath,t.url=URL.createObjectURL(t.raw),D.onFileChange(t,[t]),E.printInfo.wordTemplate=u(V.value)):s.nk.error(e.message)},j=()=>{s.nk.error("文件上传失败")};return(0,n.sV)(()=>{M();let e={printId:E.printInfo.printId,fieldName:"wordTemplate",asImage:!1};D.fileList.value=p(E.printInfo.wordTemplate,e)}),(e,s)=>{const u=x.u,p=r.S2,m=B.tk,c=me.j5,f=i.S2;return(0,n.uX)(),(0,n.Wv)(f,{type:"flex",justify:"center",class:"edit-template-word"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",ke,[(0,n.bF)((0,o.R1)(ce.CP),{data:J.value,size:(0,o.R1)(t).defaultFormItemSize,"row-config":{isHover:!0},style:{width:"100%"},"header-cell-class-name":"table-header-gray"},{default:(0,n.k6)(()=>[(0,n.bF)((0,o.R1)(ce.Wq),{title:"数据名称",field:"showName"}),(0,n.bF)((0,o.R1)(ce.Wq),{title:"数据标识",field:"variableName"}),(0,n.bF)((0,o.R1)(ce.Wq),{title:"数据集",field:"datasetPath"}),(0,n.bF)((0,o.R1)(ce.Wq),{title:"是否迭代",field:"loop",width:"80px"},{default:(0,n.k6)(e=>[(0,n.bF)(u,{size:"default",type:e.row.loop?"success":"danger"},{default:(0,n.k6)(()=>[(0,n.eW)((0,d.v_)(e.row.loop?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),(0,n.bF)((0,o.R1)(ce.Wq),{title:"操作",width:"200px"},{default:(0,n.k6)(e=>[(0,n.bF)(p,{size:"default",type:"primary",link:"",onClick:t=>O(e.row)},{default:(0,n.k6)(()=>s[2]||(s[2]=[(0,n.eW)(" 编辑 ")])),_:2,__:[2]},1032,["onClick"]),(0,n.bF)(p,{size:"default",type:"primary",link:"",onClick:t=>K(e.row)},{default:(0,n.k6)(()=>s[3]||(s[3]=[(0,n.eW)(" 字段管理 ")])),_:2,__:[3]},1032,["onClick"]),(0,n.bF)(p,{size:"default",type:"primary",link:"",onClick:t=>X(e.row)},{default:(0,n.k6)(()=>s[4]||(s[4]=[(0,n.eW)(" 删除 ")])),_:2,__:[4]},1032,["onClick"])]),_:1})]),_:1},8,["data","size"]),(0,n.bF)(p,{style:{width:"100%","margin-top":"10px",border:"1px dashed #ebeef5"},size:(0,o.R1)(t).defaultFormItemSize,icon:(0,o.R1)(g),onClick:s[0]||(s[0]=e=>O())},{default:(0,n.k6)(()=>s[5]||(s[5]=[(0,n.eW)(" 新增数据集 ")])),_:1,__:[5]},8,["size","icon"]),(0,n.Lk)("div",Re,[(0,n.bF)(c,{name:"uploadFile",drag:"",headers:(0,o.R1)(a),accept:".doc,.docx","file-list":(0,o.R1)(V),"show-file-list":!1,action:(0,o.R1)(l)((0,o.R1)(be.x)+"/report/reportPrint/upload"),data:{fieldName:"wordTemplate",asImage:!1},"on-success":Q,"on-error":j,style:{width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(m,{class:"el-icon-upload",size:"67px",color:"#C0C4CC"},{default:(0,n.k6)(()=>[(0,n.bF)((0,o.R1)(U.UploadFilled))]),_:1}),(0,o.R1)(V).length<=0?((0,n.uX)(),(0,n.CE)("div",Ie,s[6]||(s[6]=[(0,n.eW)(" 将模版文件拖到此处，或"),(0,n.Lk)("em",null,"点击上传",-1)]))):((0,n.uX)(),(0,n.CE)("a",{key:1,class:"el-upload__text",href:(0,o.R1)(V)[0].url,target:"_blank",style:{display:"block","margin-top":"10px"},onClick:s[1]||(s[1]=(0,R.D$)(()=>{},["stop"]))},[(0,n.bF)(p,{style:{width:"100%",border:"1px dashed #ebeef5"},icon:(0,o.R1)(U.Download)},{default:(0,n.k6)(()=>[(0,n.eW)((0,d.v_)((0,o.R1)(V)[0].name||(0,o.R1)(V)[0].filename),1)]),_:1},8,["icon"])],8,Te))]),_:1},8,["headers","file-list","action"])])])]),_:1})}}});const Le=(0,S.A)(Ae,[["__scopeId","data-v-28cc572d"]]);var Ce=Le,we=a(52920),Pe=(a(95509),a(19784),a(97456)),Fe=(a(15936),a(31372)),_e=a(14908),xe=a(87351),Ee=a(67192),Ne=a(80427);const De={class:"left-menu"},Ve={class:"img-box"},Se={key:0,src:_e,alt:"",style:{width:"20px"}},Je={key:1,src:xe,alt:"",style:{width:"20px"}},We={class:"img-box"},Me={key:0,src:Ee,alt:"",style:{width:"20px"}},Oe={key:1,src:Ne,alt:"",style:{width:"20px"}};var Be=(0,n.pM)({__name:"LeftPanel",props:{modelValue:{default:"form"}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,i=(0,n.EW)(()=>l.modelValue),r=e=>{a("update:modelValue",e),a("change",e)};return(e,t)=>((0,n.uX)(),(0,n.CE)("div",De,[(0,n.Lk)("div",{class:(0,d.C4)(["left-menu-item",{active:"form"===(0,o.R1)(i)}]),onClick:t[0]||(t[0]=e=>r("form"))},[(0,n.Lk)("div",Ve,["form"===(0,o.R1)(i)?((0,n.uX)(),(0,n.CE)("img",Se)):((0,n.uX)(),(0,n.CE)("img",Je))]),t[2]||(t[2]=(0,n.Lk)("span",{style:{"margin-top":"4px"}},"组件",-1))],2),(0,n.Lk)("div",{class:(0,d.C4)(["left-menu-item",{active:"data"===(0,o.R1)(i)}]),style:{"margin-top":"40px"},onClick:t[1]||(t[1]=e=>r("data"))},[(0,n.Lk)("div",We,["data"===(0,o.R1)(i)?((0,n.uX)(),(0,n.CE)("img",Me)):((0,n.uX)(),(0,n.CE)("img",Oe))]),t[3]||(t[3]=(0,n.Lk)("span",{style:{"margin-top":"4px"}},"数据",-1))],2)]))}});const Xe=(0,S.A)(Be,[["__scopeId","data-v-c8f258da"]]);var Ue=Xe;const ze={class:"base-card-header"};function Ke(e,t,a,l,o,d){const s=h.P9,u=h.AV,p=r.S2,m=i.S2,c=(0,n.g2)("DatasetItem"),f=_.kA,v=O.Ik;return(0,n.uX)(),(0,n.Wv)(v,{class:"data-card base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none","flex-grow":"1"}},{header:(0,n.k6)(()=>[(0,n.Lk)("div",ze,[(0,n.bF)(m,{type:"flex",justify:"space-between",align:"middle",style:{"flex-wrap":"nowrap",width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(u,{modelValue:o.currentItemId,"onUpdate:modelValue":t[0]||(t[0]=e=>o.currentItemId=e),style:{width:"100%","margin-right":"10px"},size:"default",placeholder:"请选择数据集",disabled:o.isEdit},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.printDatasetList,e=>((0,n.uX)(),(0,n.Wv)(s,{key:e.id,label:e.showName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),o.isEdit?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(p,{key:0,size:"default",icon:o.Plus,circle:"",title:"新建",onClick:d.handleAddDataset},null,8,["icon","onClick"])),o.isEdit?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(p,{key:1,size:"default",icon:o.Document,circle:"",title:"编辑",onClick:d.handleEditDataset},null,8,["icon","onClick"])),o.isEdit?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(p,{key:2,size:"default",icon:o.Delete,circle:"",title:"删除",onClick:d.handleDeleteDataset},null,8,["icon","onClick"])),o.isEdit?((0,n.uX)(),(0,n.Wv)(p,{key:3,size:"default",icon:o.Check,circle:"",title:"保存",onClick:d.handleSaveDataset},null,8,["icon","onClick"])):(0,n.Q3)("",!0),o.isEdit?((0,n.uX)(),(0,n.Wv)(p,{key:4,size:"default",icon:o.Close,circle:"",title:"取消",onClick:d.handleCancelEditDataset},null,8,["icon","onClick"])):(0,n.Q3)("",!0)]),_:1})])]),default:(0,n.k6)(()=>[(0,n.bF)(m,{style:{height:"calc(100% - 53px)"}},{default:(0,n.k6)(()=>[(0,n.bF)(f,{style:{height:"100%",padding:"16px",width:"100%"}},{default:(0,n.k6)(()=>[o.currentItem?((0,n.uX)(),(0,n.Wv)(c,{key:0,ref:"datasetItemRef",isEdit:o.isEdit,dataset:o.currentItem,"onUpdate:dataset":t[1]||(t[1]=e=>o.currentItem=e),printInfo:a.printInfo,datasetGroupList:a.datasetGroupList,datasetList:a.datasetList,datasetRelationList:a.datasetRelationList,dictList:a.dictList},null,8,["isEdit","dataset","printInfo","datasetGroupList","datasetList","datasetRelationList","dictList"])):(0,n.Q3)("",!0)]),_:1})]),_:1})]),_:1})}const Qe={class:"print-dataset-item"},je={style:{margin:"0px 10px"}},Ge={key:0,class:"el-icon-sort-up",style:{color:"#878d9f","margin-right":"5px","font-size":"12px"}},qe={key:1,class:"el-icon-sort-down",style:{color:"#878d9f","margin-right":"5px","font-size":"12px"}};var He=(0,n.pM)({__name:"printDatasetItem",props:{dataset:{},isEdit:{type:Boolean,default:!1},printInfo:{},datasetGroupList:{default:()=>[]},datasetList:{default:()=>[]},datasetRelationList:{default:()=>[]},dictList:{default:()=>[]},thirdParamsString:{},dialogKey:{}},emits:["update:dataset"],setup(e,{expose:t,emit:a}){const l=a,r=e,s=(0,o.KR)(),u=(0,o.KR)({id:void 0,showName:"",datasetId:void 0,variableName:"",loop:!1,filterParams:[],orderParam:[],datasetFilterParams:[]}),p={showName:[{required:!0,message:"请输入显示名称",trigger:"blur"}],variableName:[{required:!0,message:"请输入数据标识",trigger:"blur"}],datasetId:[{required:!0,message:"请选择数据集",trigger:"blur"}]},m=(0,n.EW)(()=>r.datasetList.find(e=>e.id===u.value.datasetId)||{}),f=()=>{l("update:dataset",u.value)};(0,n.wB)(()=>r.dataset,e=>{console.log("props.dataset changed",e),e&&(u.value=JSON.parse(JSON.stringify(e)))},{immediate:!0,deep:!0});const g=e=>{"thirdSetReportDatasetParam"===e.path&&e.isSuccess?R(e.data):"thirdEditReportColumnFilter"===e.path&&e.isSuccess?I(e.rowData,e.data):"thirdEditReportColumnOrder"===e.path&&e.isSuccess&&T(e.rowData,e.data)},y=async()=>{try{const e=await s.value.validate();return e}catch(e){return console.error("Form validation failed:",e),!1}};t({refreshData:g,validateForm:y});const R=e=>{u.value.datasetFilterParams=(e||[]).map(e=>({paramName:e.paramName,filterValueType:e.filterValueType,paramValue:e.paramValue})),f()},I=(e,t)=>{null==e?u.value.filterParams.push({paramId:t.paramId,required:t.required,paramName:t.paramName,filterType:t.filterType,filterValueType:t.filterValueType,paramDictId:t.paramDictId,paramValue:t.paramValue,relationId:t.relationId}):u.value.filterParams=u.value.filterParams.map(e=>e.paramId===t.paramId?{paramId:t.paramId,required:t.required,paramName:t.paramName,filterType:t.filterType,filterValueType:t.filterValueType,paramDictId:t.paramDictId,paramValue:t.paramValue,relationId:t.relationId}:e),f()},T=(e,t)=>{null==e?u.value.orderParam.push({...t}):u.value.orderParam=u.value.orderParam.map(a=>a.fieldName===e.fieldName?{...t}:a),u.value.orderParam=u.value.orderParam.sort((e,t)=>e.showOrder-t.showOrder),f()},A=e=>{u.value.loop=!1,u.value.datasetFilterParams=[],u.value.filterParams=[],u.value.orderParam=[],f()},L=()=>{Fe.l.show("数据集参数",j["default"],{area:["900px","650px"]},{datasetParamList:(m.value||{}).datasetParamList,datasetFilterParams:u.value.datasetFilterParams,formParamList:r.printInfo.paramJson.map(e=>e.variableName),validFilterValueType:[c.FilterValueKind.PRINT_INPUT_PARAM,c.FilterValueKind.INPUT_DATA],path:"thirdSetReportDatasetParam"},{width:"900px",height:"700px",pathName:"/thirdParty/thirdSetReportDatasetParam"}).then(e=>{R(e)}).catch(e=>{})},C=e=>{z.s.confirm("是否删除此数据集参数？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{u.value.datasetFilterParams=u.value.datasetFilterParams.filter(t=>t.paramName!==e.paramName),f()}).catch(e=>{})},w=e=>{z.s.confirm("是否删除此排序？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{u.value.orderParam=u.value.orderParam.filter(t=>t!==e),f()}).catch(e=>{})},P=e=>{console.log("onEditFilter",e,m.value),(0,H.C_)(m.value,null,u.value.loop).then(t=>{console.log(t),Fe.l.show("过滤字段",G["default"],{area:["600px"]},{rowData:e,columnList:t.filterColumnTree,formParamList:r.printInfo.paramJson.map(e=>e.variableName),validFilterValueType:[c.FilterValueKind.DICT_DATA,c.FilterValueKind.COLUMN_DATA,c.FilterValueKind.PRINT_INPUT_PARAM,c.FilterValueKind.INNER_VARIABLE,c.FilterValueKind.INPUT_DATA],reportDictList:r.dictList,path:"thirdEditReportColumnFilter"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditReportColumnFilter"}).then(t=>{I(e,t)}).catch(e=>{})}).catch(e=>{})},F=e=>{z.s.confirm("是否删除此过滤条件？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{u.value.filterParams=u.value.filterParams.filter(t=>t!==e),f()}).catch(e=>{})},_=e=>{(0,H.C_)(m.value,null,u.value.loop).then(t=>{console.log(t),Fe.l.show("排序",q["default"],{area:["600px"]},{rowData:e,columnList:t.orderColumnList,usedColumnList:(u.value.orderParam||[]).filter(t=>!e||t.fieldName!==e.fieldName).map(e=>e.fieldName),maxOrder:(u.value.orderParam||[]).reduce((e,t)=>Math.max(e,t.showOrder||0),0),path:"thirdEditReportColumnOrder"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditReportColumnOrder"}).then(t=>{T(e,t)}).catch(e=>{})}).catch(e=>{})};return(e,t)=>{const a=k.WK,l=v.xE,r=b.uD,g=h.P9,y=h.AV,R=E.qi,I=v.US,T=i.S2;return(0,n.uX)(),(0,n.CE)("div",Qe,[(0,n.bF)(T,null,{default:(0,n.k6)(()=>[(0,n.bF)(I,{class:"chart-attribute",ref_key:"form",ref:s,model:(0,o.R1)(u),rules:p,"label-position":"top",size:"default",style:{height:"100%",width:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(r,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(l,{label:"显示名称",prop:"showName"},{default:(0,n.k6)(()=>[(0,n.bF)(a,{modelValue:(0,o.R1)(u).showName,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.R1)(u).showName=e),disabled:!e.isEdit,clearable:"",onChange:f},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,n.bF)(r,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(l,{label:"数据标识",prop:"variableName"},{default:(0,n.k6)(()=>[(0,n.bF)(a,{modelValue:(0,o.R1)(u).variableName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.R1)(u).variableName=e),disabled:!e.isEdit,clearable:"",onChange:f},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,n.bF)(r,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(l,{label:"数据集",prop:"datasetId"},{default:(0,n.k6)(()=>[(0,n.bF)(y,{modelValue:(0,o.R1)(u).datasetId,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.R1)(u).datasetId=e),clearable:"",filterable:"",disabled:!e.isEdit,placeholder:"请选择数据集",onChange:A},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.datasetList,e=>((0,n.uX)(),(0,n.Wv)(g,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,n.bF)(r,{span:24},{default:(0,n.k6)(()=>[(0,n.bF)(l,{label:"是否迭代"},{default:(0,n.k6)(()=>[(0,n.bF)(R,{modelValue:(0,o.R1)(u).loop,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.R1)(u).loop=e),onChange:f,disabled:!e.isEdit||null==(0,o.R1)(m)||(0,o.R1)(m).datasetType===(0,o.R1)(c.DatasetType).API},null,8,["modelValue","disabled"])]),_:1})]),_:1}),((0,o.R1)(m)||{}).datasetType===(0,o.R1)(c.DatasetType).SQL||((0,o.R1)(m)||{}).datasetType===(0,o.R1)(c.DatasetType).API?((0,n.uX)(),(0,n.Wv)(r,{key:0,span:24},{default:(0,n.k6)(()=>[(0,n.bF)(K.A,{label:"数据集参数",data:(0,o.R1)(u).datasetFilterParams,onAdd:t[4]||(t[4]=e=>L()),onEdit:t[5]||(t[5]=e=>L()),onDelete:C,disabled:!e.isEdit,prop:{label:"paramName",value:"paramName"}},{default:(0,n.k6)(e=>[(0,n.Lk)("span",null,(0,d.v_)(e.data.paramName),1),t[8]||(t[8]=(0,n.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,n.Lk)("span",null,(0,d.v_)(e.data.paramValue),1)]),_:1},8,["data","disabled"])]),_:1})):(0,n.Q3)("",!0),((0,o.R1)(m)||{}).datasetType!==(0,o.R1)(c.DatasetType).API?((0,n.uX)(),(0,n.Wv)(r,{key:1,span:24},{default:(0,n.k6)(()=>[(0,n.bF)(K.A,{label:"过滤器",data:(0,o.R1)(u).filterParams,disabled:!e.isEdit,onAdd:t[6]||(t[6]=e=>P(null)),onEdit:P,onDelete:F,prop:{label:"paramName",value:"paramId"}},{default:(0,n.k6)(e=>[(0,n.Lk)("span",null,(0,d.v_)((e.data||{}).paramName),1),(0,n.Lk)("span",je,(0,d.v_)((0,o.R1)(c.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,n.Lk)("span",null,(0,d.v_)((e.data||{}).filterValueType===(0,o.R1)(c.FilterValueKind).INNER_VARIABLE?(0,o.R1)(c.CustomDateValueType).getValue((e.data||{}).paramValue):(e.data||{}).paramValue),1)]),_:1},8,["data","disabled"])]),_:1})):(0,n.Q3)("",!0),((0,o.R1)(m)||{}).datasetType!==(0,o.R1)(c.DatasetType).API?((0,n.uX)(),(0,n.Wv)(r,{key:2,span:24},{default:(0,n.k6)(()=>[(0,n.bF)(K.A,{label:"排序",data:(0,o.R1)(u).orderParam,disabled:!e.isEdit,onAdd:t[7]||(t[7]=e=>_(null)),onEdit:_,onDelete:w,prop:{label:"fieldName",value:"fieldName"}},{right:(0,n.k6)(e=>[e.data.asc?((0,n.uX)(),(0,n.CE)("i",Ge," 正序 ")):(0,n.Q3)("",!0),e.data.asc?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("i",qe," 倒序 "))]),_:1},8,["data","disabled"])]),_:1})):(0,n.Q3)("",!0)]),_:1},8,["model"])]),_:1})])}}});const Ye=(0,S.A)(He,[["__scopeId","data-v-2d170f89"]]);var Ze=Ye,$e={name:"Datasource",props:{printInfo:{type:Object},datasetGroupList:{type:Array,default:()=>[]},datasetList:{type:Array,default:()=>[]},datasetRelationList:{type:Array,default:()=>[]},dictList:{type:Array,default:()=>[]}},components:{DatasetItem:Ze},data(){return{currentItemId:void 0,printDatasetList:[],isEdit:!1,currentItem:null,Plus:(0,o.IJ)(U.Plus),Delete:(0,o.IJ)(U.Delete),Close:(0,o.IJ)(U.Close),Check:(0,o.IJ)(U.Check),Document:(0,o.IJ)(U.Document)}},inject:["printTemplate"],methods:{handleAddDataset(){const e={id:void 0,showName:"",datasetId:"",variableName:"",loop:!1,bindGroupPath:[],filterParams:[],orderParam:[],datasetFilterParams:[]};this.currentItem=e,this.isEdit=!0},handleCancelEditDataset(){this.currentItem={...this.printDatasetList.find(e=>e.id===this.currentItemId)},this.isEdit=!1},async handleSaveDataset(){const e=await this.$refs.datasetItemRef.validateForm();if(e){if(null==this.currentItem.id)this.currentItem.id=(new Date).getTime(),this.printDatasetList.push(this.currentItem),this.currentItemId=this.currentItem.id;else{const e=this.printDatasetList.findIndex(e=>e.id===this.currentItem.id);console.log("index",e),this.printDatasetList.splice(e,1,this.currentItem)}console.log("save dataset>printDatasetList",this.printDatasetList),this.printTemplate().updageFragmengJson(this.printDatasetList),this.isEdit=!1}},handleDeleteDataset(){z.s.confirm("确定删除该数据集吗?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.printDatasetList.findIndex(e=>e.id===this.currentItem.id);this.printDatasetList.splice(e,1),this.currentItemId=void 0,this.printTemplate().updageFragmengJson(this.printDatasetList)}).catch(()=>{})},handleEditDataset(){this.isEdit=!0}},watch:{printInfo:{handler(){Array.isArray(this.printInfo.fragmentJson)&&this.printInfo.fragmentJson.length>0&&(this.printDatasetList=JSON.parse(JSON.stringify(this.printInfo.fragmentJson)),this.currentItemId=this.printDatasetList[0]?.id)},immediate:!0},currentItemId:{handler(e){this.currentItem=null!=e?this.printDatasetList.find(t=>t.id===e):null},immediate:!0}}};const et=(0,S.A)($e,[["render",Ke],["__scopeId","data-v-617306b8"]]);var tt=et,at=a(23649);function lt(e){const t=(0,I.Yq)(new Date,"YYYY-MM-DD HH:mm:ss");return function(a){var l=function(a){a.removePrintElementTypes("defaultModule"),a.addPrintElementTypes("defaultModule",[new e.PrintElementTypeGroup("常规",[{tid:"defaultModule.text",title:"",data:"",type:"text",options:{field:"textField",testData:"文本"}},{tid:"defaultModule.image",title:"图片",data:"",type:"image"},{tid:"defaultModule.longText",title:"长文",data:"",type:"longText"},{tid:"defaultModule.emptyTable",title:"空白表格",type:"table",columns:[[{title:"",field:"",width:100},{title:"",field:"",width:100}]]},{tid:"defaultModule.html",title:"html",formatter:function(e,t){return'<div style="height:50pt;width:50pt;background:red;border-radius: 50%;"></div>'},type:"html"},{tid:"defaultModule.customText",title:"自定义文本",customText:"自定义文本",custom:!0,type:"text"}]),new e.PrintElementTypeGroup("辅助",[{tid:"defaultModule.hline",title:"横线",type:"hline"},{tid:"defaultModule.vline",title:"竖线",type:"vline"},{tid:"defaultModule.rect",title:"矩形",type:"rect"},{tid:"defaultModule.oval",title:"椭圆",type:"oval"},{tid:"defaultModule.barcode",title:"条形码",type:"barcode"},{tid:"defaultModule.qrcode",title:"二维码",type:"qrcode"}]),new e.PrintElementTypeGroup("系统",[{tid:"defaultModule.printTime",title:"打印时间",data:t,type:"text",options:{field:"printTime",testData:t,height:16,fontSize:6.75,fontWeight:"700",textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.printOperator",title:"打印人员",type:"text",options:{title:"打印人员",field:"printUserName",height:16,fontSize:6.75,fontWeight:"700",textAlign:"left",textContentVerticalAlign:"middle"}}])])};return{addElementTypes:l}}}var it=a(46587),rt=a.n(it),nt={__name:"Component",setup(e){return(0,n.sV)(()=>{const e=lt(at.hy);at.hy.init({providers:[new e]}),at.hy.PrintElementTypeManager.buildByHtml(rt()(".ep-draggable-item"))}),(e,t)=>{const a=b.uD,l=_.kA,r=i.S2,o=O.Ik;return(0,n.uX)(),(0,n.Wv)(o,{class:"base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none","flex-grow":"1"}},{default:(0,n.k6)(()=>[(0,n.bF)(r,{style:{height:"calc(100%)"}},{default:(0,n.k6)(()=>[(0,n.bF)(l,{style:{width:"100%",height:"100%"}},{default:(0,n.k6)(()=>[(0,n.bF)(a,{span:24,style:{padding:"0 16px"}},{default:(0,n.k6)(()=>t[0]||(t[0]=[(0,n.Lk)("div",{class:"widget-group"},[(0,n.Lk)("div",{class:"group-title"},"辅助组件"),(0,n.Lk)("div",{class:"group-widget-list"},[(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.hline"},[(0,n.Lk)("div",{class:"icon",title:"横线"},[(0,n.Lk)("i",{class:"online-icon icon-divider"})]),(0,n.Lk)("div",{class:"name"},"横线")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.vline"},[(0,n.Lk)("div",{class:"icon",title:"竖线",style:{transform:"rotate(90deg)"}},[(0,n.Lk)("i",{class:"online-icon icon-divider"})]),(0,n.Lk)("div",{class:"name"},"竖线")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.rect"},[(0,n.Lk)("div",{class:"icon",title:"矩形"},[(0,n.Lk)("i",{class:"online-icon icon-checkbox"})]),(0,n.Lk)("div",{class:"name"},"矩形")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.oval"},[(0,n.Lk)("div",{class:"icon",title:"椭圆"},[(0,n.Lk)("i",{class:"online-icon icon-ellipse"})]),(0,n.Lk)("div",{class:"name"},"椭圆")]),(0,n.Lk)("div",{style:{width:"64px"}})]),(0,n.Lk)("div",{class:"group-title"},"基础组件"),(0,n.Lk)("div",{class:"group-widget-list"},[(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.text"},[(0,n.Lk)("div",{class:"icon",title:"文本"},[(0,n.Lk)("i",{class:"online-icon icon-input"})]),(0,n.Lk)("div",{class:"name"},"文本")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.longText"},[(0,n.Lk)("div",{class:"icon",title:"长文本"},[(0,n.Lk)("i",{class:"online-icon icon-text"})]),(0,n.Lk)("div",{class:"name"},"长文本")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.image"},[(0,n.Lk)("div",{class:"icon",title:"图片"},[(0,n.Lk)("i",{class:"online-icon icon-image"})]),(0,n.Lk)("div",{class:"name"},"图片")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.emptyTable"},[(0,n.Lk)("div",{class:"icon",title:"表格"},[(0,n.Lk)("i",{class:"online-icon icon-table"})]),(0,n.Lk)("div",{class:"name"},"表格")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.barcode"},[(0,n.Lk)("div",{class:"icon",title:"条形码"},[(0,n.Lk)("i",{class:"online-icon icon-barcode"})]),(0,n.Lk)("div",{class:"name"},"条形码")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.qrcode"},[(0,n.Lk)("div",{class:"icon",title:"二维码"},[(0,n.Lk)("i",{class:"online-icon icon-qrcode"})]),(0,n.Lk)("div",{class:"name"},"二维码")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.customText"},[(0,n.Lk)("div",{class:"icon",title:"自定义文本"},[(0,n.Lk)("i",{class:"online-icon icon-custom-text"})]),(0,n.Lk)("div",{class:"name"},"自定义文本")]),(0,n.Lk)("div",{style:{width:"64px"}})]),(0,n.Lk)("div",{class:"group-title"},"系统组件"),(0,n.Lk)("div",{class:"group-widget-list"},[(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.printTime"},[(0,n.Lk)("div",{class:"icon",title:"打印时间"},[(0,n.Lk)("i",{class:"online-icon icon-print-time"})]),(0,n.Lk)("div",{class:"name"},"打印时间")]),(0,n.Lk)("div",{class:"group-widget-item ep-draggable-item",tid:"defaultModule.printOperator"},[(0,n.Lk)("div",{class:"icon",title:"打印人员"},[(0,n.Lk)("i",{class:"online-icon icon-print-person"})]),(0,n.Lk)("div",{class:"name"},"打印人员")]),(0,n.Lk)("div",{style:{width:"64px"}})])],-1)])),_:1,__:[0]})]),_:1})]),_:1})]),_:1})}}};const ot=(0,S.A)(nt,[["__scopeId","data-v-73de060f"]]);var dt=ot;class st{constructor(e=20){this.undoList=[],this.redoList=[],this.maxLength=e}addHistory(e,t){const a=JSON.stringify({lastType:e,lastJson:t}),l=this.undoList[this.undoList.length-1];if(l){const{lastType:a,lastJson:i}=JSON.parse(l);if(a===e&&JSON.stringify(i)===JSON.stringify(t))return!1}return this.undoList.push(a),this.undoList.length>this.maxLength&&this.undoList.shift(),!0}undo(){if(this.undoList.length>0){const e=this.undoList.pop(),{lastJson:t}=JSON.parse(e);return this.redoList.push(e),this.redoList.length>this.maxLength&&this.redoList.shift(),t}return null}redo(){if(this.redoList.length>0){const e=this.redoList.pop(),{lastJson:t}=JSON.parse(e);return this.undoList.push(e),this.undoList.length>this.maxLength&&this.undoList.shift(),t}return null}get undoLength(){return this.undoList.length}get redoLength(){return this.redoList.length}clear(){this.undoList=[],this.redoList=[]}}var ut=a(98283);const pt={class:"left-panel"},mt={class:"design-panel"},ct="other",ft=5,vt=.5;var ht=(0,n.pM)({__name:"index",props:{printInfo:{}},setup(e,{expose:t}){const a={A3:{width:420,height:296.6},A4:{width:210,height:296.6},A5:{width:210,height:147.6},B3:{width:500,height:352.6},B4:{width:250,height:352.6},B5:{width:250,height:175.6}},l=e,u=(0,o.KR)([]),p=(0,o.KR)([]),f=(0,o.KR)([]),h=(0,o.KR)([]),g=(0,o.KR)("small"),y=(0,o.KR)(""),b=(0,o.KR)(),T=((0,o.KR)(),(0,o.KR)()),A=(0,o.KR)(),L=(0,o.KR)("A4"),C=(0,o.KR)({width:210,height:296.6}),w=(0,o.KR)(C.value),P=()=>{K(ct,w.value),F.value=!1},F=(0,o.KR)(!1),x=(0,o.KR)("form"),E=((0,n.EW)(()=>l.height.value),new st(20));let D=0;const V=(e,t)=>{D++,E.addHistory(e,t)};let S,J=null;const W=()=>{h.value=[],N.v9.dictReportDict({}).then(e=>{h.value=e.getList()}).catch(e=>{})},M=()=>S?S.getJson():void 0,O=()=>(console.log("loadAllDatasetInfo ==>"),new Promise((e,t)=>{m.AX.listAll({}).then(t=>{p.value=(t.data.reportDatasetGroupList||[]).map(e=>({...e,id:e.groupId,name:e.groupName})),f.value=(t.data.reportDatasetRelationList||[]).map(e=>({...e,id:e.relationId,name:e.variableName,columnList:void 0})),u.value=(t.data.reportDatasetList||[]).map(e=>{try{let t=JSON.parse(e.datasetInfo);if(e.datasetParamList=t.paramList,e.datasetType===c.DatasetType.API){const a=(0,I.BN)(t.columnList,"columnId","parentId");e.columnList=(a[0]||{}).children}}catch(a){e.datasetParamList=[]}let t={...e,id:e.datasetId,name:e.datasetName,columnList:e.columnList};return t.relationList=f.value.filter(t=>{const a=t.masterDatasetId===e.datasetId;return a}),t}),t.data.columnList.forEach(e=>{e.id=e.columnName,e.name=e.columnName});const a=t.data.columnList||[];a.forEach(e=>{const t=e.datasetId,a=u.value.find(e=>e.datasetId===t);null!=a&&(null==a.columnList&&(a.columnList=[]),a.columnList.push(e))}),console.log("loadAllDatasetInfo datasetList ==>",u.value),e(u.value)}).catch(e=>{console.warn("loadAllDatasetInfo error",e),t(e)})})),B=(0,n.EW)(()=>{if(l.printInfo&&Array.isArray(l.printInfo.fragmentJson))return l.printInfo.fragmentJson.map(e=>({...e,dataset:u.value.find(t=>t.id===e.datasetId)||{}}))});(0,n.sV)(()=>{W(),O().then(e=>{S=new at.hy.PrintTemplate({settingContainer:T.value,onImageChooseClick:e=>{console.log("=== image choose click ===",e),e.setValue("https://element-plus.org/images/element-plus-logo.svg")},history:!0,onDataChanged:(e,t)=>{V(e,t)},getFields:e=>{let t=[],a=[];return(B.value||[]).forEach(l=>{a=[],a.push(l.variableName);let i=l.dataset;i.datasetType!==c.DatasetType.API?(!Array.isArray(i.columnList)||e||l.loop||i.columnList.forEach(e=>{t.push({field:a.join(".")+"."+e.columnName,text:a.join(".")+"."+e.columnName+"("+e.columnComment+")"})}),l.loop&&e&&t.push({field:a.join("."),text:a.join(".")+"("+l.showName+")"}),Array.isArray(i.relationList)&&!l.loop&&i.relationList.forEach(l=>{const i=u.value.find(e=>e.id===l.slaveDatasetId);e&&l.relationType===c.ReportRelationType.ONE_TO_MANY&&t.push({field:a.join(".")+"."+l.variableName,text:a.join(".")+"."+l.variableName}),e||l.relationType!==c.ReportRelationType.ONE_TO_ONE||(a.push(l.variableName),i&&Array.isArray(i.columnList)&&i.columnList.forEach(e=>{t.push({field:a.join(".")+"."+e.columnName,text:a.join(".")+"."+e.columnName+"("+e.columnComment+")"})}))})):l.loop&&e?t.push({field:a.join("."),text:a.join(".")+"("+l.showName+")"}):Array.isArray(i.columnList)&&!l.loop&&(console.log(i.columnList),(0,I.DS)(i.columnList,(l,i)=>{console.log("=== node ===",l,i);const r=i?i.map(e=>e.columnName).join("."):l.columnName;return e&&"Array"===l.fieldType&&t.push({field:a.join(".")+"."+r,text:a.join(".")+"."+r+"("+l.columnComment+")"}),e||"Array"===l.fieldType||t.push({field:a.join(".")+"."+r,text:a.join(".")+"."+r+"("+l.columnComment+")"}),"Array"===l.fieldType}))}),t}}),S.design(b.value),setTimeout(()=>{const e=document.querySelector(".hiprint-printPaper");e&&(e.click(),l.printInfo?.hiprintDataJson?S.update(JSON.parse(l.printInfo.hiprintDataJson)):J=S.getJson(),V("初始化",J),console.log("=== initailJson ===",J))},100)}).catch(e=>{console.error("加载数据集失败",e)})});const X=e=>{try{S.setElsAlign(e)}catch(t){s.nk.error(`操作失败: ${t?.message||t||"未知错误"}`)}},K=(e,t)=>{L.value=e;try{Object.keys(a).includes(e),C.value={width:t.width,height:t.height},S.setPaper(t.width,t.height),w.value=C.value}catch(l){s.nk.error(`操作失败: ${l}`)}},Q=(e=null)=>{try{S.update(e)}catch(t){s.nk.error(`更新失败: ${t}`)}},j=()=>{D--;const e=E.undo();console.log("undo",E.undoLength),console.log("redo",E.redoLength),console.log("lastJson",e),Q(0===D?J:e)},G=()=>{if(console.log("redo",E.redoLength),console.log("undo",E.undoLength),E.redoLength>0){const e=E.redo();Q(e||J)}},q=(0,o.KR)(1),H=e=>{let t=q.value;e?(t+=.1,t>ft&&(t=5)):(t-=.1,t<vt&&(t=.5)),console.log("scale",t),S&&(S.zoom(t,!0),q.value=t)},Y=()=>{z.s.confirm("确定要清空页面吗？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{S.clear()}).catch(()=>{console.log("取消清空页面")})},Z=()=>{Fe.l.show("HiPrint预览",ut.A,{area:["100vw","100vh"],skin:"fullscreen-dialog"},{printId:l.printInfo.printId,printParam:[],printName:l.printInfo.printName,path:"thirdPrintPreview"},{fullscreen:!0,pathName:"/thirdParty/thirdPrintSpreadSheet"}).catch(e=>{console.warn(e)})},$=()=>{z.s.confirm("确定要导出打印模板吗？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=JSON.stringify(S.getJson(),null,2),t=new Blob([e],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="printTemplate.json",l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}).catch(()=>{console.log("取消导出")})},ee=e=>{console.log("beforeUpload",e);const t="application/json"===e.type||e.name.endsWith(".json");if(!t)return s.nk.error("文件类型错误"),!1;const a=e.size/1024/1024<10;return!!a||(s.nk.error("文件大小不能超过 10MB"),!1)},te=e=>{if(!e.raw)return s.nk.error("文件为空"),void A.value?.clearFiles();if(!ee(e.raw))return void A.value?.clearFiles();const t=new FileReader;t.onload=function(e){const t=e.target?.result;if(console.log("文件内容:",t),t&&"string"===typeof t)try{const e=JSON.parse(t);S.update(e);let l=e.panels[0].paperType,i=e.panels[0].width,r=e.panels[0].height;L.value=a[l]?l:ct,C.value={width:i,height:r},V("update",e),s.nk.success("导入成功")}catch(e){s.nk.error(`更新失败: ${e}`)}else s.nk.error("模板非法")},t.onerror=function(e){console.error("读取文件失败:",e)},t.readAsText(e.raw),A.value?.clearFiles()},ae=()=>{console.log(S.getJson())};return t({saveForm:ae,getPrintJson:M}),(e,t)=>{const l=r.S2,s=Pe.R7,m=r.fg,c=k.WK,I=v.xE,C=v.US,N=we.Vc,D=me.j5,V=i.S2,J=_.kA;return(0,n.uX)(),(0,n.CE)("div",{class:"form-design",onDrop:t[15]||(t[15]=(0,R.D$)(()=>{},["prevent","stop"]))},[(0,n.bF)(Ue,{modelValue:(0,o.R1)(x),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.i9)(x)?x.value=e:null)},null,8,["modelValue"]),(0,n.Lk)("div",pt,["form"===(0,o.R1)(x)?((0,n.uX)(),(0,n.Wv)(dt,{key:0})):((0,n.uX)(),(0,n.Wv)(tt,{key:1,printInfo:e.printInfo,datasetGroupList:(0,o.R1)(p),datasetList:(0,o.R1)(u),datasetRelationList:(0,o.R1)(f),dictList:(0,o.R1)(h)},null,8,["printInfo","datasetGroupList","datasetList","datasetRelationList","dictList"]))]),(0,n.Lk)("div",mt,[(0,n.bF)(V,{type:"flex",align:"middle",style:{"margin-left":"-4px"}},{default:(0,n.k6)(()=>[(0,n.bF)(m,{key:"align-control"},{default:(0,n.k6)(()=>[(0,n.bF)(s,{effect:"dark",content:"向左对齐"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),class:"align align-left",icon:(0,o.R1)(U.Histogram),onClick:t[1]||(t[1]=e=>X("left"))},null,8,["size","icon"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"向右对齐"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),class:"align align-right",icon:(0,o.R1)(U.Histogram),onClick:t[2]||(t[2]=e=>X("right"))},null,8,["size","icon"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"向上对齐"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),class:"align align-top",icon:(0,o.R1)(U.Histogram),onClick:t[3]||(t[3]=e=>X("top"))},null,8,["size","icon"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"向下对齐"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),class:"align align-bottom",icon:(0,o.R1)(U.Histogram),onClick:t[4]||(t[4]=e=>X("bottom"))},null,8,["size","icon"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"水平居中"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),class:"align align-center",icon:(0,o.R1)(U.Histogram),onClick:t[5]||(t[5]=e=>X("horizontal"))},null,8,["size","icon"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"垂直居中"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),class:"align align-middle",icon:(0,o.R1)(U.Histogram),onClick:t[6]||(t[6]=e=>X("vertical"))},null,8,["size","icon"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"横向分散"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),icon:(0,o.R1)(U.Switch),onClick:t[7]||(t[7]=e=>X("distributeHor"))},null,8,["size","icon"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"纵向分散"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),icon:(0,o.R1)(U.Sort),onClick:t[8]||(t[8]=e=>X("distributeVer"))},null,8,["size","icon"])]),_:1})]),_:1}),(0,n.bF)(m,{key:"scale-control"},{default:(0,n.k6)(()=>[((0,n.uX)(),(0,n.CE)(n.FK,null,(0,n.pI)(a,(e,t)=>(0,n.bF)(l,{key:t,size:(0,o.R1)(g),type:(0,o.R1)(L)===t?"primary":"default",onClick:a=>K(t,e)},{default:(0,n.k6)(()=>[(0,n.eW)((0,d.v_)(t),1)]),_:2},1032,["size","type","onClick"])),64)),(0,n.bF)(N,{visible:(0,o.R1)(F),"onUpdate:visible":t[11]||(t[11]=e=>(0,o.i9)(F)?F.value=e:null),width:"200",title:"自定义纸张尺寸",trigger:"click"},{default:(0,n.k6)(()=>[(0,n.bF)(C,{ref:"formRef",style:{width:"150px"},"label-position":"left",model:(0,o.R1)(w)},{default:(0,n.k6)(()=>[(0,n.bF)(I,{label:"宽(mm)",prop:"width",rules:[{required:!0,message:"宽度必填"},{type:"number",message:"必须是数字"}]},{default:(0,n.k6)(()=>[(0,n.bF)(c,{modelValue:(0,o.R1)(w).width,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,o.R1)(w).width=e),modelModifiers:{number:!0},type:"text",autocomplete:"off"},null,8,["modelValue"])]),_:1}),(0,n.bF)(I,{label:"高(mm)",prop:"width",rules:[{required:!0,message:"高度必填"},{type:"number",message:"必须是数字"}]},{default:(0,n.k6)(()=>[(0,n.bF)(c,{modelValue:(0,o.R1)(w).height,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,o.R1)(w).height=e),modelModifiers:{number:!0},type:"text",autocomplete:"off"},null,8,["modelValue"])]),_:1}),(0,n.bF)(I,{style:{"justify-content":"right"}},{default:(0,n.k6)(()=>[(0,n.bF)(l,{type:"primary",onClick:P},{default:(0,n.k6)(()=>t[16]||(t[16]=[(0,n.eW)("确定")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"])]),reference:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),type:ct==(0,o.R1)(L)?"primary":""},{default:(0,n.k6)(()=>t[17]||(t[17]=[(0,n.eW)("自定义")])),_:1,__:[17]},8,["size","type"])]),_:1},8,["visible"]),(0,n.bF)(l,{onClick:t[12]||(t[12]=e=>(0,o.R1)(S).rotatePaper()),size:(0,o.R1)(g)},{default:(0,n.k6)(()=>t[18]||(t[18]=[(0,n.eW)("旋转")])),_:1,__:[18]},8,["size"]),(0,n.bF)(s,{effect:"dark",content:"缩小视图"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),disabled:(0,o.R1)(q)<=vt,icon:(0,o.R1)(U.ZoomOut),onClick:t[13]||(t[13]=e=>H(!1))},null,8,["size","disabled","icon"])]),_:1}),(0,n.bF)(l,{size:(0,o.R1)(g)},{default:(0,n.k6)(()=>[(0,n.eW)((0,d.v_)((100*(0,o.R1)(q)).toFixed(0)+"%"),1)]),_:1},8,["size"]),(0,n.bF)(s,{effect:"dark",content:"放大视图"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),disabled:(0,o.R1)(q)>=ft,icon:(0,o.R1)(U.ZoomIn),onClick:t[14]||(t[14]=e=>H(!0))},null,8,["size","disabled","icon"])]),_:1})]),_:1}),(0,n.bF)(m,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,{effect:"dark",content:"撤销"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),icon:(0,o.R1)(U.RefreshLeft),onClick:j,disabled:0===(0,o.R1)(E).undoLength},null,8,["size","icon","disabled"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"恢复"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{size:(0,o.R1)(g),icon:(0,o.R1)(U.RefreshRight),onClick:G,disabled:0===(0,o.R1)(E).redoLength},null,8,["size","icon","disabled"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"预览"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{icon:(0,o.R1)(U.View),size:(0,o.R1)(g),onClick:Z},null,8,["icon","size"])]),_:1}),(0,n.bF)(s,{effect:"dark",content:"清空页面"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{icon:(0,o.R1)(U.Delete),size:(0,o.R1)(g),onClick:Y},null,8,["icon","size"])]),_:1})]),_:1}),(0,n.bF)(m,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,{effect:"dark",content:"导入模板"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{"auto-upload":!1,"show-file-list":!1,limit:1,onChange:te,style:{float:"left"},accept:".json, application/json",ref_key:"uploaderRef",ref:A},{trigger:(0,n.k6)(()=>[(0,n.bF)(l,{icon:(0,o.R1)(U.Upload),size:(0,o.R1)(g),style:{"border-top-right-radius":"0","border-bottom-right-radius":"0","margin-right":"-1px"}},null,8,["icon","size"])]),_:1},512)]),_:1}),(0,n.bF)(s,{effect:"dark",content:"导出模板"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{icon:(0,o.R1)(U.Download),size:(0,o.R1)(g),onClick:$},null,8,["icon","size"])]),_:1})]),_:1})]),_:1}),((0,n.uX)(),(0,n.CE)("div",{class:"design-box",key:(0,o.R1)(y),style:{"margin-top":"10px",height:"calc(100vh - 72px - 40px - 20px - 18px)"}},[(0,n.bF)(J,{class:"paper-box",style:{width:"100%",height:"100%"}},{default:(0,n.k6)(()=>[(0,n.Lk)("div",{ref_key:"designBox",ref:b,style:{"max-width":"100%"}},null,512)]),_:1})]))]),(0,n.bF)(J,{class:"attribute-panel"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",{style:{width:"100%",height:"100%","padding-bottom":"30px"},ref_key:"attributePanel",ref:T},null,512)]),_:1})],32)}}});const gt=(0,S.A)(ht,[["__scopeId","data-v-21d46dea"]]);var yt=gt;const bt={key:0,class:"basic-step"},kt={key:1,class:"template-edit-step"};var Rt=(0,n.pM)({__name:"editPrintTemplate",props:{printId:{},reportPrintGroupList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e;(0,n.Gt)("printTemplate",()=>({updageFragmengJson:e=>{R.value.fragmentJson=e}}));const{thirdParams:a,onCloseThirdDialog:v}=(0,f.P)(t),h=(0,o.KR)(),g=(0,o.KR)(),y=(0,o.KR)(!1),b=(0,o.KR)(c.PrintTemplateEditStep.BASIC),k=(0,o.KR)(),R=(0,o.KR)({printId:void 0,groupId:void 0,printName:void 0,printVariable:void 0,printJson:void 0,fragmentJson:[],sheetDataJson:void 0,datasetJson:void 0,templateType:c.PrintTemplateType.EXCEL,paramJson:[]}),I=(0,n.EW)(()=>({printId:t.printId||a.value.printId,reportPrintGroupList:t.reportPrintGroupList||a.value.reportPrintGroupList||[]})),T=()=>{switch(b.value){case c.PrintTemplateEditStep.TEMPLATE:g.value&&g.value.getSheetData(),b.value=c.PrintTemplateEditStep.BASIC;break;default:break}},A=()=>{switch(b.value){case c.PrintTemplateEditStep.BASIC:h.value.getBasicInfo().then(e=>(R.value.printName=e.printName,R.value.printVariable=e.printVariable,R.value.groupId=e.groupId,R.value.templateType=e.templateType,R.value.fragmentJson=e.fragmentJson,R.value.printJson={landscape:e.landscape,paperType:e.paperType,customSize:"custom"===e.paperType,customHeight:e.customHeight,customWidth:e.customWidth,topMargin:e.topMargin,bottomMargin:e.bottomMargin,leftMargin:e.leftMargin,rightMargin:e.rightMargin,templateType:e.templateType},R.value.paramJson=e.paramList.map(e=>({variableName:e})),L())).then(()=>{s.nk.success("保存成功！"),b.value=c.PrintTemplateEditStep.TEMPLATE}).catch(e=>{console.log(e)});break;default:break}},L=()=>new Promise((e,t)=>{let a={reportPrintDto:{...R.value}};if(g.value&&b.value===c.PrintTemplateEditStep.TEMPLATE){let e=g.value.getSheetData();a.reportPrintDto.sheetDataJson=e}else a.reportPrintDto.sheetDataJson=void 0;if(Array.isArray(a.reportPrintDto.sheetDataJson)&&(a.reportPrintDto.sheetDataJson=JSON.stringify(a.reportPrintDto.sheetDataJson)),R.value.templateType===c.PrintTemplateType.HIPRINT&&k.value){let e=k.value.getPrintJson();console.log(e),a.reportPrintDto.hiprintDataJson=JSON.stringify(e)}a.reportPrintDto.printType=a.reportPrintDto.printJson.templateType===c.PrintTemplateType.EXCEL?1:2;let l=null==R.value.printId?m.gi.add(a):m.gi.update(a);l.then(t=>{null==R.value.printId&&(R.value.printId=t.data),e(!0)}).catch(e=>{t(e)})}),C=()=>{(R.value.templateType!==c.PrintTemplateType.EXCEL||null!=g.value&&g.value.checkValidate())&&L().then(()=>{s.nk.success("保存成功！")}).catch(e=>{console.warn(e)})},w=()=>{t.dialog?t.dialog.cancel():v(!0)},F=e=>{e?m.gi.view({printId:e}).then(e=>{e.data.printJson&&(e.data.printJson=JSON.parse(e.data.printJson)),e.data.fragmentJson?e.data.fragmentJson=JSON.parse(e.data.fragmentJson):e.data.fragmentJson=[],e.data.datasetJson&&(e.data.datasetJson=JSON.parse(e.data.datasetJson)),e.data.paramJson&&(e.data.paramJson=JSON.parse(e.data.paramJson)),e.data.sheetDataJson&&(e.data.sheetDataJson=JSON.parse(e.data.sheetDataJson)),R.value={...e.data,templateType:(e.data.printJson||{}).templateType||c.PrintTemplateType.EXCEL},y.value=!0}).catch(()=>{y.value=!0}):y.value=!0};return(0,n.wB)(()=>I.value.printId,e=>{F(e)},{immediate:!0}),(e,t)=>{const a=r.S2,s=i.S2,m=l.bZ,f=l.ZO,v=l.lX;return(0,n.uX)(),(0,n.Wv)(v,{class:"edit-print-template"},{default:(0,n.k6)(()=>[(0,n.bF)(m,{class:"step-header",style:{overflow:"hidden",height:"72px",background:"white","border-bottom":"1px solid #ebeef5"}},{default:(0,n.k6)(()=>[(0,n.bF)(s,{type:"flex",justify:"space-between",align:"middle",style:{height:"100%"}},{default:(0,n.k6)(()=>[t[6]||(t[6]=(0,n.Lk)("div",{class:"title",style:{display:"flex",width:"200px",height:"40px","line-height":"40px"}},[(0,n.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"BIQS打印设计")],-1)),(0,n.bF)(u.A,{class:"step",value:(0,o.R1)(b)},{default:(0,n.k6)(()=>[(0,n.bF)(p.A,{icon:"online-icon icon-basic-info",name:(0,o.R1)(c.PrintTemplateEditStep).BASIC},{default:(0,n.k6)(()=>t[0]||(t[0]=[(0,n.eW)("基础信息")])),_:1,__:[0]},8,["name"]),(0,n.bF)(p.A,{icon:"online-icon icon-data",name:(0,o.R1)(c.PrintTemplateEditStep).TEMPLATE},{default:(0,n.k6)(()=>t[1]||(t[1]=[(0,n.eW)("编辑模版")])),_:1,__:[1]},8,["name"])]),_:1},8,["value"]),(0,n.bF)(s,{class:"operation",type:"flex",justify:"end"},{default:(0,n.k6)(()=>[(0,n.bF)(a,{size:"default",disabled:(0,o.R1)(b)===(0,o.R1)(c.PrintTemplateEditStep).BASIC,onClick:T},{default:(0,n.k6)(()=>t[2]||(t[2]=[(0,n.eW)(" 上一步 ")])),_:1,__:[2]},8,["disabled"]),(0,o.R1)(b)!==(0,o.R1)(c.PrintTemplateEditStep).TEMPLATE?((0,n.uX)(),(0,n.Wv)(a,{key:0,size:"default",type:"primary",onClick:A},{default:(0,n.k6)(()=>t[3]||(t[3]=[(0,n.eW)(" 下一步 ")])),_:1,__:[3]})):(0,n.Q3)("",!0),(0,o.R1)(b)===(0,o.R1)(c.PrintTemplateEditStep).TEMPLATE?((0,n.uX)(),(0,n.Wv)(a,{key:1,size:"default",type:"primary",onClick:C},{default:(0,n.k6)(()=>t[4]||(t[4]=[(0,n.eW)(" 保存 ")])),_:1,__:[4]})):(0,n.Q3)("",!0),(0,n.bF)(a,{size:"default",onClick:w},{default:(0,n.k6)(()=>t[5]||(t[5]=[(0,n.eW)("退出")])),_:1,__:[5]})]),_:1})]),_:1,__:[6]})]),_:1}),(0,n.bF)(f,{style:{background:"#f8f8f8"}},{default:(0,n.k6)(()=>[(0,n.bF)(s,{type:"flex",justify:"center",style:(0,d.Tr)([{height:"100%"},{padding:(0,o.R1)(b)===(0,o.R1)(c.PrintTemplateEditStep).BASIC?"15px":"0px"}])},{default:(0,n.k6)(()=>[(0,o.R1)(b)===(0,o.R1)(c.PrintTemplateEditStep).BASIC&&(0,o.R1)(y)?((0,n.uX)(),(0,n.CE)("div",bt,[(0,n.bF)(P,{ref_key:"basic",ref:h,templateInfo:(0,o.R1)(R),reportPrintGroupList:(0,o.R1)(I).reportPrintGroupList},null,8,["templateInfo","reportPrintGroupList"])])):(0,n.Q3)("",!0),(0,o.R1)(b)===(0,o.R1)(c.PrintTemplateEditStep).TEMPLATE&&(0,o.R1)(y)?((0,n.uX)(),(0,n.CE)("div",kt,[(0,o.R1)(R).templateType===(0,o.R1)(c.PrintTemplateType).EXCEL?((0,n.uX)(),(0,n.Wv)(pe,{key:0,ref_key:"templateSheet",ref:g,printInfo:(0,o.R1)(R)},null,8,["printInfo"])):(0,n.Q3)("",!0),(0,o.R1)(R).templateType===(0,o.R1)(c.PrintTemplateType).WORD?((0,n.uX)(),(0,n.Wv)(Ce,{key:1,ref:"templateWord",printInfo:(0,o.R1)(R)},null,8,["printInfo"])):(0,n.Q3)("",!0),(0,o.R1)(R).templateType===(0,o.R1)(c.PrintTemplateType).HIPRINT?((0,n.uX)(),(0,n.Wv)(yt,{key:2,ref_key:"templateHiprint",ref:k,printInfo:(0,o.R1)(R)},null,8,["printInfo"])):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)]),_:1},8,["style"])]),_:1})]),_:1})}}});const It=(0,S.A)(Rt,[["__scopeId","data-v-a82162ea"]]);var Tt=It},67192:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAdJJREFUWEftmItRwkAQhrkOsAKxAqECSQl2ECsQK1ArUCuQEuxArEDoIHRAB/H/cc9ZkkzGe5hD5nbmJpPjsvexr8vGjI5czJHzjTJgqIdaFqzr+gpKpxjjUOWOz++wfm2M+dDP/QACjFCvAueoO+ryNbTdAJTX7xgUuM+o24QrmxHSAhKOFqRsMd4waPKhpcSG57Ip3T0zsN4cE+8WDpOToansfmBh3NO1FrIg4AITT7LoBYC8TybgecbmtwJwR8AH3NzLxCMAeZ9MWjyxACVUWAUYuwX+qFcM/yWg9gTLxNLHDUMBeodKMKC4soKFKm2hiKFymBMuihsZdqbjzEVPn+uDLIiHV1DOs5rCROD9XjLgb+rgyVpQjjDWyAnGdTPBepPNJXZ8LYjnSkAQkNJbgpIkiaMRgsqMVxZnQFXrsgVPPkn0227zLNalZN/wqNBgv2Obst5XsSALypk7x7X1NiO/EWTXVYixMYv0WIPrAq3+jH+Z6VIYe67Lgrpp8n7RjAXa1TTRZbbtpOsuYm3mqkfObMYqw4FS2MadAX0pkxWuKRt3C7eBsab/49OHysClsqSrh2Kt30BRefDxSGuWpijl57eV5slfWEP9ni0YasEvJ/jsUJWygIoAAAAASUVORK5CYII="},80427:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAjdJREFUWEftWMFR6zAQ3RWB+dxCBYQKMBUAJXC0Hc8kFQAVABXwfwVhxrF9hA6ACjAdhA58g4FByyqOgxLIJ5ZMJjDOLYp29fJ292lXCEv+wSXHBzVA2wh9YDCO491XEo4Aato6L2MvAbMVlKnnebe63RhgFEUOAfYA0CnjuPq9lCJQ1/f9VPkeAszBibvqDzP3iCB3FMghwH4UM7iCOXoggCv+npm7N7Nk5jp87mZuTWnb93YwDJM9FHA9WnzgxZaZe3urXu+yubr2yKHNQZKEfez34yNAPB8uAP0LfO/I/ihzD2EU/0XAw5xEOsYwSk45zic5QDgLfPfU3L295TSeygCOUoVVgLKX5/X9bvfAKIe/D6AWCY4Iy4R7YcLnQgDapIo1QBXKRgMGrusOdIaqymUrgHqFvTz/2dDzbFkA3rAE7BYaFQTuTcFiDXAeHeQQ/04G1RXWWHvssfy0VgQeTBfY/4qtlFCbMhhFSYelh0X869vKtoqNQlymgGqAn4WxZvBdjM1kpmZQY3Dc7U7fxbqUFANPYacPZV+1YlZVrA6c1c2o3xQQIUT2mRAnSdKSUjaLcXJWr2gN0KQJLWPzAeDk0LQMM8n00DQxdsKg7btbZf5xlXvzsfNJPSC0ipZuOLiH/SRFhO3RYQMe964QFz+4833dGYMjuA/arvMznj6KCpQkLjQmq4ze3L6ImRMoOxOPRxP9mMpJJIcQF/r8hkQZEab6GKFw1S+sc8d2xsaaQVsG3wAJWmMJ0+LAtQAAAABJRU5ErkJggg=="},84565:function(e,t,a){a.d(t,{b:function(){return i}});var l=a(47378);const i=(0,l.b_)({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:(0,l.jq)([String,Object,Array]),default:""},headerClass:String,bodyClass:String,footerClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}})},87351:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAqZJREFUWEftmNt100AQhmdE8OENUwFOBYQKMBXEfkOWdXAqiKmAUAGmAoejG284FSSpAHWAS8BP5ASiYVaRElkX65IR+Bys113Nfvpn99fsIGz5g5v4PM/r/Q7wECnoAeCB7LeQT6gt9zQ603V9WRS7ENByvhwj0EwWKj8aAU5N482nvNFcQMvxTnjg/d+Ai9cggA+moZ+k18wAqrTeBPD9biLBZwBOB6EvCYxIvGV42yC8jeM+0mA/ne4M4Jp6DDce6xNJsHQs2/ZOY8g8FTOAtuMtOMihCkQBvDZN/aJNQMvy+qjBebTG2djQB8n1chR0LxDw1b8AJKBL0xj1d4B1tkQyxWIKzudfu0dHwx8xiDr5RPR8ExiPrwzDyDiBKGD4Z7mhb4jYjQ+Q5bgz3rPHFVVb8iHYT84VBbRtdwqIH8MDFBmrZXs+IryoCMiOErxMKikKqFL7uHN1qmDYVKfKVC3XHTDttAogEi7TvioKWAWi7pwdYF3F0vP/PwXVSeZCk+L6TVlPENxXJJsU5XmX6X+7qIKO403YXuYhBNG78Xg0SxYXVdL96/rJs6TJiwKuVR7bCKgUUr6nEXYNQw/9UHljp3M1CAB6ZQpqECzSvztRBcsAmozvAJuo1lqx8FCYvPdFU3xbLPzk+wN2uSoZqg0fWY+6opYeEi5IF1zSD1tTMLfccu7vMFUUTl8tRRWM7sxhVcwF60D9FZLQZYB5Jb0oYBlAk/EdYBPVWjskD4URsZm11gfS0ByNVCuktWe9Qsr2graheXTOV71+6Aw5Lbii9puykqe3L9FCA9nWW5wOjs2NorvO7Yo98qC0/aZeruNtYrmP6st0vMIWcLQ3VAs4VLLFZ0VIk6K9Xt5EJ+6EknQDPfpcJH8P0W/URG9RsVqh/wBsq4tHP+1QrwAAAABJRU5ErkJggg=="},95304:function(e,t,a){a(97042)}}]);