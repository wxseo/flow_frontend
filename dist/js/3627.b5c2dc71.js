(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[3627],{2986:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var l=a(65451),n=(a(97042),a(63390),a(25136)),i=(a(69957),a(21929)),s=(a(98421),a(18888)),r=(a(3172),a(85415)),o=(a(22243),a(7409),a(32465),a(14022)),u=(a(72343),a(18111),a(22489),a(56768)),d=a(90144),p=a(45130),m=a(26695),c=a(22414),b=a(27007),y=a(71066),v=a(82572);const f={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}};var g=(0,u.pM)({__name:"editHttpParameter",props:{data:{default:void 0},flowVariableList:{default:void 0},usedParamList:{default:void 0},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,v.l5)(),a=e,{thirdParams:g,onCloseThirdDialog:k}=(0,y.P)(a),h=(0,d.KR)(),R=(0,d.KR)({key:"",type:c.AutoTaskValueType.FIXED,srcValue:""}),F={key:[{required:!0,message:"请输入参数名称",trigger:"blur"}],type:[{required:!0,message:"请选择绑定值类型",trigger:"blur"}],srcValue:[{required:!0,message:"请输入参数值",trigger:"blur"}]},T=(0,u.EW)(()=>({data:a.data||g.value.data,flowVariableList:a.flowVariableList||g.value.flowVariableList,usedParamList:a.usedParamList||g.value.usedParamList})),E=(0,u.EW)(()=>T.value.data?T.value.usedParamList.filter(e=>e!==T.value.data.key):T.value.usedParamList),_=()=>{a.dialog?a.dialog.cancel():k(!1)},S=()=>{(E.value||[]).includes(R.value.key)?m.nk.error("参数名称已存在"):h.value.validate(e=>{if(e){let e;e=R.value.srcValue,R.value.type===c.AutoTaskValueType.VARIABLE&&(e=Array.isArray(R.value.srcValue)?R.value.srcValue[R.value.srcValue.length-1]:void 0);let t={...R.value,srcValue:e};a.dialog?a.dialog.submit(t):k(!0,T.value.data,t)}})};return(0,u.sV)(()=>{if(T.value.data){let e=T.value.data.srcValue;T.value.data.type===c.AutoTaskValueType.VARIABLE&&(e=(0,b.Zi)(T.value.flowVariableList,e)),R.value={...R.value,...T.value.data,srcValue:e}}}),(e,a)=>{const m=o.WK,b=i.xE,y=r.P9,v=r.AV,g=s._m,k=i.US,E=n.S2,I=l.S2;return(0,u.uX)(),(0,u.CE)("div",f,[(0,u.bF)(k,{ref_key:"form",ref:h,model:(0,d.R1)(R),class:"full-width-input form-box",rules:F,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(t).defaultFormItemSize,"label-position":"right",onSubmit:a[4]||(a[4]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(b,{label:"参数名称",prop:"key"},{default:(0,u.k6)(()=>[(0,u.bF)(m,{modelValue:(0,d.R1)(R).key,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,d.R1)(R).key=e),clearable:"",disabled:null!=(0,d.R1)(T).data},null,8,["modelValue","disabled"])]),_:1}),(0,u.bF)(b,{label:"绑定值类型",prop:"type"},{default:(0,u.k6)(()=>[(0,u.bF)(v,{modelValue:(0,d.R1)(R).type,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,d.R1)(R).type=e),clearable:"",placeholder:"请选择绑定值类型"},{default:(0,u.k6)(()=>[(0,u.bF)(y,{label:(0,d.R1)(c.AutoTaskValueType).getValue((0,d.R1)(c.AutoTaskValueType).FIXED),value:(0,d.R1)(c.AutoTaskValueType).FIXED},null,8,["label","value"]),(0,u.bF)(y,{label:(0,d.R1)(c.AutoTaskValueType).getValue((0,d.R1)(c.AutoTaskValueType).VARIABLE),value:(0,d.R1)(c.AutoTaskValueType).VARIABLE},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1}),(0,u.bF)(b,{label:"参数值",prop:"srcValue"},{default:(0,u.k6)(()=>[(0,d.R1)(R).type===(0,d.R1)(c.AutoTaskValueType).FIXED?((0,u.uX)(),(0,u.Wv)(m,{key:0,modelValue:(0,d.R1)(R).srcValue,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,d.R1)(R).srcValue=e),clearable:"",placeholder:"请输入参数值"},null,8,["modelValue"])):(0,d.R1)(R).type===(0,d.R1)(c.AutoTaskValueType).VARIABLE?((0,u.uX)(),(0,u.Wv)(g,{key:1,options:(0,d.R1)(T).flowVariableList,props:{value:"id",label:"name",children:"children"},modelValue:(0,d.R1)(R).srcValue,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,d.R1)(R).srcValue=e),clearable:"",filterable:"",placeholder:"请选择流程变量"},null,8,["options","modelValue"])):(0,u.Q3)("",!0)]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(I,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,u.k6)(()=>[(0,u.bF)(E,{size:(0,d.R1)(t).defaultFormItemSize,plain:!0,onClick:a[5]||(a[5]=e=>_())},{default:(0,u.k6)(()=>a[7]||(a[7]=[(0,u.eW)(" 取消 ")])),_:1,__:[7]},8,["size"]),(0,u.bF)(E,{type:"primary",size:(0,d.R1)(t).defaultFormItemSize,onClick:a[6]||(a[6]=e=>S())},{default:(0,u.k6)(()=>a[8]||(a[8]=[(0,u.eW)(" 保存 ")])),_:1,__:[8]},8,["size"])]),_:1})])}}});const k=g;var h=k},3736:function(e,t,a){"use strict";a.d(t,{A:function(){return i}});var l=a(55583),n=a(18384);class i extends l.w{static list(e,t){return super.post(n.x+"/online/onlineApiGroup/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineApiGroup/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineApiGroup/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineApiGroup/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineApiGroup/delete",e,t)}static listAll(e={},t){return super.post(n.x+"/online/onlineApiGroup/listAll",e,t)}}},4248:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Fi}});var l=a(97722),n=(a(97042),a(54443),a(54880)),i=(a(51582),a(60713),a(12687)),s=(a(31112),a(21929)),r=(a(98421),a(54620)),o=(a(53086),a(3740)),u=(a(42899),a(92358)),d=(a(5954),a(77649)),p=(a(87603),a(97863)),m=(a(44332),a(14022)),c=(a(72343),a(85415)),b=(a(22243),a(7409),a(32465),a(17851)),y=(a(68489),a(62436),a(69225),a(65451)),v=(a(63390),a(25136)),f=(a(69957),a(76408)),g=(a(87535),a(44114),a(18111),a(22489),a(7588),a(61701),a(56768)),k=a(90144),h=a(24232),R=a(45130),F=a(61473),T=a(99540),E=a(2721),_=a(26695),S=a(164),I=a(57477),w=a(43723),A=a.n(w),x=a(57632),V=a(85285),C=a(61617),L=a(36947),D=a(22414),N=a(21016),P=a(18384),W=a(99080),O=a(31932),B=a(36525),U=a(31372),z=a(71066),K=a(82572),M=(a(20116),a(18237),a(81109)),X=a(42608),q=a(26436),$=a(27007),Q=(a(75316),a(9267)),G=(a(48493),a(19784),a(97456)),j=(a(15936),a(14603),a(47566),a(98721),a(47887)),J=a(7131),H=a.n(J),Y=a(87833),Z=a(64772),ee=a(51418),te=a(5847);const ae=(0,g.pM)({props:{code:{type:String,required:!0},language:{type:String,default:""},autodetect:{type:Boolean,default:!0},ignoreIllegals:{type:Boolean,default:!0}},setup(e){const t=(0,k.KR)(e.language);(0,g.wB)(()=>e.language,e=>{t.value=e});const a=(0,g.EW)(()=>e.autodetect||!t.value),l=(0,g.EW)(()=>!a.value&&!ee.A.getLanguage(t.value)),n=(0,g.EW)(()=>l.value?"":`hljs ${t.value}`),i=(0,g.EW)(()=>{if(l.value)return console.warn(`The language "${t.value}" you specified could not be found.`),(0,te.Z)(e.code);if(a.value){const t=ee.A.highlightAuto(e.code);return t.value}{const a=ee.A.highlight(e.code,{language:t.value,ignoreIllegals:e.ignoreIllegals});return a.value}});return{className:n,highlightedCode:i}},render(){return(0,g.h)("pre",{},[(0,g.h)("code",{class:this.className,innerHTML:this.highlightedCode})])}});var le=ae;const ne=e=>function(t,a){return a=a||{},t=e[t]||t,t.replace(/{([^}]+)}/g,function(t,l){let n=a[l];return null!==e[a[l]]&&void 0!==e[a[l]]&&(n=e[a[l]]),n||"{"+l+"}"})};var ie=ne;const se={"Append EndEvent":"追加结束事件","Append Gateway":"追加网关","Append Task":"追加任务","Append Intermediate/Boundary Event":"追加中间抛出事件/边界事件","Activate the global connect tool":"激活全局连接工具","Append {type}":"添加 {type}","Add Lane above":"在上面添加道","Divide into two Lanes":"分割成两个道","Divide into three Lanes":"分割成三个道","Add Lane below":"在下面添加道","Append compensation activity":"追加补偿活动","Change type":"修改类型","Connect using Association":"使用关联连接","Connect using Sequence/MessageFlow or Association":"使用顺序/消息流或者关联连接","Connect using DataInputAssociation":"使用数据输入关联连接",Remove:"移除","Activate the hand tool":"激活抓手工具","Activate the lasso tool":"激活套索工具","Activate the create/remove space tool":"激活创建/删除空间工具","Create expanded SubProcess":"创建扩展子过程","Create IntermediateThrowEvent/BoundaryEvent":"创建中间抛出事件/边界事件","Create Pool/Participant":"创建池/参与者","Parallel Multi Instance":"并行多重事件","Sequential Multi Instance":"时序多重事件",DataObjectReference:"数据对象参考",DataStoreReference:"数据存储参考",Loop:"循环","Ad-hoc":"即席","Create {type}":"创建 {type}",Task:"任务","Send Task":"发送任务","Receive Task":"接收任务","User Task":"用户任务","Manual Task":"手工任务","Business Rule Task":"业务规则任务","Service Task":"服务任务","Script Task":"脚本任务","Call Activity":"调用活动","Sub Process (collapsed)":"子流程（折叠的）","Sub Process (expanded)":"子流程（展开的）","Start Event":"开始事件",StartEvent:"开始事件","Intermediate Throw Event":"中间事件","End Event":"结束事件",EndEvent:"结束事件","Create StartEvent":"创建开始事件","Create EndEvent":"创建结束事件","Create Task":"创建任务","Create User Task":"创建用户任务","Create Gateway":"创建网关","Create DataObjectReference":"创建数据对象","Create DataStoreReference":"创建数据存储","Create Group":"创建分组","Create Intermediate/Boundary Event":"创建中间/边界事件","Message Start Event":"消息开始事件","Timer Start Event":"定时开始事件","Conditional Start Event":"条件开始事件","Signal Start Event":"信号开始事件","Error Start Event":"错误开始事件","Escalation Start Event":"升级开始事件","Compensation Start Event":"补偿开始事件","Message Start Event (non-interrupting)":"消息开始事件（非中断）","Timer Start Event (non-interrupting)":"定时开始事件（非中断）","Conditional Start Event (non-interrupting)":"条件开始事件（非中断）","Signal Start Event (non-interrupting)":"信号开始事件（非中断）","Escalation Start Event (non-interrupting)":"升级开始事件（非中断）","Message Intermediate Catch Event":"消息中间捕获事件","Message Intermediate Throw Event":"消息中间抛出事件","Timer Intermediate Catch Event":"定时中间捕获事件","Escalation Intermediate Throw Event":"升级中间抛出事件","Conditional Intermediate Catch Event":"条件中间捕获事件","Link Intermediate Catch Event":"链接中间捕获事件","Link Intermediate Throw Event":"链接中间抛出事件","Compensation Intermediate Throw Event":"补偿中间抛出事件","Signal Intermediate Catch Event":"信号中间捕获事件","Signal Intermediate Throw Event":"信号中间抛出事件","Message End Event":"消息结束事件","Escalation End Event":"定时结束事件","Error End Event":"错误结束事件","Cancel End Event":"取消结束事件","Compensation End Event":"补偿结束事件","Signal End Event":"信号结束事件","Terminate End Event":"终止结束事件","Message Boundary Event":"消息边界事件","Message Boundary Event (non-interrupting)":"消息边界事件（非中断）","Timer Boundary Event":"定时边界事件","Timer Boundary Event (non-interrupting)":"定时边界事件（非中断）","Escalation Boundary Event":"升级边界事件","Escalation Boundary Event (non-interrupting)":"升级边界事件（非中断）","Conditional Boundary Event":"条件边界事件","Conditional Boundary Event (non-interrupting)":"条件边界事件（非中断）","Error Boundary Event":"错误边界事件","Cancel Boundary Event":"取消边界事件","Signal Boundary Event":"信号边界事件","Signal Boundary Event (non-interrupting)":"信号边界事件（非中断）","Compensation Boundary Event":"补偿边界事件","Exclusive Gateway":"互斥网关","Parallel Gateway":"并行网关","Inclusive Gateway":"相容网关","Complex Gateway":"复杂网关","Event based Gateway":"事件网关",Transaction:"转运","Sub Process":"子流程","Event Sub Process":"事件子流程","Collapsed Pool":"折叠池","Expanded Pool":"展开池","no parent for {element} in {parent}":"在{parent}里，{element}没有父类","no shape type specified":"没有指定的形状类型","flow elements must be children of pools/participants":"流元素必须是池/参与者的子类","out of bounds release":"out of bounds release","more than {count} child lanes":"子道大于{count} ","element required":"元素不能为空","diagram not part of bpmn:Definitions":"流程图不符合bpmn规范","no diagram to display":"没有可展示的流程图","no process or collaboration to display":"没有可展示的流程/协作","element {element} referenced by {referenced}#{property} not yet drawn":"由{referenced}#{property}引用的{element}元素仍未绘制","already rendered {element}":"{element} 已被渲染","failed to import {element}":"导入{element}失败",Id:"编号",Name:"名称",General:"常规",Details:"详情","Message Name":"消息名称",Message:"消息",Initiator:"创建者","Asynchronous Continuations":"持续异步","Asynchronous Before":"异步前","Asynchronous After":"异步后","Job Configuration":"工作配置",Exclusive:"排除","Job Priority":"工作优先级","Retry Time Cycle":"重试时间周期",Documentation:"文档","Element Documentation":"元素文档","History Configuration":"历史配置","History Time To Live":"历史的生存时间",Forms:"表单","Form Key":"表单key","Form Fields":"表单字段","Business Key":"业务key","Form Field":"表单字段",ID:"编号",Type:"类型",Label:"名称","Default Value":"默认值","Default Flow":"默认流转路径","Conditional Flow":"条件流转路径","Sequence Flow":"普通流转路径",Validation:"校验","Add Constraint":"添加约束",Config:"配置",Properties:"属性","Add Property":"添加属性",Value:"值",Listeners:"监听器","Execution Listener":"执行监听","Event Type":"事件类型","Listener Type":"监听器类型","Java Class":"Java类",Expression:"表达式","Must provide a value":"必须提供一个值","Delegate Expression":"代理表达式",Script:"脚本","Script Format":"脚本格式","Script Type":"脚本类型","Inline Script":"内联脚本","External Script":"外部脚本",Resource:"资源","Field Injection":"字段注入",Extensions:"扩展","Input/Output":"输入/输出","Input Parameters":"输入参数","Output Parameters":"输出参数",Parameters:"参数","Output Parameter":"输出参数","Timer Definition Type":"定时器定义类型","Timer Definition":"定时器定义",Date:"日期",Duration:"持续",Cycle:"循环",Signal:"信号","Signal Name":"信号名称",Escalation:"升级",Error:"错误","Link Name":"链接名称",Condition:"条件名称","Variable Name":"变量名称","Variable Event":"变量事件","Specify more than one variable change event as a comma separated list.":"多个变量事件以逗号隔开","Wait for Completion":"等待完成","Activity Ref":"活动参考","Version Tag":"版本标签",Executable:"可执行文件","External Task Configuration":"扩展任务配置","Task Priority":"任务优先级",External:"外部",Connector:"连接器","Must configure Connector":"必须配置连接器","Connector Id":"连接器编号",Implementation:"实现方式","Field Injections":"字段注入",Fields:"字段","Result Variable":"结果变量",Topic:"主题","Configure Connector":"配置连接器","Input Parameter":"输入参数",Assignee:"代理人","Candidate Users":"候选用户","Candidate Groups":"候选组","Due Date":"到期时间","Follow Up Date":"跟踪日期",Priority:"优先级","The follow up date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00","The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00",Variables:"变量","Candidate Starter Configuration":"候选人起动器配置","Candidate Starter Groups":"候选人起动器组","This maps to the process definition key.":"这映射到流程定义键。","Candidate Starter Users":"候选人起动器的用户","Specify more than one user as a comma separated list.":"指定多个用户作为逗号分隔的列表。","Tasklist Configuration":"Tasklist配置",Startable:"启动","Specify more than one group as a comma separated list.":"指定多个组作为逗号分隔的列表。"};var re=se;function oe(e,t,a){const l=Object.create(null);switch(l.event=e.event,t&&(l.id=e.id),e.listenerType){case"scriptListener":l.script=de(e,a),l.class="org.flowable.engine.impl.bpmn.listener.ScriptTaskListener";break;case"expressionListener":l.expression=e.expression;break;case"delegateExpressionListener":l.delegateExpression=e.delegateExpression;break;default:l.class=e.class}e.fields&&(l.fields=e.fields.map(e=>ue(e,a)));const n=window;if(!n.bpmnInstances)return console.error("window.bpmnInstances not found"),null;if(t&&"timeout"===e.event&&e.eventDefinitionType){const t=n.bpmnInstances.moddle.create("bpmn:FormalExpression",{body:e.eventTimeDefinitions}),a=n.bpmnInstances.moddle.create("bpmn:TimerEventDefinition",{id:`TimerEventDefinition_${me(8)}`,[`time${e.eventDefinitionType.replace(/^\S/,e=>e.toUpperCase())}`]:t});l.eventDefinitions=[a]}return n.bpmnInstances.moddle.create(`${a}:${t?"TaskListener":"ExecutionListener"}`,l)}function ue(e,t){const a=window;if(!a.bpmnInstances)return console.error("window.bpmnInstances not found"),null;const{name:l,fieldType:n,string:i,expression:s}=e,r="string"===n?{name:l,string:i}:{name:l,expression:s};return a.bpmnInstances.moddle.create(`${t}:Field`,r)}function de(e,t){const a=window;if(!a.bpmnInstances)return console.error("window.bpmnInstances not found"),null;const{scriptType:l,scriptFormat:n,value:i,resource:s}=e,r="inlineScript"===l?{scriptFormat:n,value:i}:{scriptFormat:n,resource:s};return a.bpmnInstances.moddle.create(`${t}:Script`,r)}function pe(e,t){const a=window;if(!a.bpmnInstances)return void console.error("window.bpmnInstances not found");const l=a.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t});a.bpmnInstances.modeling.updateProperties(e,{extensionElements:l})}function me(e=8,t=null){let a="";const l=t||"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=e;n>0;--n)a+=l[Math.floor(Math.random()*l.length)];return a}var ce=(e,t,a,l,n)=>{a||(a="camunda");const i={activiti:"http://activiti.org/bpmn",camunda:"http://bpmn.io/schema/bpmn",flowable:"http://flowable.org/bpmn"},s=me(),r=me(),o=me(),u=me(),d=me(),p=1===l?`\n    <bpmn2:startEvent id="Event_${s}">\n      <bpmn2:outgoing>Flow_${o}</bpmn2:outgoing>\n    </bpmn2:startEvent>\n    <bpmn2:${1===n?"receiveTask":"userTask"} id="Activity_${d}">\n      <bpmn2:incoming>Flow_${o}</bpmn2:incoming>\n      <bpmn2:outgoing>Flow_${u}</bpmn2:outgoing>\n    </bpmn2:${1===n?"receiveTask":"userTask"}>\n    <bpmn2:sequenceFlow id="Flow_${o}" sourceRef="Event_${s}" targetRef="Activity_${d}" />\n    <bpmn2:endEvent id="Event_${r}">\n      <bpmn2:incoming>Flow_${u}</bpmn2:incoming>\n    </bpmn2:endEvent>\n    <bpmn2:sequenceFlow id="Flow_${u}" sourceRef="Activity_${d}" targetRef="Event_${r}" />\n  `:"",m=1===l?`\n    <bpmndi:BPMNEdge id="Flow_${o}_di" bpmnElement="Flow_${o}">\n      <di:waypoint x="86" y="68" />\n      <di:waypoint x="140" y="68" />\n    </bpmndi:BPMNEdge>\n    <bpmndi:BPMNEdge id="Flow_${u}_di" bpmnElement="Flow_${u}">\n      <di:waypoint x="240" y="68" />\n      <di:waypoint x="302" y="68" />\n    </bpmndi:BPMNEdge>\n    <bpmndi:BPMNShape id="Event_${s}_di" bpmnElement="Event_${s}">\n      <dc:Bounds x="50" y="50" width="36" height="36" />\n    </bpmndi:BPMNShape>\n    <bpmndi:BPMNShape id="Activity_${d}_di" bpmnElement="Activity_${d}">\n      <dc:Bounds x="140" y="28" width="100" height="80" />\n    </bpmndi:BPMNShape>\n    <bpmndi:BPMNShape id="Event_${r}_di" bpmnElement="Event_${r}">\n      <dc:Bounds x="302" y="50" width="36" height="36" />\n    </bpmndi:BPMNShape>\n  `:"";return`\n    <?xml version="1.0" encoding="UTF-8"?>\n    <bpmn2:definitions\n      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n      xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL"\n      xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"\n      xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"\n      xmlns:di="http://www.omg.org/spec/DD/20100524/DI"\n      xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"\n      id="diagram_${e}"\n      targetNamespace="${i[a]}">\n      <bpmn2:process id="${e}" name="${t}" isExecutable="true">\n        ${p}\n      </bpmn2:process>\n      <bpmndi:BPMNDiagram id="BPMNDiagram_1">\n        <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="${e}">\n          ${m}\n        </bpmndi:BPMNPlane>\n      </bpmndi:BPMNDiagram>\n    </bpmn2:definitions>\n  `},be=JSON.parse('{"name":"Camunda","uri":"http://camunda.org/schema/1.0/bpmn","prefix":"camunda","xml":{"tagAlias":"lowerCase"},"associations":[],"types":[{"name":"Definitions","isAbstract":true,"extends":["bpmn:Definitions"],"properties":[{"name":"diagramRelationId","isAttr":true,"type":"String"}]},{"name":"InOutBinding","superClass":["Element"],"isAbstract":true,"properties":[{"name":"source","isAttr":true,"type":"String"},{"name":"sourceExpression","isAttr":true,"type":"String"},{"name":"target","isAttr":true,"type":"String"},{"name":"businessKey","isAttr":true,"type":"String"},{"name":"local","isAttr":true,"type":"Boolean","default":false},{"name":"variables","isAttr":true,"type":"String"}]},{"name":"In","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity","bpmn:SignalEventDefinition"]}},{"name":"Out","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"AsyncCapable","isAbstract":true,"extends":["bpmn:Activity","bpmn:Gateway","bpmn:Event"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false},{"name":"asyncBefore","isAttr":true,"type":"Boolean","default":false},{"name":"asyncAfter","isAttr":true,"type":"Boolean","default":false},{"name":"exclusive","isAttr":true,"type":"Boolean","default":true}]},{"name":"JobPriorized","isAbstract":true,"extends":["bpmn:Process","camunda:AsyncCapable"],"properties":[{"name":"jobPriority","isAttr":true,"type":"String"}]},{"name":"SignalEventDefinition","isAbstract":true,"extends":["bpmn:SignalEventDefinition"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false}]},{"name":"ErrorEventDefinition","isAbstract":true,"extends":["bpmn:ErrorEventDefinition"],"properties":[{"name":"errorCodeVariable","isAttr":true,"type":"String"},{"name":"errorMessageVariable","isAttr":true,"type":"String"}]},{"name":"Error","isAbstract":true,"extends":["bpmn:Error"],"properties":[{"name":"camunda:errorMessage","isAttr":true,"type":"String"}]},{"name":"PotentialStarter","superClass":["Element"],"properties":[{"name":"resourceAssignmentExpression","type":"bpmn:ResourceAssignmentExpression"}]},{"name":"FormSupported","isAbstract":true,"extends":["bpmn:StartEvent","bpmn:UserTask"],"properties":[{"name":"formHandlerClass","isAttr":true,"type":"String"},{"name":"formKey","isAttr":true,"type":"String"}]},{"name":"TemplateSupported","isAbstract":true,"extends":["bpmn:Process","bpmn:FlowElement"],"properties":[{"name":"modelerTemplate","isAttr":true,"type":"String"},{"name":"modelerTemplateVersion","isAttr":true,"type":"Integer"}]},{"name":"Initiator","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"initiator","isAttr":true,"type":"String"}]},{"name":"ScriptTask","isAbstract":true,"extends":["bpmn:ScriptTask"],"properties":[{"name":"resultVariable","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Process","isAbstract":true,"extends":["bpmn:Process"],"properties":[{"name":"candidateStarterGroups","isAttr":true,"type":"String"},{"name":"candidateStarterUsers","isAttr":true,"type":"String"},{"name":"versionTag","isAttr":true,"type":"String"},{"name":"historyTimeToLive","isAttr":true,"type":"String"},{"name":"isStartableInTasklist","isAttr":true,"type":"Boolean","default":true}]},{"name":"EscalationEventDefinition","isAbstract":true,"extends":["bpmn:EscalationEventDefinition"],"properties":[{"name":"escalationCodeVariable","isAttr":true,"type":"String"}]},{"name":"FormalExpression","isAbstract":true,"extends":["bpmn:FormalExpression"],"properties":[{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Assignable","extends":["bpmn:UserTask"],"properties":[{"name":"assignee","isAttr":true,"type":"String"},{"name":"candidateUsers","isAttr":true,"type":"String"},{"name":"candidateGroups","isAttr":true,"type":"String"},{"name":"dueDate","isAttr":true,"type":"String"},{"name":"followUpDate","isAttr":true,"type":"String"},{"name":"priority","isAttr":true,"type":"String"}]},{"name":"CallActivity","extends":["bpmn:CallActivity"],"properties":[{"name":"calledElementBinding","isAttr":true,"type":"String","default":"latest"},{"name":"calledElementVersion","isAttr":true,"type":"String"},{"name":"calledElementVersionTag","isAttr":true,"type":"String"},{"name":"calledElementTenantId","isAttr":true,"type":"String"},{"name":"caseRef","isAttr":true,"type":"String"},{"name":"caseBinding","isAttr":true,"type":"String","default":"latest"},{"name":"caseVersion","isAttr":true,"type":"String"},{"name":"caseTenantId","isAttr":true,"type":"String"},{"name":"variableMappingClass","isAttr":true,"type":"String"},{"name":"variableMappingDelegateExpression","isAttr":true,"type":"String"}]},{"name":"ServiceTaskLike","extends":["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"resultVariable","isAttr":true,"type":"String"}]},{"name":"DmnCapable","extends":["bpmn:BusinessRuleTask"],"properties":[{"name":"decisionRef","isAttr":true,"type":"String"},{"name":"decisionRefBinding","isAttr":true,"type":"String","default":"latest"},{"name":"decisionRefVersion","isAttr":true,"type":"String"},{"name":"mapDecisionResult","isAttr":true,"type":"String","default":"resultList"},{"name":"decisionRefTenantId","isAttr":true,"type":"String"}]},{"name":"ExternalCapable","extends":["camunda:ServiceTaskLike"],"properties":[{"name":"type","isAttr":true,"type":"String"},{"name":"topic","isAttr":true,"type":"String"}]},{"name":"TaskPriorized","extends":["bpmn:Process","camunda:ExternalCapable"],"properties":[{"name":"taskPriority","isAttr":true,"type":"String"}]},{"name":"Properties","superClass":["Element"],"meta":{"allowedIn":["*"]},"properties":[{"name":"values","type":"Property","isMany":true}]},{"name":"Property","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"Connector","superClass":["Element"],"meta":{"allowedIn":["camunda:ServiceTaskLike"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"}]},{"name":"InputOutput","superClass":["Element"],"meta":{"allowedIn":["bpmn:FlowNode","camunda:Connector"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"},{"name":"inputParameters","isMany":true,"type":"InputParameter"},{"name":"outputParameters","isMany":true,"type":"OutputParameter"}]},{"name":"InputOutputParameter","properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"InputOutputParameterDefinition","isAbstract":true},{"name":"List","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"items","isMany":true,"type":"InputOutputParameterDefinition"}]},{"name":"Map","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"entries","isMany":true,"type":"Entry"}]},{"name":"Entry","properties":[{"name":"key","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"Value","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"id","isAttr":true,"type":"String"},{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Script","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"scriptFormat","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Field","superClass":["Element"],"meta":{"allowedIn":["camunda:ServiceTaskLike","camunda:ExecutionListener","camunda:TaskListener"]},"properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"expression","type":"String"},{"name":"stringValue","isAttr":true,"type":"String"},{"name":"string","type":"String"}]},{"name":"InputParameter","superClass":["InputOutputParameter"]},{"name":"OutputParameter","superClass":["InputOutputParameter"]},{"name":"Collectable","isAbstract":true,"extends":["bpmn:MultiInstanceLoopCharacteristics"],"superClass":["camunda:AsyncCapable"],"properties":[{"name":"collection","isAttr":true,"type":"String"},{"name":"elementVariable","isAttr":true,"type":"String"}]},{"name":"FailedJobRetryTimeCycle","superClass":["Element"],"meta":{"allowedIn":["camunda:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"ExecutionListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"TaskListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true},{"name":"id","type":"String","isAttr":true},{"name":"eventDefinitions","type":"bpmn:TimerEventDefinition","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true}]},{"name":"FormData","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"fields","type":"FormField","isMany":true},{"name":"businessKey","type":"String","isAttr":true}]},{"name":"FormField","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"defaultValue","type":"String","isAttr":true},{"name":"properties","type":"Properties"},{"name":"validation","type":"Validation"},{"name":"values","type":"Value","isMany":true}]},{"name":"Validation","superClass":["Element"],"properties":[{"name":"constraints","type":"Constraint","isMany":true}]},{"name":"Constraint","superClass":["Element"],"properties":[{"name":"name","type":"String","isAttr":true},{"name":"config","type":"String","isAttr":true}]},{"name":"ConditionalEventDefinition","isAbstract":true,"extends":["bpmn:ConditionalEventDefinition"],"properties":[{"name":"variableName","isAttr":true,"type":"String"},{"name":"variableEvents","isAttr":true,"type":"String"}]}],"emumerations":[]}'),ye=JSON.parse('{"name":"Activiti","uri":"http://activiti.org/bpmn","prefix":"activiti","xml":{"tagAlias":"lowerCase"},"associations":[],"types":[{"name":"Definitions","isAbstract":true,"extends":["bpmn:Definitions"],"properties":[{"name":"diagramRelationId","isAttr":true,"type":"String"}]},{"name":"InOutBinding","superClass":["Element"],"isAbstract":true,"properties":[{"name":"source","isAttr":true,"type":"String"},{"name":"sourceExpression","isAttr":true,"type":"String"},{"name":"target","isAttr":true,"type":"String"},{"name":"businessKey","isAttr":true,"type":"String"},{"name":"local","isAttr":true,"type":"Boolean","default":false},{"name":"variables","isAttr":true,"type":"String"}]},{"name":"In","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"Out","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"AsyncCapable","isAbstract":true,"extends":["bpmn:Activity","bpmn:Gateway","bpmn:Event"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false},{"name":"asyncBefore","isAttr":true,"type":"Boolean","default":false},{"name":"asyncAfter","isAttr":true,"type":"Boolean","default":false},{"name":"exclusive","isAttr":true,"type":"Boolean","default":true}]},{"name":"JobPriorized","isAbstract":true,"extends":["bpmn:Process","activiti:AsyncCapable"],"properties":[{"name":"jobPriority","isAttr":true,"type":"String"}]},{"name":"SignalEventDefinition","isAbstract":true,"extends":["bpmn:SignalEventDefinition"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false}]},{"name":"ErrorEventDefinition","isAbstract":true,"extends":["bpmn:ErrorEventDefinition"],"properties":[{"name":"errorCodeVariable","isAttr":true,"type":"String"},{"name":"errorMessageVariable","isAttr":true,"type":"String"}]},{"name":"Error","isAbstract":true,"extends":["bpmn:Error"],"properties":[{"name":"activiti:errorMessage","isAttr":true,"type":"String"}]},{"name":"PotentialStarter","superClass":["Element"],"properties":[{"name":"resourceAssignmentExpression","type":"bpmn:ResourceAssignmentExpression"}]},{"name":"FormSupported","isAbstract":true,"extends":["bpmn:StartEvent","bpmn:UserTask"],"properties":[{"name":"formHandlerClass","isAttr":true,"type":"String"},{"name":"formKey","isAttr":true,"type":"String"}]},{"name":"TemplateSupported","isAbstract":true,"extends":["bpmn:Process","bpmn:FlowElement"],"properties":[{"name":"modelerTemplate","isAttr":true,"type":"String"}]},{"name":"Initiator","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"initiator","isAttr":true,"type":"String"}]},{"name":"ScriptTask","isAbstract":true,"extends":["bpmn:ScriptTask"],"properties":[{"name":"resultVariable","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Process","isAbstract":true,"extends":["bpmn:Process"],"properties":[{"name":"candidateStarterGroups","isAttr":true,"type":"String"},{"name":"candidateStarterUsers","isAttr":true,"type":"String"},{"name":"versionTag","isAttr":true,"type":"String"},{"name":"historyTimeToLive","isAttr":true,"type":"String"},{"name":"isStartableInTasklist","isAttr":true,"type":"Boolean","default":true},{"name":"executionListener","isAbstract":true,"type":"Expression"}]},{"name":"EscalationEventDefinition","isAbstract":true,"extends":["bpmn:EscalationEventDefinition"],"properties":[{"name":"escalationCodeVariable","isAttr":true,"type":"String"}]},{"name":"FormalExpression","isAbstract":true,"extends":["bpmn:FormalExpression"],"properties":[{"name":"resource","isAttr":true,"type":"String"}]},{"name":"multiinstance_type","superClass":["Element"]},{"name":"multiinstance_condition","superClass":["Element"]},{"name":"Assignable","extends":["bpmn:UserTask"],"properties":[{"name":"assignee","isAttr":true,"type":"String"},{"name":"candidateUsers","isAttr":true,"type":"String"},{"name":"candidateGroups","isAttr":true,"type":"String"},{"name":"dueDate","isAttr":true,"type":"String"},{"name":"followUpDate","isAttr":true,"type":"String"},{"name":"priority","isAttr":true,"type":"String"},{"name":"multiinstance_condition","isAttr":true,"type":"String"}]},{"name":"CallActivity","extends":["bpmn:CallActivity"],"properties":[{"name":"calledElementBinding","isAttr":true,"type":"String","default":"latest"},{"name":"calledElementVersion","isAttr":true,"type":"String"},{"name":"calledElementVersionTag","isAttr":true,"type":"String"},{"name":"calledElementTenantId","isAttr":true,"type":"String"},{"name":"caseRef","isAttr":true,"type":"String"},{"name":"caseBinding","isAttr":true,"type":"String","default":"latest"},{"name":"caseVersion","isAttr":true,"type":"String"},{"name":"caseTenantId","isAttr":true,"type":"String"},{"name":"variableMappingClass","isAttr":true,"type":"String"},{"name":"variableMappingDelegateExpression","isAttr":true,"type":"String"}]},{"name":"ServiceTaskLike","extends":["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"resultVariable","isAttr":true,"type":"String"}]},{"name":"DmnCapable","extends":["bpmn:BusinessRuleTask"],"properties":[{"name":"decisionRef","isAttr":true,"type":"String"},{"name":"decisionRefBinding","isAttr":true,"type":"String","default":"latest"},{"name":"decisionRefVersion","isAttr":true,"type":"String"},{"name":"mapDecisionResult","isAttr":true,"type":"String","default":"resultList"},{"name":"decisionRefTenantId","isAttr":true,"type":"String"}]},{"name":"ExternalCapable","extends":["activiti:ServiceTaskLike"],"properties":[{"name":"type","isAttr":true,"type":"String"},{"name":"topic","isAttr":true,"type":"String"}]},{"name":"TaskPriorized","extends":["bpmn:Process","activiti:ExternalCapable"],"properties":[{"name":"taskPriority","isAttr":true,"type":"String"}]},{"name":"Properties","superClass":["Element"],"meta":{"allowedIn":["*"]},"properties":[{"name":"values","type":"Property","isMany":true}]},{"name":"Property","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"Connector","superClass":["Element"],"meta":{"allowedIn":["activiti:ServiceTaskLike"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"}]},{"name":"InputOutput","superClass":["Element"],"meta":{"allowedIn":["bpmn:FlowNode","activiti:Connector"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"},{"name":"inputParameters","isMany":true,"type":"InputParameter"},{"name":"outputParameters","isMany":true,"type":"OutputParameter"}]},{"name":"InputOutputParameter","properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"InputOutputParameterDefinition","isAbstract":true},{"name":"List","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"items","isMany":true,"type":"InputOutputParameterDefinition"}]},{"name":"Map","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"entries","isMany":true,"type":"Entry"}]},{"name":"Entry","properties":[{"name":"key","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"Value","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"id","isAttr":true,"type":"String"},{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Script","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"scriptFormat","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Field","superClass":["Element"],"meta":{"allowedIn":["activiti:ServiceTaskLike","activiti:ExecutionListener","activiti:TaskListener"]},"properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"expression","type":"String"},{"name":"stringValue","isAttr":true,"type":"String"},{"name":"string","type":"String"}]},{"name":"InputParameter","superClass":["InputOutputParameter"]},{"name":"OutputParameter","superClass":["InputOutputParameter"]},{"name":"Collectable","isAbstract":true,"extends":["bpmn:MultiInstanceLoopCharacteristics"],"superClass":["activiti:AsyncCapable"],"properties":[{"name":"collection","isAttr":true,"type":"String"},{"name":"elementVariable","isAttr":true,"type":"String"}]},{"name":"FailedJobRetryTimeCycle","superClass":["Element"],"meta":{"allowedIn":["activiti:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"ExecutionListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"TaskListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"defaultValue","type":"String","isAttr":true},{"name":"properties","type":"Properties"},{"name":"validation","type":"Validation"},{"name":"values","type":"Value","isMany":true}]},{"name":"Validation","superClass":["Element"],"properties":[{"name":"constraints","type":"Constraint","isMany":true}]},{"name":"Constraint","superClass":["Element"],"properties":[{"name":"name","type":"String","isAttr":true},{"name":"config","type":"String","isAttr":true}]},{"name":"ExtensionElements","properties":[{"name":"operationList","type":"String","isAttr":true}]},{"name":"OperationList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"operationList","type":"FormOperation","isMany":true}]},{"name":"FormOperation","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"showOrder","type":"String","isAttr":true},{"name":"multiSignAssignee","type":"String","isAttr":true}]},{"name":"VariableList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"variableList","type":"FormVariable","isMany":true}]},{"name":"FormVariable","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true}]},{"name":"CopyItemList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"copyItemList","type":"CopyItem","isMany":true}]},{"name":"CopyItem","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true}]},{"name":"DeptPostList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"deptPostList","type":"DeptPost","isMany":true}]},{"name":"DeptPost","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"postId","type":"String","isAttr":true},{"name":"deptPostId","type":"String","isAttr":true}]},{"name":"UserCandidateGroups","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"type","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"CustomCondition","superClass":["Element"],"meta":{"allowedIn":["bpmn:SequenceFlow"]},"properties":[{"name":"type","type":"String","isAttr":true},{"name":"operationType","type":"String","isAttr":true},{"name":"parallelRefuse","type":"Boolean","isAttr":true,"default":false}]},{"name":"AssigneeList","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"assigneeList","type":"Assignee","isMany":true},{"name":"type","type":"String","isAttr":true}]},{"name":"Assignee","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true}]},{"name":"ConditionalEventDefinition","isAbstract":true,"extends":["bpmn:ConditionalEventDefinition"],"properties":[{"name":"variableName","isAttr":true,"type":"String"},{"name":"variableEvent","isAttr":true,"type":"String"}]}],"emumerations":[]}'),ve=JSON.parse('{"name":"Flowable","uri":"http://flowable.org/bpmn","prefix":"flowable","xml":{"tagAlias":"lowerCase"},"associations":[],"types":[{"name":"InOutBinding","superClass":["Element"],"isAbstract":true,"properties":[{"name":"source","isAttr":true,"type":"String"},{"name":"sourceExpression","isAttr":true,"type":"String"},{"name":"target","isAttr":true,"type":"String"},{"name":"businessKey","isAttr":true,"type":"String"},{"name":"local","isAttr":true,"type":"Boolean","default":false},{"name":"variables","isAttr":true,"type":"String"}]},{"name":"In","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"Out","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"AsyncCapable","isAbstract":true,"extends":["bpmn:Activity","bpmn:Gateway","bpmn:Event"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false},{"name":"asyncBefore","isAttr":true,"type":"Boolean","default":false},{"name":"asyncAfter","isAttr":true,"type":"Boolean","default":false},{"name":"exclusive","isAttr":true,"type":"Boolean","default":true}]},{"name":"JobPriorized","isAbstract":true,"extends":["bpmn:Process","flowable:AsyncCapable"],"properties":[{"name":"jobPriority","isAttr":true,"type":"String"}]},{"name":"SignalEventDefinition","isAbstract":true,"extends":["bpmn:SignalEventDefinition"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false}]},{"name":"ErrorEventDefinition","isAbstract":true,"extends":["bpmn:ErrorEventDefinition"],"properties":[{"name":"errorCodeVariable","isAttr":true,"type":"String"},{"name":"errorMessageVariable","isAttr":true,"type":"String"}]},{"name":"Error","isAbstract":true,"extends":["bpmn:Error"],"properties":[{"name":"flowable:errorMessage","isAttr":true,"type":"String"}]},{"name":"PotentialStarter","superClass":["Element"],"properties":[{"name":"resourceAssignmentExpression","type":"bpmn:ResourceAssignmentExpression"}]},{"name":"FormSupported","isAbstract":true,"extends":["bpmn:StartEvent","bpmn:UserTask"],"properties":[{"name":"formHandlerClass","isAttr":true,"type":"String"},{"name":"formKey","isAttr":true,"type":"String"}]},{"name":"TemplateSupported","isAbstract":true,"extends":["bpmn:Process","bpmn:FlowElement"],"properties":[{"name":"modelerTemplate","isAttr":true,"type":"String"}]},{"name":"Initiator","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"initiator","isAttr":true,"type":"String"}]},{"name":"ScriptTask","isAbstract":true,"extends":["bpmn:ScriptTask"],"properties":[{"name":"resultVariable","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Process","isAbstract":true,"extends":["bpmn:Process"],"properties":[{"name":"candidateStarterGroups","isAttr":true,"type":"String"},{"name":"candidateStarterUsers","isAttr":true,"type":"String"},{"name":"versionTag","isAttr":true,"type":"String"},{"name":"historyTimeToLive","isAttr":true,"type":"String"},{"name":"isStartableInTasklist","isAttr":true,"type":"Boolean","default":true}]},{"name":"EscalationEventDefinition","isAbstract":true,"extends":["bpmn:EscalationEventDefinition"],"properties":[{"name":"escalationCodeVariable","isAttr":true,"type":"String"}]},{"name":"xcField","isAbstract":true,"properties":[{"name":"xcString","isMany":true,"type":"Element"},{"name":"name","isAttr":true,"type":"String"}]},{"name":"xcString","isAbstract":true,"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"FormalExpression","isAbstract":true,"extends":["bpmn:FormalExpression"],"properties":[{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Assignable","extends":["bpmn:UserTask"],"properties":[{"name":"assignee","isAttr":true,"type":"String"},{"name":"xcformKey","isAttr":true,"type":"String"},{"name":"candidateUsers","isAttr":true,"type":"String"},{"name":"candidateGroups","isAttr":true,"type":"String"},{"name":"dueDate","isAttr":true,"type":"String"},{"name":"followUpDate","isAttr":true,"type":"String"},{"name":"priority","isAttr":true,"type":"String"},{"name":"sendMessageType","isAttr":true,"type":"String"},{"name":"notifyMessage","isAttr":true,"type":"String"},{"name":"templateConfig","isAttr":true,"type":"String"},{"name":"autoSkipType","isAttr":true,"type":"String"},{"name":"rejectType","isAttr":true,"type":"String"},{"name":"timeoutHandleWay","isAttr":true,"type":"String"},{"name":"timeoutHours","isAttr":true,"type":"String"},{"name":"emptyUserHandleWay","isAttr":true,"type":"String"},{"name":"emptyUserToAssignee","isAttr":true,"type":"String"},{"name":"defaultAssignee","isAttr":true,"type":"String"}]},{"name":"CallActivity","extends":["bpmn:CallActivity"],"properties":[{"name":"calledElementBinding","isAttr":true,"type":"String","default":"latest"},{"name":"calledElementVersion","isAttr":true,"type":"String"},{"name":"calledElementVersionTag","isAttr":true,"type":"String"},{"name":"calledElementTenantId","isAttr":true,"type":"String"},{"name":"caseRef","isAttr":true,"type":"String"},{"name":"caseBinding","isAttr":true,"type":"String","default":"latest"},{"name":"caseVersion","isAttr":true,"type":"String"},{"name":"caseTenantId","isAttr":true,"type":"String"},{"name":"variableMappingClass","isAttr":true,"type":"String"},{"name":"variableMappingDelegateExpression","isAttr":true,"type":"String"}]},{"name":"ServiceTaskLike","extends":["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"resultVariable","isAttr":true,"type":"String"}]},{"name":"DmnCapable","extends":["bpmn:BusinessRuleTask"],"properties":[{"name":"decisionRef","isAttr":true,"type":"String"},{"name":"decisionRefBinding","isAttr":true,"type":"String","default":"latest"},{"name":"decisionRefVersion","isAttr":true,"type":"String"},{"name":"mapDecisionResult","isAttr":true,"type":"String","default":"resultList"},{"name":"decisionRefTenantId","isAttr":true,"type":"String"}]},{"name":"ExternalCapable","extends":["flowable:ServiceTaskLike"],"properties":[{"name":"type","isAttr":true,"type":"String"},{"name":"topic","isAttr":true,"type":"String"}]},{"name":"TaskPriorized","extends":["bpmn:Process","flowable:ExternalCapable"],"properties":[{"name":"taskPriority","isAttr":true,"type":"String"}]},{"name":"Properties","superClass":["Element"],"meta":{"allowedIn":["*"]},"properties":[{"name":"values","type":"Property","isMany":true}]},{"name":"Property","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"Connector","superClass":["Element"],"meta":{"allowedIn":["flowable:ServiceTaskLike"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"}]},{"name":"InputOutput","superClass":["Element"],"meta":{"allowedIn":["bpmn:FlowNode","flowable:Connector"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"},{"name":"inputParameters","isMany":true,"type":"InputParameter"},{"name":"outputParameters","isMany":true,"type":"OutputParameter"}]},{"name":"InputOutputParameter","properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"InputOutputParameterDefinition","isAbstract":true},{"name":"List","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"items","isMany":true,"type":"InputOutputParameterDefinition"}]},{"name":"Map","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"entries","isMany":true,"type":"Entry"}]},{"name":"Entry","properties":[{"name":"key","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"Value","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"id","isAttr":true,"type":"String"},{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Script","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"scriptFormat","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Field","superClass":["Element"],"meta":{"allowedIn":["flowable:ServiceTaskLike","flowable:ExecutionListener","flowable:TaskListener"]},"properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"expression","type":"String"},{"name":"stringValue","isAttr":true,"type":"String"},{"name":"string","type":"String"}]},{"name":"InputParameter","superClass":["InputOutputParameter"]},{"name":"OutputParameter","superClass":["InputOutputParameter"]},{"name":"Collectable","isAbstract":true,"extends":["bpmn:MultiInstanceLoopCharacteristics"],"superClass":["flowable:AsyncCapable"],"properties":[{"name":"collection","isAttr":true,"type":"String"},{"name":"elementVariable","isAttr":true,"type":"String"}]},{"name":"FailedJobRetryTimeCycle","superClass":["Element"],"meta":{"allowedIn":["flowable:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"ExecutionListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"TaskListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"defaultValue","type":"String","isAttr":true},{"name":"properties","type":"Properties"},{"name":"validation","type":"Validation"},{"name":"values","type":"Value","isMany":true}]},{"name":"Validation","superClass":["Element"],"properties":[{"name":"constraints","type":"Constraint","isMany":true}]},{"name":"Constraint","superClass":["Element"],"properties":[{"name":"name","type":"String","isAttr":true},{"name":"config","type":"String","isAttr":true}]},{"name":"ExtensionElements","properties":[{"name":"operationList","type":"String","isAttr":true},{"name":"businessOperationList","type":"String","isAttr":true}]},{"name":"OperationList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"operationList","type":"FormOperation","isMany":true}]},{"name":"BusinessOperationList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"businessOperationList","type":"Operation","isMany":true}]},{"name":"Operation","superClass":["Element"],"properties":[{"name":"data","type":"String","isAttr":true}]},{"name":"FormOperation","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"showOrder","type":"String","isAttr":true},{"name":"multiSignAssignee","type":"String","isAttr":true},{"name":"latestApprovalStatus","type":"String","isAttr":true},{"name":"variableList","type":"String","isAttr":true},{"name":"buttonStyle","type":"String","isAttr":true},{"name":"buttonIcon","type":"String","isAttr":true},{"name":"buttonPlain","type":"Boolean","isAttr":true}]},{"name":"VariableList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"variableList","type":"FormVariable","isMany":true}]},{"name":"FormVariable","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true}]},{"name":"CopyItemList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"copyItemList","type":"CopyItem","isMany":true}]},{"name":"CopyItem","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true}]},{"name":"Message","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"sendMessageType","isAttr":true,"type":"String"},{"name":"notifyMessage","isAttr":true,"type":"String"},{"name":"templateConfig","isAttr":true,"type":"String"}]},{"name":"DeptPostList","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"deptPostList","type":"DeptPost","isMany":true}]},{"name":"DeptPost","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"postId","type":"String","isAttr":true},{"name":"deptPostId","type":"String","isAttr":true}]},{"name":"ApiData","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"data","type":"String","isAttr":true}]},{"name":"TaskInfo","superClass":["Element"],"meta":{"allowedIn":["bpmn:ServiceTask","bpmn:ReceiveTask"]},"properties":[{"name":"data","type":"String","isAttr":true}]},{"name":"UserCandidateGroups","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"type","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"CustomCondition","superClass":["Element"],"meta":{"allowedIn":["bpmn:SequenceFlow"]},"properties":[{"name":"type","type":"String","isAttr":true},{"name":"operationType","type":"String","isAttr":true},{"name":"parallelRefuse","type":"Boolean","isAttr":true,"default":false}]},{"name":"AssigneeList","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"assigneeList","type":"Assignee","isMany":true},{"name":"type","type":"String","isAttr":true}]},{"name":"Assignee","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true}]},{"name":"ConditionalEventDefinition","isAbstract":true,"extends":["bpmn:ConditionalEventDefinition"],"properties":[{"name":"variableName","isAttr":true,"type":"String"},{"name":"variableEvent","isAttr":true,"type":"String"}]}],"emumerations":[]}'),fe=a(82859),ge=a.n(fe);const ke={class:"my-process-designer"},he={class:"my-process-designer__header"},Re={class:"popper-box"},Fe={class:"popper-box"},Te={class:"my-process-designer__container"};var Ee=(0,g.pM)({__name:"ProcessDesigner",props:{value:{},processId:{},processName:{},translations:{},additionalModel:{},moddleExtension:{},flowEntryInfo:{},onlyCustomizeAddi:{type:Boolean,default:!1},onlyCustomizeModdle:{type:Boolean,default:!1},simulation:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},prefix:{default:"flowable"},events:{default:()=>["element.click"]},headerButtonSize:{default:"default"},headerButtonType:{default:"primary"}},setup(e,{expose:t,emit:a}){const l=a,n=e,i=(0,k.KR)(),s=(0,k.KR)(),r=(0,k.KR)();let o;const u=(0,k.KR)(D.DiagramType.ORDINARY),d=(0,k.KR)(1),p=(0,k.KR)(!1),m=(0,k.KR)(!1),c=(0,k.KR)(""),b=(0,k.KR)("xml"),y=(0,k.KR)(!1),f=(0,k.KR)(!1),F=(0,k.KR)(!1),T=(0,g.EW)(()=>{const e=[];if(n.onlyCustomizeAddi)return Array.isArray(n.additionalModel)?n.additionalModel||[]:[n.additionalModel];Array.isArray(n.additionalModel)?e.push(...n.additionalModel):n.additionalModel&&e.push(n.additionalModel);const t={translate:["value",ie(n.translations||re)]};return e.push(t),n.simulation&&e.push(H()),n.prefix,"flowable"===n.prefix&&e.push(ge()),n.prefix,e}),E=(0,g.EW)(()=>{const e={};if(n.onlyCustomizeModdle)return n.moddleExtension||null;if(n.moddleExtension)for(let t in n.moddleExtension)e[t]=n.moddleExtension[t];return"activiti"===n.prefix&&(e.activiti=ye),"flowable"===n.prefix&&(e.flowable=ve),"camunda"===n.prefix&&(e.camunda=be),e}),w=e=>{if(console.log(">>>>>>>>>>>>> 设置BPMN的连接线 Begin"),!e||!o)return;const t=(e,a)=>{const l=e.endElement?e.endElement:e.element;let n=e.element.y,i=[...l.outgoing];if(o){if(e.conditionNodes&&(console.log("nodeConfig >>>",e),e.endElement&&o.get("modeling").resizeShape(e.endElement,{x:e.element.x,y:e.element.y,width:e.endElement.width,height:e.endElement.height}),e.conditionNodes.forEach((a,i)=>{if(a.childNode&&o){const s={id:a.element.id,name:a.element.businessObject.name,extensionElements:a.extensionElements,conditionExpression:a.conditionExpression};o.get("modeling").removeElements([a.element,...a.childNode.element.outgoing,...a.childNode.element.incoming]),a.element=(0,k.IG)(o.get("modeling").connect(e.element,a.childNode.element)),o.get("modeling").updateProperties(a.element,s),o.get("modeling").resizeShape(a.childNode.element,{x:l.x+150*i,y:n+80,width:a.childNode.element.width,height:a.childNode.element.height}),a.childNode&&t(a.childNode,e.endElement)}})),e.childNode)o.get("modeling").resizeShape(e.childNode.element,{x:l.x,y:l.y+100,width:e.childNode.element.width,height:e.childNode.element.height}),i=i.concat([...e.childNode.element.incoming]),o.get("modeling").connect(l,e.childNode.element),t(e.childNode,a);else if(a)a.y<l.y+100&&o.get("modeling").resizeShape(a,{x:a.x,y:l.y+120,width:a.width,height:a.height}),o.get("modeling").connect(l,a);else{const e=o.get("elementRegistry").find(e=>"bpmn:EndEvent"===e.type);o.get("modeling").resizeShape(e,{x:l.x,y:l.y+120,width:e.width,height:e.height}),o.get("modeling").connect(l,e)}o.get("modeling").removeElements(i)}},a=o.get("elementRegistry").find(e=>"bpmn:StartEvent"===e.type),l=o.get("elementRegistry").find(e=>"bpmn:EndEvent"===e.type),n=[...a.outgoing,...l.incoming,...e.element.outgoing,...e.element.incoming];o.get("modeling").removeElements(n),o.get("modeling").connect(a,e.element),t(e),console.log(">>>>>>>>>>>>> 设置BPMN的连接线 End")},A=()=>{if(!o)return;const e=o.get("elementRegistry").find(e=>"bpmn:Process"===e.type);if(null!=e)if(e.businessObject.extensionElements){let t=!1,a=null;e.businessObject.extensionElements.values.forEach(e=>{"flowable:Properties"===e.$type&&(a=e,e.values.forEach(a=>{"$OrangeDiagramType"===a.name&&(o?.get("modeling").updateModdleProperties(e,a,{value:u.value}),t=!0)}))}),t||o.get("modeling").updateModdleProperties(e.businessObject.extensionElements,a,{values:[...a.values||a.$children,o.get("moddle").create("flowable:Property",{name:"$OrangeDiagramType",value:u.value})]})}else{const t=o.get("moddle").create("bpmn:ExtensionElements",{values:[o.get("moddle").create("flowable:Properties",{values:[o.get("moddle").create("flowable:Property",{name:"$OrangeDiagramType",value:u.value})]})]});o.get("modeling").updateProperties(e,{extensionElements:t})}},x=e=>{let t=null;const a=e=>{console.log("findErrorNode",e),0!==e.type&&1!==e.type||0!==e.nodeUserList.length||(t=e),e.childNode&&!t&&a(e.childNode),e.conditionNodes&&!t&&e.conditionNodes.forEach(e=>{a(e)})};return e&&a(e),t},V=()=>{if(console.log("findErrorNode onSave"),null==o)return;u.value===D.DiagramType.DINGDING&&w(r.value?.getNodeConfig()),A(),console.log("findErrorNode onSave2",r.value?.getNodeConfig());const e=x(r.value?.getNodeConfig());e?S.s.confirm(e.nodeName+"任务还未设置处理人，是否保存?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o?.saveXML({format:!0}).then(({xml:e})=>{l("save",e)})}).catch(()=>{console.log("取消保存")}):o.saveXML({format:!0}).then(({xml:e})=>{l("save",e)})},C=()=>{o||(o=(0,k.IG)(new j.A({container:s.value,keyboard:n.keyboard?{bindTo:document}:null,additionalModules:T.value,moddleExtensions:E.value})),o&&l("init-finished",o),L())},L=()=>{if(!o)return;const e=o.get("eventBus");n.events.forEach(t=>{e.on(t,e=>{console.log(">>>>>>>>>>>>> bpmnModeler EventBus on",t);let a=t.replace(/\./g,"-"),n=e?e.element:null;l(a,n,e),l("event",a,n,e)})}),e.on("commandStack.changed",async e=>{if(console.log(">>>>>>>>>>>>> bpmnModeler EventBus commandStack",e),o)try{y.value=o.get("commandStack").canRedo(),f.value=o.get("commandStack").canUndo();let{xml:t}=await o.saveXML({format:!0});l("commandStack-changed",e),l("update:value",t),l("change",t)}catch(t){console.error(`[Process Designer Warn]: ${t.message||t}`)}}),o.on("canvas.viewbox.changed",({viewbox:e})=>{console.log(">>>>>>>>>>>>> bpmnModeler EventBus canvas.viewbox.changed",e),l("canvas-viewbox-changed",{viewbox:e});const{scale:t}=e;d.value=Math.floor(100*t)/100})},N=async e=>{let t=n.processId||`Process_${(new Date).getTime()}`,a=n.processName||`业务流程_${(new Date).getTime()}`,l=n.flowEntryInfo?.flowType||0,i=e||ce(t,a,n.prefix,u.value,l);try{if(o){let{warnings:e}=await o.importXML(i);e&&e.length&&e.forEach(e=>console.warn(e))}}catch(s){console.error(`[Process Designer Warn]: ${s.message||s}`)}},P=(e,t="diagram",a="")=>{console.log("setEncoded",e,t);const l=encodeURIComponent(a);return{filename:`${t}.${e}`,href:`data:application/${"svg"===e?"text/xml":"bpmn20-xml"};charset=UTF-8,${l}`,data:a}},W=async(e,t=void 0)=>{console.log("ProcessDesigner downloadProcess",e,t);try{if(o)if("xml"===e||"bpmn"===e){const{err:l,xml:n}=await o.saveXML();l&&console.error(`[Process Designer Warn ]: ${l.message||l}`);let{href:i,filename:s}=P(e.toUpperCase(),t,n);a(i,s)}else{const{err:e,svg:l}=await o.saveSVG();if(e)return console.error(e);let{href:n,filename:i}=P("SVG",t,l);a(n,i)}}catch(l){console.error(`[Process Designer Warn ]: ${l.message||l}`)}function a(e,t){if(e&&t){let a=document.createElement("a");a.download=t,a.href=e,a.click(),URL.revokeObjectURL(a.href)}}},O=()=>{const e=i.value.files[0],t=new FileReader;t.readAsText(e),t.onload=()=>{const e=t.result;console.log("ProcessDesigner.importLocalFile result",e),N(e),u.value!==D.DiagramType.DINGDING||-1!==e.indexOf('name="$OrangeDiagramType" value="1"')?N(e).then(()=>{u.value===D.DiagramType.DINGDING&&r.value.refresh()}):_.nk.error("格式错误")}};(0,g.sV)(()=>{C(),console.log("ProcessDesigner diagramType before",u.value),u.value=n.flowEntryInfo?.diagramType||D.DiagramType.ORDINARY,N(n.value).then(()=>{F.value=!0})}),(0,g.xo)(()=>{o&&(o.destroy(),l("destroy",o)),o=void 0});const B=()=>{u.value===D.DiagramType.DINGDING&&(A(),w(r.value?.getNodeConfig())),W("xml")},U=()=>{W("bpmn")},z=()=>{W("svg")},K=()=>{m.value=!m.value,n.simulation&&o&&o.get("toggleMode").toggleMode()},M=()=>{o&&o.get("commandStack").redo()},X=()=>{o&&o.get("commandStack").undo()},q=(e=.1)=>{let t=Math.floor(100*d.value+100*e)/100;if(t>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");d.value=t,o&&o.get("canvas").zoom(d.value)},$=(e=.1)=>{let t=Math.floor(100*d.value-100*e)/100;if(t<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");d.value=t,o&&o.get("canvas").zoom(d.value)},J=(e=1)=>{if(e<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");if(e>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");d.value=e,o&&o.get("canvas").zoom(e)},ee=()=>{d.value=1,o&&o.get("canvas").zoom("fit-viewport","auto")},te=()=>{y.value=!1,f.value=!1,N(null).then(()=>{o&&o.get("canvas").zoom(1,"auto")})},ae=e=>{if(!o)return;const t=o.get("alignElements"),a=o.get("selection"),l=a.get();!l||l.length<=1?_.nk.warning("请按住 Ctrl 键选择多个元素对齐"):S.s.confirm("自动对齐可能造成图形变形，是否继续？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>t.trigger(l,e))},ne=()=>{u.value===D.DiagramType.DINGDING&&(A(),w(r.value?.getNodeConfig())),o&&o.saveXML({format:!0}).then(({xml:e})=>{c.value=e,b.value="xml",p.value=!0})},se=()=>{o&&o.saveXML({format:!0}).then(({xml:e})=>{c.value=(0,Y.xml2json)(e,{spaces:2}),b.value="json",p.value=!0})},oe=()=>{S.s.confirm("确认切换？切换后流程图数据重置！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u.value=u.value===D.DiagramType.ORDINARY?D.DiagramType.DINGDING:D.DiagramType.ORDINARY,F.value=!1,(0,g.dY)(()=>{N(null).then(()=>{if(F.value=!0,o){const e=o.get("elementRegistry").find(e=>"bpmn:UserTask"===e.type);e&&o.get("selection").select(e)}})})}).catch(e=>{console.warn(e)})},ue=()=>{i.value.click()};return t({onSave:V,changeDiagram:oe,processZoomTo:J}),(e,t)=>{const a=v.S2,l=G.R7,n=v.fg,T=Q.kZ;return(0,g.uX)(),(0,g.CE)("div",ke,[(0,g.bo)((0,g.Lk)("div",he,[(0,g.RG)(e.$slots,"control-header"),e.$slots["control-header"]?(0,g.Q3)("",!0):((0,g.uX)(),(0,g.CE)(g.FK,{key:0},[(0,g.bF)(n,{key:"file-control"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,type:e.headerButtonType,icon:(0,k.R1)(I.Edit),onClick:V},{default:(0,g.k6)(()=>t[15]||(t[15]=[(0,g.eW)("保存流程")])),_:1,__:[15]},8,["size","type","icon"]),(0,g.bF)(a,{size:e.headerButtonSize,type:e.headerButtonType,icon:(0,k.R1)(I.FolderOpened),onClick:ue},{default:(0,g.k6)(()=>t[16]||(t[16]=[(0,g.eW)("打开文件")])),_:1,__:[16]},8,["size","type","icon"]),(0,g.bF)(l,{effect:"light"},{content:(0,g.k6)(()=>[(0,g.Lk)("div",Re,[(0,g.bF)(a,{size:e.headerButtonSize,link:"",type:"primary",onClick:t[0]||(t[0]=e=>B())},{default:(0,g.k6)(()=>t[17]||(t[17]=[(0,g.eW)("下载为XML文件")])),_:1,__:[17]},8,["size"]),(0,g.bF)(a,{size:e.headerButtonSize,link:"",type:"primary",onClick:t[1]||(t[1]=e=>z())},{default:(0,g.k6)(()=>t[18]||(t[18]=[(0,g.eW)("下载为SVG文件")])),_:1,__:[18]},8,["size"]),(0,g.bF)(a,{size:e.headerButtonSize,link:"",type:"primary",onClick:t[2]||(t[2]=e=>U())},{default:(0,g.k6)(()=>t[19]||(t[19]=[(0,g.eW)("下载为BPMN文件")])),_:1,__:[19]},8,["size"])])]),default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,type:e.headerButtonType,icon:(0,k.R1)(I.Download)},{default:(0,g.k6)(()=>t[20]||(t[20]=[(0,g.eW)("下载文件")])),_:1,__:[20]},8,["size","type","icon"])]),_:1}),(0,g.bF)(l,{effect:"light"},{content:(0,g.k6)(()=>[(0,g.Lk)("div",Fe,[(0,g.bF)(a,{size:e.headerButtonSize,link:"",type:"primary",onClick:ne},{default:(0,g.k6)(()=>t[21]||(t[21]=[(0,g.eW)("预览XML")])),_:1,__:[21]},8,["size"]),(0,g.bF)(a,{size:e.headerButtonSize,link:"",type:"primary",onClick:se},{default:(0,g.k6)(()=>t[22]||(t[22]=[(0,g.eW)("预览JSON")])),_:1,__:[22]},8,["size"])])]),default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,type:e.headerButtonType,icon:(0,k.R1)(I.View)},{default:(0,g.k6)(()=>t[23]||(t[23]=[(0,g.eW)("预览")])),_:1,__:[23]},8,["size","type","icon"])]),_:1}),e.simulation?((0,g.uX)(),(0,g.Wv)(l,{key:0,effect:"light",content:(0,k.R1)(m)?"退出模拟":"开启模拟"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,type:e.headerButtonType,icon:(0,k.R1)(I.Cpu),onClick:K},{default:(0,g.k6)(()=>t[24]||(t[24]=[(0,g.eW)("模拟")])),_:1,__:[24]},8,["size","type","icon"])]),_:1},8,["content"])):(0,g.Q3)("",!0)]),_:1}),(0,g.bF)(n,{key:"align-control"},{default:(0,g.k6)(()=>[(0,g.bF)(l,{effect:"light",content:"向左对齐"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,class:"align align-left",icon:(0,k.R1)(I.Histogram),onClick:t[3]||(t[3]=e=>ae("left"))},null,8,["size","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"向右对齐"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,class:"align align-right",icon:(0,k.R1)(I.Histogram),onClick:t[4]||(t[4]=e=>ae("right"))},null,8,["size","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"向上对齐"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,class:"align align-top",icon:(0,k.R1)(I.Histogram),onClick:t[5]||(t[5]=e=>ae("top"))},null,8,["size","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"向下对齐"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,class:"align align-bottom",icon:(0,k.R1)(I.Histogram),onClick:t[6]||(t[6]=e=>ae("bottom"))},null,8,["size","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"水平居中"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,class:"align align-center",icon:(0,k.R1)(I.Histogram),onClick:t[7]||(t[7]=e=>ae("center"))},null,8,["size","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"垂直居中"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,class:"align align-middle",icon:(0,k.R1)(I.Histogram),onClick:t[8]||(t[8]=e=>ae("middle"))},null,8,["size","icon"])]),_:1})]),_:1}),(0,g.bF)(n,{key:"scale-control"},{default:(0,g.k6)(()=>[(0,g.bF)(l,{effect:"light",content:"缩小视图"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,disabled:(0,k.R1)(d)<=.3,icon:(0,k.R1)(I.ZoomOut),onClick:t[9]||(t[9]=e=>$())},null,8,["size","disabled","icon"])]),_:1}),(0,g.bF)(a,{size:e.headerButtonSize},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(Math.floor(10*(0,k.R1)(d)*10)+"%"),1)]),_:1},8,["size"]),(0,g.bF)(l,{effect:"light",content:"放大视图"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,disabled:(0,k.R1)(d)>=3.9,icon:(0,k.R1)(I.ZoomIn),onClick:t[10]||(t[10]=e=>q())},null,8,["size","disabled","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"重置视图并居中"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,icon:(0,k.R1)(I.ScaleToOriginal),onClick:t[11]||(t[11]=e=>ee())},null,8,["size","icon"])]),_:1})]),_:1}),(0,g.bF)(n,{key:"stack-control"},{default:(0,g.k6)(()=>[(0,g.bF)(l,{effect:"light",content:"撤销"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,disabled:!(0,k.R1)(f),icon:(0,k.R1)(I.RefreshLeft),onClick:t[12]||(t[12]=e=>X())},null,8,["size","disabled","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"恢复"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,disabled:!(0,k.R1)(y),icon:(0,k.R1)(I.RefreshRight),onClick:t[13]||(t[13]=e=>M())},null,8,["size","disabled","icon"])]),_:1}),(0,g.bF)(l,{effect:"light",content:"重新绘制"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{size:e.headerButtonSize,icon:(0,k.R1)(I.Refresh),onClick:te},null,8,["size","icon"])]),_:1})]),_:1})],64)),(0,g.Lk)("input",{type:"file",id:"files",ref_key:"refFile",ref:i,style:{display:"none"},accept:".xml, .bpmn",onChange:O},null,544)],512),[[R.aG,(0,k.R1)(u)==(0,k.R1)(D.DiagramType).ORDINARY]]),(0,g.bo)((0,g.Lk)("div",Te,[(0,g.Lk)("div",{class:"my-process-designer__canvas",ref_key:"bpmnCanvas",ref:s},null,512)],512),[[R.aG,(0,k.R1)(u)==(0,k.R1)(D.DiagramType).ORDINARY]]),(0,k.R1)(F)&&(0,k.R1)(u)==(0,k.R1)(D.DiagramType).DINGDING?((0,g.uX)(),(0,g.Wv)(Z.A,{key:0,ref_key:"dingflowDesigner",ref:r,bpmnModeler:(0,k.R1)(o),downloadProcessAsXml:B,previewProcessXML:ne,openFile:ue},null,8,["bpmnModeler"])):(0,g.Q3)("",!0),(0,g.bF)(T,{title:"预览",width:"60%",modelValue:(0,k.R1)(p),"onUpdate:modelValue":t[14]||(t[14]=e=>(0,k.i9)(p)?p.value=e:null),"append-to-body":"","destroy-on-close":""},{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(le),{language:(0,k.R1)(b),code:(0,k.R1)(c),style:{height:"60vh"}},null,8,["language","code"])]),_:1},8,["modelValue"])])}}}),_e=a(71241);const Se=(0,_e.A)(Ee,[["__scopeId","data-v-5b73ee32"]]);var Ie=Se,we=a(77195),Ae=(a(38389),a(61688),a(22369)),xe=(0,g.pM)({__name:"ElementBaseInfo",props:{businessObject:{},type:{},idEditDisabled:{type:Boolean,default:!0}},setup(e){const t=(0,K.l5)(),a=e,l=(0,g.WQ)("flowEntry",()=>({})),n=(0,k.KR)({});let i=null;const r=window,u=()=>{i=r?.bpmnInstances?.bpmnElement,n.value=JSON.parse(JSON.stringify(i?.businessObject))},d=e=>{const t=Object.create(null);t[e]=n.value[e],"id"===e?null!=n.value[e]&&""!==n.value[e]&&r.bpmnInstances.modeling.updateProperties(i,{id:n.value[e],di:{id:`${n.value[e]}_di`}}):r.bpmnInstances.modeling.updateProperties(i,t)};return(0,g.xo)(()=>{i=null}),(0,g.wB)(()=>a.businessObject,e=>{e&&(0,g.dY)(()=>u())}),(e,a)=>{const i=m.WK,r=s.xE,u=o.qi,p=s.US;return(0,g.uX)(),(0,g.CE)("div",null,[(0,g.bF)(p,{size:(0,k.R1)(t).defaultFormItemSize,onSubmit:a[6]||(a[6]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[(0,g.bF)(r,{label:"流程名称"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{value:(0,k.R1)(l)().value.processDefinitionName,disabled:!0},null,8,["value"])]),_:1}),(0,g.bF)(r,{label:"任务ID"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:n.value.id,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value.id=e),disabled:e.idEditDisabled||"bpmn:Process"===n.value.$type,clearable:"",onInput:a[1]||(a[1]=e=>d("id"))},null,8,["modelValue","disabled"])]),_:1}),(0,g.bF)(r,{label:"任务名称"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:n.value.name,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.name=e),clearable:"",disabled:e.idEditDisabled||"bpmn:Process"===n.value.$type,onInput:a[3]||(a[3]=e=>d("name"))},null,8,["modelValue","disabled"])]),_:1}),"bpmn:Process"===n.value.$type?((0,g.uX)(),(0,g.Wv)(r,{key:0,label:"可执行"},{default:(0,g.k6)(()=>[(0,g.bF)(u,{modelValue:n.value.isExecutable,"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.isExecutable=e),onChange:a[5]||(a[5]=e=>d("isExecutable")),style:{"margin-left":"18px"}},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)]),_:1},8,["size"])])}}});const Ve=xe;var Ce=Ve,Le=(a(25032),a(19183));const De={class:"task-multiple-select"},Ne={key:0,class:"tag-box"};var Pe=(0,g.pM)({__name:"TaskMultipleSelect",props:{value:{},isCountersign:{type:Boolean,default:!1}},emits:["update:value"],setup(e,{emit:t}){const a=t,l=e,n=((0,K.l5)(),(0,k.KR)([])),s={"${startUserName}":"流程发起人","${appointedAssignee}":"指定审批人 "},r=e=>{let t=n.value.filter(t=>t.id!==e.id);Array.isArray(l.value)?a("update:value",t):a("update:value",t.map(e=>e.id).join(","))};return(0,g.wB)(()=>l.value,e=>{console.log("TaskMultipleSelect value change",e),e?Array.isArray(e)?n.value=[...e].map(e=>({id:e.id,name:s[e.id]?s[e.id]:e.name||e.id})):n.value=e.split(",").map(e=>({id:e,name:s[e]?s[e]:e})):n.value=[]},{immediate:!0,deep:!0}),(e,t)=>{const a=i.u;return(0,g.uX)(),(0,g.CE)("div",De,[(0,g.RG)(e.$slots,"default"),(0,k.R1)(n).length?((0,g.uX)(),(0,g.CE)("div",Ne,[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(n),t=>((0,g.uX)(),(0,g.Wv)(a,{size:"large",effect:"dark",key:t.id,closable:!e.isCountersign,onClose:e=>r(t)},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(t.name),1)]),_:2},1032,["closable","onClose"]))),128))])):(0,g.Q3)("",!0)])}}});const We=(0,_e.A)(Pe,[["__scopeId","data-v-77d3c004"]]);var Oe=We,Be=a(99564),Ue=a(64379),ze=a(54428),Ke=a(91542),Me=(a(37985),a(72855)),Xe=(a(64491),a(72153),a(31328),a(86221)),qe=a(2986),$e=a(37032),Qe=a(52081),Ge=a(63019);const je={class:"autotask-http-settting",style:{width:"100%"}},Je={style:{margin:"0px 10px 0px 0px"}},He={style:{margin:"0px 10px 0px 0px"}},Ye={style:{margin:"0px 10px 0px 0px"}};var Ze=(0,g.pM)({__name:"ApiSetting",props:{modelValue:{},isBusiness:{type:Boolean}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix"),(0,g.WQ)("getAllAutoVariableList",()=>[])),o=(0,k.KR)({actionType:D.AutoTaskActionType.HTTP,httpRequestInfo:{url:"",httpMethod:"GET",headerList:[],bodyType:"formData",urlParamList:[],formDataList:[],rawType:"json",bodyData:""},httpResponnseData:{successStatusCode:"",successBodyField:"",errorMessageBodyField:"",failHandleType:"stop",httpResponseBody:[],bizDataPath:""}}),u=new Qe.w("Body类型",[{id:"formData",name:"form-data",symbol:"FORM_DATA"},{id:"raw",name:"raw",symbol:"RAW"}]),d=new Qe.w("Raw类型",[{id:"text",name:"text",symbol:"TEXT"},{id:"json",name:"json",symbol:"JSON"}]),p=(new Qe.w("失败处理方式",[{id:"stop",name:"流程中止执行",symbol:"EXIT"},{id:"continue",name:"继续执行",symbol:"CONTINUE"}]),(0,g.EW)(()=>{let e=o.value.httpResponnseData.httpResponseBody.map(e=>({...e,disabled:"Object"!==e.fieldType&&"Array"!==e.fieldType}));return(0,$.BN)(e,"id","parentId")}),()=>{let e={...o.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))}),v=(e,t)=>{null==e?(null==o.value.httpRequestInfo.headerList&&(o.value.httpRequestInfo.headerList=[]),o.value.httpRequestInfo.headerList.push(t)):o.value.httpRequestInfo.headerList=o.value.httpRequestInfo.headerList.map(e=>e.key===t.key?t:e),p()},f=e=>{U.l.show("编辑请求头",Xe["default"],{area:["500px","300px"]},{entryId:n().entryId,data:e,usedKeyList:o.value.httpRequestInfo.headerList.map(e=>e.key),flowVariableList:i(),path:"thirdEditHttpHeader"},{width:"500px",height:"300px",pathName:"/thirdParty/thirdEditHttpHeader"}).then(t=>{v(e,t)}).catch(e=>{console.log(e)})},R=e=>{S.s.confirm("是否删除此请求头？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.value.httpRequestInfo.headerList=o.value.httpRequestInfo.headerList.filter(t=>t.key!==e.key),p()}).catch(e=>{console.log(e)})},F=(e,t)=>{null==e?(null==o.value.httpRequestInfo.urlParamList&&(o.value.httpRequestInfo.urlParamList=[]),o.value.httpRequestInfo.urlParamList.push(t)):o.value.httpRequestInfo.urlParamList=o.value.httpRequestInfo.urlParamList.map(e=>e.key===t.key?t:e),p()},T=e=>{U.l.show("编辑URL参数",qe["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,usedParamList:o.value.httpRequestInfo.urlParamList.map(e=>e.key),flowVariableList:i(),path:"thirdEditHttpUrlParam"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditHttpRequestParam"}).then(t=>{F(e,t)}).catch(e=>{console.log(e)})},E=e=>{S.s.confirm("是否删除此URL参数？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{o.value.httpRequestInfo.urlParamList=o.value.httpRequestInfo.urlParamList.filter(t=>t.key!==e.key),p()}).catch(e=>{console.log(e)})},_=(e,t)=>{null==o.value.httpRequestInfo.formDataList&&(o.value.httpRequestInfo.formDataList=[]),null==e?o.value.httpRequestInfo.formDataList.push(t):o.value.httpRequestInfo.formDataList=o.value.httpRequestInfo.formDataList.map(e=>e.key===t.key?t:e),p()},w=e=>{U.l.show("编辑Body参数",qe["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,usedParamList:o.value.httpRequestInfo.formDataList.map(e=>e.key),flowVariableList:i(),path:"thirdEditHttpBodyParam"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditHttpRequestParam"}).then(t=>{_(e,t)}).catch(e=>{console.log(e)})},A=e=>{S.s.confirm("是否删除此Body参数？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{o.value.httpRequestInfo.formDataList=o.value.httpRequestInfo.formDataList.filter(t=>t.key!==e.key),p()}).catch(e=>{console.log(e)})};return(0,g.wB)(()=>l.modelValue,e=>{let t=e&&""!==e?JSON.parse(e):{};null==t.httpRequestInfo&&(t.httpRequestInfo={}),null==t.httpResponnseData&&(t.httpResponnseData={}),o.value={actionType:D.AutoTaskActionType.HTTP,httpRequestInfo:{url:t.httpRequestInfo.url||"",httpMethod:t.httpRequestInfo.httpMethod||"GET",headerList:t.httpRequestInfo.headerList||[],bodyType:t.httpRequestInfo.bodyType||"formData",urlParamList:t.httpRequestInfo.urlParamList||[],formDataList:t.httpRequestInfo.formDataList||[],rawType:t.httpRequestInfo.rawType||"json",bodyData:t.httpRequestInfo.bodyData||""},httpResponnseData:{successStatusCode:t.httpResponnseData.successStatusCode||"",successBodyField:t.httpResponnseData.successBodyField||"",errorMessageBodyField:t.httpResponnseData.errorMessageBodyField||"",failHandleType:t.httpResponnseData.failHandleType||"stop",httpResponseBody:t.httpResponnseData.httpResponseBody||[],bizDataPath:t.httpResponnseData.bizDataPath||""}}},{immediate:!0}),(e,t)=>{const a=c.P9,l=c.AV,n=m.WK,i=s.xE,v=r.C4,F=Me.c6,_=Me.Iy,S=Me.dW,x=y.S2,V=b.ll,C=b.MQ,L=Ke.tk,N=G.R7;return(0,g.uX)(),(0,g.CE)("div",je,[(0,g.bF)(i,{label:"API Url"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{placeholder:"请输入请求URL",modelValue:(0,k.R1)(o).httpRequestInfo.url,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(o).httpRequestInfo.url=e),onChange:p},{prepend:(0,g.k6)(()=>[(0,g.bF)(l,{class:"url-select",style:{width:"100px"},modelValue:(0,k.R1)(o).httpRequestInfo.httpMethod,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(o).httpRequestInfo.httpMethod=e),placeholder:"请选择",onChange:p},{default:(0,g.k6)(()=>[(0,g.bF)(a,{label:"GET",value:"GET"}),(0,g.bF)(a,{label:"POST",value:"POST"}),(0,g.bF)(a,{label:"PUT",value:"PUT"}),(0,g.bF)(a,{label:"DELETE",value:"DELETE"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(Ge.A,{label:"请求头设置",data:(0,k.R1)(o).httpRequestInfo.headerList,addText:"添加",onAdd:t[2]||(t[2]=e=>f()),onEdit:f,onDelete:R,prop:{label:"key",value:"key"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).key),1),t[12]||(t[12]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",Je,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).srcValue),1)]),_:1},8,["data"]),(0,g.bF)(Ge.A,{label:"URL参数设置",data:(0,k.R1)(o).httpRequestInfo.urlParamList,addText:"添加",onAdd:t[3]||(t[3]=e=>T()),onEdit:T,onDelete:E,prop:{label:"name",value:"id"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).key),1),t[13]||(t[13]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",He,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).srcValue),1)]),_:1},8,["data"]),(0,g.bF)(i,{labe:"请求Body类型"},{default:(0,g.k6)(()=>[(0,g.bF)(C,{modelValue:(0,k.R1)(o).httpRequestInfo.bodyType,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(o).httpRequestInfo.bodyType=e),onChange:p},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u).getList(),e=>((0,g.uX)(),(0,g.Wv)(V,{key:e.id,value:e.id},{default:(0,g.k6)(()=>[(0,g.bF)(x,{type:"flex",align:"middle"},{default:(0,g.k6)(()=>[(0,g.Lk)("span",null,(0,h.v_)(e.name),1),(0,k.R1)(o).httpRequestInfo.bodyType===(0,k.R1)(u).RAW&&e.id===(0,k.R1)(u).RAW?((0,g.uX)(),(0,g.Wv)(S,{key:0,style:{"margin-left":"10px"},onCommand:t[4]||(t[4]=e=>(0,k.R1)(o).httpRequestInfo.rawType=e)},{dropdown:(0,g.k6)(()=>[(0,g.bF)(_,null,{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(d).getList(),e=>((0,g.uX)(),(0,g.Wv)(F,{key:e.id,command:e.id},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(e.name),1)]),_:2},1032,["command"]))),128))]),_:2},1024)]),default:(0,g.k6)(()=>[(0,g.bF)(v,null,{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)((0,k.R1)(d).getValue((0,k.R1)(o).httpRequestInfo.rawType)),1)]),_:1})]),_:2},1024)):(0,g.Q3)("",!0)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,k.R1)(o).httpRequestInfo.bodyType===(0,k.R1)(u).FORM_DATA?((0,g.uX)(),(0,g.Wv)(Ge.A,{key:0,label:"Body参数设置",data:(0,k.R1)(o).httpRequestInfo.formDataList,addText:"添加",onAdd:t[6]||(t[6]=e=>w()),onEdit:w,onDelete:A,prop:{label:"name",value:"id"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).key),1),t[14]||(t[14]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",Ye,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).srcValue),1)]),_:1},8,["data"])):(0,g.Q3)("",!0),(0,k.R1)(o).httpRequestInfo.bodyType===(0,k.R1)(u).RAW?((0,g.uX)(),(0,g.Wv)(i,{key:1,label:"Body参数设置"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpRequestInfo.bodyData,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(o).httpRequestInfo.bodyData=e),type:"textarea",rows:"5",clearable:"",placeholder:"请输入请求Body",onChange:p},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),(0,g.bF)(i,{label:"请求成功的HTTP状态码"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpResponnseData.successStatusCode,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.R1)(o).httpResponnseData.successStatusCode=e),clearable:"",placeholder:"示例：200,201 (多个状态码使用英文逗号分隔)",onChange:p},null,8,["modelValue"])]),_:1}),(0,g.bF)(i,{label:"请求成功字段"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpResponnseData.successBodyField,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,k.R1)(o).httpResponnseData.successBodyField=e),clearable:"",placeholder:"示例：data.isSuccess 请求成功情况下，进一步判断是否成功字段",onChange:p},null,8,["modelValue"])]),_:1}),(0,g.bF)(i,{label:"失败信息字段"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpResponnseData.errorMessageBodyField,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,k.R1)(o).httpResponnseData.errorMessageBodyField=e),clearable:"",placeholder:"示例：data.message 请求成功情况下，返回的失败信息字段",onChange:p},null,8,["modelValue"])]),_:1}),e.isBusiness?(0,g.Q3)("",!0):((0,g.uX)(),(0,g.Wv)(i,{key:2,label:"应答业务字段路径"},{label:(0,g.k6)(()=>[t[16]||(t[16]=(0,g.Lk)("span",null,"应答业务字段路径 ",-1)),(0,g.bF)(N,{class:"item",effect:"dark",placement:"right-start"},{content:(0,g.k6)(()=>t[15]||(t[15]=[(0,g.Lk)("div",null,"返回候选用户组，多个用户名之间用逗号分隔",-1)])),default:(0,g.k6)(()=>[(0,g.bF)(L,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.InfoFilled))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpResponnseData.bizDataPath,"onUpdate:modelValue":t[11]||(t[11]=e=>(0,k.R1)(o).httpResponnseData.bizDataPath=e),clearable:"",placeholder:"示例：data.userList，目前仅支持返回用户名列表 (逗号分隔)",onChange:p},null,8,["modelValue"])]),_:1}))])}}});const et=(0,_e.A)(Ze,[["__scopeId","data-v-52232918"]]);var tt=et;const at=!0;var lt=(0,g.pM)({__name:"UserTask",props:{id:{},type:{}},setup(e){const t=e,a=(0,g.WQ)("flowEntry",()=>(console.warn("UserTask not inject flowEntry yet."),{})),l=(0,g.WQ)("prefix"),n=(0,K.l5)(),i=(0,k.KR)(!1),r=(0,k.KR)([]),o=(0,k.KR)([]),u=(0,k.KR)([]),d={assignee:"",candidateUsers:"",candidateGroups:"",dueDate:"",followUpDate:"",priority:"",sendMessageType:""},p=(0,k.KR)({groupType:"ASSIGNEE",variableType:void 0}),y=(0,k.KR)(),f=(0,k.KR)();let R=new Map;const F=(0,k.KR)([]),T=(0,k.KR)([]);let E=new Map,_=new Map,S=(0,k.KR)({assignee:"",candidateUsers:"",candidateGroups:"",dueDate:"",followUpDate:"",priority:"",sendMessageType:""});const w=(0,k.KR)([]),A=(0,k.KR)(),x=(0,k.KR)(),V=(0,K.L4)(),C=window,L=e=>{null!=e&&null!=e.loginName&&("${startUserName}"===e.loginName&&(e.showName="流程发起人"),"${appointedAssignee}"===e.loginName&&(e.showName="指定审批人"),"${assignee}"===e.loginName&&(e.showName="会签人"))},N=e=>{L(e),w.value=e?[{id:e.loginName,name:e.showName||e.loginName}]:[]},P=()=>{U.l.show("选择用户",Le["default"],{area:["1000px","650px"]},{multiple:!1,path:"thirdTaskUserSelect"},{width:"1000px",height:"650px",pathName:"/thirdParty/thirdTaskUserSelect"}).then(e=>{N(e)}).catch(e=>{console.error(e)})},W=e=>{let t=e;if(e&&!Array.isArray(e)&&(t=[e]),Array.isArray(t)){let e=w.value.map(e=>e.id);t.forEach(t=>{L(t),-1===e.indexOf(t.loginName)&&w.value.push({id:t.loginName,name:t.showName||t.loginName})})}},O=()=>{let e=null==S.value.candidateUsers||""===S.value.candidateUsers?[]:S.value.candidateUsers.split(",");U.l.show("选择候选用户",Le["default"],{area:["1000px","650px"]},{multiple:!0,usedUserIdList:e,path:"thirdTaskUserSelectCandidateUsers"},{width:"1000px",height:"650px",pathName:"/thirdParty/thirdTaskUserSelect"}).then(e=>{W(e)}).catch(e=>{console.warn(e)})},B=()=>new Promise((e,t)=>{if(at){let a={widgetType:"upms_role",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{null==t.data.dataList&&(t.data.dataList=[]),y.value=t.data.dataList.map(e=>({id:String(e.roleId),name:e.roleName,...e})),e(t)}).catch(e=>{t(e)})}else ze.v9.dictSysRole({}).then(t=>{y.value=t.getList(),e(t)}).catch(e=>{t(e)})}),z=()=>new Promise((e,t)=>{if(at){let a={widgetType:"upms_dept",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{let a=[];null==t.data.dataList&&(t.data.dataList=[]),t.data.dataList.forEach(e=>{const t={id:String(e.deptId),name:e.deptName,parentId:String(e.parentId),...e};R?.set(t.id+"",t),a.push(t)}),f.value=(0,$.BN)(a),e(t)}).catch(e=>{t(e)})}else ze.v9.dictSysDept({}).then(t=>{t.getList().forEach(e=>{R?.set(e.id+"",e)}),f.value=(0,$.BN)(t.getList()),e(t)}).catch(e=>{t(e)})}),M=()=>new Promise((e,t)=>{if(at){let a={widgetType:"upms_dept_post",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{null==t.data.dataList&&(t.data.dataList=[]),t.data.dataList.forEach(e=>{_?.set(e.deptPostId+"",e)}),T.value=t.data.dataList,e(t)}).catch(e=>{t(e)})}else ze.v9.dictDeptPost({}).then(t=>{t.forEach(e=>{_?.set(e.deptPostId+"",e)}),T.value=t.sort((e,t)=>e.postLevel-t.postLevel),e(t)}).catch(e=>{t(e)})}),X=()=>(E=new Map,new Promise((e,t)=>{if(at){let a={widgetType:"upms_post",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{null==t.data.dataList&&(t.data.dataList=[]),t.data.dataList.forEach(e=>{const t={id:String(e.postId),name:e.postName,...e};E?.set(t.id+"",t)}),F.value=t.data.dataList,e(t)}).catch(e=>{t(e)})}else ze.S_.list({}).then(t=>{F.value=t.data.dataList,F.value.forEach(e=>{E?.set(e.postId+"",e)}),e(t)}).catch(e=>{t(e)})})),q=()=>{let e=window.bpmnInstances.bpmnElement.businessObject.get("extensionElements")||window.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});return e},Q=()=>{let e=q(),t=e.values.filter(e=>e.$type!==`${l}:ApiData`);if("API"===p.value.groupType){let e=window.bpmnInstances.moddle.create(`${l}:ApiData`,{data:x.value||""});t=t.concat(e)}const a=window.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t});window.bpmnInstances.modeling.updateProperties(window.bpmnInstances.bpmnElement,{extensionElements:a})},G=e=>{U.l.show("选择部门",Be["default"],{area:["600px","600px"]},{allGroupList:f.value,usedIdList:e,path:"thirdTaskGroupSelect"},{width:"600px",height:"630px",pathName:"/thirdParty/thirdTaskGroupSelect"}).then(e=>{j(e)}).catch(e=>{console.warn(e)})},j=e=>{Array.isArray(e)?(Array.isArray(r.value)||(r.value=[]),e.forEach(e=>{null==(0,$.PH)(r.value,e.id,"id")&&r.value.push(e)})):r.value.push({id:e.deptId,name:e.deptName}),S.value.candidateGroups=Array.isArray(r.value)?r.value.map(e=>e.id).join(","):""},J=e=>{U.l.show("选择岗位",Ue["default"],{area:["1000px","615px"],skin:"layer-advance-dialog"},{deptList:f.value,deptPostList:T.value,postList:F.value,usedIdList:e,path:"thirdTaskPostSelect"},{width:"1000px",height:"640px",pathName:"/thirdParty/thirdTaskPostSelect"}).then(e=>{Y(e)}).catch(e=>{console.warn(e)})},H=()=>{let e=q(),t=e.values.filter(e=>e.$type!==`${l}:DeptPostList`),a=null;"POST"===p.value.groupType?(a=C.bpmnInstances.moddle.create(`${l}:DeptPostList`,{deptPostList:[]}),a&&!Array.isArray(a)&&(a.deptPostList=r.value.map(e=>C.bpmnInstances.moddle.create(`${l}:DeptPost`,{id:e.id,type:e.deptType,postId:e.postId,deptPostId:e.deptPostId})))):a=[];const n=C.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t.concat(a)});C.bpmnInstances.modeling.updateProperties(C.bpmnInstances.bpmnElement,{extensionElements:n})},Y=e=>{S.value.candidateGroups="",Array.isArray(e)&&(Array.isArray(r.value)||(r.value=[]),e.forEach(e=>{let t=ee(e);null==(0,$.PH)(r.value,e.id,"id")&&r.value.push({...e,name:t.deptName?`${t.deptName} / ${t.postName}`:t.postName})}),H()),S.value.candidateGroups=Array.isArray(r.value)?r.value.map(e=>e.id).join(","):""},Z=()=>{se();const e="USERS"===p.value.variableType?"candidateUsers":"candidateGroups",t="candidateUsers"===e?"candidateGroups":"candidateUsers";let a=Object.create(null);a[e]=A.value,a[t]=void 0,window.bpmnInstances.modeling.updateProperties(window.bpmnInstances.bpmnElement,a);let n=null;"allDeptPost"===p.value.variableType||"deptPost"===p.value.variableType?(oe(p.value.variableType,null),n=window.bpmnInstances.moddle.create(`${l}:DeptPostList`,{deptPostList:[]}),n.deptPostList=[window.bpmnInstances.moddle.create(`${l}:DeptPost`,{type:p.value.variableType,deptPostId:A.value})]):(n=[],oe(p.value.variableType,A.value));let i=q(),s=i.values.filter(e=>e.$type!==`${l}:DeptPostList`);const r=window.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:s.concat(n)});window.bpmnInstances.modeling.updateProperties(window.bpmnInstances.bpmnElement,{extensionElements:r})},ee=e=>{let t;switch(e.deptType){case"allDeptPost":t="全部";break;case"selfDeptPost":t="本部门";break;case"siblingDeptPost":t="同级部门";break;case"upDeptPost":t="上级部门";break;case"deptPost":t=(_?.get(e.deptPostId)||{}).deptName||"未知岗位";break}let a="deptPost"===e.deptType?(_?.get(e.deptPostId)||{}).postShowName||"未知岗位":(E?.get(String(e.postId))||{}).postName||"未知岗位";return{deptName:t,postName:a}},te=()=>{let e=S.value.candidateGroups?S.value.candidateGroups.split(","):[];"DEPT"===p.value.groupType?G(e):J(e)},ae=e=>{(0,g.dY)(()=>{S.value.candidateGroups=Array.isArray(e)?e.join(","):""})},le=e=>new Promise((t,a)=>{null==e||""===e.fieldValues?t([]):ze.If.viewByIds(e).then(e=>{t(e.data||[])}).catch(e=>{a(e)})});let ne={};const ie=()=>{S.value={assignee:"",candidateUsers:"",candidateGroups:"",dueDate:"",followUpDate:"",priority:"",sendMessageType:""},r.value=[],o.value=[],ne=C.bpmnInstances.bpmnElement;let e=ne.businessObject.formKey,t=e?JSON.parse(e):void 0;p.value=t?{formId:t.formId,routerName:t.routerName,mobileRouterName:t.mobileRouterName,editable:!t.readOnly,formAuth:t.formAuth||{},groupType:t.groupType||(i.value?"USERS":"ASSIGNEE"),variableType:t.variableType}:{groupType:i.value?"USERS":"ASSIGNEE"},i.value&&"ASSIGNEE"===p.value.groupType&&(p.value.groupType="USERS",w.value=[]);for(let l in d){let e;"sendMessageType"===l&&(e=(C.bpmnInstances.bpmnElement||{}).businessObject[l]||d[l],o.value=null!=e&&""!==e?e.split(","):[]),"candidateUsers"===l||"candidateGroups"===l?(e=(C.bpmnInstances.bpmnElement||{}).businessObject[l]||d[l],"candidateGroups"===l&&e&&(r.value=e.split(","),Array.isArray(r.value)&&"DEPT"===p.value.groupType&&(r.value=r.value.map(e=>R?.get(e.toString())).filter(e=>null!=e)))):e=(C.bpmnInstances.bpmnElement||{}).businessObject[l]||d[l],S.value[l]=e}let a={widgetType:"upms_user",fieldName:"loginName",fieldValues:""};"ASSIGNEE"===p.value.groupType?a.fieldValues=S.value.assignee:"USERS"===p.value.groupType&&(a.fieldValues=S.value.candidateUsers);let n=a.fieldValues.split(",");a.fieldValues=a.fieldValues.split(",").filter(e=>-1===["${startUserName}","${appointedAssignee}","${assignee}"].indexOf(e)).join(","),le(a).then(e=>{w.value=n.map(t=>{let a=null;return a="${startUserName}"===t||"${appointedAssignee}"===t||"${assignee}"===t?{loginName:t}:(0,$.PH)(e,t,"loginName"),null!=a?(L(a),{id:a.loginName,name:a.showName}):null!=t&&""!==t?{id:t,name:t}:null}).filter(e=>null!=e)}).catch(e=>{console.log(e)});let s=q();if("POST"===p.value.groupType){const e=s.values.filter(e=>e.$type===`${l}:DeptPostList`)?.[0]||C.bpmnInstances.moddle.create(`${l}:DeptPostList`,{deptPostList:[]});r.value=e.deptPostList.map(e=>{e.deptType=e.type,e.type=void 0;let t=ee({...e});if(t)return{...e,name:t.deptName?`${t.deptName} / ${t.postName}`:t.postName}})}if("VARIABLE"===p.value.groupType||"EXPRESSION"===p.value.groupType)if("allDeptPost"===p.value.variableType||"deptPost"===p.value.variableType){const e=s.values.filter(e=>e.$type===`${l}:DeptPostList`)?.[0];e&&(A.value=e.deptPostList[0]?.deptPostId)}else{const e=s.values.filter(e=>e.$type===`${l}:UserCandidateGroups`)?.[0];A.value=e?.value}if("API"===p.value.groupType){let e=s.values.filter(e=>e.$type===`${l}:ApiData`)?.[0]||window.bpmnInstances.moddle.create(`${l}:ApiData`,{data:null});x.value=e.data}},se=()=>{if(null==p.value)return;let e=JSON.stringify({formId:a().value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM?p.value.formId:void 0,routerName:a().value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM?void 0:p.value.routerName,mobileRouterName:a().value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM?void 0:p.value.mobileRouterName,readOnly:!p.value.editable,groupType:p.value.groupType||"ASSIGNEE",formAuth:p.value.formAuth,variableType:p.value.variableType||void 0});C.bpmnInstances.modeling.updateProperties(C.bpmnInstances.bpmnElement,{formKey:e})},re=e=>{w.value=[],S.value.assignee=void 0,S.value.candidateUsers=void 0,r.value=[],S.value.candidateGroups="",p.value.variableType=void 0,A.value=void 0,se(),H()},oe=(e,t)=>{let a=q(),n=a.values.filter(e=>e.$type!==`${l}:UserCandidateGroups`),i=C.bpmnInstances.moddle.create(`${l}:UserCandidateGroups`,{type:e,value:t});"POST"!==e&&null!=t&&""!==t&&n.push(i);const s=C.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:n});C.bpmnInstances.modeling.updateProperties(C.bpmnInstances.bpmnElement,{extensionElements:s})},ue=e=>{let t=Object.create(null);if("candidateUsers"===e||"candidateGroups"===e){t[e]=S.value[e]||null;let a="candidateUsers"===e?"USERS":p.value.groupType;oe(a,t[e])}else t[e]="sendMessageType"===e?o.value.join(","):S.value[e]||null;i.value&&(t.assignee="${assignee}"),C.bpmnInstances.modeling.updateProperties(C.bpmnInstances.bpmnElement,t)};return(0,g.xo)(()=>{R=null,E=null,_=null}),(0,g.wB)(()=>t.id,()=>{i.value=null!=C.bpmnInstances.bpmnElement?.businessObject?.loopCharacteristics;const e=C.bpmnInstances.modeler.get("elementRegistry"),a=e.getAll().filter(e=>"bpmn:UserTask"===e.type&&null==e.businessObject.loopCharacteristics&&e.businessObject.id!==t.id);u.value=a.map(e=>{const t=e.businessObject;return{id:t.id,name:t.name}}),null==y.value?B().then(()=>{let e=[z(),X(),M()];return Promise.all(e)}).then(()=>{(0,g.dY)(()=>ie())}).catch(()=>{y.value=void 0}):(0,g.dY)(()=>ie())},{immediate:!0}),(0,g.wB)(()=>i.value,e=>{e&&"ASSIGNEE"===p.value.groupType&&(p.value.groupType="USERS",w.value=[])}),(0,g.wB)(()=>S.value.assignee,()=>{console.log("userTaskForm.assignee changed"),ue("assignee")}),(0,g.wB)(()=>S.value.candidateUsers,()=>{console.log("userTaskForm.candidateUsers changed"),ue("candidateUsers")}),(0,g.wB)(()=>S.value.candidateGroups,()=>{console.log("userTaskForm.candidateGroups changed"),ue("candidateGroups")}),(0,g.wB)(w,()=>{let e=(w.value||[]).map(e=>e.id),t={...V.getUserShowNameData};V.setUserShowNameData(t),"ASSIGNEE"===p.value.groupType?S.value.assignee=e.join(","):"USERS"===p.value.groupType&&(S.value.candidateUsers=e.join(","))},{deep:!0}),(0,g.wB)(r,()=>{"ROLE"===p.value.groupType?S.value.candidateGroups=Array.isArray(r.value)?r.value.join(","):"":"POST"===p.value.groupType?(S.value.candidateGroups=Array.isArray(r.value)?r.value.map(e=>e.id).join(","):"",H()):S.value.candidateGroups=Array.isArray(r.value)?r.value.map(e=>e.id).join(","):""}),(e,t)=>{const a=b.ll,l=b.MQ,o=s.xE,d=c.P9,f=c.EL,R=c.AV,F=v.S2,T=m.WK;return(0,g.uX)(),(0,g.CE)("div",null,[(0,g.bF)(o,{label:"候选类型"},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(p).groupType,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(p).groupType=e),onChange:re},{default:(0,g.k6)(()=>[(0,g.bF)(a,{value:"ASSIGNEE",disabled:(0,k.R1)(i)},{default:(0,g.k6)(()=>t[9]||(t[9]=[(0,g.eW)(" 处理用户 ")])),_:1,__:[9]},8,["disabled"]),(0,g.bF)(a,{value:"USERS"},{default:(0,g.k6)(()=>t[10]||(t[10]=[(0,g.eW)("候选用户组")])),_:1,__:[10]}),(0,g.bF)(a,{value:"ROLE"},{default:(0,g.k6)(()=>t[11]||(t[11]=[(0,g.eW)("指定角色")])),_:1,__:[11]}),(0,g.bF)(a,{value:"DEPT"},{default:(0,g.k6)(()=>t[12]||(t[12]=[(0,g.eW)("指定部门")])),_:1,__:[12]}),(0,g.bF)(a,{value:"POST"},{default:(0,g.k6)(()=>t[13]||(t[13]=[(0,g.eW)("指定岗位")])),_:1,__:[13]}),(0,g.bF)(a,{value:"VARIABLE"},{default:(0,g.k6)(()=>t[14]||(t[14]=[(0,g.eW)("流程变量")])),_:1,__:[14]}),(0,g.bF)(a,{value:"EXPRESSION"},{default:(0,g.k6)(()=>t[15]||(t[15]=[(0,g.eW)("变量表达式")])),_:1,__:[15]}),(0,g.bF)(a,{value:"API"},{default:(0,g.k6)(()=>t[16]||(t[16]=[(0,g.eW)("接口服务")])),_:1,__:[16]}),(0,g.bF)(a,{value:"OTHER_TASK_SUBMITTER",disabled:(0,k.R1)(i)},{default:(0,g.k6)(()=>t[17]||(t[17]=[(0,g.eW)("流程环节")])),_:1,__:[17]},8,["disabled"]),(0,g.bF)(a,{value:"DEPT_POST_LEADER"},{default:(0,g.k6)(()=>t[18]||(t[18]=[(0,g.eW)("发起人领导")])),_:1,__:[18]}),(0,g.bF)(a,{value:"UP_DEPT_POST_LEADER"},{default:(0,g.k6)(()=>t[19]||(t[19]=[(0,g.eW)("发起人上级领导")])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1}),"OTHER_TASK_SUBMITTER"===(0,k.R1)(p).groupType?((0,g.uX)(),(0,g.Wv)(o,{key:0,label:"设置审批人为审批流程中某个环节的审批人"},{default:(0,g.k6)(()=>[(0,g.bF)(R,{modelValue:(0,k.R1)(S).assignee,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(S).assignee=e),placeholder:"请选择"},{default:(0,g.k6)(()=>[(0,g.bF)(f,{label:"流程环节不支持选择会签任务"},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u),e=>((0,g.uX)(),(0,g.Wv)(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"ASSIGNEE"===(0,k.R1)(p).groupType?((0,g.uX)(),(0,g.Wv)(o,{key:1,label:""},{default:(0,g.k6)(()=>[(0,g.bF)(Oe,{value:(0,k.R1)(w),"onUpdate:value":t[2]||(t[2]=e=>(0,k.i9)(w)?w.value=e:null),style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(F,{icon:(0,k.R1)(I.Plus),size:(0,k.R1)(n).defaultFormItemSize,onClick:P},{default:(0,g.k6)(()=>t[20]||(t[20]=[(0,g.eW)("添加处理用户")])),_:1,__:[20]},8,["icon","size"])]),_:1},8,["value"])]),_:1})):(0,g.Q3)("",!0),"USERS"===(0,k.R1)(p).groupType?((0,g.uX)(),(0,g.Wv)(o,{key:2,label:""},{default:(0,g.k6)(()=>[(0,g.bF)(Oe,{value:(0,k.R1)(w),"onUpdate:value":t[3]||(t[3]=e=>(0,k.i9)(w)?w.value=e:null),style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(F,{icon:(0,k.R1)(I.Plus),size:(0,k.R1)(n).defaultFormItemSize,onClick:O},{default:(0,g.k6)(()=>t[21]||(t[21]=[(0,g.eW)("添加候选用户")])),_:1,__:[21]},8,["icon","size"])]),_:1},8,["value"])]),_:1})):(0,g.Q3)("",!0),"ROLE"===(0,k.R1)(p).groupType?((0,g.uX)(),(0,g.Wv)(o,{key:3,label:"候选角色"},{default:(0,g.k6)(()=>[(0,g.bF)(R,{modelValue:(0,k.R1)(r),"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.i9)(r)?r.value=e:null),placeholder:"",multiple:!0,onChange:ae},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(y),e=>((0,g.uX)(),(0,g.Wv)(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"DEPT"==(0,k.R1)(p).groupType||"POST"==(0,k.R1)(p).groupType?((0,g.uX)(),(0,g.Wv)(o,{key:4,label:""},{default:(0,g.k6)(()=>[(0,g.bF)(Oe,{value:(0,k.R1)(r),"onUpdate:value":t[5]||(t[5]=e=>(0,k.i9)(r)?r.value=e:null),style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(F,{icon:(0,k.R1)(I.Plus),size:(0,k.R1)(n).defaultFormItemSize,onClick:te},{default:(0,g.k6)(()=>[(0,g.eW)("添加"+(0,h.v_)("DEPT"===(0,k.R1)(p).groupType?"候选部门":"候选岗位"),1)]),_:1},8,["icon","size"])]),_:1},8,["value"])]),_:1})):(0,g.Q3)("",!0),"VARIABLE"===(0,k.R1)(p).groupType||"EXPRESSION"===(0,k.R1)(p).groupType?((0,g.uX)(),(0,g.Wv)(o,{key:5,label:"VARIABLE"===(0,k.R1)(p).groupType?"流程变量":"变量表达式"},{default:(0,g.k6)(()=>[(0,g.bF)(T,{placeholder:"VARIABLE"===(0,k.R1)(p).groupType?"流程变量用 $ 表示，如 ${deptld}":"请输入 EL 表达式，如：${myBean.getDept(deptId)}",modelValue:(0,k.R1)(A),"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.i9)(A)?A.value=e:null),class:"input-with-select",onChange:Z},{prepend:(0,g.k6)(()=>[(0,g.bF)(R,{modelValue:(0,k.R1)(p).variableType,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,k.R1)(p).variableType=e),placeholder:"请选择",onChange:Z,style:{width:"100px"}},{default:(0,g.k6)(()=>[(0,g.bF)(d,{label:"用户组",value:"USERS"}),(0,g.bF)(d,{label:"部门",value:"DEPT"}),(0,g.bF)(d,{label:"岗位",value:"allDeptPost"}),(0,g.bF)(d,{label:"部门岗位",value:"deptPost"}),(0,g.bF)(d,{label:"角色",value:"ROLE"})]),_:1},8,["modelValue"])]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"])):(0,g.Q3)("",!0),"API"===(0,k.R1)(p).groupType?((0,g.uX)(),(0,g.Wv)(tt,{key:6,modelValue:(0,k.R1)(x),"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.i9)(x)?x.value=e:null),onChange:Q},null,8,["modelValue"])):(0,g.Q3)("",!0)])}}});const nt=(0,_e.A)(lt,[["__scopeId","data-v-47e755ee"]]);var it=nt;const st={style:{"margin-top":"16px"}};var rt=(0,g.pM)({__name:"ScriptTask",props:{id:{},type:{}},setup(e){const t=e,a=(0,k.KR)({scriptFormat:"",script:"",resource:"",resultVariable:""}),l=(0,k.KR)({});let n=null;const i=window,r=()=>{for(let e in a.value){let t=n?.businessObject[e]||a.value[e];l.value[e]=t}l.value.scriptType=l.value.script?"inline":"external"},o=()=>{let e=Object.create(null);e.scriptFormat=l.value.scriptFormat||null,e.resultVariable=l.value.resultVariable||null,"inline"===l.value.scriptType?(e.script=l.value.script||null,e.resource=null):(e.resource=l.value.resource||null,e.script=null),i?.bpmnInstances.modeling.updateProperties(n,e)};return(0,g.wB)(()=>t.id,()=>{n=i?.bpmnInstances?.bpmnElement,(0,g.dY)(()=>{r()})},{immediate:!0}),(0,g.xo)(()=>{n=null}),(e,t)=>{const a=m.WK,n=s.xE,i=c.P9,r=c.AV;return(0,g.uX)(),(0,g.CE)("div",st,[(0,g.bF)(n,{label:"脚本格式"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{modelValue:(0,k.R1)(l).scriptFormat,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(l).scriptFormat=e),clearable:"",onInput:t[1]||(t[1]=e=>o()),onChange:t[2]||(t[2]=e=>o())},null,8,["modelValue"])]),_:1}),(0,g.bF)(n,{label:"脚本类型"},{default:(0,g.k6)(()=>[(0,g.bF)(r,{modelValue:(0,k.R1)(l).scriptType,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(l).scriptType=e)},{default:(0,g.k6)(()=>[(0,g.bF)(i,{label:"内联脚本",value:"inline"}),(0,g.bF)(i,{label:"外部资源",value:"external"})]),_:1},8,["modelValue"])]),_:1}),(0,g.bo)((0,g.bF)(n,{label:"脚本"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{modelValue:(0,k.R1)(l).script,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(l).script=e),type:"textarea",resize:"vertical",autosize:{minRows:2,maxRows:4},clearable:"",onInput:t[5]||(t[5]=e=>o()),onChange:t[6]||(t[6]=e=>o())},null,8,["modelValue"])]),_:1},512),[[R.aG,"inline"===(0,k.R1)(l).scriptType]]),(0,g.bo)((0,g.bF)(n,{label:"资源地址"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{modelValue:(0,k.R1)(l).resource,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(l).resource=e),clearable:"",onInput:t[8]||(t[8]=e=>o()),onChange:t[9]||(t[9]=e=>o())},null,8,["modelValue"])]),_:1},512),[[R.aG,"external"===(0,k.R1)(l).scriptType]]),(0,g.bF)(n,{label:"结果变量"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{modelValue:(0,k.R1)(l).resultVariable,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,k.R1)(l).resultVariable=e),clearable:"",onInput:t[11]||(t[11]=e=>o()),onChange:t[12]||(t[12]=e=>o())},null,8,["modelValue"])]),_:1})])}}});const ot=rt;var ut=ot;const dt={style:{"margin-top":"16px"}},pt={style:{display:"flex","justify-content":"space-between","align-items":"center","flex-wrap":"nowrap"}},mt={slot:"footer"};var ct=(0,g.pM)({__name:"ReceiveTask",props:{id:{},type:{}},setup(e){const t=e,a=(0,k.KR)(""),l=(0,k.KR)({}),n=(0,k.KR)({}),i=(0,k.KR)(!1),r=(0,K.l5)();let o=null,u={};const d=(0,k.KR)([]),p=window,b=()=>{o=p?.bpmnInstances?.bpmnElement,a.value=o?.businessObject?.messageRef?.id||"-1"},y=()=>{i.value=!0,l.value={}},f=()=>{if(n.value[l.value.id])return void _.nk.error("该消息已存在，请修改id后重新保存");const e=p?.bpmnInstances?.moddle?.create("bpmn:Message",l.value);d.value.push(e),n.value[l.value.id]=l.value.name,u[l.value.id]=e,i.value=!1},h=e=>{p?.bpmnInstances?.modeling?.updateProperties(o,"-1"===e?{messageRef:null}:{messageRef:u[e]})};return(0,g.wB)(()=>t.id,()=>{o=p?.bpmnInstances?.bpmnElement,(0,g.dY)(()=>{b()})},{immediate:!0}),(0,g.sV)(()=>{u={},d.value=p?.bpmnInstances?.modeler?.getDefinitions().rootElements,d.value.filter(e=>"bpmn:Message"===e.$type).forEach(e=>{u[e.id]=e,n.value[e.id]=e.name}),n.value["-1"]="无"}),(0,g.xo)(()=>{o=null}),(e,t)=>{const o=c.P9,u=c.AV,d=v.S2,p=s.xE,b=m.WK,F=s.US,T=Q.kZ;return(0,g.uX)(),(0,g.CE)("div",dt,[(0,g.bF)(p,{label:"消息实例"},{default:(0,g.k6)(()=>[(0,g.Lk)("div",pt,[(0,g.bF)(u,{modelValue:(0,k.R1)(a),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.i9)(a)?a.value=e:null),onChange:h},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(Object.keys((0,k.R1)(n)),e=>((0,g.uX)(),(0,g.Wv)(o,{value:e,label:(0,k.R1)(n)[e],key:e},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),(0,g.bF)(d,{size:(0,k.R1)(r).defaultFormItemSize,type:"primary",icon:(0,k.R1)(I.Plus),style:{"margin-left":"8px"},onClick:y},null,8,["size","icon"])])]),_:1}),(0,g.bF)(T,{visible:(0,k.R1)(i),"close-on-click-modal":!1,title:"创建新消息",width:"400px","append-to-body":"","destroy-on-close":""},{default:(0,g.k6)(()=>[(0,g.bF)(F,{model:(0,k.R1)(l),size:(0,k.R1)(r).defaultFormItemSize,"label-width":"90px",onSubmit:t[3]||(t[3]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(p,{label:"消息ID"},{default:(0,g.k6)(()=>[(0,g.bF)(b,{modelValue:(0,k.R1)(l).id,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(l).id=e),clearable:""},null,8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"消息名称"},{default:(0,g.k6)(()=>[(0,g.bF)(b,{modelValue:(0,k.R1)(l).name,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(l).name=e),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","size"]),(0,g.Lk)("template",mt,[(0,g.bF)(d,{size:(0,k.R1)(r).defaultFormItemSize,type:"primary",onClick:f},{default:(0,g.k6)(()=>t[4]||(t[4]=[(0,g.eW)("确 认")])),_:1,__:[4]},8,["size"])])]),_:1},8,["visible"])])}}});const bt=ct;var yt=bt;const vt={class:"element-task"};var ft=(0,g.pM)({__name:"ElementTask",props:{id:{},type:{},isCountersign:{type:Boolean}},setup(e){const t=e,a=(0,K.l5)(),l=(0,k.KR)({asyncAfter:!1,asyncBefore:!1,exclusive:!1}),n=(0,k.KR)(),i={SubProcess:(0,k.IG)(it),UserTask:(0,k.IG)(it),ScriptTask:(0,k.IG)(ut),ReceiveTask:(0,k.IG)(yt)},r=window;return(0,g.wB)(()=>t.id,()=>{const e=r.bpmnInstances.bpmnElement;l.value.asyncBefore=e?.businessObject?.asyncBefore,l.value.asyncAfter=e?.businessObject?.asyncAfter,l.value.exclusive=e?.businessObject?.exclusive},{immediate:!0}),(0,g.wB)(()=>t.type,()=>{n.value=i[t.type]},{immediate:!0}),(e,t)=>{const l=s.US;return(0,g.uX)(),(0,g.CE)("div",vt,[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,onSubmit:t[0]||(t[0]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[((0,g.uX)(),(0,g.Wv)((0,g.$y)((0,k.R1)(n)),(0,h._B)((0,g.Ng)(e.$props)),null,16))]),_:1},8,["size"])])}}});const gt=ft;var kt=gt,ht=a(2403);a(63266);const Rt={class:"expression-editor"},Ft={class:"expression-con"},Tt={class:"template-edit-box"},Et={class:"template-item"},_t={class:"template-item"},St=["onClick"],It={class:"expression-toolbar"},wt={class:"expression-form"},At={class:"expression-form-row"},xt={class:"expression-form-inline"},Vt=["onClick"];var Ct=(0,g.pM)({name:"MessageTemplateEditor",__name:"index",props:{modelValue:{default:""},options:{default:()=>({})}},emits:["change","update:modelValue"],setup(e,{emit:t}){const a=e,l=t,n=(0,k.KR)([]),i=(0,k.KR)(0),s=(0,k.KR)(void 0),r=(0,k.KR)(void 0),o=(0,k.KR)(!1),u=(0,g.EW)(()=>a.options?.variableList||[]),d=((0,g.EW)(()=>a.options?.operatorList),(0,g.EW)(()=>a.options?.numberList),(0,g.EW)(()=>n.value[i.value-1])),p=(0,k.KR)(null),m=(0,k.KR)(null),c=e=>{if(null==e||""===e)return[];let t=[];try{t=JSON.parse(e)}catch(a){console.error("parse error",a)}if(Array.isArray(t)){let e=(new Date).getTime();t.forEach(t=>{t.id=e++})}return t},b=e=>Array.isArray(e)&&e.length>0?JSON.stringify(e):"",y=()=>{0!==i.value&&null!=d.value&&((d.value.itemKind===N.FormulaItemKind.NUMBER||d.value.itemKind===N.FormulaItemKind.STRING)&&d.value.itemName.length>1?d.value.itemName=d.value.itemName.slice(0,d.value.itemName.length-1):(n.value.splice(i.value-1,1),i.value=i.value-1,w()))},f=()=>{n.value=[],i.value=0,w()},F=e=>{null!=e&&(n.value.splice(i.value,0,e),i.value=i.value+1,w())},T=e=>{if(null!=e)if(e={...e},null!=d.value){if(d.value.itemKind===N.FormulaItemKind.NUMBER){if(e.itemKind===N.FormulaItemKind.NUMBER||e.itemKind===N.FormulaItemKind.STRING)return d.value.itemName+=e.itemCode,e.itemKind===N.FormulaItemKind.STRING&&(d.value.itemKind=N.FormulaItemKind.STRING),void w()}else if(d.value.itemKind===N.FormulaItemKind.STRING&&(e.itemKind===N.FormulaItemKind.NUMBER||e.itemKind===N.FormulaItemKind.STRING))return d.value.itemName+=e.itemCode,void w();F(e)}else F(e)},E=e=>{i.value=e+1},_=()=>{let e;e=null!=a.options?.stringify?a.options?.stringify(n.value):b(n.value),s.value=e,l("update:modelValue",e),l("change",e)},S=()=>{w()},w=()=>{setTimeout(()=>{0===i.value?p.value.focus():m.value[m.value.length-1].focus(),o.value=!0},50)},A=e=>{console.log(e,i.value,p.value,m.value),0===i.value?o.value=e.target===p.value:null==m.value?o.value=!1:o.value=e.target===m.value[m.value.length-1]},x=e=>{if(r.value){const e={itemName:r.value,itemCode:r.value,itemKind:N.FormulaItemKind.STRING};r.value=void 0,T(e)}},V=e=>{8===e.keyCode&&(y(),w())},C=e=>e.itemKind===N.FormulaItemKind.STRING?{marginRight:0}:null;return(0,g.wB)(()=>a.modelValue,e=>{s.value!==e&&(null!=a.options?.parse?n.value=a.options.parse(e):n.value=c(e),i.value=n.value.length)},{immediate:!0}),(0,g.wB)(()=>n.value,()=>{_()},{deep:!0,immediate:!0}),(0,g.sV)(()=>{w()}),(e,t)=>{const a=ht.kA,l=v.S2;return(0,g.uX)(),(0,g.CE)("div",Rt,[(0,g.Lk)("div",{class:"expression-box",onClick:S},[(0,g.Lk)("div",Ft,[t[5]||(t[5]=(0,g.Lk)("div",{style:{display:"inline"}},[(0,g.Lk)("span",{class:"expression-filed"},"消息模版"),(0,g.Lk)("span",{class:"expression-filed"},"=")],-1)),(0,g.bF)(a,{style:{"flex-grow":"1",width:"100px"}},{default:(0,g.k6)(()=>[(0,g.Lk)("div",Tt,[(0,g.Lk)("div",Et,[(0,g.Lk)("span",{class:"expression-filed",onClick:t[0]||(t[0]=e=>E(-1))})]),(0,g.Lk)("div",_t,[0===(0,k.R1)(i)?(0,g.bo)(((0,g.uX)(),(0,g.CE)("input",{key:0,style:{border:"none",width:"3px"},ref_key:"inputRef0",ref:p,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.i9)(r)?r.value=e:null),onInput:x,onBlur:A},null,544)),[[R.Jo,(0,k.R1)(r)]]):(0,g.Q3)("",!0)]),((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(n),(e,a)=>((0,g.uX)(),(0,g.CE)("div",{class:"template-item",key:e.itemName+"_"+a,style:(0,h.Tr)(C(e))},[(0,g.Lk)("span",{style:(0,h.Tr)({"background-color":e.itemKind==(0,k.R1)(N.FormulaItemKind).VARABLE?"#eee":"",padding:e.itemKind==(0,k.R1)(N.FormulaItemKind).VARABLE?"2px 8px":"2px 0"}),class:(0,h.C4)(["expression-filed",{"expression-fild-string":e.itemKind==(0,k.R1)(N.FormulaItemKind).STRING}]),onClick:e=>E(a)},(0,h.v_)(e.itemName),15,St),(0,k.R1)(i)===a+1?(0,g.bo)(((0,g.uX)(),(0,g.CE)("input",{key:0,style:{border:"none",width:"3px"},ref_for:!0,ref_key:"inputRef1",ref:m,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.i9)(r)?r.value=e:null),onInput:x,onBlur:A,onKeydown:(0,R.D$)(V,["stop"])},null,544)),[[R.Jo,(0,k.R1)(r)]]):(0,g.Q3)("",!0)],4))),128))])]),_:1})]),(0,g.Lk)("div",It,[(0,g.bF)(l,{link:"",icon:(0,k.R1)(I.Back),onClick:t[3]||(t[3]=e=>y())},null,8,["icon"]),(0,g.bF)(l,{link:"",icon:(0,k.R1)(I.Delete),onClick:t[4]||(t[4]=e=>f())},null,8,["icon"])])]),t[7]||(t[7]=(0,g.Lk)("div",{class:"expression-tips"},"可以从下方变量列表中选择需要的内容填入模版中",-1)),(0,g.Lk)("div",wt,[(0,g.Lk)("div",At,[t[6]||(t[6]=(0,g.Lk)("div",{class:"expression-form-label"},"变量：",-1)),(0,g.Lk)("div",xt,[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u),(e,t)=>((0,g.uX)(),(0,g.CE)("span",{key:t,class:"expression-form-value",onClick:t=>T(e)},(0,h.v_)(e.itemName),9,Vt))),128))])])])])}}});const Lt=(0,_e.A)(Ct,[["__scopeId","data-v-47741228"]]);var Dt=Lt;const Nt={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}};var Pt=(0,g.pM)({name:"EditMessageTemplate",__name:"editMessageTemplate",props:{data:{},flowVariableList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,K.l5)(),a=e,{thirdParams:l,onCloseThirdDialog:n}=(0,z.P)(a),i=(0,k.KR)(),r=(0,k.KR)({templateConfig:""}),o={templateConfig:[{required:!0,message:"请输入模版内容",trigger:"blur"}]},u=(0,g.EW)(()=>({data:a.data||l.value.data||"",flowVariableList:a.flowVariableList||l.value.flowVariableList||[]})),d=(0,g.EW)(()=>{const e=[];for(const t of u.value.flowVariableList)e.push({itemName:t.name,itemCode:t.id,itemKind:N.FormulaItemKind.VARABLE});return e}),p=(0,g.EW)(()=>({variableList:d.value})),m=()=>{a.dialog?a.dialog.cancel():n()},c=()=>{i.value.validate(e=>{if(!e)return;const t=r.value.templateConfig;let l,i=[];null!=t&&""!==t&&(i=JSON.parse(t)),Array.isArray(i)&&i.length>0&&(l=i.reduce((e,t)=>{let a="";return t.itemKind===N.FormulaItemKind.STRING?a=t.itemName:t.itemKind===N.FormulaItemKind.VARABLE&&(a="${"+t.itemCode+"}"),""!==a&&""!==e&&(e+=" "),e+a},"")),a.dialog?a.dialog.submit({templateConfig:r.value.templateConfig,message:l}):n(!0,u.value.data,{templateConfig:r.value.templateConfig,message:l})})};return(0,g.sV)(()=>{u.value.data&&(r.value={templateConfig:u.value.data})}),(e,a)=>{const l=s.xE,n=ht.kA,u=s.US,d=v.S2,b=y.S2;return(0,g.uX)(),(0,g.CE)("div",Nt,[(0,g.bF)(u,{ref_key:"form",ref:i,model:(0,k.R1)(r),class:"full-width-input form-box",rules:o,style:{width:"100%"},"label-width":"100px",size:(0,k.R1)(t).defaultFormItemSize,"label-position":"top",onSubmit:a[1]||(a[1]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(n,null,{default:(0,g.k6)(()=>[(0,g.bF)(l,{label:"","label-width":"0px"},{default:(0,g.k6)(()=>[(0,g.bF)(Dt,{modelValue:(0,k.R1)(r).templateConfig,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,k.R1)(r).templateConfig=e),options:(0,k.R1)(p)},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,g.bF)(b,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,g.k6)(()=>[(0,g.bF)(d,{size:(0,k.R1)(t).defaultFormItemSize,plain:!0,onClick:a[2]||(a[2]=e=>m())},{default:(0,g.k6)(()=>a[4]||(a[4]=[(0,g.eW)(" 取消 ")])),_:1,__:[4]},8,["size"]),(0,g.bF)(d,{type:"primary",size:(0,k.R1)(t).defaultFormItemSize,onClick:a[3]||(a[3]=e=>c())},{default:(0,g.k6)(()=>a[5]||(a[5]=[(0,g.eW)(" 保存 ")])),_:1,__:[5]},8,["size"])]),_:1})])}}});const Wt=Pt;var Ot=Wt;const Bt={class:"panel-tab__content",style:{"padding-top":"0"}},Ut={key:1},zt={style:{padding:"16px 20px"}};var Kt=(0,g.pM)({__name:"ElementMultiInstance",props:{businessObject:{},type:{},templateVariableList:{}},emits:["isCountersignChange"],setup(e,{emit:t}){const a=e,l=(0,K.l5)(),n=(0,g.WQ)("prefix"),i=window,r=(0,k.KR)(!0),u=(0,k.KR)(!1),d=(0,k.KR)("ParallelMultiInstance"),p=(0,k.KR)([]),f=(0,k.KR)(),h=(0,k.KR)(),E=(0,k.KR)(),_=(0,k.KR)(),S=(0,k.KR)(),w=(0,k.KR)(),A=(0,k.KR)("autoComplete"),x=(0,k.KR)(),V=(0,k.KR)(),C={completionCondition:"",loopCardinality:"",extensionElements:[],asyncAfter:!1,asyncBefore:!1,exclusive:!1},L=(0,k.KR)({collection:"assigneeList",elementVariable:"assignee",completionCondition:"${nrOfInstances == nrOfCompletedInstances}"}),D=[{name:"assigneeList",desc:"多实例用户集合变量"},{name:"nrOfInstances",desc:"实例总数"},{name:"nrOfActiveInstances",desc:"当前活动的（即未完成的），实例数量。对于顺序多实例，这个值总为1"},{name:"nrOfCompletedInstances",desc:"已完成的实例数量"},{name:"multiNumOfInstances",desc:"实例总数（多实例节点后使用这个变量判断）"},{name:"multiAgreeCount",desc:"同意实例数量"},{name:"multiRefuseCount",desc:"拒绝实例数量"},{name:"multiAbstainCount",desc:"弃权实例数量"}];let N={},P={};const W=(e,t)=>{let a={widgetType:"upms_user",fieldName:"loginName",fieldValues:e};ze.If.viewByIds(a).then(e=>{console.log(e),Array.isArray(e.data)&&e.data.length>0?t&&t(e.data[0].showName||e.data[0].loginName):t&&t(void 0)}).catch(e=>{console.log(e)})},O=e=>{U.l.show("选择用户",Le["default"],{area:["1000px","650px"]},{multiple:!1,showAssignee:!1,path:"thirdTaskUserSelect"},{width:"1000px",height:"650px",pathName:"/thirdParty/thirdTaskUserSelect"}).then(t=>{console.log("onSelectAssignee >>>",t),e(t)}).catch(e=>{console.error(e)})},B=e=>{let t=(i.bpmnInstances.bpmnElement||{}).businessObject.get("extensionElements")||window.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});const a=t.values.filter(e=>e.$type===`${n}:Message`)?.[0];if(a){let e=a.sendMessageType;p.value=null!=e&&""!==e?e.split(","):[],f.value=a.notifyMessage,h.value=a.templateConfig}if(E.value=(i.bpmnInstances.bpmnElement||{}).businessObject?.timeoutHandleWay,_.value=(i.bpmnInstances.bpmnElement||{}).businessObject?.timeoutHours,S.value=(i.bpmnInstances.bpmnElement||{}).businessObject?.defaultAssignee,A.value=(i.bpmnInstances.bpmnElement||{}).businessObject.emptyUserHandleWay||"autoComplete",x.value=(i.bpmnInstances.bpmnElement||{}).businessObject.emptyUserToAssignee,te("isCountersignChange",!!e.loopCharacteristics),!e.loopCharacteristics)return d.value="Null",L.value={},void(r.value=!1);if("bpmn:StandardLoopCharacteristics"===e.loopCharacteristics.$type)return d.value="StandardLoop",void(L.value={});if(e.loopCharacteristics.isSequential?d.value="SequentialMultiInstance":d.value="ParallelMultiInstance",L.value={...C,...e.loopCharacteristics,completionCondition:e.loopCharacteristics?.completionCondition?.body??"${nrOfInstances == nrOfCompletedInstances}",loopCardinality:e.loopCharacteristics?.loopCardinality?.body??""},P=i.bpmnInstances.bpmnElement.businessObject.loopCharacteristics,e.loopCharacteristics.extensionElements&&e.loopCharacteristics.extensionElements.values&&e.loopCharacteristics.extensionElements.values.length){const t={...L.value};t.timeCycle=e.loopCharacteristics.extensionElements.values[0].body,L.value=t}},z=e=>{if("SequentialMultiInstance"!==e&&""!==L.value.completionCondition||(L.value.completionCondition="${nrOfInstances == nrOfCompletedInstances}",M(L.value.completionCondition)),"Null"!==e){if("StandardLoop"===e){const e=i.bpmnInstances.moddle.create("bpmn:StandardLoopCharacteristics");return i.bpmnInstances.modeling.updateProperties(N,{loopCharacteristics:e}),void(P=null)}P="SequentialMultiInstance"===e?i.bpmnInstances.moddle.create("bpmn:MultiInstanceLoopCharacteristics",{isSequential:!0}):i.bpmnInstances.moddle.create("bpmn:MultiInstanceLoopCharacteristics"),i.bpmnInstances.modeling.updateProperties(N,{loopCharacteristics:P}),q(),M(L.value.completionCondition)}else i.bpmnInstances.modeling.updateProperties(N,{loopCharacteristics:null})},M=e=>{let t=null;e&&e.length&&(t=i.bpmnInstances.moddle.create("bpmn:FormalExpression",{body:e})),i.bpmnInstances.modeling.updateModdleProperties(N,P,{completionCondition:t})},X=e=>{const t=i.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[i.bpmnInstances.moddle.create(`${n}:FailedJobRetryTimeCycle`,{body:e})]});i.bpmnInstances.modeling.updateModdleProperties(N,P,{extensionElements:t})},q=()=>{i.bpmnInstances.modeling.updateModdleProperties(N,P,{collection:L.value.collection||null,elementVariable:L.value.elementVariable||null})},$=e=>{e?(d.value="ParallelMultiInstance",L.value={collection:"assigneeList",elementVariable:"assignee"},z("ParallelMultiInstance"),L.value.completionCondition="${nrOfInstances == nrOfCompletedInstances}",M(L.value.completionCondition)):(d.value="Null",L.value={},z("Null"),i.bpmnInstances.modeling.updateProperties(i.bpmnInstances.bpmnElement,{assignee:void 0}))},G=()=>{const e=i.bpmnInstances.bpmnElement.businessObject.get("extensionElements")||i.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]}),t=e.values.filter(e=>e.$type!==`${n}:Message`);let a=Object.create(null);a.sendMessageType=p.value.join(","),a.notifyMessage=f.value,a.templateConfig=h.value;const l=i.bpmnInstances.moddle.create(`${n}:Message`,a),s=i.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t.concat(l)});i.bpmnInstances.modeling.updateProperties(i.bpmnInstances.bpmnElement,{extensionElements:s})},j=()=>{G()},J=()=>{G()},H=()=>{console.log("onEditMessageTemplate"),U.l.show("编辑消息模版",Ot,{area:["1000px","710px"]},{data:h.value,flowVariableList:a.templateVariableList}).then(e=>{console.log("模版编辑完成",e),h.value=e.templateConfig,f.value=e.message,J()}).catch(e=>{console.error(e)})},Y=()=>{let e=Object.create(null);E.value?null==_.value&&(_.value=24):(E.value=void 0,_.value=void 0),"autoComplete"!==E.value&&(S.value=void 0),e.timeoutHandleWay=E.value,e.timeoutHours=_.value,e.defaultAssignee=S.value,i.bpmnInstances.modeling.updateProperties(i.bpmnInstances.bpmnElement,e),console.log("ElementMultiInstance onTimeoutChange",i.bpmnInstances.bpmnElement,e)},Z=e=>{e&&(S.value=e.loginName,w.value=e.showName),Y()},ee=e=>{e&&(x.value=e.loginName,V.value=e.showName);let t=Object.create(null);"toAssignee"!==A.value&&(x.value=void 0),t.emptyUserHandleWay=A.value,t.emptyUserToAssignee=x.value,i.bpmnInstances.modeling.updateProperties(i.bpmnInstances.bpmnElement,t),console.log("ElementMultiInstance onEmptyUserChange",i.bpmnInstances.bpmnElement,t)};(0,g.xo)(()=>{P=null,N=null});const te=t;return(0,g.wB)(()=>a.type,()=>{a.businessObject&&B(a.businessObject)}),(0,g.wB)(()=>a.businessObject,e=>{N=i.bpmnInstances.bpmnElement,B(e)},{immediate:!0}),(0,g.wB)(r,e=>{te("isCountersignChange",e)},{immediate:!0}),(0,g.wB)(x,e=>{null==e||""===e?V.value=void 0:"${startUserName}"===e?V.value="流程发起人":"${appointedAssignee}"===e?V.value="指定审批人":null!=V.value&&""!==V.value||W(e,e=>{V.value=e})},{immediate:!0}),(0,g.wB)(S,e=>{null==e||""===e?w.value=void 0:"${startUserName}"===e?w.value="流程发起人":null!=w.value&&""!==w.value||W(e,e=>{w.value=e})},{immediate:!0}),(e,t)=>{const a=o.qi,n=s.xE,i=b.ll,h=b.MQ,S=v.S2,x=m.WK,C=c.P9,N=c.AV,P=y.S2,W=s.US,B=Q.kZ;return(0,g.uX)(),(0,g.CE)("div",Bt,[(0,g.bF)(W,{size:(0,k.R1)(l).defaultFormItemSize,onSubmit:t[15]||(t[15]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{label:"是否会签",style:{"margin-bottom":"4px"}},{label:(0,g.k6)(()=>[t[17]||(t[17]=(0,g.Lk)("span",null,"是否会签",-1)),(0,g.bF)(a,{modelValue:(0,k.R1)(r),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.i9)(r)?r.value=e:null),style:{"margin-left":"18px"},onChange:$},null,8,["modelValue"])]),_:1}),(0,k.R1)(r)?((0,g.uX)(),(0,g.Wv)(n,{key:0,label:"会签类型",style:{"margin-bottom":"4px"}},{default:(0,g.k6)(()=>[(0,g.bF)(h,{modelValue:(0,k.R1)(d),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.i9)(d)?d.value=e:null),onChange:z},{default:(0,g.k6)(()=>[(0,g.bF)(i,{value:"ParallelMultiInstance"},{default:(0,g.k6)(()=>t[18]||(t[18]=[(0,g.eW)("并行会签")])),_:1,__:[18]}),(0,g.bF)(i,{value:"SequentialMultiInstance"},{default:(0,g.k6)(()=>t[19]||(t[19]=[(0,g.eW)("串行会签")])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(r)?((0,g.uX)(),(0,g.CE)("div",Ut,[(0,g.bF)(n,{label:"内置变量",style:{"margin-bottom":"5px"}},{label:(0,g.k6)(()=>[t[21]||(t[21]=(0,g.Lk)("span",null,"内置变量",-1)),(0,g.bF)(S,{class:"variables-btn",type:"primary",onClick:t[2]||(t[2]=e=>u.value=!0),size:"default",plain:""},{default:(0,g.k6)(()=>t[20]||(t[20]=[(0,g.eW)(" 查看 ")])),_:1,__:[20]})]),_:1}),"ParallelMultiInstance"===(0,k.R1)(d)||"SequentialMultiInstance"===(0,k.R1)(d)?((0,g.uX)(),(0,g.CE)(g.FK,{key:0},[(0,g.bF)(n,{label:"完成条件",key:"completionCondition"},{default:(0,g.k6)(()=>[(0,g.bF)(x,{modelValue:(0,k.R1)(L).completionCondition,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(L).completionCondition=e),disabled:"SequentialMultiInstance"===(0,k.R1)(d),clearable:"",onChange:M},null,8,["modelValue","disabled"])]),_:1}),(0,k.R1)(L).asyncAfter||(0,k.R1)(L).asyncBefore?((0,g.uX)(),(0,g.Wv)(n,{label:"重试周期",prop:"timeCycle",key:"timeCycle"},{default:(0,g.k6)(()=>[(0,g.bF)(x,{modelValue:(0,k.R1)(L).timeCycle,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(L).timeCycle=e),clearable:"",onChange:X},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)],64)):(0,g.Q3)("",!0)])):(0,g.Q3)("",!0),"SubProcess"!==e.type?((0,g.uX)(),(0,g.Wv)(n,{key:2,label:"任务通知"},{default:(0,g.k6)(()=>[(0,g.bF)(N,{modelValue:(0,k.R1)(p),"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.i9)(p)?p.value=e:null),multiple:"",clearable:"",onChange:t[6]||(t[6]=e=>j()),placeholder:""},{default:(0,g.k6)(()=>[(0,g.bF)(C,{label:"邮件",value:"email"}),(0,g.bF)(C,{label:"飞书",value:"feishu"}),(0,g.bF)(C,{label:"钉钉",value:"dingtalk"}),(0,g.bF)(C,{label:"微信",value:"wechat"}),(0,g.bF)(C,{label:"企业微信",value:"wework"})]),_:1},8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"SubProcess"!==e.type?((0,g.uX)(),(0,g.Wv)(n,{key:3},{label:(0,g.k6)(()=>[(0,g.bF)(P,{type:"flex",justify:"space-between",align:"middle"},{default:(0,g.k6)(()=>[t[23]||(t[23]=(0,g.Lk)("span",null,"消息模版",-1)),(0,g.bF)(S,{size:"default",type:"text",onClick:H},{default:(0,g.k6)(()=>t[22]||(t[22]=[(0,g.eW)("编辑")])),_:1,__:[22]})]),_:1,__:[23]})]),default:(0,g.k6)(()=>[(0,g.bF)(x,{modelValue:(0,k.R1)(f),"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.i9)(f)?f.value=e:null),type:"textarea",placeholder:"请输入消息模版",clearable:"",rows:"4",readonly:"",onChange:J},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"SubProcess"!==e.type?((0,g.uX)(),(0,g.Wv)(n,{key:4,label:"超时设置"},{default:(0,g.k6)(()=>[(0,g.bF)(P,{type:"flex",align:"middle",style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(x,{placeholder:"超时时间设置",modelValue:(0,k.R1)(_),"onUpdate:modelValue":t[9]||(t[9]=e=>(0,k.i9)(_)?_.value=e:null),class:"input-with-select",disabled:!(0,k.R1)(E),onChange:Y},{prepend:(0,g.k6)(()=>[(0,g.bF)(N,{size:(0,k.R1)(l).defaultFormItemSize,modelValue:(0,k.R1)(E),"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.i9)(E)?E.value=e:null),onChange:Y,placeholder:"不设置"},{default:(0,g.k6)(()=>[(0,g.bF)(C,{label:"不设置",value:void 0}),(0,g.bF)(C,{label:"自动审批",value:"autoComplete"}),(0,g.bF)(C,{label:"发送通知",value:"sendMessage"})]),_:1},8,["size","modelValue"])]),_:1},8,["modelValue","disabled"]),t[24]||(t[24]=(0,g.Lk)("span",{style:{width:"40px","font-size":"14px","text-align":"right"}},"小时",-1))]),_:1,__:[24]})]),_:1})):(0,g.Q3)("",!0),"SubProcess"!==e.type&&"autoComplete"===(0,k.R1)(E)?((0,g.uX)(),(0,g.Wv)(n,{key:5,label:"超时处理人"},{default:(0,g.k6)(()=>[(0,g.bF)(x,{modelValue:(0,k.R1)(w),"onUpdate:modelValue":t[11]||(t[11]=e=>(0,k.i9)(w)?w.value=e:null),readonly:"",disabled:!(0,k.R1)(E)},{append:(0,g.k6)(()=>[(0,g.bF)(S,{icon:(0,k.R1)(I.Search),onClick:t[10]||(t[10]=e=>O(Z))},null,8,["icon"])]),_:1},8,["modelValue","disabled"])]),_:1})):(0,g.Q3)("",!0),"SubProcess"!==e.type?((0,g.uX)(),(0,g.Wv)(n,{key:6,label:"处理人为空",class:"empty-user"},{default:(0,g.k6)(()=>[(0,g.bF)(h,{modelValue:(0,k.R1)(A),"onUpdate:modelValue":t[12]||(t[12]=e=>(0,k.i9)(A)?A.value=e:null),onChange:ee},{default:(0,g.k6)(()=>[(0,g.bF)(i,{value:"autoComplete"},{default:(0,g.k6)(()=>t[25]||(t[25]=[(0,g.eW)("自动通过")])),_:1,__:[25]}),(0,g.bF)(i,{value:"autoReject"},{default:(0,g.k6)(()=>t[26]||(t[26]=[(0,g.eW)("自动拒绝")])),_:1,__:[26]}),(0,g.bF)(i,{value:"toAssignee"},{default:(0,g.k6)(()=>t[27]||(t[27]=[(0,g.eW)("指定处理人")])),_:1,__:[27]})]),_:1},8,["modelValue"]),"toAssignee"===(0,k.R1)(A)?((0,g.uX)(),(0,g.Wv)(x,{key:0,modelValue:(0,k.R1)(V),"onUpdate:modelValue":t[14]||(t[14]=e=>(0,k.i9)(V)?V.value=e:null),readonly:""},{append:(0,g.k6)(()=>[(0,g.bF)(S,{icon:(0,k.R1)(I.Search),onClick:t[13]||(t[13]=e=>O(ee))},null,8,["icon"])]),_:1},8,["modelValue"])):(0,g.Q3)("",!0)]),_:1})):(0,g.Q3)("",!0)]),_:1},8,["size"]),(0,g.bF)(B,{title:"内置变量",modelValue:(0,k.R1)(u),"onUpdate:modelValue":t[16]||(t[16]=e=>(0,k.i9)(u)?u.value=e:null),width:"800px","append-to-body":"","destroy-on-close":"",class:"panel-dialog"},{default:(0,g.k6)(()=>[(0,g.Lk)("div",zt,[(0,g.bF)((0,k.R1)(T.CP),{data:D,size:(0,k.R1)(l).defaultFormItemSize,"row-config":{isHover:!0}},{empty:(0,g.k6)(()=>t[28]||(t[28]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"变量名称",field:"name",width:"180px"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"描述",field:"desc"})]),_:1},8,["size"])])]),_:1},8,["modelValue"])])}}});const Mt=(0,_e.A)(Kt,[["__scopeId","data-v-10f5489e"]]);var Xt=Mt;const qt={class:"panel-tab__content",style:{"padding-top":"6px"}};var $t=(0,g.pM)({__name:"FlowCondition",props:{businessObject:{},type:{}},setup(e){const t=e,a=(0,K.l5)(),l=(0,g.WQ)("prefix"),n=(0,k.KR)({});let i={},r={},o={};const u=window,d=(0,g.EW)(()=>D.SysFlowTaskOperationType.getList().filter(e=>-1===[D.SysFlowTaskOperationType.INTERVENE,D.SysFlowTaskOperationType.REVIVE,D.SysFlowTaskOperationType.TIMEOUT_AUTO_COMPLETE,D.SysFlowTaskOperationType.EMPTY_USER_AUTO_COMPLETE,D.SysFlowTaskOperationType.EMPTY_USER_AUTO_REJECT].indexOf(e.id))),p=()=>{let e,{conditionType:t,scriptType:a,body:s,resource:r,language:o}=n.value,d=i?.businessObject?.extensionElements?.values?.filter(e=>e.$type===`${l}:Properties`)??[];if("expression"===t){if(e=u.bpmnInstances.moddle.create("bpmn:FormalExpression",{body:s}),"operation"===n.value.type){let e=u.bpmnInstances.moddle.create(`${l}:CustomCondition`,{type:n.value.type,operationType:n.value.operationType===D.SysFlowTaskOperationType.PARALLEL_REFUSE?void 0:n.value.operationType,parallelRefuse:n.value.operationType===D.SysFlowTaskOperationType.PARALLEL_REFUSE});d.push(e)}}else{const t={...n.value};"inlineScript"===a?(e=u.bpmnInstances.moddle.create("bpmn:FormalExpression",{body:s,language:o}),t.resource="",n.value=t):(t.body="",n.value=t,e=u.bpmnInstances.moddle.create("bpmn:FormalExpression",{resource:r,language:o}))}const p=u.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:d});u.bpmnInstances.modeling.updateProperties(i,{conditionExpression:e,extensionElements:p})},b=e=>{n.value.body=e,p()},y=()=>{if(i=u.bpmnInstances.bpmnElement,r=i?.source,o=i?.businessObject.sourceRef,o&&o.default&&o.default.id===i?.id)n.value={type:"default"};else if(i?.businessObject.conditionExpression){const e=i.businessObject.conditionExpression;let t=i.businessObject.get("extensionElements")||u.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]}),a=(t.values||[]).filter(e=>e.$type===`${l}:CustomCondition`)[0];a&&"operation"===a.type?(n.value={...e,type:a.type},n.value.operationType=a.parallelRefuse?D.SysFlowTaskOperationType.PARALLEL_REFUSE:a.operationType):n.value={...e,type:"condition"};const s={...n.value};if(n.value.resource)return s.conditionType="script",s.scriptType="externalScript",void(n.value=s);if(e.language)return s.conditionType="script",s.scriptType="inlineScript",void(n.value=s);s.conditionType="expression",n.value=s}else n.value={type:"normal"}},v=e=>{null==e||""===e?n.value.body=void 0:e===D.SysFlowTaskOperationType.PARALLEL_REFUSE?n.value.body="${parallelRefuse == true}":n.value.body="${operationType == '"+e+"'}",p()},f=e=>{if("condition"===e||"operation"===e){let t=null;if("operation"===e){let a=i?.businessObject?.extensionElements?.values?.filter(e=>e.$type===`${l}:Properties`)??[];t=u.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[...a,u.bpmnInstances.moddle.create(`${l}:CustomCondition`,{type:e})]})}const a=u.bpmnInstances.moddle.create("bpmn:FormalExpression");return void u.bpmnInstances.modeling.updateProperties(i,{conditionExpression:a,extensionElements:t})}if("default"===e)return u.bpmnInstances.modeling.updateProperties(i,{conditionExpression:null}),void u.bpmnInstances.modeling.updateProperties(r,{default:i});o?.default&&o.default.id===i?.id&&u.bpmnInstances.modeling.updateProperties(r,{default:null}),u.bpmnInstances.modeling.updateProperties(i,{conditionExpression:null})};return(0,g.wB)(()=>t.businessObject,()=>{(0,g.dY)(()=>y())},{immediate:!0}),(0,g.xo)(()=>{i=null,r=null,o=null}),(e,t)=>{const l=c.P9,i=c.AV,r=s.xE,o=m.WK,u=s.US;return(0,g.uX)(),(0,g.CE)("div",qt,[(0,g.bF)(u,{model:(0,k.R1)(n),size:(0,k.R1)(a).defaultFormItemSize,onSubmit:t[6]||(t[6]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[(0,g.bF)(r,{label:"流转类型"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:(0,k.R1)(n).type,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(n).type=e),onChange:f},{default:(0,g.k6)(()=>[(0,g.bF)(l,{label:"普通流转路径",value:"normal"}),(0,g.bF)(l,{label:"默认流转路径",value:"default"}),(0,g.bF)(l,{label:"内置按钮",value:"operation"}),(0,g.bF)(l,{label:"条件流转路径",value:"condition"})]),_:1},8,["modelValue"])]),_:1}),"condition"===(0,k.R1)(n).type?((0,g.uX)(),(0,g.Wv)(r,{label:"条件格式",key:"condition"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:(0,k.R1)(n).conditionType,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(n).conditionType=e)},{default:(0,g.k6)(()=>[(0,g.bF)(l,{label:"表达式",value:"expression"}),(0,g.bF)(l,{label:"脚本",value:"script"})]),_:1},8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"operation"===(0,k.R1)(n).type?((0,g.uX)(),(0,g.Wv)(r,{label:"按钮类型",key:"operation"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:(0,k.R1)(n).operationType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(n).operationType=e),onChange:v},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(d),e=>((0,g.uX)(),(0,g.Wv)(l,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(n).conditionType&&"expression"===(0,k.R1)(n).conditionType?((0,g.uX)(),(0,g.Wv)(r,{label:"表达式",key:"express"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{"model-value":(0,k.R1)(n).body,"onUpdate:modelValue":b,clearable:"",type:"textarea",disabled:"operation"===(0,k.R1)(n).type},null,8,["model-value","disabled"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(n).conditionType&&"script"===(0,k.R1)(n).conditionType?((0,g.uX)(),(0,g.CE)(g.FK,{key:3},[(0,g.bF)(r,{label:"脚本语言",key:"language"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{modelValue:(0,k.R1)(n).language,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(n).language=e),clearable:"",onChange:p},null,8,["modelValue"])]),_:1}),(0,g.bF)(r,{label:"脚本类型",key:"scriptType"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:(0,k.R1)(n).scriptType,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(n).scriptType=e)},{default:(0,g.k6)(()=>[(0,g.bF)(l,{label:"内联脚本",value:"inlineScript"}),(0,g.bF)(l,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),"inlineScript"===(0,k.R1)(n).scriptType?((0,g.uX)(),(0,g.Wv)(r,{label:"脚本",key:"body"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{value:(0,k.R1)(n).body,onInput:b,clearable:"",type:"textarea",disabled:"operation"===(0,k.R1)(n).type},null,8,["value","disabled"])]),_:1})):(0,g.Q3)("",!0),"externalScript"===(0,k.R1)(n).scriptType?((0,g.uX)(),(0,g.Wv)(r,{label:"资源地址",key:"resource"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{modelValue:(0,k.R1)(n).resource,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(n).resource=e),clearable:"",onChange:p},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)],64)):(0,g.Q3)("",!0)]),_:1},8,["model","size"])])}}});const Qt=$t;var Gt=Qt;const jt={class:"panel-tab__content",style:{"padding-top":"0"}},Jt={class:"panel-tab__content--title",style:{height:"32px","padding-bottom":"3px","box-sizing":"content-box"}},Ht={class:"panel-tab__content--title",style:{"padding-top":"10px","padding-bottom":"3px"}};var Yt=(0,g.pM)({__name:"SignalAndMessage",setup(e){const t=(0,K.l5)(),a=(0,k.KR)([]),l=(0,k.KR)([]),n=(0,k.KR)(!1),i=(0,k.KR)(""),r=(0,k.KR)({});let o=[],u={},d={};const p=(0,g.EW)(()=>"message"===i.value?{title:"创建消息",idLabel:"消息ID",nameLabel:"消息名称"}:{title:"创建信号",idLabel:"信号ID",nameLabel:"信号名称"}),c=e=>{i.value=e,r.value={},n.value=!0},b=()=>{o=window.bpmnInstances.modeler.getDefinitions().rootElements,u={},d={},l.value=[],a.value=[],o.forEach(e=>{"bpmn:Message"===e.$type&&(u[e.id]=!0,l.value.push({...e})),"bpmn:Signal"===e.$type&&(d[e.id]=!0,a.value.push({...e}))})},y=()=>{if("message"===i.value){if(u[r.value.id])return _.nk.error("该消息已存在，请修改id后重新保存");const e=window.bpmnInstances.moddle.create("bpmn:Message",r.value);o.push(e)}else{if(d[r.value.id])return _.nk.error("该信号已存在，请修改id后重新保存");const e=window.bpmnInstances.moddle.create("bpmn:Signal",r.value);o.push(e)}n.value=!1,b()};return(0,g.sV)(()=>{b()}),(e,i)=>{const o=m.WK,u=s.xE,d=s.US,b=v.S2,f=Q.kZ;return(0,g.uX)(),(0,g.CE)("div",jt,[(0,g.Lk)("div",Jt,[i[8]||(i[8]=(0,g.Lk)("span",{class:"panel-title"},"消息列表",-1)),(0,g.bF)(Ae.A,{onClick:i[0]||(i[0]=(0,R.D$)(e=>c("message"),["prevent","stop"]))},{default:(0,g.k6)(()=>i[7]||(i[7]=[(0,g.eW)("添加")])),_:1,__:[7]})]),(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(l),size:(0,k.R1)(t).defaultFormItemSize,"row-config":{isHover:!0},"header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>i[9]||(i[9]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{type:"seq",title:"序号",width:"70px"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"消息ID",field:"id","max-width":"300px","show-overflow-tooltip":""}),(0,g.bF)((0,k.R1)(T.Wq),{title:"消息名称",field:"name","max-width":"300px","show-overflow-tooltip":""})]),_:1},8,["data","size"]),(0,g.Lk)("div",Ht,[i[11]||(i[11]=(0,g.Lk)("span",{class:"panel-title"},"信号列表",-1)),(0,g.bF)(Ae.A,{onClick:i[1]||(i[1]=(0,R.D$)(e=>c("signal"),["prevent","stop"]))},{default:(0,g.k6)(()=>i[10]||(i[10]=[(0,g.eW)("添加")])),_:1,__:[10]})]),(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(a),size:(0,k.R1)(t).defaultFormItemSize,"row-config":{isHover:!0},style:{"margin-bottom":"10px"},"header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>i[12]||(i[12]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{type:"seq",title:"序号",width:"70px"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"信号ID",field:"id","max-width":"300px","show-overflow-tooltip":""}),(0,g.bF)((0,k.R1)(T.Wq),{title:"信号名称",field:"name","max-width":"300px","show-overflow-tooltip":""})]),_:1},8,["data","size"]),(0,g.bF)(f,{modelValue:(0,k.R1)(n),"onUpdate:modelValue":i[6]||(i[6]=e=>(0,k.i9)(n)?n.value=e:null),title:(0,k.R1)(p).title,"close-on-click-modal":!1,width:"400px","append-to-body":"","destroy-on-close":""},{footer:(0,g.k6)(()=>[(0,g.bF)(b,{size:(0,k.R1)(t).defaultFormItemSize,onClick:i[5]||(i[5]=e=>n.value=!1)},{default:(0,g.k6)(()=>i[13]||(i[13]=[(0,g.eW)("取 消")])),_:1,__:[13]},8,["size"]),(0,g.bF)(b,{size:(0,k.R1)(t).defaultFormItemSize,type:"primary",onClick:y},{default:(0,g.k6)(()=>i[14]||(i[14]=[(0,g.eW)("保 存")])),_:1,__:[14]},8,["size"])]),default:(0,g.k6)(()=>[(0,g.bF)(d,{model:(0,k.R1)(r),size:(0,k.R1)(t).defaultFormItemSize,"label-width":"90px",onSubmit:i[4]||(i[4]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(u,{label:(0,k.R1)(p).idLabel},{default:(0,g.k6)(()=>[(0,g.bF)(o,{modelValue:(0,k.R1)(r).id,"onUpdate:modelValue":i[2]||(i[2]=e=>(0,k.R1)(r).id=e),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),(0,g.bF)(u,{label:(0,k.R1)(p).nameLabel},{default:(0,g.k6)(()=>[(0,g.bF)(o,{modelValue:(0,k.R1)(r).name,"onUpdate:modelValue":i[3]||(i[3]=e=>(0,k.R1)(r).name=e),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","size"])]),_:1},8,["modelValue","title"])])}}});const Zt=(0,_e.A)(Yt,[["__scopeId","data-v-34481c40"]]);var ea=Zt,ta=a(43589),aa=(a(69982),a(11194));a(57583);function la(e){let t={...e};if(e.script&&(t={...e,...e.script,scriptType:e.script.resource?"externalScript":"inlineScript"}),"timeout"===e.event&&e.eventDefinitions){if(e.eventDefinitions.length){let a="";for(const l in e.eventDefinitions[0])-1!==l.indexOf("time")&&(a=l,t.eventDefinitionType=l.replace("time","").toLowerCase());t.eventTimeDefinitions=e.eventDefinitions[0][a].body}e.fields&&(t.fields=e.fields.map(e=>({...e,fieldType:e.string?"string":"expression"})))}return t}function na(e){let t;return e.class&&(t="classListener"),e.expression&&(t="expressionListener"),e.delegateExpression&&(t="delegateExpressionListener"),e.script&&(t="scriptListener"),{id:(e.$attrs||{}).id,...JSON.parse(JSON.stringify(e)),...e.script??{},listenerType:t}}const ia={classListener:"Java 类",expressionListener:"表达式",delegateExpressionListener:"代理表达式",scriptListener:"脚本"},sa={create:"创建",assignment:"指派",complete:"完成",delete:"删除"},ra={string:"字符串",expression:"表达式"},oa={class:"panel-tab__content",style:{"padding-top":"3px"}},ua={class:"listener-filed__title",style:{"margin-bottom":"12px"}},da={class:"element-drawer__button",style:{"margin-top":"8px"}};var pa=(0,g.pM)({__name:"ElementListeners",props:{id:{},type:{}},setup(e,{expose:t}){const a=(0,K.l5)(),l=e,n=(0,g.WQ)("prefix",""),i=(0,g.WQ)("width"),r=(0,k.KR)(),o=(0,k.KR)(),u=(0,k.KR)([]),d=(0,k.KR)({}),p=(0,k.KR)(!1),b=(0,k.KR)([]),y=(0,k.KR)({}),f=(0,k.KR)(!1),E=(0,k.KR)(-1),_=(0,k.KR)(-1),w=(0,k.KR)(ia),A=(0,k.KR)(ra);let x=[],V={},C=[];const L=window,D=()=>{C=[];let e=V.businessObject?.extensionElements?.values?.filter(e=>(e.$type!==`${n}:ExecutionListener`&&C.push(e),e.$type===`${n}:ExecutionListener`))??[];return e},N=()=>{V=L.bpmnInstances.bpmnElement,C=[],x=D(),u.value=x.map(e=>na(e))},P=(e,t)=>{if(e?(d.value=la(e),E.value=t):(d.value={},E.value=-1),e&&e.fields)b.value=e.fields.map(e=>({...e,fieldType:e.string?"string":"expression"}));else{b.value=[];const e={...d.value};e.fields=[],d.value=e}p.value=!0,(0,g.dY)(()=>{r.value&&r.value.clearValidate()})},W=(e,t=0)=>{y.value=e?JSON.parse(JSON.stringify(e)):{},_.value=e?t:-1,f.value=!0,(0,g.dY)(()=>{o.value&&o.value.clearValidate()})},O=async()=>{let e=await o.value.validate();e&&(-1===_.value?(b.value.push(y.value),d.value.fields.push(y.value)):(b.value.splice(_.value,1,y.value),d.value.fields.splice(_.value,1,y.value)),f.value=!1,(0,g.dY)(()=>y.value={}))},B=(e,t)=>{S.s.confirm("确认移除该字段吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{b.value.splice(t,1),d.value.fields.splice(t,1)}).catch(()=>console.info("操作取消"))},U=(e,t)=>{S.s.confirm("确认移除该监听器吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(),x.splice(t,1),u.value.splice(t,1),pe(V,C.concat(x))}).catch(()=>console.info("操作取消"))},z=async()=>{let e=await r.value.validate();if(!e)return;const t=oe(d.value,!1,n);-1===E.value?(x.push(t),u.value.push(d.value)):(x.splice(E.value,1,t),u.value.splice(E.value,1,d.value)),D(),pe(V,C.concat(x)),p.value=!1,d.value={}};return(0,g.wB)(()=>l.id,e=>{e&&e.length&&(0,g.dY)(()=>N())},{immediate:!0}),t({openListenerForm:P}),(e,t)=>{const l=v.S2,n=c.P9,E=c.AV,_=s.xE,S=m.WK,x=s.US,V=aa.fR,C=Ke.tk,L=ta.pw,D=Q.kZ;return(0,g.uX)(),(0,g.CE)("div",oa,[(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(u),size:(0,k.R1)(a).defaultFormItemSize,"row-config":{isHover:!0},"header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>t[22]||(t[22]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",width:"70px",type:"seq"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"事件类型","min-width":"100px",field:"event"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"监听器类型","min-width":"100px","show-overflow-tooltip":""},{default:(0,g.k6)(e=>[(0,g.eW)((0,h.v_)((0,k.R1)(w)[e.row.listenerType]),1)]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"110px"},{default:(0,g.k6)(({row:e,$rowIndex:n})=>[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"primary",onClick:t=>P(e,n)},{default:(0,g.k6)(()=>t[20]||(t[20]=[(0,g.eW)("编辑")])),_:2,__:[20]},1032,["size","onClick"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"danger",onClick:t=>U(e,n)},{default:(0,g.k6)(()=>t[21]||(t[21]=[(0,g.eW)("删除")])),_:2,__:[21]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,g.bF)(L,{modelValue:(0,k.R1)(p),"onUpdate:modelValue":t[12]||(t[12]=e=>(0,k.i9)(p)?p.value=e:null),title:"执行监听器",size:`${(0,k.R1)(i)}px`,class:"process-drawer","append-to-body":"","destroy-on-close":""},{default:(0,g.k6)(()=>[(0,g.bF)(x,{size:(0,k.R1)(a).defaultFormItemSize,model:(0,k.R1)(d),"label-width":"96px",ref_key:"listenerFormRef",ref:r,onSubmit:t[9]||(t[9]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(_,{label:"事件类型",prop:"event",rules:{required:!0,message:"请选择事件类型",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(d).event,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(d).event=e)},{default:(0,g.k6)(()=>[(0,g.bF)(n,{label:"start",value:"start"}),(0,g.bF)(n,{label:"end",value:"end"})]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(_,{label:"监听器类型",prop:"listenerType",rules:{required:!0,message:"请选择监听器类型",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(d).listenerType,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(d).listenerType=e)},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(Object.keys((0,k.R1)(w)),e=>((0,g.uX)(),(0,g.Wv)(n,{key:e,label:(0,k.R1)(w)[e],value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),"classListener"===(0,k.R1)(d).listenerType?((0,g.uX)(),(0,g.Wv)(_,{label:"Java类",prop:"class",key:"listener-class",rules:{required:!0,message:"请填写Java类",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(d).class,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(d).class=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"expressionListener"===(0,k.R1)(d).listenerType?((0,g.uX)(),(0,g.Wv)(_,{label:"表达式",prop:"expression",key:"listener-expression",rules:{required:!0,message:"请填写表达式",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(d).expression,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(d).expression=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"delegateExpressionListener"===(0,k.R1)(d).listenerType?((0,g.uX)(),(0,g.Wv)(_,{label:"代理表达式",prop:"delegateExpression",key:"listener-delegate",rules:{required:!0,message:"请填写代理表达式",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(d).delegateExpression,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(d).delegateExpression=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"scriptListener"===(0,k.R1)(d).listenerType?((0,g.uX)(),(0,g.CE)(g.FK,{key:3},[(0,g.bF)(_,{label:"脚本格式",prop:"scriptFormat",key:"listener-script-format",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本格式"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(d).scriptFormat,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(d).scriptFormat=e),clearable:""},null,8,["modelValue"])]),_:1}),(0,g.bF)(_,{label:"脚本类型",prop:"scriptType",key:"listener-script-type",rules:{required:!0,trigger:["blur","change"],message:"请选择脚本类型"}},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(d).scriptType,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,k.R1)(d).scriptType=e)},{default:(0,g.k6)(()=>[(0,g.bF)(n,{label:"内联脚本",value:"inlineScript"}),(0,g.bF)(n,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),"inlineScript"===(0,k.R1)(d).scriptType?((0,g.uX)(),(0,g.Wv)(_,{label:"脚本内容",prop:"value",key:"listener-script",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本内容"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(d).value,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(d).value=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"externalScript"===(0,k.R1)(d).scriptType?((0,g.uX)(),(0,g.Wv)(_,{label:"资源地址",prop:"resource",key:"listener-resource",rules:{required:!0,trigger:["blur","change"],message:"请填写资源地址"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(d).resource,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.R1)(d).resource=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)],64)):(0,g.Q3)("",!0)]),_:1},8,["size","model"]),(0,g.bF)(V),(0,g.Lk)("p",ua,[(0,g.Lk)("span",null,[(0,g.bF)(C,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Menu))]),_:1}),t[23]||(t[23]=(0,g.eW)("注入字段："))]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,type:"primary",onClick:t[10]||(t[10]=e=>W(null))},{default:(0,g.k6)(()=>t[24]||(t[24]=[(0,g.eW)("添加字段")])),_:1,__:[24]},8,["size"])]),(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(b),size:(0,k.R1)(a).defaultFormItemSize,"row-config":{isHover:!0},"max-height":"240",border:"",fit:"",style:{flex:"none"},"header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>t[27]||(t[27]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",width:"70px",type:"seq"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"字段名称","min-width":"100px",field:"name"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"字段类型","min-width":"80px","show-overflow-tooltip":""},{default:(0,g.k6)(e=>[(0,g.eW)((0,h.v_)((0,k.R1)(A)[e.row.fieldType]),1)]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"字段值/表达式","min-width":"100px","show-overflow-tooltip":"",formatter:e=>e.string||e.expression},{default:(0,g.k6)(e=>[(0,g.eW)((0,h.v_)(e.row.string||e.row.expression),1)]),_:1},8,["formatter"]),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"100px"},{default:(0,g.k6)(({row:e,$rowIndex:n})=>[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"primary",onClick:t=>W(e,n)},{default:(0,g.k6)(()=>t[25]||(t[25]=[(0,g.eW)("编辑")])),_:2,__:[25]},1032,["size","onClick"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"danger",onClick:t=>B(e,n)},{default:(0,g.k6)(()=>t[26]||(t[26]=[(0,g.eW)("删除")])),_:2,__:[26]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,g.Lk)("div",da,[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,onClick:t[11]||(t[11]=e=>p.value=!1)},{default:(0,g.k6)(()=>t[28]||(t[28]=[(0,g.eW)("取 消")])),_:1,__:[28]},8,["size"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,type:"primary",onClick:z},{default:(0,g.k6)(()=>t[29]||(t[29]=[(0,g.eW)("保 存")])),_:1,__:[29]},8,["size"])])]),_:1},8,["modelValue","size"]),(0,g.bF)(D,{title:"字段配置",modelValue:(0,k.R1)(f),"onUpdate:modelValue":t[19]||(t[19]=e=>(0,k.i9)(f)?f.value=e:null),width:"600px","append-to-body":"","destroy-on-close":""},{footer:(0,g.k6)(()=>[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,onClick:t[18]||(t[18]=e=>f.value=!1)},{default:(0,g.k6)(()=>t[30]||(t[30]=[(0,g.eW)("取 消")])),_:1,__:[30]},8,["size"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,type:"primary",onClick:O},{default:(0,g.k6)(()=>t[31]||(t[31]=[(0,g.eW)("确 定")])),_:1,__:[31]},8,["size"])]),default:(0,g.k6)(()=>[(0,g.bF)(x,{model:(0,k.R1)(y),size:(0,k.R1)(a).defaultFormItemSize,"label-width":"96px",ref_key:"listenerFieldFormRef",ref:o,onSubmit:t[17]||(t[17]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(_,{label:"字段名称：",prop:"name",rules:{required:!0,message:"请填写字段名称",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(y).name,"onUpdate:modelValue":t[13]||(t[13]=e=>(0,k.R1)(y).name=e),clearable:""},null,8,["modelValue"])]),_:1}),(0,g.bF)(_,{label:"字段类型：",prop:"fieldType",rules:{required:!0,message:"请选择字段类型",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(y).fieldType,"onUpdate:modelValue":t[14]||(t[14]=e=>(0,k.R1)(y).fieldType=e)},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(Object.keys((0,k.R1)(A)),e=>((0,g.uX)(),(0,g.Wv)(n,{key:e,label:(0,k.R1)(A)[e],value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),"string"===(0,k.R1)(y).fieldType?((0,g.uX)(),(0,g.Wv)(_,{label:"字段值：",prop:"string",key:"field-string",rules:{required:!0,message:"请填写字段值",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(y).string,"onUpdate:modelValue":t[15]||(t[15]=e=>(0,k.R1)(y).string=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"expression"===(0,k.R1)(y).fieldType?((0,g.uX)(),(0,g.Wv)(_,{label:"表达式：",prop:"expression",key:"field-expression",rules:{required:!0,message:"请填写表达式",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(y).expression,"onUpdate:modelValue":t[16]||(t[16]=e=>(0,k.R1)(y).expression=e),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)]),_:1},8,["model","size"])]),_:1},8,["modelValue"])])}}});const ma=pa;var ca=ma;const ba={class:"panel-tab__content",style:{"padding-top":"3px"}};var ya=(0,g.pM)({__name:"ElementProperties",props:{id:{},type:{}},setup(e,{expose:t}){const a=(0,K.l5)(),l=e,n=(0,g.WQ)("prefix");console.log("prefix",n);const i=(0,k.KR)(),r=(0,k.KR)([]),o=(0,k.KR)({}),u=(0,k.KR)(-1),d=(0,k.KR)(!1);let p={},c=[],b=[];const y=window,f=()=>{p=y.bpmnInstances.bpmnElement,c=[];const e=p.businessObject?.extensionElements?.values?.filter(e=>(e.$type!==`${n}:Properties`&&c.push(e),e.$type===`${n}:Properties`))??[];b=e.reduce((e,t)=>(null!=t.values&&(e=e.concat(t.values)),e),[]),r.value=JSON.parse(JSON.stringify(b??[]))},h=(e,t)=>{u.value=t,o.value=-1===t?{}:JSON.parse(JSON.stringify(e)),d.value=!0,(0,g.dY)(()=>{i.value&&i.value.clearValidate()})},E=(e,t)=>{S.s.confirm("确认移除该属性吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.splice(t,1),b.splice(t,1);const e=y.bpmnInstances.moddle.create(`${n}:Properties`,{values:b});I(e),f()}).catch(()=>console.info("操作取消"))},_=()=>{let e=[];if(-1===u.value){const t=y.bpmnInstances.moddle.create(`${n}:Property`,o.value);e=y.bpmnInstances.moddle.create(`${n}:Properties`,{values:b.concat([t])})}else e=y.bpmnInstances.moddle.create(`${n}:Properties`,{values:r.value.map((e,t)=>t!==u.value?y.bpmnInstances.moddle.create(`${n}:Property`,{name:e.name,value:e.value}):y.bpmnInstances.moddle.create(`${n}:Property`,{name:o.value.name,value:o.value.value}))});I(e),d.value=!1,f()},I=e=>{const t=y.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:c.concat([e])});y.bpmnInstances.modeling.updateProperties(p,{extensionElements:t})};return(0,g.wB)(()=>l.id,e=>{e&&e.length&&f()},{immediate:!0}),t({openAttributesForm:h}),(e,t)=>{const l=v.S2,n=m.WK,u=s.xE,p=s.US,c=Q.kZ;return(0,g.uX)(),(0,g.CE)("div",ba,[(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(r),size:(0,k.R1)(a).defaultFormItemSize,"row-config":{isHover:!0},"max-height":"240",fit:"","header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>t[7]||(t[7]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",width:"70px",type:"seq"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"属性名",field:"name","min-width":"100px","show-overflow-tooltip":""}),(0,g.bF)((0,k.R1)(T.Wq),{title:"属性值",field:"value","min-width":"90px","show-overflow-tooltip":""}),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"110px"},{default:(0,g.k6)(({row:e,$rowIndex:n})=>[(0,g.bF)(l,{type:"primary",size:(0,k.R1)(a).defaultFormItemSize,link:"",onClick:t=>h(e,n)},{default:(0,g.k6)(()=>t[5]||(t[5]=[(0,g.eW)("编辑")])),_:2,__:[5]},1032,["size","onClick"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"danger",onClick:t=>E(e,n)},{default:(0,g.k6)(()=>t[6]||(t[6]=[(0,g.eW)("删除")])),_:2,__:[6]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,g.bF)(c,{modelValue:(0,k.R1)(d),"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.i9)(d)?d.value=e:null),title:"属性配置",width:"600px","append-to-body":"","destroy-on-close":""},{footer:(0,g.k6)(()=>[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,onClick:t[3]||(t[3]=e=>d.value=!1)},{default:(0,g.k6)(()=>t[8]||(t[8]=[(0,g.eW)("取 消")])),_:1,__:[8]},8,["size"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,type:"primary",onClick:_},{default:(0,g.k6)(()=>t[9]||(t[9]=[(0,g.eW)("确 定")])),_:1,__:[9]},8,["size"])]),default:(0,g.k6)(()=>[(0,g.bF)(p,{model:(0,k.R1)(o),"label-width":"80px",size:(0,k.R1)(a).defaultFormItemSize,ref_key:"attributeFormRef",ref:i,onSubmit:t[2]||(t[2]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(u,{label:"属性名：",prop:"name"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).name,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(o).name=e),clearable:""},null,8,["modelValue"])]),_:1}),(0,g.bF)(u,{label:"属性值：",prop:"value"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).value,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(o).value=e),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","size"])]),_:1},8,["modelValue"])])}}});const va=ya;var fa=va;const ga={class:"panel-tab__content"};var ka=(0,g.pM)({__name:"SetApproveStatus",props:{id:{},type:{}},setup(e){const t=e,a=(0,g.WQ)("flowEntry",()=>({})),l=(0,g.WQ)("prefix"),n=(0,k.KR)(),i=(0,k.KR)([]),s=(0,g.EW)(()=>null!=a().value.extensionData&&Array.isArray(a().value.extensionData.approvalStatusDict)?a().value.extensionData.approvalStatusDict.map(e=>({id:e.id.toString(),name:e.name})):[]);let r={},o=[];const u=window,d=()=>{n.value="none_undefined",r=u.bpmnInstances.bpmnElement;const e=r.businessObject?.extensionElements?.values?.filter(e=>e.$type===`${l}:Properties`)??[];o=e.reduce((e,t)=>e.concat(t.values),[]),i.value=JSON.parse(JSON.stringify(o??[])),i.value.forEach(e=>{"latestApprovalStatus"===e.name&&(n.value="none_undefined"===e.value?void 0:e.value)})},p=e=>{const t=r.businessObject?.extensionElements?.values?.filter(e=>e.$type!==`${l}:Properties`)??[],a=u.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t.concat(e)});u.bpmnInstances.modeling.updateProperties(r,{extensionElements:a})},m=e=>{if(null==e||""===e||"none_undefined"===e)p([]);else{const t=u.bpmnInstances.moddle.create(`${l}:Property`,{name:"latestApprovalStatus",value:e}),a=u.bpmnInstances.moddle.create(`${l}:Properties`,{values:[t]});p([a]),d()}};return(0,g.wB)(()=>t.id,e=>{e&&e.length&&d()},{immediate:!0}),(e,t)=>{const a=c.P9,l=c.AV;return(0,g.uX)(),(0,g.CE)("div",ga,[(0,g.bF)(l,{class:"input-item",modelValue:(0,k.R1)(n),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.i9)(n)?n.value=e:null),onChange:m},{default:(0,g.k6)(()=>[(0,g.bF)(a,{label:"不更新",value:"none_undefined"}),((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(s),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])}}});const ha=ka;var Ra=ha,Fa=a(6552),Ta=a(4849),Ea=(0,g.pM)({__name:"flowFormConfig",props:{id:{},type:{},tabType:{}},setup(e,{expose:t}){const a=(0,K.l5)(),l=e,n=(0,g.WQ)("flowEntry",()=>({})),r=(0,g.WQ)("formList",()=>({})),u=(0,g.WQ)("prefix"),d=window,p=(0,k.KR)(),b=(0,k.KR)({formId:n().value.defaultFormId,routerName:n().value.defaultRouterName,mobileRouterName:void 0,formAuth:{},editable:!1}),E=(0,k.KR)({}),_=(0,k.KR)([]),I={formId:[{required:!0,message:"请选择在线表单！",trigger:"blur"}],routerName:[{required:!0,message:"表单路由不能为空！",trigger:"blur"}]};let w={};const A=(0,g.EW)(()=>(console.log("flowEntryComputed",n().value),n().value)),x=(0,g.EW)(()=>n().value.extensionData&&Array.isArray(n().value.extensionData.approvalStatusDict)?n().value.extensionData.approvalStatusDict:[]),V=(0,g.EW)(()=>r().find(e=>e.formId===b.value.formId)),C=e=>{if(null==e)return null;let t;return Array.isArray(e.childWidgetList)&&e.childWidgetList.length>0&&(t=e.childWidgetList.map(e=>C(e))),{formId:(0,$.yk)(),showName:e.showName,variableName:e.variableName,widgetType:e.widgetType,children:t}},L=()=>{let e={pc:{widgetList:void 0},mobile:{widgetList:void 0}};if(null!=V.value){let t=JSON.parse(V.value.widgetJson);null!=t&&(t.pc&&Array.isArray(t.pc.widgetList)&&t.pc.widgetList.length>0&&(e.pc={widgetList:t.pc.widgetList.map(e=>C(e))}),t.mobile&&Array.isArray(t.mobile.widgetList)&&t.mobile.widgetList.length>0&&(e.mobile={widgetList:t.mobile.widgetList.map(e=>C(e))}))}console.log(e),U.l.show("设置表单权限",Ta["default"],{area:["1000px","700px"]},{formAuth:b.value.formAuth||{},formWidgetConfig:e,bindFormType:A.value.bindFormType,path:"thirdSetOnlineFormAuth"},{width:"1000px",height:"700px",pathName:"/thirdParty/formSetOnlineFormAuth"}).then(e=>{b.value.formAuth=e,W()}).catch(e=>{console.warn(e)})},P=()=>{w=d.bpmnInstances.bpmnElement;let e=w.businessObject.formKey,t=e?JSON.parse(e):void 0;t&&(b.value={formId:t.formId,routerName:t.routerName,mobileRouterName:t.mobileRouterName,formAuth:t.formAuth||{},editable:!t.readOnly,groupType:t.groupType||"ASSIGNEE",variableType:t.variableType});let a=w.businessObject.get("extensionElements")||d.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});E.value=a.values.filter(e=>e.$type===`${u}:OperationList`)?.[0]||d.bpmnInstances.moddle.create(`${u}:OperationList`,{operationList:[]}),_.value=JSON.parse(JSON.stringify(E.value.operationList||[])),_.value.forEach(e=>{e.showOrder=Number.parseInt(e.showOrder)}),W(),O()},W=()=>{console.log("updateElementFormKey"),p.value?.validate(e=>{if(!e)return;let t=JSON.stringify({formId:n().value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM?b.value.formId:void 0,routerName:n().value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM?void 0:b.value.routerName,mobileRouterName:n().value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM?void 0:b.value.mobileRouterName,formAuth:b.value.formAuth,readOnly:!b.value.editable,groupType:b.value.groupType||"ASSIGNEE",variableType:b.value.variableType});d.bpmnInstances.modeling.updateProperties(w,{formKey:t})})},O=()=>{let e=w.businessObject.get("extensionElements")||d.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]}),t=e.values.filter(e=>e.$type!==`${u}:OperationList`);const a=d.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t.concat(E.value)});E.value.operationList=_.value.map(e=>d.bpmnInstances.moddle.create(`${u}:FormOperation`,{id:e.id,label:e.label,type:e.type,showOrder:e.showOrder,latestApprovalStatus:e.latestApprovalStatus,multiSignAssignee:e.multiSignAssignee,variableList:e.variableList,buttonStyle:e.buttonStyle,buttonIcon:e.buttonIcon,buttonPlain:e.buttonPlain})),d.bpmnInstances.modeling.updateProperties(w,{extensionElements:a})},B=e=>{U.l.show(e?"编辑按钮":"添加按钮",Fa["default"],{area:"500px"},{rowData:e,validStatusList:x.value,path:"thirdEditOperation"},{width:"500px",height:"450px",pathName:"/thirdParty/thirdEditOperation"}).then(e=>{z(e)}).catch(e=>{console.warn(e)})},z=e=>{null==e.id?(e.id=(new Date).getTime(),_.value.push(e)):_.value.forEach(t=>{t.id===e.id&&(t.label=e.label,t.type=e.type,t.showOrder=e.showOrder,t.multiSignAssignee=e.multiSignAssignee,t.latestApprovalStatus=e.latestApprovalStatus,t.variableList=e.variableList,t.buttonStyle=e.buttonStyle,t.buttonIcon=e.buttonIcon,t.buttonPlain=e.buttonPlain)}),_.value.sort((e,t)=>e.showOrder-t.showOrder),O()},M=e=>{S.s.confirm("是否删除此按钮？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.value=_.value.filter(t=>t.id!==e.id),O()}).catch(e=>{console.warn(e)})};return(0,g.wB)(()=>l.id,e=>{e&&e.length&&(0,g.dY)(()=>P())},{immediate:!0}),t({onEditOperation:B}),(e,t)=>{const l=m.WK,n=s.xE,u=c.P9,d=c.AV,E=o.qi,S=f.uD,w=v.S2,x=y.S2,V=s.US,C=i.u;return(0,g.uX)(),(0,g.CE)("div",null,["baseInfo"===e.tabType?((0,g.uX)(),(0,g.Wv)(V,{key:0,ref_key:"form",ref:p,size:(0,k.R1)(a).defaultFormItemSize,model:(0,k.R1)(b),rules:I,onSubmit:t[4]||(t[4]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[(0,k.R1)(A).bindFormType===(0,k.R1)(D.SysFlowEntryBindFormType).ROUTER_FORM?((0,g.uX)(),(0,g.Wv)(n,{key:0,label:"表单路由",prop:"routerName"},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(b).routerName,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(b).routerName=e),clearable:"",onChange:W},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(A).bindFormType===(0,k.R1)(D.SysFlowEntryBindFormType).ROUTER_FORM?((0,g.uX)(),(0,g.Wv)(n,{key:1,label:"移动端表单路由",prop:"mobileRouterName"},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(b).mobileRouterName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(b).mobileRouterName=e),clearable:"",onChange:W},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(A).bindFormType===(0,k.R1)(D.SysFlowEntryBindFormType).ONLINE_FORM?((0,g.uX)(),(0,g.Wv)(n,{key:2,label:"在线表单",prop:"formId"},{default:(0,g.k6)(()=>[(0,g.bF)(d,{modelValue:(0,k.R1)(b).formId,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(b).formId=e),clearable:"",placeholder:"",onChange:W},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(r)().filter(e=>e.formType===(0,k.R1)(N.SysOnlineFormType).FLOW),e=>((0,g.uX)(),(0,g.Wv)(u,{key:e.formId,label:e.formName,value:e.formId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),(0,g.bF)(x,null,{default:(0,g.k6)(()=>[(0,g.bF)(S,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(n,{label:"允许编辑",style:{"margin-bottom":"4px"}},{label:(0,g.k6)(()=>[t[5]||(t[5]=(0,g.Lk)("span",null,"允许编辑",-1)),(0,g.bF)(E,{modelValue:(0,k.R1)(b).editable,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(b).editable=e),onChange:W,style:{"margin-left":"18px"}},null,8,["modelValue"])]),_:1})]),_:1}),(0,g.bF)(S,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(n,null,{label:(0,g.k6)(()=>[t[7]||(t[7]=(0,g.Lk)("span",null,"表单权限",-1)),(0,g.bF)(w,{type:"primary",size:"default",style:{"margin-left":"18px"},onClick:L},{default:(0,g.k6)(()=>t[6]||(t[6]=[(0,g.eW)("设置")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1})]),_:1},8,["size","model"])):"button"===e.tabType?((0,g.uX)(),(0,g.Wv)(x,{key:1,style:{"padding-top":"3px"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{span:24},{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(_),"row-config":{isHover:!0},"header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>t[10]||(t[10]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",width:"70px",type:"seq"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"按钮名称","min-width":"100px"},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)(e.row.label),1)]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"按钮类型","min-width":"100px"},{default:(0,g.k6)(e=>[(0,g.bF)(C,{size:(0,k.R1)(a).defaultFormItemSize,effect:"dark"},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)((0,k.R1)(D.SysFlowTaskOperationType).getValue(e.row.type)),1)]),_:2},1032,["size"])]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"95px"},{default:(0,g.k6)(e=>[(0,g.bF)(w,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"primary",onClick:t=>B(e.row),style:{padding:"0"}},{default:(0,g.k6)(()=>t[8]||(t[8]=[(0,g.eW)("编辑")])),_:2,__:[8]},1032,["size","onClick"]),(0,g.bF)(w,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"danger",onClick:t=>M(e.row),style:{padding:"0"}},{default:(0,g.k6)(()=>t[9]||(t[9]=[(0,g.eW)("删除")])),_:2,__:[9]},1032,["size","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})):(0,g.Q3)("",!0)])}}});const _a=(0,_e.A)(Ea,[["__scopeId","data-v-4514226c"]]);var Sa=_a,Ia=a(8571),wa=a(11128);const Aa={class:"autotask-insert-settting"},xa={style:{margin:"0px 10px"}},Va={style:{margin:"0px 10px 0px 0px"}},Ca={style:{margin:"0px 10px 0px 0px"}};var La=(0,g.pM)({__name:"AutoInsertTaskSetting",props:{modelValue:{},flowDblinkList:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix"),(0,g.WQ)("getAllAutoVariableList",()=>[])),r=(0,k.KR)({actionType:D.AutoTaskActionType.INSERT,srcFilterType:"field",srcFilterSql:"",srcDblinkId:void 0,srcDblinkType:void 0,srcTableName:"",destDblinkId:void 0,destTableName:"",destDblinkType:void 0,srcFilterList:[],insertDataList:[]}),o=(0,k.KR)([]),u=(0,k.KR)([]),d=()=>{let e={...r.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},p=async e=>{let t=await C.V7.listDblinkTables({dblinkId:e});return Array.isArray(t.data)?t.data.map(e=>e.tableName):[]},v=(e,t)=>{null==e?r.value.insertDataList.push(t):r.value.insertDataList=r.value.insertDataList.map(e=>e.destColumnName===t.destColumnName?t:e),d()},R=e=>{U.l.show("编辑插入字段",Ia["default"],{area:["500px","300px"]},{entryId:n().entryId,data:e,dblinkId:r.value.destDblinkId,tableName:r.value.destTableName,srcDblinkId:r.value.srcDblinkId,srcTableName:r.value.srcTableName,flowVariableList:i(),path:"thirdEditInsertData"},{width:"500px",height:"300px",pathName:"/thirdParty/thirdEditFieldUpdateData"}).then(t=>{v(e,t)}).catch(e=>{console.log(e)})},F=e=>{S.s.confirm("是否删除此字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.insertDataList=r.value.insertDataList.filter(t=>t.destColumnName!==e.destColumnName),d()}).catch(e=>{console.log(e)})},T=(e,t)=>{null==e?r.value.srcFilterList.push(t):r.value.srcFilterList=r.value.srcFilterList.map(e=>e.filterColumnName===t.filterColumnName?t:e),d()},E=e=>{U.l.show("编辑过滤字段",wa["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,dblinkId:r.value.srcDblinkId,tableName:r.value.srcTableName,flowVariableList:i(),path:"thirdEditSrcFilter"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditTableFilter"}).then(t=>{T(e,t)}).catch(e=>{console.log(e)})},_=e=>{S.s.confirm("是否删除此过滤字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.srcFilterList=r.value.srcFilterList.filter(t=>t.filterColumnName!==e.filterColumnName),d()}).catch(e=>{console.log(e)})},I=e=>{r.value.srcTableName="",r.value.srcDblinkType=(l.flowDblinkList.find(t=>t.id===e)||{}).type,r.value.srcFilterSql="",r.value.srcFilterList=[],d()},w=e=>{r.value.srcFilterSql="",r.value.srcFilterList=[],d()},A=e=>{r.value.destTableName="",r.value.destDblinkType=(l.flowDblinkList.find(t=>t.id===e)||{}).type,r.value.insertDataList=[],d()},x=e=>{r.value.insertDataList=[],d()};return(0,g.wB)(()=>l.modelValue,e=>{if(e){let t=e&&""!==e?JSON.parse(e):{};r.value={actionType:t.actionType||0,srcFilterType:t.srcFilterType||"field",srcFilterSql:t.srcFilterSql||"",srcDblinkId:t.srcDblinkId,srcTableName:t.srcTableName||"",srcDblinkType:t.srcDblinkType,destDblinkId:t.destDblinkId,destDblinkType:t.destDblinkType,destTableName:t.destTableName||"",insertDataList:t.insertDataList||[],srcFilterList:t.srcFilterList||[]}}},{immediate:!0}),(0,g.wB)(()=>r.value.srcDblinkId,e=>{e?p(e).then(e=>{o.value=e}):o.value=[]},{immediate:!0}),(0,g.wB)(()=>r.value.destDblinkId,e=>{e?p(e).then(e=>{u.value=e}):u.value=[]},{immediate:!0}),(e,t)=>{const a=c.P9,l=c.AV,n=f.uD,i=y.S2,p=s.xE,v=b.ll,T=b.MQ,S=m.WK;return(0,g.uX)(),(0,g.CE)("div",Aa,[(0,g.bF)(p,{label:"源表"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).srcDblinkId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(r).srcDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:I},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).srcTableName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(r).srcTableName=e),clearable:"",filterable:"",placeholder:"请选择数据源表",onChange:w},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(o),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(p,{label:"源表过滤类型"},{default:(0,g.k6)(()=>[(0,g.bF)(T,{modelValue:(0,k.R1)(r).srcFilterType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(r).srcFilterType=e),onChange:d},{default:(0,g.k6)(()=>[(0,g.bF)(v,{value:"field"},{default:(0,g.k6)(()=>t[8]||(t[8]=[(0,g.eW)("字段过滤")])),_:1,__:[8]}),(0,g.bF)(v,{value:"sql"},{default:(0,g.k6)(()=>t[9]||(t[9]=[(0,g.eW)("自定义SQL")])),_:1,__:[9]})]),_:1},8,["modelValue"])]),_:1}),"field"===(0,k.R1)(r).srcFilterType?((0,g.uX)(),(0,g.Wv)(Ge.A,{key:0,label:"源表过滤条件",data:(0,k.R1)(r).srcFilterList,addText:"添加",disabled:null==(0,k.R1)(r).srcTableName||""===(0,k.R1)(r).srcTableName,onAdd:t[3]||(t[3]=e=>E()),onEdit:E,onDelete:_,prop:{label:"filterColumnName",value:"filterColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterColumnName),1),(0,g.Lk)("span",xa,(0,h.v_)((0,k.R1)(N.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,g.Lk)("span",Va,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.valueType)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterValue),1)]),_:1},8,["data","disabled"])):((0,g.uX)(),(0,g.Wv)(S,{key:1,modelValue:(0,k.R1)(r).srcFilterSql,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(r).srcFilterSql=e),type:"textarea",rows:"5",placeholder:"重要！过滤值使用流程变量时需要手动输入，变量名的两边一定不要添加任何引号，如：name = ${variableName}",onChange:d},null,8,["modelValue"])),(0,g.bF)(p,{label:"目标表"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).destDblinkId,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(r).destDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:A},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).destTableName,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,k.R1)(r).destTableName=e),clearable:"",filterable:"",placeholder:"请选择数据目标表",onChange:x},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(Ge.A,{label:"数据插入对象",data:(0,k.R1)(r).insertDataList,addText:"添加",disabled:null==(0,k.R1)(r).destTableName||""===(0,k.R1)(r).destTableName,onAdd:t[7]||(t[7]=e=>R()),onEdit:R,onDelete:F,prop:{label:"destColumnName",value:"destColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)(e.data.destColumnName),1),t[10]||(t[10]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",Ca,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)(e.data.srcValue),1)]),_:1},8,["data","disabled"])])}}});const Da=La;var Na=Da;const Pa={class:"autotask-query-single-settting"},Wa={style:{margin:"0px 10px"}},Oa={style:{margin:"0px 10px 0px 0px"}};var Ba=(0,g.pM)({__name:"AutoQuerySingleDataSetting",props:{modelValue:{},flowDblinkList:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix"),(0,g.WQ)("getAllAutoVariableList",()=>[])),r=(0,k.KR)({actionType:D.AutoTaskActionType.QUERY_SINGLE_DATA,srcDblinkId:void 0,srcDblinkType:void 0,srcTableName:null,srcFilterType:"field",srcFilterList:[],srcFilterSql:"",selectFieldList:[]}),o=(0,k.KR)([]),u=(0,k.KR)([]),d=()=>{let e={...r.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},p=async e=>{let t=await C.V7.listDblinkTables({dblinkId:e});return Array.isArray(t.data)?t.data.map(e=>e.tableName):[]},v=()=>{null!=r.value.srcDblinkId&&null!=r.value.srcTableName&&""!==r.value.srcTableName&&""!==r.value.srcDblinkId?C.V7.listDblinkTableColumns({dblinkId:r.value.srcDblinkId,tableName:r.value.srcTableName}).then(e=>{o.value=e.data}):o.value=[]},R=e=>{r.value.srcTableName="",r.value.srcDblinkType=(l.flowDblinkList.find(t=>t.id===e)||{}).type,r.value.srcFilterSql="",r.value.srcFilterList=[],d()},F=()=>{r.value.srcFilterSql="",r.value.srcFilterList=[],d()},T=(e,t)=>{null==e?r.value.srcFilterList.push(t):r.value.srcFilterList=r.value.srcFilterList.map(e=>e.srcTableName===t.srcTableName?t:e),d()},E=e=>{U.l.show("编辑过滤字段",wa["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,dblinkId:r.value.srcDblinkId,tableName:r.value.srcTableName,flowVariableList:i(),path:"thirdEditQuerySingleFilter"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditTableFilter"}).then(t=>{T(e,t)}).catch(e=>{console.log(e)})},_=e=>{S.s.confirm("是否删除此过滤字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.srcFilterList=r.value.srcFilterList.filter(t=>t.filterColumnName!==e.filterColumnName),d()}).catch(e=>{console.log(e)})};return(0,g.wB)(()=>l.modelValue,e=>{let t=e&&""!==e?JSON.parse(e):{};r.value={actionType:D.AutoTaskActionType.QUERY_SINGLE_DATA,srcFilterType:t.srcFilterType||"field",srcFilterSql:t.srcFilterSql||"",srcDblinkId:t.srcDblinkId,srcTableName:t.srcTableName||"",srcDblinkType:t.srcDblinkType,srcFilterList:t.srcFilterList||[],selectFieldList:t.selectFieldList||[]}},{immediate:!0}),(0,g.wB)(()=>r.value.srcDblinkId,e=>{e?p(e).then(e=>{u.value=e}):u.value=[]}),(0,g.wB)(()=>r.value.srcTableName,()=>{v()},{immediate:!0}),(e,t)=>{const a=c.P9,l=c.AV,n=f.uD,i=y.S2,p=s.xE,v=b.ll,T=b.MQ,S=m.WK;return(0,g.uX)(),(0,g.CE)("div",Pa,[(0,g.bF)(p,{label:"源表"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).srcDblinkId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(r).srcDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:R},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).srcTableName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(r).srcTableName=e),clearable:"",filterable:"",placeholder:"请选择数据源表",onChange:F},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(p,{label:"源表过滤类型"},{default:(0,g.k6)(()=>[(0,g.bF)(T,{modelValue:(0,k.R1)(r).srcFilterType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(r).srcFilterType=e),onChange:d},{default:(0,g.k6)(()=>[(0,g.bF)(v,{value:"field"},{default:(0,g.k6)(()=>t[6]||(t[6]=[(0,g.eW)("字段过滤")])),_:1,__:[6]}),(0,g.bF)(v,{value:"sql"},{default:(0,g.k6)(()=>t[7]||(t[7]=[(0,g.eW)("自定义SQL")])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1}),"field"===(0,k.R1)(r).srcFilterType?((0,g.uX)(),(0,g.Wv)(Ge.A,{key:0,label:"源表过滤条件",data:(0,k.R1)(r).srcFilterList,addText:"添加",disabled:null==(0,k.R1)(r).srcTableName||""===(0,k.R1)(r).srcTableName,onAdd:t[3]||(t[3]=e=>E()),onEdit:E,onDelete:_,prop:{label:"filterColumnName",value:"filterColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterColumnName),1),(0,g.Lk)("span",Wa,(0,h.v_)((0,k.R1)(N.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,g.Lk)("span",Oa,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.valueType)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterValue),1)]),_:1},8,["data","disabled"])):((0,g.uX)(),(0,g.Wv)(S,{key:1,modelValue:(0,k.R1)(r).srcFilterSql,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(r).srcFilterSql=e),type:"textarea",rows:"5",placeholder:"重要！过滤值使用流程变量时需要手动输入，变量名的两边一定不要添加任何引号，如：name = ${variableName}",onChange:d},null,8,["modelValue"])),(0,g.bF)(p,{label:"查询字段"},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).selectFieldList,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(r).selectFieldList=e),clearable:"",filterable:"",multiple:"",placeholder:"查询仅返回选择的字段，如不选则返回所有字段",onChange:d},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(o),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])}}});const Ua=Ba;var za=Ua,Ka=a(68368);a(81208),a(47001);const Ma={class:"autotask-http-settting"},Xa={style:{margin:"0px 10px 0px 0px"}},qa={style:{margin:"0px 10px 0px 0px"}},$a={style:{margin:"0px 10px 0px 0px"}};var Qa=(0,g.pM)({__name:"AutoHttpTaskSetting",props:{modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix"),(0,g.WQ)("getAllAutoVariableList",()=>[])),o=(0,k.KR)({actionType:D.AutoTaskActionType.HTTP,httpRequestInfo:{url:"",httpMethod:"GET",headerList:[],bodyType:"formData",urlParamList:[],formDataList:[],rawType:"json",bodyData:""},httpResponnseData:{successStatusCode:"",successBodyField:"",errorMessageBodyField:"",failHandleType:"stop",httpResponseBody:[]}}),u=new Qe.w("Body类型",[{id:"formData",name:"form-data",symbol:"FORM_DATA"},{id:"raw",name:"raw",symbol:"RAW"}]),d=new Qe.w("Raw类型",[{id:"text",name:"text",symbol:"TEXT"},{id:"json",name:"json",symbol:"JSON"}]),p=new Qe.w("失败处理方式",[{id:"stop",name:"流程中止执行",symbol:"EXIT"},{id:"continue",name:"继续执行",symbol:"CONTINUE"}]),f=(0,g.EW)(()=>{let e=o.value.httpResponnseData.httpResponseBody.map(e=>({...e,disabled:"Object"!==e.fieldType&&"Array"!==e.fieldType}));return(0,$.BN)(e,"id","parentId")}),R=()=>{let e={...o.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},F=(e,t)=>{null==e?(null==o.value.httpRequestInfo.headerList&&(o.value.httpRequestInfo.headerList=[]),o.value.httpRequestInfo.headerList.push(t)):o.value.httpRequestInfo.headerList=o.value.httpRequestInfo.headerList.map(e=>e.key===t.key?t:e),R()},T=e=>{U.l.show("编辑请求头",Xe["default"],{area:["500px","300px"]},{entryId:n().entryId,data:e,usedKeyList:o.value.httpRequestInfo.headerList.map(e=>e.key),flowVariableList:i(),path:"thirdEditHttpHeader"},{width:"500px",height:"300px",pathName:"/thirdParty/thirdEditHttpHeader"}).then(t=>{F(e,t)}).catch(e=>{console.log(e)})},E=e=>{S.s.confirm("是否删除此请求头？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.value.httpRequestInfo.headerList=o.value.httpRequestInfo.headerList.filter(t=>t.key!==e.key),R()}).catch(e=>{console.log(e)})},_=(e,t)=>{null==e?(null==o.value.httpRequestInfo.urlParamList&&(o.value.httpRequestInfo.urlParamList=[]),o.value.httpRequestInfo.urlParamList.push(t)):o.value.httpRequestInfo.urlParamList=o.value.httpRequestInfo.urlParamList.map(e=>e.key===t.key?t:e),R()},w=e=>{U.l.show("编辑URL参数",qe["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,usedParamList:o.value.httpRequestInfo.urlParamList.map(e=>e.key),flowVariableList:i(),path:"thirdEditHttpUrlParam"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditHttpRequestParam"}).then(t=>{_(e,t)}).catch(e=>{console.log(e)})},A=e=>{S.s.confirm("是否删除此URL参数？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{o.value.httpRequestInfo.urlParamList=o.value.httpRequestInfo.urlParamList.filter(t=>t.key!==e.key),R()}).catch(e=>{console.log(e)})},x=(e,t)=>{null==o.value.httpRequestInfo.formDataList&&(o.value.httpRequestInfo.formDataList=[]),null==e?o.value.httpRequestInfo.formDataList.push(t):o.value.httpRequestInfo.formDataList=o.value.httpRequestInfo.formDataList.map(e=>e.key===t.key?t:e),R()},V=e=>{U.l.show("编辑Body参数",qe["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,usedParamList:o.value.httpRequestInfo.formDataList.map(e=>e.key),flowVariableList:i(),path:"thirdEditHttpBodyParam"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditHttpRequestParam"}).then(t=>{x(e,t)}).catch(e=>{console.log(e)})},C=e=>{S.s.confirm("是否删除此Body参数？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{o.value.httpRequestInfo.formDataList=o.value.httpRequestInfo.formDataList.filter(t=>t.key!==e.key),R()}).catch(e=>{console.log(e)})},L=(e,t)=>{function a(e,t){e.id=null==t||""===t?t+"."+e.fieldName:e.fieldName,Array.isArray(e.children)&&e.children.forEach(t=>{a(t,e.id)})}null==o.value.httpResponnseData.httpResponseBody&&(o.value.httpResponnseData.httpResponseBody=[]),null==e?o.value.httpResponnseData.httpResponseBody.push(t):o.value.httpResponnseData.httpResponseBody=o.value.httpResponnseData.httpResponseBody.map(e=>e.id===t.oldIId?(a(t,t.parentId),t):e),R()},N=e=>{U.l.show("编辑响应字段",$e["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,usedFieldList:f.value,path:"thirdEditResponseData"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditResponseData"}).then(t=>{L(e,t)}).catch(e=>{console.log(e)})},P=e=>{S.s.confirm("是否删除此响应字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{o.value.httpResponnseData.httpResponseBody=o.value.httpResponnseData.httpResponseBody.filter(t=>t.id!==e.id),R()}).catch(e=>{console.log(e)})};return(0,g.wB)(()=>l.modelValue,e=>{let t=e&&""!==e?JSON.parse(e):{};null==t.httpRequestInfo&&(t.httpRequestInfo={}),null==t.httpResponnseData&&(t.httpResponnseData={}),o.value={actionType:D.AutoTaskActionType.HTTP,httpRequestInfo:{url:t.httpRequestInfo.url||"",httpMethod:t.httpRequestInfo.httpMethod||"GET",headerList:t.httpRequestInfo.headerList||[],bodyType:t.httpRequestInfo.bodyType||"formData",urlParamList:t.httpRequestInfo.urlParamList||[],formDataList:t.httpRequestInfo.formDataList||[],rawType:t.httpRequestInfo.rawType||"json",bodyData:t.httpRequestInfo.bodyData||""},httpResponnseData:{successStatusCode:t.httpResponnseData.successStatusCode||"",successBodyField:t.httpResponnseData.successBodyField||"",errorMessageBodyField:t.httpResponnseData.errorMessageBodyField||"",failHandleType:t.httpResponnseData.failHandleType||"stop",httpResponseBody:t.httpResponnseData.httpResponseBody||[]}}},{immediate:!0}),(e,t)=>{const a=c.P9,l=c.AV,n=m.WK,i=s.xE,F=r.C4,_=Me.c6,S=Me.Iy,x=Me.dW,L=y.S2,W=b.ll,O=b.MQ,B=Ka.o8,U=v.S2,z=Ka.Up;return(0,g.uX)(),(0,g.CE)("div",Ma,[(0,g.bF)(i,{label:"API Url"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{placeholder:"请输入请求URL",modelValue:(0,k.R1)(o).httpRequestInfo.url,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(o).httpRequestInfo.url=e),onChange:R},{prepend:(0,g.k6)(()=>[(0,g.bF)(l,{class:"url-select",style:{width:"100px"},modelValue:(0,k.R1)(o).httpRequestInfo.httpMethod,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(o).httpRequestInfo.httpMethod=e),placeholder:"请选择",onChange:R},{default:(0,g.k6)(()=>[(0,g.bF)(a,{label:"GET",value:"GET"}),(0,g.bF)(a,{label:"POST",value:"POST"}),(0,g.bF)(a,{label:"PUT",value:"PUT"}),(0,g.bF)(a,{label:"DELETE",value:"DELETE"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(Ge.A,{label:"请求头设置",data:(0,k.R1)(o).httpRequestInfo.headerList,addText:"添加",onAdd:t[2]||(t[2]=e=>T()),onEdit:T,onDelete:E,prop:{label:"key",value:"key"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).key),1),t[13]||(t[13]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",Xa,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).srcValue),1)]),_:1},8,["data"]),(0,g.bF)(Ge.A,{label:"URL参数设置",data:(0,k.R1)(o).httpRequestInfo.urlParamList,addText:"添加",onAdd:t[3]||(t[3]=e=>w()),onEdit:w,onDelete:A,prop:{label:"name",value:"id"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).key),1),t[14]||(t[14]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",qa,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).srcValue),1)]),_:1},8,["data"]),(0,g.bF)(i,{labe:"请求Body类型"},{default:(0,g.k6)(()=>[(0,g.bF)(O,{modelValue:(0,k.R1)(o).httpRequestInfo.bodyType,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(o).httpRequestInfo.bodyType=e),onChange:R},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u).getList(),e=>((0,g.uX)(),(0,g.Wv)(W,{key:e.id,value:e.id},{default:(0,g.k6)(()=>[(0,g.bF)(L,{type:"flex",align:"middle"},{default:(0,g.k6)(()=>[(0,g.Lk)("span",null,(0,h.v_)(e.name),1),(0,k.R1)(o).httpRequestInfo.bodyType===(0,k.R1)(u).RAW&&e.id===(0,k.R1)(u).RAW?((0,g.uX)(),(0,g.Wv)(x,{key:0,style:{"margin-left":"10px"},onCommand:t[4]||(t[4]=e=>(0,k.R1)(o).httpRequestInfo.rawType=e)},{dropdown:(0,g.k6)(()=>[(0,g.bF)(S,null,{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(d).getList(),e=>((0,g.uX)(),(0,g.Wv)(_,{key:e.id,command:e.id},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(e.name),1)]),_:2},1032,["command"]))),128))]),_:2},1024)]),default:(0,g.k6)(()=>[(0,g.bF)(F,null,{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)((0,k.R1)(d).getValue((0,k.R1)(o).httpRequestInfo.rawType)),1)]),_:1})]),_:2},1024)):(0,g.Q3)("",!0)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,k.R1)(o).httpRequestInfo.bodyType===(0,k.R1)(u).FORM_DATA?((0,g.uX)(),(0,g.Wv)(Ge.A,{key:0,label:"Body参数设置",data:(0,k.R1)(o).httpRequestInfo.formDataList,addText:"添加",onAdd:t[6]||(t[6]=e=>V()),onEdit:V,onDelete:C,prop:{label:"name",value:"id"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).key),1),t[15]||(t[15]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",$a,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).srcValue),1)]),_:1},8,["data"])):(0,g.Q3)("",!0),(0,k.R1)(o).httpRequestInfo.bodyType===(0,k.R1)(u).RAW?((0,g.uX)(),(0,g.Wv)(i,{key:1,label:"Body参数设置"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpRequestInfo.bodyData,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(o).httpRequestInfo.bodyData=e),type:"textarea",rows:"5",clearable:"",placeholder:"请输入请求Body",onChange:R},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),(0,g.bF)(i,{label:"请求成功的HTTP状态码"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpResponnseData.successStatusCode,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.R1)(o).httpResponnseData.successStatusCode=e),clearable:"",placeholder:"示例：200,201 (多个状态码使用英文逗号分隔)",onChange:R},null,8,["modelValue"])]),_:1}),(0,g.bF)(i,{label:"请求成功字段"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpResponnseData.successBodyField,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,k.R1)(o).httpResponnseData.successBodyField=e),clearable:"",placeholder:"示例：data.isSuccess 请求成功情况下，进一步判断是否成功字段",onChange:R},null,8,["modelValue"])]),_:1}),(0,g.bF)(i,{label:"失败信息字段"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(o).httpResponnseData.errorMessageBodyField,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,k.R1)(o).httpResponnseData.errorMessageBodyField=e),clearable:"",placeholder:"示例：data.message 请求成功情况下，返回的失败信息字段",onChange:R},null,8,["modelValue"])]),_:1}),(0,g.bF)(i,{label:"请求失败处理方式"},{default:(0,g.k6)(()=>[(0,g.bF)(O,{modelValue:(0,k.R1)(o).httpResponnseData.failHandleType,"onUpdate:modelValue":t[11]||(t[11]=e=>(0,k.R1)(o).httpResponnseData.failHandleType=e),onChange:R},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(p).getList(),e=>((0,g.uX)(),(0,g.Wv)(W,{key:e.id,value:e.id},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(i,{label:"响应数据"},{default:(0,g.k6)(()=>[(0,g.bF)(z,{"show-header":!1,data:(0,k.R1)(f),size:"mini","row-key":"id","tree-props":{children:"children"}},{default:(0,g.k6)(()=>[(0,g.bF)(B,{prop:"fieldName",label:"字段名"}),(0,g.bF)(B,{prop:"fieldType",label:"字段类型",width:"100px"}),(0,g.bF)(B,{label:"操作",width:"120px"},{default:(0,g.k6)(e=>[(0,g.bF)(U,{type:"primary",link:"",size:"small",onClick:t=>N(e.row)},{default:(0,g.k6)(()=>t[16]||(t[16]=[(0,g.eW)(" 编辑 ")])),_:2,__:[16]},1032,["onClick"]),(0,g.bF)(U,{type:"primary",link:"",size:"small",onClick:t=>P(e.row)},{default:(0,g.k6)(()=>t[17]||(t[17]=[(0,g.eW)(" 删除 ")])),_:2,__:[17]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),(0,g.bF)(U,{type:"primary",plain:"",size:"small",icon:(0,k.R1)(I.Plus),style:{width:"100%"},onClick:t[12]||(t[12]=e=>N())},{default:(0,g.k6)(()=>t[18]||(t[18]=[(0,g.eW)(" 添加响应字段 ")])),_:1,__:[18]},8,["icon"])]),_:1})])}}});const Ga=(0,_e.A)(Qa,[["__scopeId","data-v-0b079317"]]);var ja=Ga;const Ja={class:"autotask-update-settting"},Ha={style:{margin:"0px 10px"}},Ya={style:{margin:"0px 10px 0px 0px"}},Za={style:{margin:"0px 10px 0px 0px"}};var el=(0,g.pM)({__name:"AutoUpdateTaskSetting",props:{modelValue:{},flowDblinkList:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix"),(0,g.WQ)("getAllAutoVariableList",()=>[])),r=(0,k.KR)({actionType:D.AutoTaskActionType.UPDATE,destDblinkId:void 0,destDblinkType:void 0,destTableName:void 0,destFilterType:"field",destFilterList:[],destFilterSql:"",updateDataList:[]}),o=(0,k.KR)([]),u=()=>{let e={...r.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},d=async e=>{let t=await C.V7.listDblinkTables({dblinkId:e});return Array.isArray(t.data)?t.data.map(e=>e.tableName):[]},p=(e,t)=>{null==e?r.value.updateDataList.push(t):r.value.updateDataList=r.value.updateDataList.map(e=>e.destColumnName===t.destColumnName?t:e),u()},v=e=>{U.l.show("编辑更新字段",Ia["default"],{area:["500px","300px"]},{entryId:n().entryId,data:e,dblinkId:r.value.destDblinkId,tableName:r.value.destTableName,flowVariableList:i(),path:"thirdEditUpdateField"},{width:"500px",height:"300px",pathName:"/thirdParty/thirdEditFieldUpdateData"}).then(t=>{p(e,t)}).catch(e=>{console.log(e)})},R=e=>{S.s.confirm("是否删除此字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.updateDataList=r.value.updateDataList.filter(t=>t.destColumnName!==e.destColumnName),u()}).catch(e=>{console.log(e)})},F=(e,t)=>{null==e?r.value.destFilterList.push(t):r.value.destFilterList=r.value.destFilterList.map(e=>e.filterColumnName===t.filterColumnName?t:e),u()},T=e=>{U.l.show("编辑过滤字段",wa["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,dblinkId:r.value.destDblinkId,tableName:r.value.destTableName,flowVariableList:i(),path:"thirdEditDestFilter"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditTableFilter"}).then(t=>{F(e,t)}).catch(e=>{console.log(e)})},E=e=>{S.s.confirm("是否删除此过滤字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.destFilterList=r.value.destFilterList.filter(t=>t.filterColumnName!==e.filterColumnName),u()}).catch(e=>{console.log(e)})},_=e=>{r.value.destTableName="",r.value.destDblinkType=(l.flowDblinkList.find(t=>t.id===e)||{}).type,r.value.updateDataList=[],u()},I=()=>{r.value.updateDataList=[],u()};return(0,g.wB)(()=>l.modelValue,e=>{if(e){let t=e&&""!==e?JSON.parse(e):{};r.value={actionType:D.AutoTaskActionType.UPDATE,destDblinkId:t.destDblinkId,destDblinkType:t.destDblinkType,destTableName:t.destTableName,destFilterType:t.destFilterType||"field",destFilterList:t.destFilterList||[],destFilterSql:t.destFilterSql||"",updateDataList:t.updateDataList||[]}}},{immediate:!0}),(0,g.wB)(()=>r.value.destDblinkId,e=>{e?d(e).then(e=>{o.value=e}):o.value=[]}),(e,t)=>{const a=c.P9,l=c.AV,n=f.uD,i=y.S2,d=s.xE,p=b.ll,F=b.MQ,S=m.WK;return(0,g.uX)(),(0,g.CE)("div",Ja,[(0,g.bF)(d,{label:"目标表"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).destDblinkId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(r).destDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:_},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).destTableName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(r).destTableName=e),clearable:"",filterable:"",placeholder:"请选择数据目标表",onChange:I},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(o),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(d,{label:"目标表过滤类型"},{default:(0,g.k6)(()=>[(0,g.bF)(F,{modelValue:(0,k.R1)(r).destFilterType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(r).destFilterType=e),onChange:u},{default:(0,g.k6)(()=>[(0,g.bF)(p,{value:"field"},{default:(0,g.k6)(()=>t[6]||(t[6]=[(0,g.eW)("字段过滤")])),_:1,__:[6]}),(0,g.bF)(p,{value:"sql"},{default:(0,g.k6)(()=>t[7]||(t[7]=[(0,g.eW)("自定义SQL")])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1}),"field"===(0,k.R1)(r).destFilterType?((0,g.uX)(),(0,g.Wv)(Ge.A,{key:0,label:"目标表过滤条件",data:(0,k.R1)(r).destFilterList,addText:"添加",disabled:null==(0,k.R1)(r).destTableName||""===(0,k.R1)(r).destTableName,onAdd:t[3]||(t[3]=e=>T()),onEdit:T,onDelete:E,prop:{label:"filterColumnName",value:"filterColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterColumnName),1),(0,g.Lk)("span",Ha,(0,h.v_)((0,k.R1)(N.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,g.Lk)("span",Ya,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.valueType)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterValue),1)]),_:1},8,["data","disabled"])):((0,g.uX)(),(0,g.Wv)(S,{key:1,style:{"margin-bottom":"10px"},modelValue:(0,k.R1)(r).destFilterSql,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(r).destFilterSql=e),type:"textarea",rows:"5",onChange:u},null,8,["modelValue"])),(0,g.bF)(Ge.A,{label:"数据更新配置",data:(0,k.R1)(r).updateDataList,addText:"添加",disabled:null==(0,k.R1)(r).destTableName||""===(0,k.R1)(r).destTableName,onAdd:t[5]||(t[5]=e=>v()),onEdit:v,onDelete:R,prop:{label:"destColumnName",value:"destColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)(e.data.destColumnName),1),t[8]||(t[8]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",Za,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.type)),1),(0,g.Lk)("span",null,(0,h.v_)(e.data.srcValue),1)]),_:1},8,["data","disabled"])])}}});const tl=el;var al=tl;const ll={class:"autotask-delete-settting"},nl={style:{margin:"0px 10px"}},il={style:{margin:"0px 10px 0px 0px"}};var sl=(0,g.pM)({__name:"AutoDeleteTaskSetting",props:{modelValue:{},flowDblinkList:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix"),(0,g.WQ)("getAllAutoVariableList",()=>[])),r=(0,k.KR)({actionType:D.AutoTaskActionType.DELETE,destDblinkId:void 0,destDblinkType:void 0,destTableName:null,destFilterType:"field",destFilterList:[],destFilterSql:"",logicDeleteField:""}),o=(0,k.KR)([]),u=(0,k.KR)([]),d=()=>{let e={...r.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},p=async e=>{let t=await C.V7.listDblinkTables({dblinkId:e});return Array.isArray(t.data)?t.data.map(e=>e.tableName):[]},v=(e,t)=>{null==e?r.value.destFilterList.push(t):r.value.destFilterList=r.value.destFilterList.map(e=>e.filterColumnName===t.filterColumnName?t:e),d()},R=e=>{U.l.show("编辑过滤字段",wa["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,dblinkId:r.value.destDblinkId,tableName:r.value.destTableName,flowVariableList:i(),path:"thirdEditDeleteFilter"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditTableFilter"}).then(t=>{v(e,t)}).catch(e=>{console.log(e)})},F=e=>{S.s.confirm("是否删除此过滤字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.destFilterList=r.value.destFilterList.filter(t=>t.filterColumnName!==e.filterColumnName),d()}).catch(e=>{console.log(e)})},T=e=>{r.value.destTableName="",r.value.destDblinkType=((l.flowDblinkList||[]).find(t=>t.id===e)||{}).type,d()},E=e=>{d()};return(0,g.wB)(()=>l.modelValue,e=>{if(e){let t=e&&""!==e?JSON.parse(e):{};r.value={actionType:D.AutoTaskActionType.DELETE,destDblinkId:t.destDblinkId,destDblinkType:t.destDblinkType,destTableName:t.destTableName,destFilterType:t.destFilterType||"field",destFilterList:t.destFilterList||[],destFilterSql:t.destFilterSql||"",logicDeleteField:t.logicDeleteField||""}}},{immediate:!0}),(0,g.wB)(()=>r.value.destDblinkId,e=>{e?p(e).then(e=>{o.value=e}):o.value=[]},{immediate:!0}),(0,g.wB)(()=>r.value.destTableName,e=>{e?C.V7.listDblinkTableColumns({dblinkId:r.value.destDblinkId,tableName:e}).then(e=>{u.value=e.data}):u.value=[]}),(e,t)=>{const a=c.P9,n=c.AV,i=f.uD,p=y.S2,v=s.xE,_=b.ll,S=b.MQ,I=m.WK;return(0,g.uX)(),(0,g.CE)("div",ll,[(0,g.bF)(v,{label:"目标表"},{default:(0,g.k6)(()=>[(0,g.bF)(p,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(i,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(r).destDblinkId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(r).destDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:T},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(l.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(i,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(r).destTableName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(r).destTableName=e),clearable:"",filterable:"",placeholder:"请选择数据目标表",onChange:E},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(o),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(v,{label:"逻辑删除字段"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(r).logicDeleteField,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(r).logicDeleteField=e),clearable:"",filterable:"",placeholder:"请选择逻辑删除字段",onChange:d},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(v,{label:"目标表过滤类型"},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(r).destFilterType,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(r).destFilterType=e),onChange:d},{default:(0,g.k6)(()=>[(0,g.bF)(_,{value:"field"},{default:(0,g.k6)(()=>t[6]||(t[6]=[(0,g.eW)("字段过滤")])),_:1,__:[6]}),(0,g.bF)(_,{value:"sql"},{default:(0,g.k6)(()=>t[7]||(t[7]=[(0,g.eW)("自定义SQL")])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1}),"field"===(0,k.R1)(r).destFilterType?((0,g.uX)(),(0,g.Wv)(Ge.A,{key:0,label:"目标表过滤条件",data:(0,k.R1)(r).destFilterList,addText:"添加",disabled:null==(0,k.R1)(r).destTableName||""===(0,k.R1)(r).destTableName,onAdd:t[4]||(t[4]=e=>R()),onEdit:R,onDelete:F,prop:{label:"filterColumnName",value:"filterColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterColumnName),1),(0,g.Lk)("span",nl,(0,h.v_)((0,k.R1)(N.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,g.Lk)("span",il,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.valueType)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterValue),1)]),_:1},8,["data","disabled"])):((0,g.uX)(),(0,g.Wv)(I,{key:1,modelValue:(0,k.R1)(r).destFilterSql,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(r).destFilterSql=e),type:"textarea",rows:"5",onChange:d},null,8,["modelValue"]))])}}});const rl=sl;var ol=rl,ul=a(78935);const dl={class:"autotask-aggregation-settting"},pl={style:{margin:"0px 10px"}},ml={style:{margin:"0px 10px 0px 0px"}};var cl=(0,g.pM)({__name:"AutoAggregationTaskSetting",props:{modelValue:{},flowDblinkList:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix"),(0,g.WQ)("getAllAutoVariableList",()=>[])),r=(0,k.KR)({actionType:D.AutoTaskActionType.AGGREGATE,srcDblinkId:void 0,srcDblinkType:void 0,srcTableName:void 0,srcFilterType:"field",srcFilterList:[],srcFilterSql:void 0,aggregationDataList:[]}),o=(0,k.KR)([]),u=(0,k.KR)([]),d=()=>{let e={...r.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},p=async e=>{let t=await C.V7.listDblinkTables({dblinkId:e});return Array.isArray(t.data)?t.data.map(e=>e.tableName):[]},v=()=>{null!=r.value.srcDblinkId&&null!=r.value.srcTableName&&""!==r.value.srcTableName&&""!==r.value.srcDblinkId?C.V7.listDblinkTableColumns({dblinkId:r.value.srcDblinkId,tableName:r.value.srcTableName}).then(e=>{o.value=e.data}):o.value=[]},R=e=>{r.value.srcTableName="",r.value.srcDblinkType=(l.flowDblinkList.find(t=>t.id===e)||{}).type,r.value.srcFilterSql="",r.value.srcFilterList=[],d()},F=()=>{r.value.srcFilterSql="",r.value.srcFilterList=[],d()},T=(e,t)=>{null==e?r.value.srcFilterList.push(t):r.value.srcFilterList=r.value.srcFilterList.map(e=>e.srcTableName===t.srcTableName?t:e),d()},E=e=>{U.l.show("编辑过滤字段",wa["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,dblinkId:r.value.srcDblinkId,tableName:r.value.srcTableName,flowVariableList:i(),path:"thirdEditAggregationFilter"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditTableFilter"}).then(t=>{T(e,t)}).catch(e=>{console.log(e)})},_=e=>{S.s.confirm("是否删除此过滤字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.srcFilterList=r.value.srcFilterList.filter(t=>t.filterColumnName!==e.filterColumnName),d()}).catch(e=>{console.log(e)})},I=(e,t)=>{null==e?r.value.aggregationDataList.push(t):r.value.aggregationDataList=r.value.aggregationDataList.map(e=>e.id===t.id?t:e),d()},w=e=>{U.l.show("编辑聚合字段",ul["default"],{area:["500px","400px"]},{data:e,srcDblinkId:r.value.srcDblinkId,srcTableName:r.value.srcTableName,flowVariableList:i(),path:"thirdEditAggregationData"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditAggregationData"}).then(t=>{I(e,t)}).catch(e=>{console.log(e)})},A=e=>{S.s.confirm("是否删除此聚合字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.aggregationDataList=r.value.aggregationDataList.filter(t=>t.id!==e.id),d()}).catch(e=>{console.log(e)})};return(0,g.wB)(()=>l.modelValue,e=>{let t=e&&""!==e?JSON.parse(e):{};r.value={actionType:D.AutoTaskActionType.AGGREGATE,srcFilterType:t.srcFilterType||"field",srcFilterSql:t.srcFilterSql||"",srcDblinkId:t.srcDblinkId,srcTableName:t.srcTableName||"",srcDblinkType:t.srcDblinkType,srcFilterList:t.srcFilterList||[],aggregationDataList:t.aggregationDataList||[]}},{immediate:!0}),(0,g.wB)(()=>r.value.srcDblinkId,e=>{e?p(e).then(e=>{u.value=e}):u.value=[]},{immediate:!0}),(0,g.wB)(()=>r.value.srcTableName,e=>{v()},{immediate:!0}),(e,t)=>{const a=c.P9,l=c.AV,n=f.uD,i=y.S2,o=s.xE,p=b.ll,v=b.MQ,T=m.WK;return(0,g.uX)(),(0,g.CE)("div",dl,[(0,g.bF)(o,{label:"源表"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).srcDblinkId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(r).srcDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:R},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(n,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(l,{modelValue:(0,k.R1)(r).srcTableName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(r).srcTableName=e),clearable:"",filterable:"",placeholder:"请选择数据源表",onChange:F},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(u),e=>((0,g.uX)(),(0,g.Wv)(a,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(o,{label:"源表过滤类型"},{default:(0,g.k6)(()=>[(0,g.bF)(v,{modelValue:(0,k.R1)(r).srcFilterType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(r).srcFilterType=e),onChange:d},{default:(0,g.k6)(()=>[(0,g.bF)(p,{value:"field"},{default:(0,g.k6)(()=>t[6]||(t[6]=[(0,g.eW)("字段过滤")])),_:1,__:[6]}),(0,g.bF)(p,{value:"sql"},{default:(0,g.k6)(()=>t[7]||(t[7]=[(0,g.eW)("自定义SQL")])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1}),"field"===(0,k.R1)(r).srcFilterType?((0,g.uX)(),(0,g.Wv)(Ge.A,{key:0,label:"源表过滤条件",data:(0,k.R1)(r).srcFilterList,addText:"添加",disabled:null==(0,k.R1)(r).srcTableName||""===(0,k.R1)(r).srcTableName,onAdd:t[3]||(t[3]=e=>E()),onEdit:E,onDelete:_,prop:{label:"filterColumnName",value:"id"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterColumnName),1),(0,g.Lk)("span",pl,(0,h.v_)((0,k.R1)(N.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,g.Lk)("span",ml,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.valueType)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterValue),1)]),_:1},8,["data","disabled"])):((0,g.uX)(),(0,g.Wv)(T,{key:1,modelValue:(0,k.R1)(r).srcFilterSql,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(r).srcFilterSql=e),type:"textarea",rows:"5",placeholder:"重要！过滤值使用流程变量时需要手动输入，变量名的两边一定不要添加任何引号，如：name = ${variableName}",onChange:d},null,8,["modelValue"])),(0,g.bF)(Ge.A,{label:"聚合字段",data:(0,k.R1)(r).aggregationDataList,addText:"添加",disabled:null==(0,k.R1)(r).srcTableName||""===(0,k.R1)(r).srcTableName,onAdd:t[5]||(t[5]=e=>w()),onEdit:w,onDelete:A,prop:{label:"aggregationFunction",value:"id"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)(e.data.alias),1),t[8]||(t[8]=(0,g.Lk)("span",{style:{margin:"0px 10px"}},"等于",-1)),(0,g.Lk)("span",null,(0,h.v_)(e.data.aggregationFunction+"("+e.data.aggregationColumn+")"),1)]),_:1},8,["data","disabled"])])}}});const bl=cl;var yl=bl,vl=a(51365);const fl={class:"autotask-calc-settting"};var gl=(0,g.pM)({__name:"AutoCalcTaskSetting",props:{modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,k.KR)({actionType:D.AutoTaskActionType.FORMULA,calculateFormula:"",formulaConfig:""}),i=(0,g.WQ)("getAllAutoVariableList",()=>[]),r=e=>{U.l.show("编辑表达式",vl["default"],{area:["1000px","700px"]},{data:e,flowVariableList:i()},{width:"1000px",height:"700px",pathName:"/thirdParty/thirdEditFormulaData"}).then(e=>{n.value.formulaConfig=e,o(e)}).catch(()=>{console.log("取消")})},o=e=>{n.value.formulaConfig=e,n.value.calculateFormula="";let t=[];null!=e&&""!==e&&(t=JSON.parse(e)),Array.isArray(t)&&t.length>0&&(n.value.calculateFormula=t.reduce((e,t)=>{let a="";return t.itemKind===N.FormulaItemKind.OPERATOR?a=t.itemCode:t.itemKind===N.FormulaItemKind.NUMBER?a=t.itemName:t.itemKind===N.FormulaItemKind.STRING?a="'"+t.itemName+"'":t.itemKind===N.FormulaItemKind.VARABLE&&(a="${"+t.itemCode+"}"),""!==a&&""!==e&&(e+=" "),e+a},"")),u()},u=()=>{let e={...n.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))};return(0,g.wB)(()=>l.modelValue,e=>{if(e){let t=e&&""!==e?JSON.parse(e):{};n.value={actionType:D.AutoTaskActionType.FORMULA,calculateFormula:t.calculateFormula||"",formulaConfig:t.formulaConfig||""}}},{immediate:!0}),(e,t)=>{const a=v.S2,l=y.S2,i=m.WK,o=s.xE;return(0,g.uX)(),(0,g.CE)("div",fl,[(0,g.bF)(o,{label:"表达式",prop:"calculateFormula"},{label:(0,g.k6)(()=>[(0,g.bF)(l,{type:"flex",justify:"space-between"},{default:(0,g.k6)(()=>[t[3]||(t[3]=(0,g.Lk)("span",null,"表达式",-1)),(0,g.bF)(a,{size:"small",link:"",type:"primary",onClick:t[0]||(t[0]=e=>r((0,k.R1)(n).formulaConfig))},{default:(0,g.k6)(()=>t[2]||(t[2]=[(0,g.eW)(" 编辑 ")])),_:1,__:[2]})]),_:1,__:[3]})]),default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:(0,k.R1)(n).calculateFormula,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(n).calculateFormula=e),type:"textarea",placeholder:"请输入表达式",clearable:"",rows:"7",readonly:"",onChange:u},null,8,["modelValue"])]),_:1})])}}});const kl=gl;var hl=kl;const Rl={class:"autotask-load-cache-settting"},Fl={key:0,class:"cache-key-from-sql"},Tl={style:{margin:"0px 10px"}},El={style:{margin:"0px 10px 0px 0px"}},_l={key:1,class:"cache-key-not-from-sql"};var Sl=(0,g.pM)({__name:"AutoLoadCache",props:{modelValue:{},flowDblinkList:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,k.KR)({actionType:D.AutoTaskActionType.LOAD_CACHE,cacheKeyPrefix:"",cacheKeyFromSql:!1,srcFilterType:"field",srcFilterList:[],srcTableName:null,srcFilterSql:"",selectFieldList:[],cacheKeyFieldNames:[],cacheValueFieldNames:[],cacheValueType:D.AutoTaskCacheValueType.STRING}),i=(0,k.KR)([]),r=(0,k.KR)([]),u=(0,g.WQ)("flowEntry",()=>({})),p=(0,g.WQ)("getAllAutoVariableList",()=>[]),v=()=>{let e={...n.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},R=async e=>{let t=await C.V7.listDblinkTables({dblinkId:e});return Array.isArray(t.data)?t.data.map(e=>e.tableName):[]},F=()=>{null!=n.value.srcDblinkId&&null!=n.value.srcTableName&&""!=n.value.srcTableName&&""!=n.value.srcDblinkId?C.V7.listDblinkTableColumns({dblinkId:n.value.srcDblinkId,tableName:n.value.srcTableName}).then(e=>{i.value=e.data}):i.value=[]},T=e=>{n.value.srcTableName="",n.value.srcDblinkType=(l.flowDblinkList.find(t=>t.id==e)||{}).type,n.value.srcFilterSql="",n.value.srcFilterList=[],v()},E=()=>{n.value.srcFilterSql="",n.value.srcFilterList=[],v()},_=(e,t)=>{null==e?n.value.srcFilterList.push(t):n.value.srcFilterList=n.value.srcFilterList.map(e=>e.srcTableName==t.srcTableName?t:e),v()},w=e=>{U.l.show("编辑过滤字段",wa["default"],{area:["500px","400px"]},{entryId:u().entryId,data:e,dblinkId:n.value.srcDblinkId,tableName:n.value.srcTableName,flowVariableList:p(),path:"thirdEditQuerySingleFilter"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditTableFilter"}).then(t=>{_(e,t)}).catch(e=>{console.log(e)})},A=e=>{S.s.confirm("是否删除此过滤字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n.value.srcFilterList=n.value.srcFilterList.filter(t=>t.filterColumnName!==e.filterColumnName),v()}).catch(e=>{console.log(e)})};return(0,g.wB)(()=>l.modelValue,e=>{let t=e&&""!==e?JSON.parse(e):{};n.value={cacheKeyPrefix:t.cacheKeyPrefix||"",cacheKeyFromSql:t.cacheKeyFromSql||!1,cacheKey:t.cacheKey,cacheValue:t.cacheValue,actionType:D.AutoTaskActionType.LOAD_CACHE,srcFilterType:t.srcFilterType||"field",srcFilterSql:t.srcFilterSql||"",srcDblinkId:t.srcDblinkId,srcTableName:t.srcTableName||"",srcDblinkType:t.srcDblinkType,srcFilterList:t.srcFilterList||[],selectFieldList:t.selectFieldList||[],cacheKeyFieldNames:t.cacheKeyFieldNames||[],cacheValueFieldNames:t.cacheValueFieldNames||[],cacheExpireMinutes:t.cacheExpireMinutes,cacheValueType:t.cacheValueType||D.AutoTaskCacheValueType.STRING,cacheMapKey:t.cacheMapKey}},{immediate:!0}),(0,g.wB)(()=>n.value.srcDblinkId,e=>{e?R(e).then(e=>{r.value=e}):r.value=[]}),(0,g.wB)(()=>n.value.srcTableName,()=>{F()},{immediate:!0}),(e,t)=>{const a=Ke.tk,l=G.R7,u=m.WK,p=s.xE,R=o.qi,F=c.P9,_=c.AV,S=f.uD,x=y.S2,V=b.ll,C=b.MQ,L=Ge.A,P=d.lq;return(0,g.uX)(),(0,g.CE)("div",Rl,[(0,g.bF)(p,{label:"缓存键前缀"},{label:(0,g.k6)(()=>[t[13]||(t[13]=(0,g.Lk)("span",null,"缓存键前缀 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"缓存键前缀，推荐以冒号结尾",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(u,{modelValue:(0,k.R1)(n).cacheKeyPrefix,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(n).cacheKeyPrefix=e),onChange:v,placeholder:"缓存键前缀，推荐以冒号结尾"},null,8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"缓存数据来自结果集"},{default:(0,g.k6)(()=>[(0,g.bF)(R,{modelValue:(0,k.R1)(n).cacheKeyFromSql,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(n).cacheKeyFromSql=e),onChange:v},null,8,["modelValue"])]),_:1}),(0,k.R1)(n).cacheKeyFromSql?((0,g.uX)(),(0,g.CE)("div",Fl,[(0,g.bF)(p,{label:"源表"},{default:(0,g.k6)(()=>[(0,g.bF)(x,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(_,{modelValue:(0,k.R1)(n).srcDblinkId,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(n).srcDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:T},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(F,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(S,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(_,{modelValue:(0,k.R1)(n).srcTableName,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(n).srcTableName=e),clearable:"",filterable:"",placeholder:"请选择数据源表",onChange:E},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(r),e=>((0,g.uX)(),(0,g.Wv)(F,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(p,{label:"源表过滤类型"},{default:(0,g.k6)(()=>[(0,g.bF)(C,{modelValue:(0,k.R1)(n).srcFilterType,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(n).srcFilterType=e),onChange:v},{default:(0,g.k6)(()=>[(0,g.bF)(V,{value:"field"},{default:(0,g.k6)(()=>t[14]||(t[14]=[(0,g.eW)("字段过滤")])),_:1,__:[14]}),(0,g.bF)(V,{value:"sql"},{default:(0,g.k6)(()=>t[15]||(t[15]=[(0,g.eW)("自定义SQL")])),_:1,__:[15]})]),_:1},8,["modelValue"])]),_:1}),"field"==(0,k.R1)(n).srcFilterType?((0,g.uX)(),(0,g.Wv)(L,{key:0,label:"源表过滤条件",data:(0,k.R1)(n).srcFilterList,addText:"添加",disabled:null==(0,k.R1)(n).srcTableName||""==(0,k.R1)(n).srcTableName,onAdd:t[5]||(t[5]=e=>w()),onEdit:w,onDelete:A,prop:{label:"filterColumnName",value:"filterColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterColumnName),1),(0,g.Lk)("span",Tl,(0,h.v_)((0,k.R1)(N.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,g.Lk)("span",El,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.valueType)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterValue),1)]),_:1},8,["data","disabled"])):((0,g.uX)(),(0,g.Wv)(u,{key:1,modelValue:(0,k.R1)(n).srcFilterSql,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,k.R1)(n).srcFilterSql=e),type:"textarea",rows:"5",placeholder:"重要！过滤值使用流程变量时需要手动输入，变量名的两边一定不要添加任何引号，如：name = ${variableName}",onChange:v},null,8,["modelValue"])),(0,g.bF)(p,{label:"查询字段"},{default:(0,g.k6)(()=>[(0,g.bF)(_,{modelValue:(0,k.R1)(n).selectFieldList,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(n).selectFieldList=e),clearable:"",filterable:"",multiple:"",placeholder:"查询仅返回选择的字段，如不选则返回所有字段",onChange:v},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(i),e=>((0,g.uX)(),(0,g.Wv)(F,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"缓存键字段"},{default:(0,g.k6)(()=>[(0,g.bF)(_,{modelValue:(0,k.R1)(n).cacheKeyFieldNames,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.R1)(n).cacheKeyFieldNames=e),clearable:"",filterable:"",multiple:"",placeholder:"根据所选顺序组成缓存键",onChange:v},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(n).selectFieldList,e=>((0,g.uX)(),(0,g.Wv)(F,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"缓存值字段"},{default:(0,g.k6)(()=>[(0,g.bF)(_,{modelValue:(0,k.R1)(n).cacheValueFieldNames,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,k.R1)(n).cacheValueFieldNames=e),clearable:"",filterable:"",multiple:"",onChange:v},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(n).selectFieldList,e=>((0,g.uX)(),(0,g.Wv)(F,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])):((0,g.uX)(),(0,g.CE)("div",_l,[(0,g.bF)(p,{label:"缓存键"},{label:(0,g.k6)(()=>[t[16]||(t[16]=(0,g.Lk)("span",null,"缓存键 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"缓存键支持使用变量，变量名可用 ${} 表示",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(u,{modelValue:(0,k.R1)(n).cacheKey,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,k.R1)(n).cacheKey=e),onChange:v,placeholder:"缓存键支持使用变量，变量名可用 ${} 表示"},null,8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"缓存值"},{label:(0,g.k6)(()=>[t[17]||(t[17]=(0,g.Lk)("span",null,"缓存值 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"缓存值支持使用变量，变量名可用 ${} 表示",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(u,{modelValue:(0,k.R1)(n).cacheValue,"onUpdate:modelValue":t[11]||(t[11]=e=>(0,k.R1)(n).cacheValue=e),onChange:v,placeholder:"缓存值支持使用变量，变量名可用 ${} 表示"},null,8,["modelValue"])]),_:1})])),(0,g.bF)(p,{label:"缓存过期时间 (分钟)"},{default:(0,g.k6)(()=>[(0,g.bF)(P,{modelValue:(0,k.R1)(n).cacheExpireMinutes,"onUpdate:modelValue":t[12]||(t[12]=e=>(0,k.R1)(n).cacheExpireMinutes=e),"controls-position":"right",style:{width:"100%"},min:1,max:99999,placeholder:"缓存过期时间 (分钟)",onChange:v},null,8,["modelValue"])]),_:1})])}}});const Il=Sl;var wl=Il;const Al={class:"autotask-delete-cache-settting"},xl={key:0,class:"cache-key-from-sql"},Vl={style:{margin:"0px 10px"}},Cl={style:{margin:"0px 10px 0px 0px"}},Ll={key:1,class:"cache-key-not-from-sql"};var Dl=(0,g.pM)({__name:"AutoDeleteCache",props:{modelValue:{},flowDblinkList:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,k.KR)({actionType:D.AutoTaskActionType.DELETE_CACHE,cacheKeyPrefix:"",cacheKeyFromSql:!1,srcFilterType:"field",srcFilterList:[],srcTableName:null,srcFilterSql:"",selectFieldList:[],cacheKeyFieldNames:[],cacheValueType:D.AutoTaskCacheValueType.STRING}),i=(0,k.KR)([]),r=(0,k.KR)([]),u=(0,g.WQ)("flowEntry",()=>({})),d=(0,g.WQ)("getAllAutoVariableList",()=>[]),p=()=>{let e={...n.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},v=async e=>{let t=await C.V7.listDblinkTables({dblinkId:e});return Array.isArray(t.data)?t.data.map(e=>e.tableName):[]},R=()=>{null!=n.value.srcDblinkId&&null!=n.value.srcTableName&&""!=n.value.srcTableName&&""!=n.value.srcDblinkId?C.V7.listDblinkTableColumns({dblinkId:n.value.srcDblinkId,tableName:n.value.srcTableName}).then(e=>{i.value=e.data}):i.value=[]},F=e=>{n.value.srcTableName="",n.value.srcDblinkType=(l.flowDblinkList.find(t=>t.id==e)||{}).type,n.value.srcFilterSql="",n.value.srcFilterList=[],p()},T=()=>{n.value.srcFilterSql="",n.value.srcFilterList=[],p()},E=(e,t)=>{null==e?n.value.srcFilterList.push(t):n.value.srcFilterList=n.value.srcFilterList.map(e=>e.srcTableName==t.srcTableName?t:e),p()},_=e=>{U.l.show("编辑过滤字段",wa["default"],{area:["500px","400px"]},{entryId:u().entryId,data:e,dblinkId:n.value.srcDblinkId,tableName:n.value.srcTableName,flowVariableList:d(),path:"thirdEditQuerySingleFilter"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditTableFilter"}).then(t=>{E(e,t)}).catch(e=>{console.log(e)})},w=e=>{S.s.confirm("是否删除此过滤字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n.value.srcFilterList=n.value.srcFilterList.filter(t=>t.filterColumnName!==e.filterColumnName),p()}).catch(e=>{console.log(e)})};return(0,g.wB)(()=>l.modelValue,e=>{let t=e&&""!==e?JSON.parse(e):{};n.value={cacheKeyPrefix:t.cacheKeyPrefix||"",cacheKeyFromSql:t.cacheKeyFromSql||!1,cacheKey:t.cacheKey,actionType:D.AutoTaskActionType.DELETE_CACHE,srcFilterType:t.srcFilterType||"field",srcFilterSql:t.srcFilterSql||"",srcDblinkId:t.srcDblinkId,srcTableName:t.srcTableName||"",srcDblinkType:t.srcDblinkType,srcFilterList:t.srcFilterList||[],selectFieldList:t.selectFieldList||[],cacheKeyFieldNames:t.cacheKeyFieldNames||[],cacheValueType:t.cacheValueType||D.AutoTaskCacheValueType.STRING,cacheMapKey:t.cacheMapKey}},{immediate:!0}),(0,g.wB)(()=>n.value.srcDblinkId,e=>{e?v(e).then(e=>{r.value=e}):r.value=[]}),(0,g.wB)(()=>n.value.srcTableName,()=>{R()},{immediate:!0}),(e,t)=>{const a=Ke.tk,l=G.R7,u=m.WK,d=s.xE,v=o.qi,R=c.P9,E=c.AV,S=f.uD,A=y.S2,x=b.ll,V=b.MQ,C=Ge.A;return(0,g.uX)(),(0,g.CE)("div",Al,[(0,g.bF)(d,{label:"缓存键前缀"},{label:(0,g.k6)(()=>[t[10]||(t[10]=(0,g.Lk)("span",null,"缓存键前缀 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"缓存键前缀，推荐以冒号结尾",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(u,{modelValue:(0,k.R1)(n).cacheKeyPrefix,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(n).cacheKeyPrefix=e),onChange:p,placeholder:"缓存键前缀，推荐以冒号结尾"},null,8,["modelValue"])]),_:1}),(0,g.bF)(d,{label:"缓存数据来自结果集"},{default:(0,g.k6)(()=>[(0,g.bF)(v,{modelValue:(0,k.R1)(n).cacheKeyFromSql,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(n).cacheKeyFromSql=e),onChange:p},null,8,["modelValue"])]),_:1}),(0,k.R1)(n).cacheKeyFromSql?((0,g.uX)(),(0,g.CE)("div",xl,[(0,g.bF)(d,{label:"源表"},{default:(0,g.k6)(()=>[(0,g.bF)(A,{gutter:8,style:{width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(n).srcDblinkId,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(n).srcDblinkId=e),clearable:"",placeholder:"请选择数据库链接",onChange:F},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.flowDblinkList,e=>((0,g.uX)(),(0,g.Wv)(R,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(S,{span:12},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(n).srcTableName,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(n).srcTableName=e),clearable:"",filterable:"",placeholder:"请选择数据源表",onChange:T},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(r),e=>((0,g.uX)(),(0,g.Wv)(R,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,g.bF)(d,{label:"源表过滤类型"},{default:(0,g.k6)(()=>[(0,g.bF)(V,{modelValue:(0,k.R1)(n).srcFilterType,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(n).srcFilterType=e),onChange:p},{default:(0,g.k6)(()=>[(0,g.bF)(x,{value:"field"},{default:(0,g.k6)(()=>t[11]||(t[11]=[(0,g.eW)("字段过滤")])),_:1,__:[11]}),(0,g.bF)(x,{value:"sql"},{default:(0,g.k6)(()=>t[12]||(t[12]=[(0,g.eW)("自定义SQL")])),_:1,__:[12]})]),_:1},8,["modelValue"])]),_:1}),"field"==(0,k.R1)(n).srcFilterType?((0,g.uX)(),(0,g.Wv)(C,{key:0,label:"源表过滤条件",data:(0,k.R1)(n).srcFilterList,addText:"添加",disabled:null==(0,k.R1)(n).srcTableName||""==(0,k.R1)(n).srcTableName,onAdd:t[5]||(t[5]=e=>_()),onEdit:_,onDelete:w,prop:{label:"filterColumnName",value:"filterColumnName"}},{default:(0,g.k6)(e=>[(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterColumnName),1),(0,g.Lk)("span",Vl,(0,h.v_)((0,k.R1)(N.CriteriaFilterType).getValue((e.data||{}).filterType)),1),(0,g.Lk)("span",Cl,(0,h.v_)((0,k.R1)(D.AutoTaskValueType).getValue(e.data.valueType)),1),(0,g.Lk)("span",null,(0,h.v_)((e.data||{}).filterValue),1)]),_:1},8,["data","disabled"])):((0,g.uX)(),(0,g.Wv)(u,{key:1,modelValue:(0,k.R1)(n).srcFilterSql,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,k.R1)(n).srcFilterSql=e),type:"textarea",rows:"5",placeholder:"重要！过滤值使用流程变量时需要手动输入，变量名的两边一定不要添加任何引号，如：name = ${variableName}",onChange:p},null,8,["modelValue"])),(0,g.bF)(d,{label:"查询字段"},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(n).selectFieldList,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(n).selectFieldList=e),clearable:"",filterable:"",multiple:"",placeholder:"查询仅返回选择的字段，如不选则返回所有字段",onChange:p},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(i),e=>((0,g.uX)(),(0,g.Wv)(R,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(d,{label:"缓存键字段"},{default:(0,g.k6)(()=>[(0,g.bF)(E,{modelValue:(0,k.R1)(n).cacheKeyFieldNames,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.R1)(n).cacheKeyFieldNames=e),clearable:"",filterable:"",multiple:"",placeholder:"根据所选顺序组成缓存键",onChange:p},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(n).selectFieldList,e=>((0,g.uX)(),(0,g.Wv)(R,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])):((0,g.uX)(),(0,g.CE)("div",Ll,[(0,g.bF)(d,{label:"缓存键"},{label:(0,g.k6)(()=>[t[13]||(t[13]=(0,g.Lk)("span",null,"缓存键 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"缓存键支持使用变量，变量名可用 ${} 表示",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(u,{modelValue:(0,k.R1)(n).cacheKey,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,k.R1)(n).cacheKey=e),onChange:p,placeholder:"缓存键支持使用变量，变量名可用 ${} 表示"},null,8,["modelValue"])]),_:1})]))])}}});const Nl=Dl;var Pl=Nl;const Wl={class:"autotask-mq-settting"};var Ol=(0,g.pM)({__name:"AutoMqTaskSetting",props:{modelValue:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const a=t,l=e,n=(0,g.WQ)("flowEntry",()=>({})),i=(0,k.KR)({actionType:D.AutoTaskActionType.SEND_MQ,autoTrigger:!0}),r=(0,g.EW)(()=>{const e=i.value.messageResponnseBody?.map(e=>({...e,disabled:"Object"!==e.fieldType&&"Array"!==e.fieldType}))||[];return(0,$.BN)(e,"id","parentId")}),u=(0,g.EW)({get(){return!i.value.autoTrigger},set(e){i.value.autoTrigger=!e}}),d=()=>{let e={...i.value};a("update:modelValue",JSON.stringify(e)),a("change",JSON.stringify(e))},p=(e,t)=>{function a(e,t){e.id=null==t||""===t?t+"."+e.fieldName:e.fieldName,Array.isArray(e.children)&&e.children.forEach(t=>{a(t,e.id)})}null==i.value.messageResponnseBody&&(i.value.messageResponnseBody=[]),null==e?i.value.messageResponnseBody.push(t):i.value.messageResponnseBody=i.value.messageResponnseBody.map(e=>e.id===t.oldIId?(a(t,t.parentId),t):e),d()},c=e=>{U.l.show("编辑响应字段",$e["default"],{area:["500px","400px"]},{entryId:n().entryId,data:e,usedFieldList:r.value,path:"thirdEditResponseData"},{width:"500px",height:"400px",pathName:"/thirdParty/thirdEditResponseData"}).then(t=>{p(e,t)}).catch(e=>{console.log(e)})},b=e=>{S.s.confirm("是否删除此响应字段？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{i.value.messageResponnseBody=i.value.messageResponnseBody?.filter(t=>t.id!==e.id),d()}).catch(e=>{console.log(e)})};return(0,g.wB)(()=>l.modelValue,e=>{let t=e&&""!==e?JSON.parse(e):{};i.value={actionType:D.AutoTaskActionType.SEND_MQ,messageTopic:t.messageTopic,messageType:t.messageType,messageCommand:t.messageCommand,messageData:t.messageData,autoTrigger:void 0===t.autoTrigger||t.autoTrigger,messageResponnseBody:t.messageResponnseBody||[]}},{immediate:!0}),(e,t)=>{const a=Ke.tk,l=G.R7,n=m.WK,p=s.xE,y=o.qi,f=Ka.o8,h=v.S2,R=Ka.Up;return(0,g.uX)(),(0,g.CE)("div",Wl,[(0,g.bF)(p,{label:"消息主题"},{label:(0,g.k6)(()=>[t[6]||(t[6]=(0,g.Lk)("span",null,"消息主题 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"该选项为必填项，同时要确保消息队列中存在该 Topic。",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(i).messageTopic,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(i).messageTopic=e),onChange:d,placeholder:"必填项，同时要确保消息队列中存在该 Topic。"},null,8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"消息类型"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(i).messageType,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(i).messageType=e),onChange:d,placeholder:"该选项不是必填项"},null,8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"消息命令"},{default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(i).messageCommand,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(i).messageCommand=e),onChange:d,placeholder:"该选项不是必填项"},null,8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"消息数据"},{label:(0,g.k6)(()=>[t[7]||(t[7]=(0,g.Lk)("span",null,"消息数据 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"必填项，可直接输入数据值，也可使用变量，并用 ${} 包含",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(n,{modelValue:(0,k.R1)(i).messageData,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(i).messageData=e),type:"textarea",rows:"5",clearable:"",placeholder:"必填项，可直接输入数据值，也可使用变量，并用 ${} 包含",onChange:d},null,8,["modelValue"])]),_:1}),(0,g.bF)(p,{label:"是否等待消费应答"},{label:(0,g.k6)(()=>[t[8]||(t[8]=(0,g.Lk)("span",null,"是否等待消费应答 ",-1)),(0,g.bF)(l,{class:"item",effect:"dark",content:"如不等待，当前消息发送后将自动流转，否则等待消费者应答后继续流转",placement:"right-start"},{default:(0,g.k6)(()=>[(0,g.bF)(a,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),default:(0,g.k6)(()=>[(0,g.bF)(y,{modelValue:(0,k.R1)(u),"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.i9)(u)?u.value=e:null),onChange:d},null,8,["modelValue"])]),_:1}),(0,k.R1)(u)?((0,g.uX)(),(0,g.Wv)(p,{key:0,label:"响应数据"},{default:(0,g.k6)(()=>[(0,g.bF)(R,{"show-header":!1,data:(0,k.R1)(r),size:"default","row-key":"id","tree-props":{children:"children"}},{default:(0,g.k6)(()=>[(0,g.bF)(f,{prop:"fieldName",label:"字段名"}),(0,g.bF)(f,{prop:"fieldType",label:"字段类型",width:"100px"}),(0,g.bF)(f,{label:"操作",width:"120px"},{default:(0,g.k6)(e=>[(0,g.bF)(h,{type:"primary",link:"",size:"small",onClick:t=>c(e.row)},{default:(0,g.k6)(()=>t[9]||(t[9]=[(0,g.eW)(" 编辑 ")])),_:2,__:[9]},1032,["onClick"]),(0,g.bF)(h,{type:"primary",link:"",size:"small",onClick:t=>b(e.row)},{default:(0,g.k6)(()=>t[10]||(t[10]=[(0,g.eW)(" 删除 ")])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),(0,g.bF)(h,{type:"primary",plain:"",size:"small",icon:(0,k.R1)(I.Plus),style:{width:"100%"},onClick:t[5]||(t[5]=e=>c())},{default:(0,g.k6)(()=>t[11]||(t[11]=[(0,g.eW)(" 添加响应字段 ")])),_:1,__:[11]},8,["icon"])]),_:1})):(0,g.Q3)("",!0)])}}});const Bl=Ol;var Ul=Bl,zl=(0,g.pM)({__name:"ServiceTask",props:{id:{},type:{},tabType:{}},setup(e){const t=(0,K.l5)(),a=e,l=(0,g.WQ)("flowEntry",()=>({})),n=((0,g.WQ)("formList",()=>({})),(0,g.WQ)("prefix")),i=(0,g.WQ)("flowVariableList",()=>[]),r=(0,g.WQ)("autoTaskVariableList",()=>[]),o=window,u=()=>{let e=i(),t=r();return[...e,...t]};(0,g.Gt)("getAllAutoVariableList",u);const d=(0,k.KR)({class:"",actionType:D.AutoTaskActionType.INSERT}),p=(0,k.KR)(),b=(0,k.KR)(),y=(0,k.KR)([]),v=()=>{b.value=void 0,F()},f=()=>{C.V7.list({}).then(e=>{y.value=(e.data.dataList||[]).map(e=>({id:e.dblinkId,name:e.dblinkName,type:e.dblinkType}))}).catch(e=>{console.error(e)})},h=()=>{let e=o.bpmnInstances.bpmnElement,t=e.businessObject.get("extensionElements")||o.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});p.value=t.values.filter(e=>e.$type===`${n}:TaskInfo`)[0],null==p.value&&(p.value=o.bpmnInstances.moddle.create(`${n}:TaskInfo`,{data:"{}"})),b.value=p.value.data;let a=D.AutoTaskActionType.INSERT;if(b.value){let e=b.value?JSON.parse(b.value):{};console.log("tempTaskData",e),a=e.actionType||D.AutoTaskActionType.INSERT}d.value={actionType:a,class:e.businessObject.class}},F=()=>{let e=o.bpmnInstances.bpmnElement;if(l().value.flowType===D.FlowEntryType.NORMAL)return o.bpmnInstances.modeling.updateProperties(e,{class:d.value.class}),void o.bpmnInstances.modeling.updateProperties(e,{extensionElements:null});let t=e.businessObject.get("extensionElements")||o.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});t.values.filter(e=>e.$type!==`${n}:TaskInfo`);p.value.data=null==b.value?JSON.stringify({actionType:d.value.actionType}):b.value;const a=o.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[p.value]});o.bpmnInstances.modeling.updateProperties(e,{extensionElements:a}),o.bpmnInstances.modeling.updateProperties(e,{class:void 0})};return(0,g.wB)(()=>a.id,e=>{e&&e.length&&(0,g.dY)(()=>h())},{immediate:!0}),(0,g.sV)(()=>{f()}),(e,n)=>{const i=m.WK,r=s.xE,o=c.P9,u=c.EL,p=c.AV,f=s.US;return(0,g.uX)(),(0,g.CE)("div",null,["baseInfo"===e.tabType?((0,g.uX)(),(0,g.Wv)(f,{key:0,ref:"form","label-position":"top",size:(0,k.R1)(t).defaultFormItemSize,model:d.value,onSubmit:n[12]||(n[12]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,k.R1)(l)().value.flowType===(0,k.R1)(D.FlowEntryType).NORMAL||"ReceiveTask"!==a.type?((0,g.uX)(),(0,g.Wv)(r,{key:0,label:"Java委托类"},{default:(0,g.k6)(()=>[(0,g.bF)(i,{modelValue:d.value.class,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value.class=e),clearable:"",placeholder:"输入包含包名的完整委托类名",onChange:F},null,8,["modelValue"])]),_:1})):((0,g.uX)(),(0,g.CE)(g.FK,{key:1},[(0,g.bF)(r,{label:"任务类型"},{default:(0,g.k6)(()=>[(0,g.bF)(p,{modelValue:d.value.actionType,"onUpdate:modelValue":n[1]||(n[1]=e=>d.value.actionType=e),clearable:"",placeholder:"请选择任务类型",onChange:v},{default:(0,g.k6)(()=>[(0,g.bF)(u,{label:"数据操作"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).INSERT),value:(0,k.R1)(D.AutoTaskActionType).INSERT},null,8,["label","value"]),(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).UPDATE),value:(0,k.R1)(D.AutoTaskActionType).UPDATE},null,8,["label","value"]),(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).DELETE),value:(0,k.R1)(D.AutoTaskActionType).DELETE},null,8,["label","value"])]),_:1}),(0,g.bF)(u,{label:"查询计算"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).QUERY_SINGLE_DATA),value:(0,k.R1)(D.AutoTaskActionType).QUERY_SINGLE_DATA},null,8,["label","value"]),(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).AGGREGATE),value:(0,k.R1)(D.AutoTaskActionType).AGGREGATE},null,8,["label","value"]),(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).FORMULA),value:(0,k.R1)(D.AutoTaskActionType).FORMULA},null,8,["label","value"])]),_:1}),(0,g.bF)(u,{label:"开发者"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).HTTP),value:(0,k.R1)(D.AutoTaskActionType).HTTP},null,8,["label","value"]),(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).LOAD_CACHE),value:(0,k.R1)(D.AutoTaskActionType).LOAD_CACHE},null,8,["label","value"]),(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).DELETE_CACHE),value:(0,k.R1)(D.AutoTaskActionType).DELETE_CACHE},null,8,["label","value"]),(0,g.bF)(o,{label:(0,k.R1)(D.AutoTaskActionType).getValue((0,k.R1)(D.AutoTaskActionType).SEND_MQ),value:(0,k.R1)(D.AutoTaskActionType).SEND_MQ},null,8,["label","value"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).INSERT?((0,g.uX)(),(0,g.Wv)(Na,{key:0,modelValue:b.value,"onUpdate:modelValue":n[2]||(n[2]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).QUERY_SINGLE_DATA?((0,g.uX)(),(0,g.Wv)(za,{key:1,modelValue:b.value,"onUpdate:modelValue":n[3]||(n[3]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).HTTP?((0,g.uX)(),(0,g.Wv)(ja,{key:2,modelValue:b.value,"onUpdate:modelValue":n[4]||(n[4]=e=>b.value=e),onChange:F},null,8,["modelValue"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).UPDATE?((0,g.uX)(),(0,g.Wv)(al,{key:3,modelValue:b.value,"onUpdate:modelValue":n[5]||(n[5]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).DELETE?((0,g.uX)(),(0,g.Wv)(ol,{key:4,modelValue:b.value,"onUpdate:modelValue":n[6]||(n[6]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).AGGREGATE?((0,g.uX)(),(0,g.Wv)(yl,{key:5,modelValue:b.value,"onUpdate:modelValue":n[7]||(n[7]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).FORMULA?((0,g.uX)(),(0,g.Wv)(hl,{key:6,modelValue:b.value,"onUpdate:modelValue":n[8]||(n[8]=e=>b.value=e),onChange:F},null,8,["modelValue"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).LOAD_CACHE?((0,g.uX)(),(0,g.Wv)(wl,{key:7,modelValue:b.value,"onUpdate:modelValue":n[9]||(n[9]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).DELETE_CACHE?((0,g.uX)(),(0,g.Wv)(Pl,{key:8,modelValue:b.value,"onUpdate:modelValue":n[10]||(n[10]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0),d.value.actionType===(0,k.R1)(D.AutoTaskActionType).SEND_MQ?((0,g.uX)(),(0,g.Wv)(Ul,{key:9,modelValue:b.value,"onUpdate:modelValue":n[11]||(n[11]=e=>b.value=e),flowDblinkList:y.value,onChange:F},null,8,["modelValue","flowDblinkList"])):(0,g.Q3)("",!0)],64))]),_:1},8,["size","model"])):(0,g.Q3)("",!0)])}}});const Kl=zl;var Ml=Kl,Xl=(0,g.pM)({__name:"index",props:{id:{},type:{}},setup(e){const t=(0,K.l5)(),a=e,l=(0,g.WQ)("allVariableList",()=>(console.warn("flowFormConfig not inject formList yet."),{}));console.log("allVariableList()",l());const n=(0,g.WQ)("prefix"),i=(0,g.EW)(()=>(console.log("allVariableListComputed",l().value),l().value)),r=(0,k.KR)(),o=(0,k.KR)([]);let u={};const d=window,p=()=>{u=d.bpmnInstances.bpmnElement;let e=u.businessObject.get("extensionElements")||d.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});r.value=e.values.filter(e=>e.$type===`${n}:VariableList`)?.[0]||d.bpmnInstances.moddle.create(`${n}:VariableList`,{variableList:[]}),o.value=JSON.parse(JSON.stringify(r.value.variableList||[])),o.value=o.value.map(e=>e.id),m()},m=()=>{let e=u.businessObject.get("extensionElements")||d.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});const t=e.values.filter(e=>e.$type!==`${n}:VariableList`);r.value.variableList=o.value.map(e=>d.bpmnInstances.moddle.create(`${n}:FormVariable`,{id:e}));const a=d.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t.concat(r.value)});d.bpmnInstances.modeling.updateProperties(u,{extensionElements:a})},b=()=>{m()};return(0,g.wB)(()=>a.id,e=>{e&&e.length&&(0,g.dY)(()=>p())},{immediate:!0}),(e,a)=>{const l=y.S2,n=c.P9,r=c.AV,u=s.xE,d=s.US;return(0,g.uX)(),(0,g.CE)("div",null,[(0,g.bF)(d,{size:(0,k.R1)(t).defaultFormItemSize,onSubmit:a[1]||(a[1]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[(0,g.bF)(u,{label:"任务变量"},{default:(0,g.k6)(()=>[(0,g.bF)(r,{modelValue:(0,k.R1)(o),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,k.i9)(o)?o.value=e:null),clearable:"",multiple:"","collapse-tags":"",placeholder:"选择任务节点使用的变量",filterable:"","default-first-option":"",onChange:b},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(i),e=>((0,g.uX)(),(0,g.Wv)(n,{key:e.variableId,value:e.variableId,label:e.showName},{default:(0,g.k6)(()=>[(0,g.bF)(l,{justify:"space-between"},{default:(0,g.k6)(()=>[(0,g.Lk)("span",null,(0,h.v_)(e.showName),1),(0,g.Lk)("span",null,(0,h.v_)(e.variableName),1)]),_:2},1024)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["size"])])}}});const ql=Xl;var $l=ql,Ql=a(42421);const Gl={class:"copy-select",span:24},jl={key:0},Jl={key:1};var Hl=(0,g.pM)({__name:"copyForSetting",props:{value:{default:()=>[]}},emits:["update:value"],setup(e,{emit:t}){const a=t,l=e,n=(0,K.l5)(),s=(0,k.KR)(!1);let r=[],o=new Map,u=[],d=new Map,p=[],m=new Map,c=[],b=new Map;const y={"${startUserName}":"流程发起人","${appointedAssignee}":"指定审批人"},f=(0,g.EW)(()=>s.value&&Array.isArray(l.value)?l.value.map(e=>{let t=[],a=(e.id||"").split(",");switch(e.type){case D.SysFlowCopyForType.USER:t=a.map(t=>t&&""!==t?{id:t,name:y[t]?y[t]:(e.userName||[]).find(e=>e.id===t)?.name||t}:void 0).filter(e=>void 0!=e);break;case D.SysFlowCopyForType.ROLE:t=a.map(e=>{let t=o?.get(e);return t?{id:e,name:t.name,...t}:void 0}).filter(e=>void 0!=e);break;case D.SysFlowCopyForType.DEPT:t=a.map(e=>{let t=d?.get(e);return t?{id:e,name:t.name}:void 0}).filter(e=>void 0!=e);break;case D.SysFlowCopyForType.SELF_DEPT_LEADER:case D.SysFlowCopyForType.UP_DEPT_LEADER:t=[];break;case D.SysFlowCopyForType.POST:case D.SysFlowCopyForType.SELF_DEPT_POST:case D.SysFlowCopyForType.SLIBING_DEPT_POST:case D.SysFlowCopyForType.UP_DEPT_POST:t=a.map(e=>{let t=m?.get(e);return t?{id:e,name:t.postName}:void 0}).filter(e=>null!=e);break;case D.SysFlowCopyForType.DEPT_POST:t=a.map(e=>{let t=b?.get(e);return t?{id:e,name:t.deptName+" / "+t.postShowName}:void 0}).filter(e=>null!=e);break}return{...e,showNameList:t}}):[]),R=e=>{S.s.confirm("是否删除此抄送人？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t=(l.value||[]).filter(t=>e.type!==t.type);a("update:value",t)}).catch(e=>{console.warn(e)})},F=(e,t)=>{S.s.confirm("是否移除此抄送人？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let n=(l.value||[]).filter(a=>{if(e.type===a.type){if(null==a.id||""===a.id)return!1;let e=(a.id||"").split(",");return e=e.filter(e=>e!==t.id),!(e.length<=0)&&(a.id=e.join(","),!0)}return!0});a("update:value",n)}).catch(e=>{console.warn(e)})},T=()=>{U.l.show("添加抄送人",Ql["default"],{area:"600px"},{roleList:r,deptList:u,postList:p,deptPostList:c,path:"thirdAddCopyForItem"},{width:"600px",height:"450px",pathName:"/thirdParty/thirdAddCopyForItem"}).then(e=>{E(e)}).catch(e=>{console.warn(e)})},E=e=>{let t=e.type,n=!1,i=(l.value||[]).map(a=>{if(a.type===t){n=!0;let t=(a.id||"").split(","),l=(e.id||"").split(","),i=t;return l.forEach(e=>{-1===i.indexOf(e)&&i.push(e)}),{...a,id:i.join(","),userName:e.userName.concat(a.userName)}}return{...a}});n||i.push({...e}),a("update:value",i)},_=()=>new Promise((e,t)=>{let a={widgetType:"upms_dept",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{u=[],null==t.data.dataList&&(t.data.dataList=[]),t.data.dataList.forEach(e=>{const t={id:String(e.deptId),name:e.deptName,parentId:e.parentId,...e};d?.set(t.id,t),u.push(t)}),u=(0,$.BN)(u),e(t)}).catch(e=>{t(e)})}),w=()=>new Promise((e,t)=>{let a={widgetType:"upms_dept_post",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{null==t.data.dataList&&(t.data.dataList=[]),t.data.dataList.forEach(e=>{b?.set(e.deptPostId,e)}),c=t.data.dataList.sort((e,t)=>e.postLevel-t.postLevel),e(t)}).catch(e=>{t(e)})}),A=()=>(m=new Map,new Promise((e,t)=>{let a={widgetType:"upms_post",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{null==t.data.dataList&&(t.data.dataList=[]),t.data.dataList.forEach(e=>{const t={id:String(e.postId),name:e.postName,...e};m?.set(t.id,t)}),p=t.data.dataList,e(t)}).catch(e=>{t(e)})})),x=()=>new Promise((e,t)=>{let a={widgetType:"upms_role",filter:{}};ze.If.list(a,{showMask:!1}).then(t=>{null==t.data.dataList&&(t.data.dataList=[]),r=t.data.dataList.map(e=>({id:String(e.roleId),name:e.roleName,...e})),r.forEach(e=>{o?.set(e.id,e)}),e(t)}).catch(e=>{t(e)})});return(0,g.sV)(()=>{let e=[_(),A(),w(),x()];Promise.all(e).then(()=>{s.value=!0}).catch(e=>{console.warn(e)})}),(0,g.xo)(()=>{o=null,d=null,m=null,b=null}),(e,t)=>{const a=v.S2,l=i.u;return(0,g.uX)(),(0,g.CE)("div",Gl,[(0,g.bF)(a,{icon:(0,k.R1)(I.Plus),size:(0,k.R1)(n).defaultFormItemSize,onClick:T},{default:(0,g.k6)(()=>t[0]||(t[0]=[(0,g.eW)("添加抄送")])),_:1,__:[0]},8,["icon","size"]),(0,g.Lk)("ul",null,[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(f),e=>((0,g.uX)(),(0,g.CE)("li",{key:e.type},[(0,g.Lk)("label",null,(0,h.v_)((0,k.R1)(D.SysFlowCopyForType).getValue(e.type)),1),e.showNameList.length?((0,g.uX)(),(0,g.CE)("div",jl,[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(e.showNameList,t=>((0,g.uX)(),(0,g.Wv)(l,{size:(0,k.R1)(n).defaultFormItemSize,effect:"dark",key:t.id,closable:"",onClose:a=>F(e,t)},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(t.name),1)]),_:2},1032,["size","onClose"]))),128))])):((0,g.uX)(),(0,g.CE)("div",Jl,[((0,g.uX)(),(0,g.Wv)(l,{size:(0,k.R1)(n).defaultFormItemSize,effect:"dark",key:e.type,closable:"",onClose:t=>R(e)},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)((0,k.R1)(D.SysFlowCopyForType).getValue(e.type)),1)]),_:2},1032,["size","onClose"]))]))]))),128))])])}}});const Yl=(0,_e.A)(Hl,[["__scopeId","data-v-fea53eda"]]);var Zl=Yl;const en={class:"panel-tab__content",style:{"padding-top":"3px"}};var tn=(0,g.pM)({__name:"index",props:{id:{},type:{}},setup(e){const t=e,a=(0,g.WQ)("prefix"),l=(0,k.KR)([]);let n;const i=window;let s=null;const r=async()=>{s=i.bpmnInstances.bpmnElement;let e=s?.businessObject.get("extensionElements")||i.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});n=e.values.filter(e=>e.$type===`${a}:CopyItemList`)?.[0]||i.bpmnInstances.moddle.create(`${a}:CopyItemList`,{copyItemList:[]});let t=[];if(n&&n.copyItemList)for(let a=0;a<n.copyItemList.length;a++){const e=n.copyItemList[a];if(e.type===D.SysFlowCopyForType.USER){let a={widgetType:"upms_user",fieldName:"loginName",fieldValues:e.id},l=e.id.split(",");a.fieldValues=a.fieldValues.split(",").filter(e=>-1===["${startUserName}","${appointedAssignee}"].indexOf(e)).join(",");let n=e.id.split(",");if(a.fieldValues){const e=await ze.If.viewByIds(a);e.data.forEach(e=>{l[n.indexOf(e.loginName)]=e.showName})}t.push({...e,userName:n.map((e,t)=>({id:e,name:l[t]}))})}else t.push(e)}l.value=t,o()},o=()=>{let e=s?.businessObject.get("extensionElements")||i.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]}),t=e.values.filter(e=>e.$type!==`${a}:CopyItemList`);n&&(n.copyItemList=(l.value||[]).map(e=>i.bpmnInstances.moddle.create(`${a}:CopyItem`,{id:e.id,type:e.type})));const r=i.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t.concat(n)});i.bpmnInstances.modeling.updateProperties(s,{extensionElements:r})};return(0,g.wB)(()=>t.id,e=>{e&&e.length&&(0,g.dY)(()=>{r()})},{immediate:!0}),(0,g.wB)(l,()=>{o()}),(e,t)=>((0,g.uX)(),(0,g.CE)("div",en,[(0,g.bF)(Zl,{value:(0,k.R1)(l),"onUpdate:value":t[0]||(t[0]=e=>(0,k.i9)(l)?l.value=e:null)},null,8,["value"])]))}});const an=tn;var ln=an;const nn={class:"panel-tab__content",style:{"padding-top":"3px"}},sn={class:"listener-filed__title",style:{"margin-top":"12px","margin-bottom":"12px"}},rn={class:"element-drawer__button",style:{"margin-top":"8px"}};var on=(0,g.pM)({__name:"UserTaskListeners",props:{id:{},type:{}},setup(e,{expose:t}){const a=(0,K.l5)(),l=e,n=(0,g.WQ)("prefix"),i=(0,g.WQ)("width"),r=(0,k.KR)(),o=(0,k.KR)(),u=(0,k.KR)([]),d=(0,k.KR)(sa),p=(0,k.KR)(ia),b=(0,k.KR)(!1),y=(0,k.KR)({}),f=(0,k.KR)(ra),E=(0,k.KR)([]),_=(0,k.KR)(!1),w=(0,k.KR)(-1),A=(0,k.KR)(-1),x=(0,k.KR)({});let V=[],C={},L=[];const D=()=>{L=[];let e=C.businessObject?.extensionElements?.values?.filter(e=>(e.$type!==`${n}:TaskListener`&&L.push(e),e.$type===`${n}:TaskListener`))??[];return e},N=()=>{C=window.bpmnInstances.bpmnElement,V=D(),u.value=V.map(e=>na(e))},P=(e,t)=>{if(e?(y.value=la(e),w.value=t):(y.value={},w.value=-1),e&&e.fields)E.value=e.fields.map(e=>({...e,fieldType:e.string?"string":"expression"}));else{E.value=[];const e={...y.value};e.fields=[],y.value=e}b.value=!0,(0,g.dY)(()=>{r.value&&r.value.clearValidate()})},W=(e,t)=>{S.s.confirm("确认移除该监听器吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消",type:"warning"}).then(()=>{D(),V.splice(t,1),u.value.splice(t,1),pe(C,L.concat(V))}).catch(()=>console.info("操作取消"))},O=async()=>{let e=await r.value.validate();if(!e)return;const t=oe(y.value,!0,n);-1===w.value?(V.push(t),u.value.push(y.value)):(V.splice(w.value,1,t),u.value.splice(w.value,1,y.value)),D(),pe(C,L.concat(V)),b.value=!1,y.value={}},B=(e,t)=>{x.value=e?JSON.parse(JSON.stringify(e)):{},A.value=e?t:-1,_.value=!0,(0,g.dY)(()=>{o.value&&o.value.clearValidate()})},U=async()=>{let e=await o.value.validate();e&&(-1===A.value?(E.value.push(x.value),y.value.fields.push(x.value)):(E.value.splice(A.value,1,x.value),y.value.fields.splice(A.value,1,x.value)),_.value=!1,(0,g.dY)(()=>x.value={}))},z=(e,t)=>{S.s.confirm("确认移除该字段吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消",type:"warning"}).then(()=>{E.value.splice(t,1),y.value.fields.splice(t,1)}).catch(()=>console.info("操作取消"))};return(0,g.wB)(()=>l.id,e=>{e&&e.length&&(0,g.dY)(()=>N())},{immediate:!0}),t({openListenerForm:P}),(e,t)=>{const l=v.S2,n=c.P9,S=c.AV,w=s.xE,A=m.WK,V=s.US,C=aa.fR,L=Ke.tk,D=ta.pw,N=Q.kZ;return(0,g.uX)(),(0,g.CE)("div",nn,[(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(u),size:(0,k.R1)(a).defaultFormItemSize,"row-config":{isHover:!0},"header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>t[25]||(t[25]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",width:"70px",type:"seq"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"事件类型","min-width":"80px","show-overflow-tooltip":""},{default:(0,g.k6)(e=>[(0,g.eW)((0,h.v_)((0,k.R1)(d)[e.row.event]),1)]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"监听器类型","min-width":"80px","show-overflow-tooltip":""},{default:(0,g.k6)(e=>[(0,g.eW)((0,h.v_)((0,k.R1)(p)[e.row.listenerType]),1)]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"110px"},{default:(0,g.k6)(({row:e,$rowIndex:n})=>[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"primary",onClick:t=>P(e,n)},{default:(0,g.k6)(()=>t[23]||(t[23]=[(0,g.eW)("编辑")])),_:2,__:[23]},1032,["size","onClick"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"danger",onClick:t=>W(e,n)},{default:(0,g.k6)(()=>t[24]||(t[24]=[(0,g.eW)("删除")])),_:2,__:[24]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,g.bF)(D,{modelValue:(0,k.R1)(b),"onUpdate:modelValue":t[15]||(t[15]=e=>(0,k.i9)(b)?b.value=e:null),title:"任务监听器",size:`${(0,k.R1)(i)}px`,class:"process-drawer","append-to-body":"","destroy-on-close":""},{default:(0,g.k6)(()=>[(0,g.bF)(V,{size:(0,k.R1)(a).defaultFormItemSize,model:(0,k.R1)(y),"label-width":"96px",ref_key:"listenerFormRef",ref:r,onSubmit:t[12]||(t[12]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(w,{label:"事件类型",prop:"event",rules:{required:!0,message:"请选择事件类型",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(y).event,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(y).event=e)},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(Object.keys((0,k.R1)(d)),e=>((0,g.uX)(),(0,g.Wv)(n,{key:e,label:(0,k.R1)(d)[e],value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.bF)(w,{label:"监听器ID",prop:"id",rules:{required:!0,message:"请填写监听器ID",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).id,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(y).id=e),clearable:""},null,8,["modelValue"])]),_:1}),(0,g.bF)(w,{label:"监听器类型",prop:"listenerType",rules:{required:!0,message:"请选择监听器类型",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(y).listenerType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(y).listenerType=e)},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(Object.keys((0,k.R1)(p)),e=>((0,g.uX)(),(0,g.Wv)(n,{key:e,label:(0,k.R1)(p)[e],value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),"classListener"===(0,k.R1)(y).listenerType?((0,g.uX)(),(0,g.Wv)(w,{label:"Java类",prop:"class",key:"listener-class",rules:{required:!0,message:"请填写Java类",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).class,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(y).class=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"expressionListener"===(0,k.R1)(y).listenerType?((0,g.uX)(),(0,g.Wv)(w,{label:"表达式",prop:"expression",key:"listener-expression",rules:{required:!0,message:"请填写表达式",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).expression,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(y).expression=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"delegateExpressionListener"===(0,k.R1)(y).listenerType?((0,g.uX)(),(0,g.Wv)(w,{label:"代理表达式",prop:"delegateExpression",key:"listener-delegate",rules:{required:!0,message:"请填写代理表达式",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).delegateExpression,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(y).delegateExpression=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"scriptListener"===(0,k.R1)(y).listenerType?((0,g.uX)(),(0,g.CE)(g.FK,{key:3},[(0,g.bF)(w,{label:"脚本格式",prop:"scriptFormat",key:"listener-script-format",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本格式"}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).scriptFormat,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,k.R1)(y).scriptFormat=e),clearable:""},null,8,["modelValue"])]),_:1}),(0,g.bF)(w,{label:"脚本类型",prop:"scriptType",key:"listener-script-type",rules:{required:!0,trigger:["blur","change"],message:"请选择脚本类型"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(y).scriptType,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(y).scriptType=e)},{default:(0,g.k6)(()=>[(0,g.bF)(n,{label:"内联脚本",value:"inlineScript"}),(0,g.bF)(n,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),"inlineScript"===(0,k.R1)(y).scriptType?((0,g.uX)(),(0,g.Wv)(w,{label:"脚本内容",prop:"value",key:"listener-script",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本内容"}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).value,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.R1)(y).value=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"externalScript"===(0,k.R1)(y).scriptType?((0,g.uX)(),(0,g.Wv)(w,{label:"资源地址",prop:"resource",key:"listener-resource",rules:{required:!0,trigger:["blur","change"],message:"请填写资源地址"}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).resource,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,k.R1)(y).resource=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)],64)):(0,g.Q3)("",!0),"timeout"===(0,k.R1)(y).event?((0,g.uX)(),(0,g.CE)(g.FK,{key:4},[(0,g.bF)(w,{label:"定时器类型",prop:"eventDefinitionType",key:"eventDefinitionType"},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(y).eventDefinitionType,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,k.R1)(y).eventDefinitionType=e)},{default:(0,g.k6)(()=>[(0,g.bF)(n,{label:"日期",value:"date"}),(0,g.bF)(n,{label:"持续时长",value:"duration"}),(0,g.bF)(n,{label:"循环",value:"cycle"}),(0,g.bF)(n,{label:"无",value:"null"})]),_:1},8,["modelValue"])]),_:1}),(0,k.R1)(y).eventDefinitionType&&"null"!==(0,k.R1)(y).eventDefinitionType?((0,g.uX)(),(0,g.Wv)(w,{label:"定时器",prop:"eventTimeDefinitions",key:"eventTimeDefinitions",rules:{required:!0,trigger:["blur","change"],message:"请填写定时器配置"}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(y).eventTimeDefinitions,"onUpdate:modelValue":t[11]||(t[11]=e=>(0,k.R1)(y).eventTimeDefinitions=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)],64)):(0,g.Q3)("",!0)]),_:1},8,["size","model"]),(0,g.bF)(C),(0,g.Lk)("p",sn,[(0,g.Lk)("span",null,[(0,g.bF)(L,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Menu))]),_:1}),t[26]||(t[26]=(0,g.eW)("注入字段："))]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,type:"primary",onClick:t[13]||(t[13]=e=>B(null))},{default:(0,g.k6)(()=>t[27]||(t[27]=[(0,g.eW)("添加字段")])),_:1,__:[27]},8,["size"])]),(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(E),size:(0,k.R1)(a).defaultFormItemSize,"row-config":{isHover:!0},"max-height":"240",border:"",fit:"",style:{flex:"none"},"header-cell-class-name":"table-header-gray"},{empty:(0,g.k6)(()=>t[30]||(t[30]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",width:"70px",type:"seq"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"字段名称","min-width":"100px",field:"name"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"字段类型","min-width":"80px","show-overflow-tooltip":""},{default:(0,g.k6)(e=>[(0,g.eW)((0,h.v_)((0,k.R1)(f)[e.row.fieldType]),1)]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"字段值/表达式","min-width":"100px","show-overflow-tooltip":""},{default:(0,g.k6)(e=>[(0,g.eW)((0,h.v_)(e.row.string||e.row.expression),1)]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"100px"},{default:(0,g.k6)(({row:e,$rowIndex:n})=>[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"primary",onClick:t=>B(e,n)},{default:(0,g.k6)(()=>t[28]||(t[28]=[(0,g.eW)("编辑")])),_:2,__:[28]},1032,["size","onClick"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,link:"",type:"danger",onClick:t=>z(e,n)},{default:(0,g.k6)(()=>t[29]||(t[29]=[(0,g.eW)("删除")])),_:2,__:[29]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,g.Lk)("div",rn,[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,onClick:t[14]||(t[14]=e=>b.value=!1)},{default:(0,g.k6)(()=>t[31]||(t[31]=[(0,g.eW)("取 消")])),_:1,__:[31]},8,["size"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,type:"primary",onClick:O},{default:(0,g.k6)(()=>t[32]||(t[32]=[(0,g.eW)("保 存")])),_:1,__:[32]},8,["size"])])]),_:1},8,["modelValue","size"]),(0,g.bF)(N,{title:"字段配置",modelValue:(0,k.R1)(_),"onUpdate:modelValue":t[22]||(t[22]=e=>(0,k.i9)(_)?_.value=e:null),width:"600px","append-to-body":"","destroy-on-close":""},{footer:(0,g.k6)(()=>[(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,onClick:t[21]||(t[21]=e=>_.value=!1)},{default:(0,g.k6)(()=>t[33]||(t[33]=[(0,g.eW)("取 消")])),_:1,__:[33]},8,["size"]),(0,g.bF)(l,{size:(0,k.R1)(a).defaultFormItemSize,type:"primary",onClick:U},{default:(0,g.k6)(()=>t[34]||(t[34]=[(0,g.eW)("确 定")])),_:1,__:[34]},8,["size"])]),default:(0,g.k6)(()=>[(0,g.bF)(V,{model:(0,k.R1)(x),size:(0,k.R1)(a).defaultFormItemSize,"label-width":"96px",ref_key:"listenerFieldFormRef",ref:o,onSubmit:t[20]||(t[20]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(w,{label:"字段名称：",prop:"name",rules:{required:!0,message:"请填写字段名称",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(x).name,"onUpdate:modelValue":t[16]||(t[16]=e=>(0,k.R1)(x).name=e),clearable:""},null,8,["modelValue"])]),_:1}),(0,g.bF)(w,{label:"字段类型：",prop:"fieldType",rules:{required:!0,message:"请选择字段类型",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{modelValue:(0,k.R1)(x).fieldType,"onUpdate:modelValue":t[17]||(t[17]=e=>(0,k.R1)(x).fieldType=e)},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(Object.keys((0,k.R1)(f)),e=>((0,g.uX)(),(0,g.Wv)(n,{key:e,label:(0,k.R1)(f)[e],value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),"string"===(0,k.R1)(x).fieldType?((0,g.uX)(),(0,g.Wv)(w,{label:"字段值：",prop:"string",key:"field-string",rules:{required:!0,message:"请填写字段值",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(x).string,"onUpdate:modelValue":t[18]||(t[18]=e=>(0,k.R1)(x).string=e),clearable:""},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0),"expression"===(0,k.R1)(x).fieldType?((0,g.uX)(),(0,g.Wv)(w,{label:"表达式：",prop:"expression",key:"field-expression",rules:{required:!0,message:"请填写表达式",trigger:["blur","change"]}},{default:(0,g.k6)(()=>[(0,g.bF)(A,{modelValue:(0,k.R1)(x).expression,"onUpdate:modelValue":t[19]||(t[19]=e=>(0,k.R1)(x).expression=e),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})):(0,g.Q3)("",!0)]),_:1},8,["model","size"])]),_:1},8,["modelValue"])])}}});const un=on;var dn=un,pn=(0,g.pM)({__name:"index",props:{id:{},isCountersign:{type:Boolean}},setup(e){const t=(0,K.l5)(),a=e,l=[{label:"审批人为发起人",value:"0"},{label:"审批人与上一审批节点处理人相同",value:"1"},{label:"审批人审批过",value:"2"}],n=(0,k.KR)([]),i=window,r=()=>{let e=(i.bpmnInstances.bpmnElement||{}).businessObject;n.value=(e.autoSkipType||"").split(",").filter(e=>!!e)},o=()=>{let e={autoSkipType:n.value&&n.value.length?n.value.join(","):void 0};i.bpmnInstances.modeling.updateProperties(i.bpmnInstances.bpmnElement,e)};return(0,g.wB)(()=>a.id,e=>{e&&e.length&&(0,g.dY)(()=>r())},{immediate:!0}),(0,g.wB)(()=>a.isCountersign,e=>{e&&(n.value=[])},{immediate:!0}),(0,g.wB)(n,()=>{o()},{deep:!0}),(e,a)=>{const i=c.P9,r=c.AV,o=s.xE,u=s.US;return(0,g.uX)(),(0,g.Wv)(u,{class:"auto-agree",size:(0,k.R1)(t).defaultFormItemSize,"label-width":"80px","label-position":"top",onSubmit:a[1]||(a[1]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(o,{label:"自动同意",style:{"margin-bottom":"0 !important"}},{default:(0,g.k6)(()=>[(0,g.bF)(r,{modelValue:(0,k.R1)(n),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,k.i9)(n)?n.value=e:null),size:(0,k.R1)(t).defaultFormItemSize,multiple:"",placeholder:"请选择"},{default:(0,g.k6)(()=>[((0,g.uX)(),(0,g.CE)(g.FK,null,(0,g.pI)(l,e=>(0,g.bF)(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","size"])]),_:1})]),_:1},8,["size"])}}});const mn=(0,_e.A)(pn,[["__scopeId","data-v-1d9b418a"]]);var cn=mn,bn=(0,g.pM)({__name:"index",props:{id:{},isCountersign:{type:Boolean}},setup(e){const t=(0,K.l5)(),a=e,l=(0,k.KR)("0"),n=window,i=()=>{let e=(n.bpmnInstances.bpmnElement||{}).businessObject;l.value=a.isCountersign?"":e.rejectType||"0"},r=()=>{let e=Object.create(null);e.rejectType=l.value,n.bpmnInstances.modeling.updateProperties(n.bpmnInstances.bpmnElement,e)};return(0,g.wB)(()=>a.id,e=>{e&&e.length&&(0,g.dY)(()=>i())},{immediate:!0}),(0,g.wB)(()=>a.isCountersign,()=>{a.isCountersign&&(l.value="")},{deep:!0}),(0,g.wB)(l,()=>{r()}),(e,a)=>{const n=b.ll,i=Ke.tk,r=G.R7,o=y.S2,u=b.MQ,d=s.xE,p=s.US;return(0,g.uX)(),(0,g.Wv)(p,{class:"panel-go-back",size:(0,k.R1)(t).defaultFormItemSize,onSubmit:a[1]||(a[1]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[(0,g.bF)(d,{label:"退回设置"},{default:(0,g.k6)(()=>[(0,g.bF)(u,{modelValue:(0,k.R1)(l),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,k.i9)(l)?l.value=e:null),disabled:e.isCountersign},{default:(0,g.k6)(()=>[(0,g.bF)(n,{value:"0"},{default:(0,g.k6)(()=>a[2]||(a[2]=[(0,g.eW)("重新审批")])),_:1,__:[2]}),(0,g.bF)(n,{value:"1"},{default:(0,g.k6)(()=>[(0,g.bF)(o,{type:"flex",justify:"space-between",align:"middle"},{default:(0,g.k6)(()=>[a[3]||(a[3]=(0,g.Lk)("span",{style:{"margin-right":"4px"}},"从当前节点审批",-1)),(0,g.bF)(r,{class:"item",effect:"dark",content:"若流程为A->B->C,C退回至A，则C->A->C",placement:"top"},{default:(0,g.k6)(()=>[(0,g.bF)(i,null,{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(I.Warning))]),_:1})]),_:1})]),_:1,__:[3]})]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1},8,["size"])}}});const yn=(0,_e.A)(bn,[["__scopeId","data-v-f6e0fd68"]]);var vn=yn;const fn={class:"name"},gn={class:"desc"};function kn(e,t,a,l,n,i){const r=b.ll,o=b.MQ,u=(0,g.g2)("Delete"),d=Ke.tk,p=y.S2,c=s.xE,f=m.WK,k=(0,g.g2)("ApiSetting"),F=v.S2,T=s.US;return(0,g.uX)(),(0,g.Wv)(T,{size:e.defaultFormItemSize,onSubmit:t[0]||(t[0]=(0,R.D$)(()=>{},["prevent"])),"label-position":"top"},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(i.businessOperationList,a=>((0,g.uX)(),(0,g.CE)("div",{class:"business-operation-list",key:a.type},[(0,g.Lk)("div",fn,(0,h.v_)(a.name),1),(0,g.Lk)("div",gn,(0,h.v_)(a.desc),1),((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)(a.operationList,e=>((0,g.uX)(),(0,g.CE)("div",{class:"business-operation-item",key:e.id},[(0,g.bF)(c,{label:""},{default:(0,g.k6)(()=>[(0,g.bF)(p,{type:"flex",justify:"space-between",align:"middle",style:{"flex-wrap":"nowrap",width:"100%"}},{default:(0,g.k6)(()=>[(0,g.bF)(o,{modelValue:e.actionType,"onUpdate:modelValue":t=>e.actionType=t,onChange:i.updateBusinessOperationList},{default:(0,g.k6)(()=>[(0,g.bF)(r,{value:"SQL"},{default:(0,g.k6)(()=>t[1]||(t[1]=[(0,g.eW)("SQL")])),_:1,__:[1]}),(0,g.bF)(r,{value:"EXPRESSION"},{default:(0,g.k6)(()=>t[2]||(t[2]=[(0,g.eW)("EL表达式")])),_:1,__:[2]}),(0,g.bF)(r,{value:"HTTP"},{default:(0,g.k6)(()=>t[3]||(t[3]=[(0,g.eW)("HTTP")])),_:1,__:[3]})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),(0,g.bF)(d,{style:{cursor:"pointer",color:"#606266","font-size":"16px"},onClick:t=>i.onDeleteVariable(a,e)},{default:(0,g.k6)(()=>[(0,g.bF)(u)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),"SQL"===e.actionType?((0,g.uX)(),(0,g.Wv)(c,{key:0,label:""},{default:(0,g.k6)(()=>[(0,g.bF)(f,{modelValue:e.sql,"onUpdate:modelValue":t=>e.sql=t,type:"textarea",placeholder:"请输入SQL语句, 流程变量使用${}, 如: select * from t where id = ${businessKey}",onChange:i.updateBusinessOperationList},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)):(0,g.Q3)("",!0),"EXPRESSION"===e.actionType?((0,g.uX)(),(0,g.Wv)(c,{key:1,label:""},{default:(0,g.k6)(()=>[(0,g.bF)(f,{modelValue:e.expression,"onUpdate:modelValue":t=>e.expression=t,placeholder:"请输入EL表达式, 如: ${flowApproveFunction.getDept(deptId)}",onChange:i.updateBusinessOperationList},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)):(0,g.Q3)("",!0),"HTTP"===e.actionType?((0,g.uX)(),(0,g.Wv)(c,{key:2,label:""},{default:(0,g.k6)(()=>[(0,g.bF)(k,{isBusiness:!0,"model-value":i.getHttpJsonString(e),"onUpdate:modelValue":t=>i.onHttpInfoChange(t,e)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)):(0,g.Q3)("",!0)]))),128)),(0,g.bF)(F,{type:"default",style:{"margin-top":"5px"},size:e.defaultFormItemSize,onClick:e=>i.addOperation(a)},{default:(0,g.k6)(()=>t[4]||(t[4]=[(0,g.eW)(" 添加操作 ")])),_:2,__:[4]},1032,["size","onClick"])]))),128))]),_:1},8,["size"])}var hn={name:"BusinessOperationList",props:{id:String},inject:["flowEntry","prefix","templateVariableList"],provide(){return{getAllAutoVariableList:()=>[...this.templateVariableList()]}},components:{ApiSetting:tt,Delete:I.Delete},data(){return{businessOperation:{enter_task:{type:"enter_task",name:"节点开始时更新",desc:"流程进入此节点且审批开始前执行(退回后再次进入也会执行)",operationList:[]},agree:{type:"agree",name:"节点同意后更新",desc:"节点点击同意后执行",operationList:[]},refuse:{type:"refuse",name:"节点驳回后更新",desc:"节点点击驳回或决绝后执行",operationList:[]},revoke:{type:"revoke",name:"节点撤销后更新",desc:"节点被上一个节点撤回后执行",operationList:[]},multi_sign:{type:"multi_sign",name:"会签过程中更新",desc:"会签节点多人审批时，在每个审批人处理后执行",operationList:[]}},elementBusinessOperationList:void 0}},computed:{businessOperationList(){return Object.keys(this.businessOperation).map(e=>this.businessOperation[e])}},methods:{onDeleteVariable(e,t){let a=e.operationList.findIndex(e=>e.id===t.id);-1!==a&&(e.operationList.splice(a,1),this.updateBusinessOperationList())},resetFormList(){this.bpmnELement=window.bpmnInstances.bpmnElement;let e=this.bpmnELement.businessObject.get("extensionElements")||window.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]});this.elementBusinessOperationList=e.values.filter(e=>e.$type===`${this.prefix}:BusinessOperationList`)?.[0]||window.bpmnInstances.moddle.create(`${this.prefix}:BusinessOperationList`,{businessOperationList:[]}),console.log(this.elementBusinessOperationList),Object.keys(this.businessOperation).forEach(e=>{this.businessOperation[e].operationList=[]}),Array.isArray(this.elementBusinessOperationList.businessOperationList)&&this.elementBusinessOperationList.businessOperationList.forEach(e=>{if(e&&null!=e.data&&""!==e.data)try{let t=JSON.parse(e.data);t&&this.businessOperation[t.operationType].operationList.push(t)}catch(t){console.error(t)}})},updateBusinessOperationList(){let e=this.bpmnELement.businessObject.get("extensionElements")||window.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:[]}),t=e.values.filter(e=>e.$type!==`${this.prefix}:BusinessOperationList`);this.elementBusinessOperationList.businessOperationList=[],Object.keys(this.businessOperation).forEach(e=>{this.businessOperation[e].operationList.forEach(e=>{let t=JSON.stringify(e),a=window.bpmnInstances.moddle.create(`${this.prefix}:Operation`,{data:t});this.elementBusinessOperationList.businessOperationList.push(a)})});const a=window.bpmnInstances.moddle.create("bpmn:ExtensionElements",{values:t.concat(this.elementBusinessOperationList)});window.bpmnInstances.modeling.updateProperties(this.bpmnELement,{extensionElements:a})},addOperation(e){e.operationList.push({id:(new Date).getTime(),operationType:e.type,forOnlineTable:this.flowEntry().value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM,actionType:"SQL",sql:"",expression:"",httpRequestInfo:{},httpResponnseData:{},processDefinitionKey:this.flowEntry().value.processDefinitionKey,dblinkId:this.flowEntry().value.dblinkId}),this.updateBusinessOperationList()},getHttpJsonString(e){return JSON.stringify({httpRequestInfo:e.httpRequestInfo,httpResponnseData:e.httpResponnseData})},onHttpInfoChange(e,t){if(console.log(e),null==e||""===e)t.httpRequestInfo={},t.httpResponnseData={};else{let a=JSON.parse(e);t.httpRequestInfo=a.httpRequestInfo,t.httpResponnseData=a.httpResponnseData}this.updateBusinessOperationList()}},watch:{id:{immediate:!0,handler(e){e&&e.length&&this.$nextTick(()=>{this.resetFormList()})}}}};const Rn=(0,_e.A)(hn,[["render",kn],["__scopeId","data-v-42e172a6"]]);var Fn=Rn;const Tn={class:"process-panel__container"},En={key:"goback"},_n={key:"condition"},Sn={key:"status"},In={class:"process-panel__container"},wn={key:"form"},An={class:"panel-title"},xn={key:1},Vn={class:"process-panel__container"},Cn={key:"task"},Ln={key:"copyFor"},Dn={class:"process-panel__container"},Nn={key:"message"},Pn={key:"listeners",style:{"margin-bottom":"10px"}},Wn={class:"panel-title"},On={key:"taskListeners",style:{"margin-bottom":"10px"}},Bn={class:"panel-title"},Un={key:"extensions"},zn={class:"panel-title"};var Kn=(0,g.pM)({__name:"PropertiesPanel",props:{bpmnModeler:{},prefix:{default:"camunda"},width:{default:480},idEditDisabled:{type:Boolean,default:!1},autoTaskVariableList:{default:()=>[]},flowVariableList:{default:()=>[]},templateVariableList:{default:()=>[]}},setup(e){const t=e;(0,g.Gt)("prefix",t.prefix),(0,g.Gt)("width",t.width),(0,g.Gt)("flowVariableList",()=>t.flowVariableList),(0,g.Gt)("autoTaskVariableList",()=>t.autoTaskVariableList),(0,g.Gt)("templateVariableList",()=>t.templateVariableList);const a=(0,k.KR)(),l=(0,k.KR)(),n=(0,k.KR)(),i=(0,k.KR)(),s=(0,k.KR)("baseInfo"),r=(0,k.KR)(""),o=(0,k.KR)(""),u=(0,k.KR)({}),d=(0,k.KR)(!1),p=(0,k.KR)(!1),m=(0,k.KR)(!1),c=(0,k.KR)(!1);(0,g.wB)(m,e=>{e||-1!==["baseInfo","other"].indexOf(s.value)||(s.value="baseInfo")},{deep:!0});const b=window;let y=null;const v=()=>{t.bpmnModeler?(y&&clearTimeout(y),b.bpmnInstances={modeler:t.bpmnModeler,modeling:t.bpmnModeler.get("modeling"),moddle:t.bpmnModeler.get("moddle"),eventBus:t.bpmnModeler.get("eventBus"),bpmnFactory:t.bpmnModeler.get("bpmnFactory"),elementRegistry:t.bpmnModeler.get("elementRegistry"),replace:t.bpmnModeler.get("replace"),selection:t.bpmnModeler.get("selection")},f()):y=setTimeout(()=>v(),10)},f=()=>{h(null),t.bpmnModeler.on("import.done",()=>{h(null)}),t.bpmnModeler.on("selection.changed",({newSelection:e})=>{h(e[0]||null)}),t.bpmnModeler.on("element.changed",({element:e})=>{e&&e.id===r.value&&h(e)})},h=e=>{let t=e;t||(t=b.bpmnInstances.elementRegistry.find(e=>"bpmn:Process"===e.type)??b.bpmnInstances.elementRegistry.find(e=>"bpmn:Collaboration"===e.type)),t&&(b.bpmnInstances.bpmnElement=t,r.value=t.id,o.value=t.type.split(":")[1],u.value=JSON.parse(JSON.stringify(t.businessObject)),d.value=!("SequenceFlow"!==o.value||!t.source||-1!==t.source.type.indexOf("StartEvent")),p.value=!("SequenceFlow"!==o.value),m.value="UserTask"===o.value)},F=e=>{c.value=e};return(0,g.sV)(()=>{v()}),(0,g.xo)(()=>{b.bpmnInstances=null}),(e,t)=>{const b=we.v$,y=we.q;return(0,g.uX)(),(0,g.Wv)(y,{class:"properties-panel",modelValue:(0,k.R1)(s),"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.i9)(s)?s.value=e:null),style:{width:"430px"}},{default:(0,g.k6)(()=>[(0,g.bF)(b,{label:"基础设置",name:"baseInfo"},{label:(0,g.k6)(()=>t[5]||(t[5]=[(0,g.Lk)("div",{class:"panel-label"},"基础设置",-1)])),default:(0,g.k6)(()=>[(0,g.Lk)("div",Tn,[(0,g.Lk)("div",null,[(0,g.bF)(Ce,{"id-edit-disabled":e.idEditDisabled,"business-object":(0,k.R1)(u),type:(0,k.R1)(o)},null,8,["id-edit-disabled","business-object","type"]),(0,k.R1)(m)&&"baseInfo"===(0,k.R1)(s)?((0,g.uX)(),(0,g.Wv)(Sa,{id:(0,k.R1)(r),type:(0,k.R1)(o),tabType:(0,k.R1)(s),key:"form"},null,8,["id","type","tabType"])):(0,g.Q3)("",!0),(0,k.R1)(m)?((0,g.uX)(),(0,g.Wv)($l,{id:(0,k.R1)(r),type:(0,k.R1)(o),key:"variable"},null,8,["id","type"])):(0,g.Q3)("",!0),(0,k.R1)(m)&&"baseInfo"===(0,k.R1)(s)&&(0,k.R1)(o)&&-1!==(0,k.R1)(o).indexOf("Task")||"baseInfo"===(0,k.R1)(s)&&"SubProcess"===(0,k.R1)(o)?((0,g.uX)(),(0,g.Wv)(Xt,{onIsCountersignChange:F,"business-object":(0,k.R1)(u),type:(0,k.R1)(o),key:(0,k.R1)(u).id,templateVariableList:e.templateVariableList},null,8,["business-object","type","templateVariableList"])):(0,g.Q3)("",!0),"ServiceTask"!==(0,k.R1)(o)&&"ReceiveTask"!==(0,k.R1)(o)||"baseInfo"!==(0,k.R1)(s)?(0,g.Q3)("",!0):((0,g.uX)(),(0,g.Wv)((0,k.R1)(Ml),{key:3,id:(0,k.R1)(r),type:(0,k.R1)(o),tabType:(0,k.R1)(s)},null,8,["id","type","tabType"]))]),(0,k.R1)(m)?((0,g.uX)(),(0,g.CE)("div",En,[(0,g.bF)(vn,{id:(0,k.R1)(r),isCountersign:(0,k.R1)(c)},null,8,["id","isCountersign"])])):(0,g.Q3)("",!0),(0,k.R1)(d)?((0,g.uX)(),(0,g.CE)("div",_n,[(0,g.bF)(Gt,{"business-object":(0,k.R1)(u),type:(0,k.R1)(o)},null,8,["business-object","type"])])):(0,g.Q3)("",!0),(0,k.R1)(p)?((0,g.uX)(),(0,g.CE)("div",Sn,[t[6]||(t[6]=(0,g.Lk)("div",{class:"panel-title"},"审批状态",-1)),(0,g.bF)(Ra,{id:(0,k.R1)(r),type:(0,k.R1)(o)},null,8,["id","type"])])):(0,g.Q3)("",!0)])]),_:1}),(0,k.R1)(m)?((0,g.uX)(),(0,g.Wv)(b,{key:0,label:"按钮设置",name:"button"},{label:(0,g.k6)(()=>t[7]||(t[7]=[(0,g.Lk)("div",{class:"panel-label"},"按钮设置",-1)])),default:(0,g.k6)(()=>[(0,g.Lk)("div",In,[(0,k.R1)(m)?((0,g.uX)(),(0,g.CE)("div",wn,[(0,g.Lk)("div",An,[t[9]||(t[9]=(0,g.eW)(" 按钮 ")),(0,g.bF)(Ae.A,{onClick:t[0]||(t[0]=(0,R.D$)(e=>(0,k.R1)(a).onEditOperation(),["prevent","stop"]))},{default:(0,g.k6)(()=>t[8]||(t[8]=[(0,g.eW)("添加")])),_:1,__:[8]})]),"button"===(0,k.R1)(s)?((0,g.uX)(),(0,g.Wv)(Sa,{key:0,id:(0,k.R1)(r),type:(0,k.R1)(o),tabType:(0,k.R1)(s),ref_key:"elementForm",ref:a},null,8,["id","type","tabType"])):(0,g.Q3)("",!0)])):(0,g.Q3)("",!0),(0,k.R1)(m)?((0,g.uX)(),(0,g.CE)("div",xn,[(0,g.bF)(cn,{id:(0,k.R1)(r),isCountersign:(0,k.R1)(c)},null,8,["id","isCountersign"]),(0,g.bF)(Fn,{id:(0,k.R1)(r),type:(0,k.R1)(o)},null,8,["id","type"])])):(0,g.Q3)("",!0)])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(m)?((0,g.uX)(),(0,g.Wv)(b,{key:1,label:"任务处理人",name:"taskHandler"},{label:(0,g.k6)(()=>t[10]||(t[10]=[(0,g.Lk)("div",{class:"panel-label"},"任务处理人",-1)])),default:(0,g.k6)(()=>[(0,g.Lk)("div",Vn,[!(0,k.R1)(o)||-1===(0,k.R1)(o).indexOf("Task")&&"SubProcess"!==(0,k.R1)(o)?(0,g.Q3)("",!0):((0,g.uX)(),(0,g.CE)("div",Cn,[(0,g.bF)(kt,{id:(0,k.R1)(r),type:(0,k.R1)(o),isCountersign:(0,k.R1)(c)},null,8,["id","type","isCountersign"])])),(0,k.R1)(m)?((0,g.uX)(),(0,g.CE)("div",Ln,[t[11]||(t[11]=(0,g.Lk)("div",{class:"panel-title"},"抄送设置",-1)),(0,g.bF)(ln,{id:(0,k.R1)(r),type:(0,k.R1)(o),ref:"copyForSelect"},null,8,["id","type"])])):(0,g.Q3)("",!0)])]),_:1})):(0,g.Q3)("",!0),(0,g.bF)(b,{label:"其他设置",name:"other"},{label:(0,g.k6)(()=>t[12]||(t[12]=[(0,g.Lk)("div",{class:"panel-label"},"其他设置",-1)])),default:(0,g.k6)(()=>[(0,g.Lk)("div",Dn,["Process"===(0,k.R1)(o)?((0,g.uX)(),(0,g.CE)("div",Nn,[(0,g.bF)(ea)])):(0,g.Q3)("",!0),(0,k.R1)(o)?((0,g.uX)(),(0,g.CE)("div",Pn,[(0,g.Lk)("div",Wn,[t[14]||(t[14]=(0,g.eW)(" 执行监听器 ")),(0,g.bF)(Ae.A,{onClick:t[1]||(t[1]=(0,R.D$)(e=>(0,k.R1)(l).openListenerForm(),["prevent","stop"]))},{default:(0,g.k6)(()=>t[13]||(t[13]=[(0,g.eW)("添加")])),_:1,__:[13]})]),(0,g.bF)(ca,{ref_key:"listeners",ref:l,id:(0,k.R1)(r),type:(0,k.R1)(o)},null,8,["id","type"])])):(0,g.Q3)("",!0),"UserTask"===(0,k.R1)(o)?((0,g.uX)(),(0,g.CE)("div",On,[(0,g.Lk)("div",Bn,[t[16]||(t[16]=(0,g.eW)(" 任务监听器 ")),(0,g.bF)(Ae.A,{onClick:t[2]||(t[2]=(0,R.D$)(e=>(0,k.R1)(n).openListenerForm(),["prevent","stop"]))},{default:(0,g.k6)(()=>t[15]||(t[15]=[(0,g.eW)("添加")])),_:1,__:[15]})]),(0,g.bF)(dn,{id:(0,k.R1)(r),type:(0,k.R1)(o),ref_key:"useTaskListeners",ref:n},null,8,["id","type"])])):(0,g.Q3)("",!0),(0,k.R1)(o)&&!(0,k.R1)(d)?((0,g.uX)(),(0,g.CE)("div",Un,[(0,g.Lk)("div",zn,[t[18]||(t[18]=(0,g.eW)(" 扩展属性 ")),(0,g.bF)(Ae.A,{onClick:t[3]||(t[3]=(0,R.D$)(e=>(0,k.R1)(i).openAttributesForm(null,-1),["prevent","stop"]))},{default:(0,g.k6)(()=>t[17]||(t[17]=[(0,g.eW)("添加")])),_:1,__:[17]})]),(0,g.bF)(fa,{id:(0,k.R1)(r),type:(0,k.R1)(o),ref_key:"properties",ref:i},null,8,["id","type"])])):(0,g.Q3)("",!0)])]),_:1})]),_:1},8,["modelValue"])}}});const Mn=Kn;var Xn=Mn,qn=a(83639),$n=a(90007),Qn=a(60123),Gn=a(96659),jn=a(9334),Jn=a(27563);function Hn(e,t,a,l,n,i,s,r,o,u,d,p,m){e=e||{},l.registerProvider(this),this._contextPad=l,this._modeling=n,this._elementFactory=i,this._connect=s,this._create=r,this._popupMenu=o,this._canvas=u,this._rules=d,this._translate=p,!1!==e.autoPlace&&(this._autoPlace=t.get("autoPlace",!1)),a.on("create.end",250,function(e){var t=e.context,a=t.shape;if((0,Jn.Io)(e)&&l.isOpen(a)){var n=l.getEntries(a);n.replace&&n.replace.action.click(e,a)}})}function Yn(e,t,a){var l=e.$instanceOf(t),n=!1,i=e.eventDefinitions||[];return(0,qn.jJ)(i,function(e){e.$type===a&&(n=!0)}),l&&n}Hn.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate","elementRegistry"],Hn.prototype.getContextPadEntries=function(e){var t=this._contextPad,a=this._modeling,l=this._elementFactory,n=this._connect,i=this._create,s=this._popupMenu,r=this._canvas,o=this._rules,u=this._autoPlace,d=this._translate,p={};if("label"===e.type)return p;var m=e.businessObject;function c(e,t){n.start(e,t)}function b(){a.removeElements([e])}function y(e){var a=5,l=r.getContainer(),n=t.getPad(e).html,i=l.getBoundingClientRect(),s=n.getBoundingClientRect(),o=s.top-i.top,u=s.left-i.left,d={x:u,y:o+s.height+a};return d}function v(e,t,a,n){function s(t,a){var s=l.createShape((0,qn.kp)({type:e},n));i.start(t,s,{source:a})}"string"!==typeof a&&(n=a,a=d("Append {type}",{type:e.replace(/^bpmn:/,"")}));var r=u?function(t,a){var i=l.createShape((0,qn.kp)({type:e},n));u.append(a,i)}:s;return{group:"model",className:t,title:a,action:{dragstart:s,click:r}}}function f(e){return function(l,n){a.splitLane(n,e),t.open(n,!0)}}if((0,Gn.f)(m,["bpmn:Lane","bpmn:Participant"])&&(0,Qn.Av)(m)){var g=(0,jn.Aw)(e);(0,qn.kp)(p,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:d("Add Lane above"),action:{click:function(e,t){a.addLane(t,"top")}}}}),g.length<2&&(e.height>=120&&(0,qn.kp)(p,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:d("Divide into two Lanes"),action:{click:f(2)}}}),e.height>=180&&(0,qn.kp)(p,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:d("Divide into three Lanes"),action:{click:f(3)}}})),(0,qn.kp)(p,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:d("Add Lane below"),action:{click:function(e,t){a.addLane(t,"bottom")}}}})}(0,$n.is)(m,"bpmn:FlowNode")&&((0,$n.is)(m,"bpmn:EventBasedGateway")?(0,qn.kp)(p,{"append.receive-task":v("bpmn:ReceiveTask","bpmn-icon-receive-task",d("Append ReceiveTask")),"append.message-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",d("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",d("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",d("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",d("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):Yn(m,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?(0,qn.kp)(p,{"append.compensation-activity":v("bpmn:Task","bpmn-icon-task",d("Append compensation activity"),{isForCompensation:!0})}):(0,$n.is)(m,"bpmn:EndEvent")||m.isForCompensation||Yn(m,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||(0,Qn.Q1)(m)||(0,qn.kp)(p,{"append.end-event":v("bpmn:EndEvent","bpmn-icon-end-event-none",d("Append EndEvent")),"append.gateway":v("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",d("Append Gateway")),"append.append-task":v("bpmn:UserTask","bpmn-icon-user-task",d("Append Task")),"append.intermediate-event":v("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",d("Append Intermediate/Boundary Event"))})),s.isEmpty(e,"bpmn-replace")||(0,qn.kp)(p,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:d("Change type"),action:{click:function(e,t){var a=(0,qn.kp)(y(t),{cursor:{x:e.x,y:e.y}});s.open(t,"bpmn-replace",a)}}}}),(0,Gn.f)(m,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,qn.kp)(p,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:d("Connect using "+(m.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:c,dragstart:c}}}),(0,Gn.f)(m,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,qn.kp)(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:d("Connect using DataInputAssociation"),action:{click:c,dragstart:c}}}),(0,$n.is)(m,"bpmn:Group")&&(0,qn.kp)(p,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var k=o.allowed("elements.delete",{elements:[e]});return(0,qn.cy)(k)&&(k=k[0]===e),k&&(0,qn.kp)(p,{delete:{group:"edit",className:"bpmn-icon-trash",title:d("Remove"),action:{click:b}}}),p};var Zn={__init__:["contextPadProvider"],contextPadProvider:["type",Hn]},ei=a(5754),ti=a(45268),ai=a(42340),li=a(73685),ni=a(97294),ii=a(61928),si=a(42543);function ri(e,t,a,l,n,i,s,r){this._palette=e,this._create=t,this._elementFactory=a,this._spaceTool=l,this._lassoTool=n,this._handTool=i,this._globalConnect=s,this._translate=r,e.registerProvider(this)}ri.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],ri.prototype.getPaletteEntries=function(){var e={},t=this._create,a=this._elementFactory,l=this._spaceTool,n=this._lassoTool,i=this._handTool,s=this._globalConnect,r=this._translate;function o(e,l,n,i,s){function o(l){var n=a.createShape((0,qn.kp)({type:e},s));s&&(n.businessObject.di.isExpanded=s.isExpanded),t.start(l,n)}var u=e.replace(/^bpmn:/,"");return{group:l,className:n,title:i||r("Create {type}",{type:u}),action:{dragstart:o,click:o}}}function u(e){var l=a.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),n=a.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:l});t.start(e,[l,n],{hints:{autoSelect:[n]}})}function d(e){t.start(e,a.createParticipantShape())}return(0,qn.kp)(e,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:r("Activate the hand tool"),action:{click:function(e){i.activateHand(e)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:r("Activate the lasso tool"),action:{click:function(e){n.activateSelection(e)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:r("Activate the create/remove space tool"),action:{click:function(e){l.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:r("Activate the global connect tool"),action:{click:function(e){s.toggle(e)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":o("bpmn:StartEvent","event","bpmn-icon-start-event-none",r("Create StartEvent")),"create.intermediate-event":o("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",r("Create Intermediate/Boundary Event")),"create.end-event":o("bpmn:EndEvent","event","bpmn-icon-end-event-none",r("Create EndEvent")),"create.exclusive-gateway":o("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",r("Create Gateway")),"create.user-task":o("bpmn:UserTask","activity","bpmn-icon-user-task",r("Create User Task")),"create.data-object":o("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",r("Create DataObjectReference")),"create.data-store":o("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",r("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:r("Create expanded SubProcess"),action:{dragstart:u,click:u}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:r("Create Pool/Participant"),action:{dragstart:d,click:d}},"create.group":o("bpmn:Group","artifact","bpmn-icon-group",r("Create Group"))}),e};var oi={__depends__:[ei.A,ti.A,ai.A,li.A,ni.A,ii.A,si.A],__init__:["paletteProvider"],paletteProvider:["type",ri]};const ui={class:"process-design",style:{display:"flex",height:"100%"}};var di=(0,g.pM)({__name:"ProcessDesigner",props:{flowEntryInfo:{}},emits:["save"],setup(e,{expose:t,emit:a}){M.A.registerLanguage("xml",X.A),M.A.registerLanguage("json",q.A);const l=a,n=e,i=(0,k.KR)();let s=0;const r=(0,k.KR)(n.flowEntryInfo.bpmnXml),o=(0,k.KR)(),u=(0,k.KR)({processId:"",processName:"",simulation:!1,labelEditing:!1,labelVisible:!1,prefix:"flowable",headerButtonSize:"default",additionalModel:[Zn,oi]}),d=(0,k.KR)([]),p=(0,k.KR)([]),m=(0,k.KR)([]),c=e=>{console.log("ProcessDesigner main",e)},b=e=>{setTimeout(()=>{o.value=e},10)},y=(e,t,a)=>{console.log("ProcessDesigner main",e,t,a)},v=e=>{l("save",e)},f=()=>new Promise((e,t)=>{let a={entryId:n.flowEntryInfo.entryId};C.nY.listAutoFlowVariables(a).then(t=>{p.value=(t.data||[]).reduce((e,t)=>{let a=e.find(e=>e.id===t.variableType);return null==a?(a={id:t.variableType,name:D.SysFlowVariableType.getValue(t.variableType),children:[{id:t.variableName,name:t.showName}]},e.push(a)):a.children.push({id:t.variableName,name:t.showName}),e},[]),e(p.value)}).catch(e=>{t(e)})}),h=()=>{let e={entryId:n.flowEntryInfo.entryId};C.nY.listMessageFlowVariables(e).then(e=>{const t=e.data||[],a=[];for(const l of t)a.push({id:l.variableName,name:l.showName});m.value=a})},R=(e,t,a)=>{let l;if(e===D.AutoTaskActionType.HTTP||e===D.AutoTaskActionType.SEND_MQ){if(null==a)return[];let e=a.map(e=>({id:t+"."+e.id,name:e.fieldName,parentId:e.parentId?t+"."+e.parentId:void 0,fieldName:e.fieldName,fieldType:e.fieldType}));l=(0,$.BN)(e,"id","parentId")}else if(e===D.AutoTaskActionType.QUERY_SINGLE_DATA){if(null==a)return[];l=a.map(e=>({id:t+"."+e,name:e}))}else if(e===D.AutoTaskActionType.AGGREGATE){if(null==a)return[];l=a.map(e=>({id:t+"."+e,name:e}))}else if(e===D.AutoTaskActionType.FORMULA){if(null==a)return[];l=a.map(e=>({id:t+"."+e,name:e}))}return l},F=(e,t,a)=>{let l=d.value.find(t=>t.id===e);a&&a.length>0?null==l?d.value.push({id:e,name:t||e,children:a}):(l.name=t||e,l.children=a):null!=l&&(d.value=d.value.filter(t=>t.id!==e))},T=(e,t)=>{function a(e,t,l){e.id=t+"."+e.id.split(".").pop(),e.children&&e.children.length>0&&e.children.forEach(e=>{a(e,t,l)})}console.log("elementUpdateId",e,t);let l=e.id,n=t.newId;d.value.forEach(e=>{e.id===l&&(e.id=n,e.children.forEach(e=>{a(e,n,l)}))})},E=async(e,t)=>{if(n.flowEntryInfo.flowType===D.FlowEntryType.AUTO_TASK&&e&&e.businessObject){let t=e.businessObject.id,a=e.businessObject.name,l=e.businessObject.get("extensionElements");if(null!=l&&Array.isArray(l.values)){let e=l.values.filter(e=>":TaskInfo"===e.$type)[0];if(null!=e){let l=e.data;if(null!=l&&""!==l){let e,n=JSON.parse(l);if(n.actionType===D.AutoTaskActionType.INSERT);else if(n.actionType===D.AutoTaskActionType.QUERY_SINGLE_DATA){if(null!=t&&""!==t){let a=n.selectFieldList;if((null==a||0===a.length)&&n.srcDblinkId&&n.srcTableName){let e=await C.V7.listDblinkTableColumns({dblinkId:n.srcDblinkId,tableName:n.srcTableName});a=e.data.map(e=>e.columnName)}e=R(n.actionType,t,a)}}else if(n.actionType===D.AutoTaskActionType.HTTP)null!=t&&""!==t&&n.httpResponnseData&&n.httpResponnseData.httpResponseBody&&(e=R(n.actionType,t,n.httpResponnseData.httpResponseBody));else if(n.actionType===D.AutoTaskActionType.AGGREGATE){if(null!=t&&""!==t){let a=(n.aggregationDataList||[]).map(e=>e.alias);e=R(n.actionType,t,a)}}else if(n.actionType===D.AutoTaskActionType.FORMULA&&null!=t&&""!==t){let a=["dataResult"];e=R(n.actionType,t,a)}e&&F(t,a,e)}}}}},_=(e,t)=>{setTimeout(()=>{if(e&&e.businessObject){let t=e.businessObject.id,a=e.businessObject.name;t&&F(t,a,null)}})};return(0,g.wB)(()=>n.flowEntryInfo.autoTaskVariableList,()=>{null!=n.flowEntryInfo.autoTaskVariableList?d.value=n.flowEntryInfo.autoTaskVariableList.map(e=>{let t=e.fieldList||e.httpResponseBody||e.messageResponseBody;e.actionType!==D.AutoTaskActionType.HTTP&&e.actionType!==D.AutoTaskActionType.SEND_MQ||(t=JSON.parse(t));let a=R(e.actionType,e.taskKey,t);return a&&a.length>0?{taskId:e.taskId,id:e.taskKey,name:e.taskName||e.taskKey,actionType:e.actionType,children:a}:null}).filter(e=>null!=e):d.value=[]},{deep:!0,immediate:!0}),(0,g.sV)(()=>{f(),h()}),t({processDesigner:i}),(e,t)=>((0,g.uX)(),(0,g.CE)("div",ui,[((0,g.uX)(),(0,g.Wv)(Ie,(0,g.v6)((0,k.R1)(u),{key:`designer-${(0,k.R1)(s)}`,value:(0,k.R1)(r),"onUpdate:value":t[0]||(t[0]=e=>(0,k.i9)(r)?r.value=e:null),keyboard:"",ref_key:"processDesigner",ref:i,processId:e.flowEntryInfo.processDefinitionKey,processName:e.flowEntryInfo.processDefinitionName,flowEntryInfo:e.flowEntryInfo,events:["element.click","connection.added","connection.removed","connection.changed","element.changed","element.updateId","shape.removed"],onElementClick:c,onElementChanged:E,onElementUpdateId:T,onShapeRemoved:_,onInitFinished:b,onEvent:y,onSave:v}),null,16,["value","processId","processName","flowEntryInfo"])),(0,k.R1)(o)?((0,g.uX)(),(0,g.Wv)(Xn,{key:`penal-${(0,k.R1)(s)}`,"bpmn-modeler":(0,k.R1)(o),prefix:(0,k.R1)(u).prefix,width:600,autoTaskVariableList:(0,k.R1)(d),flowVariableList:(0,k.R1)(p),templateVariableList:(0,k.R1)(m),class:"process-panel"},null,8,["bpmn-modeler","prefix","autoTaskVariableList","flowVariableList","templateVariableList"])):(0,g.Q3)("",!0)]))}});const pi=di;var mi=pi,ci=a(39585),bi=a(22609);const yi={class:"edit-online-form"},vi={key:0,style:{position:"relative"}},fi=["src"],gi={key:1,class:"el-icon-plus upload-image-item"},ki="${startShowName}的${processDefinitionName}";var hi=(0,g.pM)({__name:"formEditFlowEntry",props:{flowEntry:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,K.l5)(),a=[{id:1,name:"同意"},{id:2,name:"拒绝"},{id:3,name:"驳回"},{id:4,name:"会签同意"},{id:5,name:"会签拒绝"}],{getUploadFileUrl:w,getUploadHeaders:M,getUploadActionUrl:X}=(0,O.v)(),q=e,{thirdParams:$,onCloseThirdDialog:Q}=(0,z.P)(q),G=(0,g.EW)(()=>t.defaultFormItemSize||$.value.defaultFormItemSize?.value),j=(0,g.WQ)("documentClientHeight",200),J=(0,k.KR)(),H=(0,k.KR)(),Y=(0,k.KR)(D.SysFlowEntryStep.BASIC),Z=(0,k.KR)({entryId:void 0,processDefinitionName:void 0,processDefinitionKey:void 0,flowType:D.FlowEntryType.NORMAL,categoryId:void 0,bindFormType:D.SysFlowEntryBindFormType.ROUTER_FORM,pageId:void 0,defaultFormId:void 0,defaultRouterName:void 0,bpmnXml:void 0,diagramType:D.DiagramType.ORDINARY,encodedRule:{calculateWhenView:!1,prefix:void 0,precisionTo:D.SysAutoCodeType.DAYS,middle:void 0,idWidth:void 0},extensionData:{},notifyTypes:void 0,cascadeDeleteBusinessData:!1,supportRevive:!1,keptReviveDays:void 0,autoParamJson:void 0,flowSummary:ki,imageData:void 0}),ee=(0,k.KR)([]),te={processDefinitionKey:[{required:!0,message:"流程标识不能为空！",trigger:"blur"},{type:"string",pattern:/^[A-Za-z0-9]+$/,message:"流程标识只允许输入字母和数字",trigger:"blur"},{type:"string",pattern:/^[A-Za-z][A-Za-z0-9]+$/,message:"流程标识不能以数字开头",trigger:"blur"}],processDefinitionName:[{required:!0,message:"流程名称不能为空！",trigger:"blur"}],categoryId:[{required:!0,message:"流程分类不能为空！",trigger:"blur"}],flowType:[{required:!0,message:"流程类型不能为空！",trigger:"blur"}],pageId:[{required:!0,message:"流程页面不能为空！",trigger:"blur"}],defaultFormId:[{required:!0,message:"默认在线表单不能为空！",trigger:"blur"}],defaultRouterName:[{required:!0,message:"默认路由表单不能为空！",trigger:"blur"}],flowSummary:[{required:!0,message:"流程摘要不能为空！",trigger:"blur"}]},ae=(0,k.KR)([]),le=(0,k.KR)([]);let ne;const ie=()=>new Promise((e,t)=>{C.VU.dictFlowCategory({}).then(t=>{e({dataList:t.getList()})}).catch(e=>{t(e)})}),se={loadData:ie},re=(0,k.Kh)((0,W.B)(se)),oe=()=>new Promise((e,t)=>{L.Pr.list({onlinePageDtoFilter:{pageType:B.SysOnlinePageType.FLOW}}).then(t=>{e({dataList:t.data.dataList.filter(e=>e.published)})}).catch(e=>{t(e)})}),ue={loadData:oe},de=(0,k.Kh)((0,W.B)(ue)),pe=()=>new Promise((e,t)=>{null!=Z.value.pageId&&""!==Z.value.pageId?L.k$.list({onlineFormDtoFilter:{pageId:Z.value.pageId},orderParam:[{fieldName:"createTime",asc:!0}]}).then(t=>{le.value=t.data.dataList||[],e({dataList:(t.data.dataList||[]).filter(e=>e.formType===N.SysOnlineFormType.FLOW)})}).catch(e=>{t(e)}):e({dataList:[]})}),me={loadData:pe},ce=(0,k.Kh)((0,W.B)(me)),be=e=>{e.success?Z.value.imageData=e.data:_.nk.error(e.message)},ye=()=>{Z.value.imageData=void 0},ve=(0,g.EW)(()=>({flowEntry:q.flowEntry||$.value.flowEntry})),fe=(0,g.EW)(()=>null!=ve.value.flowEntry||null!=Z.value.entryId),ge=(0,g.EW)(()=>(le.value||[]).filter(e=>e.formType===N.SysOnlineFormType.WORK_ORDER)),ke=(0,g.EW)(()=>w(Z.value.imageData,{filename:Z.value.imageData.filename})),he=()=>{switch(Y.value){case D.SysFlowEntryStep.PROCESS_VARIABLE:Y.value=D.SysFlowEntryStep.BASIC;break;case D.SysFlowEntryStep.PROCESS_STATUS:Y.value=D.SysFlowEntryStep.PROCESS_VARIABLE;break;case D.SysFlowEntryStep.PROCESS_DESIGN:Z.value.flowType===D.FlowEntryType.AUTO_TASK?Y.value=D.SysFlowEntryStep.BASIC:Y.value=D.SysFlowEntryStep.PROCESS_STATUS;break}},Re=()=>{null==Z.value.extensionData&&(Z.value.extensionData={}),Array.isArray(Z.value.extensionData.approvalStatusDict)||(Z.value.extensionData["approvalStatusDict"]=[...a]),Z.value.extensionData["notifyTypes"]=Z.value.notifyTypes,Z.value.extensionData["cascadeDeleteBusinessData"]=Z.value.cascadeDeleteBusinessData,Z.value.extensionData["supportRevive"]=Z.value.supportRevive,Z.value.extensionData["keptReviveDays"]=Z.value.keptReviveDays,Z.value.extensionData["flowSummary"]=Z.value.flowSummary;let e={flowEntryDto:{...Z.value,diagramType:H.value?.processDesigner?.diagramType||Z.value.diagramType,imageData:Z.value.imageData?JSON.stringify(Z.value.imageData):"",extensionData:JSON.stringify(Z.value.extensionData),autoParamJson:JSON.stringify(ee.value.map(e=>({variableName:e})))}};return console.log("formEditFlowEntry.saveFlowEntryInfo params",e,"designer.value",H.value),fe.value?C.Dy.update(e):C.Dy.add(e)},Fe=e=>null==ne?Promise.resolve(e):L.PC.list({onlineDatasourceRelationDtoFilter:{datasourceId:ne.datasourceId}}),Te=(e,t)=>null==e||""===e?Promise.reject():new Promise((a,l)=>{let n={onlineColumnDtoFilter:{tableId:e}};L.aq.list(n).then(e=>{t.columnList=e.data.dataList,a(e)}).catch(e=>{l(e)})}),Ee=e=>{if(null==ne)return Promise.resolve(e);let t=[Te(ne.masterTableId,ne)];ne.relationList.forEach(e=>{e.relationType===B.SysOnlineRelationType.ONE_TO_ONE&&t.push(Te(e.slaveTableId,e))}),Promise.all(t).then(e=>Promise.resolve(e))},_e=()=>new Promise((e,t)=>{if(null!=ne||Z.value.flowType===D.FlowEntryType.AUTO_TASK)return e(null);Z.value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM?L.Pr.listOnlinePageDatasource({pageId:Z.value.pageId}).then(e=>(ne=e.data.dataList[0],Fe(e))).then(e=>(ne?ne.relationList=e.data.dataList||[]:console.error("formEditFlowEntry.entryDatasource is null"),Ee(e))).then(()=>L.jk.list({onlineVirtualColumnDtoFilter:{datasourceId:ne?.datasourceId}})).then(t=>{let a=t.data.dataList;Array.isArray(a)&&ne&&(Array.isArray(ne.columnList)||(ne.columnList=[]),ne?.columnList.push(...a.map(e=>({...e,columnId:e.virtualColumnId,columnName:e.objectFieldName,columnComment:e.columnPrompt})))),e(t)}).catch(e=>{t(e)}):(ne=null,e(null))}),Se=()=>Re(),Ie=()=>new Promise((e,t)=>{let a={flowEntryVariableDtoFilter:{entryId:Z.value.entryId||ve.value.flowEntry?.entryId}};C.nY.list(a).then(t=>{ae.value=t.data.dataList.map(e=>({...e})),e(t)}).catch(e=>{t(e)})}),we=()=>{switch(Y.value){case D.SysFlowEntryStep.BASIC:J.value.validate(e=>{if(e){if(Z.value.encodedRule.calculateWhenView){if(null==Z.value.encodedRule.precisionTo||""===Z.value.encodedRule.precisionTo)return void _.nk.error("工单编码精度类型！");if(null==Z.value.encodedRule.idWidth||Z.value.encodedRule.idWidth<=0)return void _.nk.error("工单编码编号长度不能小于1！")}Se().then(e=>{fe.value||(Z.value.entryId=e.data),_.nk.success("保存成功"),Z.value.flowType!==D.FlowEntryType.AUTO_TASK?(null!=Z.value.pageId&&""!==Z.value.pageId&&L.Pr.getDblinkIdByPageId({pageId:Z.value.pageId}).then(e=>{Z.value.dblinkId=e.data}).catch(e=>{}),_e().then(()=>Ie()).then(()=>{Y.value=D.SysFlowEntryStep.PROCESS_VARIABLE}).catch(e=>{console.log(e)})):Y.value=D.SysFlowEntryStep.PROCESS_DESIGN}).catch(e=>{console.log(e)})}});break;case D.SysFlowEntryStep.PROCESS_VARIABLE:Y.value=D.SysFlowEntryStep.PROCESS_STATUS;break;case D.SysFlowEntryStep.PROCESS_STATUS:Se().then(()=>{_.nk.success("保存成功"),Y.value=D.SysFlowEntryStep.PROCESS_DESIGN}).catch(e=>{console.log(e)});break}},Ae=()=>{q.dialog?q.dialog.cancel():Q(!0)},xe=()=>{Z.value.diagramType=Z.value.diagramType===D.DiagramType.ORDINARY?D.DiagramType.DINGDING:D.DiagramType.ORDINARY,H.value.processDesigner.changeDiagram()},Ve=()=>{H.value.processDesigner.onSave()},Ce=()=>{Z.value.pageId=void 0,Z.value.defaultFormId=void 0,Z.value.defaultRouterName=void 0,ne=void 0},Le=()=>{ce.setDirty(!0),Z.value.defaultFormId=void 0,ne=null},De=e=>{let t={url:window.location.origin+"/#/thirdParty/thirdOnlineForm?formId="+e.formId+"&entryId="+Z.value.entryId,processDefinitionKey:Z.value.processDefinitionKey};return JSON.stringify(t)},Ne=e=>{try{let t=new(A())("."+e);t.on("success",e=>{_.nk.success("接入信息复制成功！"),t.destroy()}),t.on("error",e=>{_.nk.error("浏览器不支持复制，请手动复制接入信息"),t.destroy()})}catch(t){console.log(t)}},Pe=e=>{U.l.show("编辑变量",bi["default"],{area:"500px"},{entryId:Z.value.entryId||ve.value.flowEntry.entryId,datasource:ne,rowData:e,path:"thirdFormEditFlowEntryVariable"},{width:"500px",height:"260px",pathName:"/thirdParty/thirdFormEditFlowEntryVariable"}).then(()=>{Ie()}).catch(e=>{console.warn(e)})},We=e=>{S.s.confirm("是否删除此流程变量？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t={variableId:e.variableId};return C.nY.delete(t)}).then(()=>{_.nk.success("删除成功！"),Ie()}).catch(e=>{console.warn(e)})},Oe=()=>{U.l.show("添加变量",bi["default"],{area:"500px"},{entryId:Z.value.entryId||ve.value.flowEntry.entryId,datasource:ne,path:"thirdFormEditFlowEntryVariable"},{width:"500px",height:"260px",pathName:"/thirdParty/thirdFormEditFlowEntryVariable"}).then(()=>{Ie()}).catch(e=>{console.warn(e)})},Be=e=>{U.l.show(e?"编辑状态":"添加状态",ci["default"],{area:"500px"},{rowData:e,flowEntry:Z.value,path:"thirdFormEditFlowEntryStatus"},{width:"500px",height:"220px",pathName:"/thirdParty/thirdFormEditFlowEntryStatus"}).then(e=>{Z.value.extensionData.approvalStatusDict=[...e]}).catch(e=>{console.warn(e)})},Ue=e=>{console.log("formEditFlowEntry.deleteEntryStatus row",e),S.s.confirm("是否删除此审批状态？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t=>{console.log("formEditFlowEntry.deleteEntryStatus formFlowEntryData.extensionData.approvalStatusDict",Z.value.extensionData.approvalStatusDict);let a=Z.value.extensionData.approvalStatusDict.filter(t=>t.id!==e.id);console.log("formEditFlowEntry.deleteEntryStatus approvalStatusDict",a);let l={flowEntryDto:{...Z.value,extensionData:JSON.stringify({approvalStatusDict:a})}};C.Dy.update(l).then(e=>{_.nk.success("删除成功！"),Z.value.extensionData.approvalStatusDict=a}).catch(e=>{console.warn(e)})}).catch(e=>{console.warn(e)})},ze=e=>{Z.value.bpmnXml=e,Se().then(()=>{_.nk.success("保存成功")}).catch(e=>{console.warn(e)})},Ke=()=>{Z.value={processDefinitionName:void 0,processDefinitionKey:void 0,categoryId:void 0,flowType:D.FlowEntryType.NORMAL,bindFormType:D.SysFlowEntryBindFormType.ONLINE_FORM,pageId:void 0,defaultFormId:void 0,defaultRouterName:void 0,bpmnXml:void 0,diagramType:D.DiagramType.ORDINARY,encodedRule:{calculateWhenView:!1,prefix:void 0,precisionTo:D.SysAutoCodeType.DAYS,middle:void 0,idWidth:void 0},extensionData:{},notifyTypes:void 0,cascadeDeleteBusinessData:!1,supportRevive:!1,keptReviveDays:void 0,autoParamJson:void 0,flowSummary:ki,imageData:void 0},ee.value=[],Y.value=D.SysFlowEntryStep.BASIC,C.Dy.view({entryId:ve.value.flowEntry?.entryId}).then(e=>{if(Z.value={...Z.value,...e.data,encodedRule:null!=e.data.encodedRule?JSON.parse(e.data.encodedRule):{calculateWhenView:!1,prefix:void 0,precisionTo:D.SysAutoCodeType.DAYS,middle:void 0,idWidth:void 0},extensionData:null!=e.data.extensionData?JSON.parse(e.data.extensionData):{}},Z.value.notifyTypes=Z.value.extensionData.notifyTypes||[],Z.value.cascadeDeleteBusinessData=Z.value.extensionData.cascadeDeleteBusinessData||!1,Z.value.supportRevive=Z.value.extensionData.supportRevive||!1,Z.value.keptReviveDays=Z.value.extensionData.keptReviveDays,Z.value.flowSummary=Z.value.extensionData.flowSummary||ki,ee.value=JSON.parse(Z.value.autoParamJson||"[]"),ee.value=ee.value.map(e=>e.variableName),null!=Z.value.imageData)try{Z.value.imageData=JSON.parse(e.data.imageData)}catch(t){Z.value.imageData=void 0}Z.value.bindFormType===D.SysFlowEntryBindFormType.ONLINE_FORM&&ce.onVisibleChange(!0),H.value?.processDesigner&&(H.value.processDesigner.diagramType=e.data.diagramType)}).catch(e=>{console.warn(e)})};return(0,g.sV)(()=>{re.onVisibleChange(!0),de.onVisibleChange(!0),fe.value&&Ke()}),(0,g.Gt)("flowEntry",()=>Z),(0,g.Gt)("formList",()=>ce?ce.dropdownList:[]),(0,g.Gt)("allVariableList",()=>ae),(e,t)=>{const a=f.uD,_=v.S2,S=y.S2,w=n.bZ,A=b.ll,C=b.MQ,L=s.xE,N=c.P9,W=c.AV,O=m.WK,B=p.dI,U=d.lq,z=u.j5,K=o.qi,q=r.C4,$=s.US,Q=i.u,le=n.ZO,ne=n.lX,ie=l.H6;return(0,g.uX)(),(0,g.Wv)(ie,{locale:(0,k.R1)(E.A)},{default:(0,g.k6)(()=>[(0,g.Lk)("div",yi,[(0,g.bF)(ne,{style:{height:"100vh"}},{default:(0,g.k6)(()=>[(0,g.bF)(w,{class:"step-header",style:{height:"72px"}},{default:(0,g.k6)(()=>[(0,g.bF)(S,{type:"flex",justify:"space-between"},{default:(0,g.k6)(()=>[(0,g.bF)(a,{class:"title header",span:6,style:{height:"auto","line-height":"auto"}},{default:(0,g.k6)(()=>t[21]||(t[21]=[(0,g.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"BIQS流程设计",-1)])),_:1,__:[21]}),(0,g.Lk)("div",null,[(0,g.bF)(x.A,{class:"step",value:(0,k.R1)(Y),style:{"margin-top":"14px"}},{default:(0,g.k6)(()=>[(0,g.bF)(V.A,{icon:"online-icon icon-basic-info",name:(0,k.R1)(D.SysFlowEntryStep).BASIC},{default:(0,g.k6)(()=>t[22]||(t[22]=[(0,g.eW)("基础信息")])),_:1,__:[22]},8,["name"]),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(V.A,{key:0,icon:"online-icon icon-operator",name:(0,k.R1)(D.SysFlowEntryStep).PROCESS_VARIABLE},{default:(0,g.k6)(()=>t[23]||(t[23]=[(0,g.eW)("流程变量")])),_:1,__:[23]},8,["name"])):(0,g.Q3)("",!0),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(V.A,{key:1,icon:"online-icon icon-flow-stauts",name:(0,k.R1)(D.SysFlowEntryStep).PROCESS_STATUS},{default:(0,g.k6)(()=>t[24]||(t[24]=[(0,g.eW)("审批状态")])),_:1,__:[24]},8,["name"])):(0,g.Q3)("",!0),(0,g.bF)(V.A,{icon:"online-icon icon-flow-design",name:(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN},{default:(0,g.k6)(()=>t[25]||(t[25]=[(0,g.eW)("流程设计")])),_:1,__:[25]},8,["name"])]),_:1},8,["value"])]),(0,g.bF)(a,{span:6},{default:(0,g.k6)(()=>[(0,g.bF)(S,{type:"flex",justify:"end",align:"middle",style:{height:"72px"}},{default:(0,g.k6)(()=>[(0,k.R1)(Y)!==(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN?((0,g.uX)(),(0,g.Wv)(_,{key:0,size:"default",onClick:he,disabled:(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).BASIC},{default:(0,g.k6)(()=>t[26]||(t[26]=[(0,g.eW)(" 上一步 ")])),_:1,__:[26]},8,["disabled"])):(0,g.Q3)("",!0),(0,k.R1)(Y)!==(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN?((0,g.uX)(),(0,g.Wv)(_,{key:1,type:"primary",size:"default",onClick:we,disabled:(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN},{default:(0,g.k6)(()=>t[27]||(t[27]=[(0,g.eW)("下一步")])),_:1,__:[27]},8,["disabled"])):(0,g.Q3)("",!0),(0,k.R1)(Y)!==(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN?((0,g.uX)(),(0,g.Wv)(_,{key:2,size:"default",onClick:Ae},{default:(0,g.k6)(()=>t[28]||(t[28]=[(0,g.eW)("退出")])),_:1,__:[28]})):(0,g.Q3)("",!0),(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN?((0,g.uX)(),(0,g.Wv)(_,{key:3,size:"default",onClick:xe},{default:(0,g.k6)(()=>t[29]||(t[29]=[(0,g.eW)("切换")])),_:1,__:[29]})):(0,g.Q3)("",!0),(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN?((0,g.uX)(),(0,g.Wv)(_,{key:4,size:"default",type:"primary",onClick:Ve},{default:(0,g.k6)(()=>t[30]||(t[30]=[(0,g.eW)("保存")])),_:1,__:[30]})):(0,g.Q3)("",!0),(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN?((0,g.uX)(),(0,g.Wv)(_,{key:5,size:"default",onClick:he},{default:(0,g.k6)(()=>t[31]||(t[31]=[(0,g.eW)("返回")])),_:1,__:[31]})):(0,g.Q3)("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),(0,g.bF)(le,{style:(0,h.Tr)([{padding:"10px",background:"#ebeef5"},{height:(0,k.R1)(j)-72+"px"}])},{default:(0,g.k6)(()=>[(0,g.bF)(S,{type:"flex",justify:"center",style:{height:"100%"}},{default:(0,g.k6)(()=>[(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).BASIC?((0,g.uX)(),(0,g.Wv)(a,{key:0,class:"main-box",style:{"min-width":"650px"},span:9},{default:(0,g.k6)(()=>[(0,g.bF)($,{ref_key:"entryBasicInfo",ref:J,class:"full-width-input",size:"default",model:(0,k.R1)(Z),rules:te,"label-position":"right","label-width":"80px",onSubmit:t[19]||(t[19]=(0,R.D$)(()=>{},["prevent"]))},{default:(0,g.k6)(()=>[(0,g.bF)(S,{gutter:16},{default:(0,g.k6)(()=>[(0,g.bF)(a,{span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程类型",prop:"flowType"},{default:(0,g.k6)(()=>[(0,g.bF)(C,{modelValue:(0,k.R1)(Z).flowType,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,k.R1)(Z).flowType=e),disabled:(0,k.R1)(fe)},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(D.FlowEntryType).getList(),e=>((0,g.uX)(),(0,g.Wv)(A,{key:e.id,value:e.id},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:0,span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"表单类型",prop:"bindFormType"},{default:(0,g.k6)(()=>[(0,g.bF)(W,{modelValue:(0,k.R1)(Z).bindFormType,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,k.R1)(Z).bindFormType=e),placeholder:"",onChange:Ce,disabled:(0,k.R1)(fe)},{default:(0,g.k6)(()=>[(0,g.bF)(N,{label:(0,k.R1)(D.SysFlowEntryBindFormType).getValue((0,k.R1)(D.SysFlowEntryBindFormType).ROUTER_FORM),value:(0,k.R1)(D.SysFlowEntryBindFormType).ROUTER_FORM},null,8,["label","value"]),(0,g.bF)(N,{label:(0,k.R1)(D.SysFlowEntryBindFormType).getValue((0,k.R1)(D.SysFlowEntryBindFormType).ONLINE_FORM),value:(0,k.R1)(D.SysFlowEntryBindFormType).ONLINE_FORM},null,8,["label","value"])]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,g.bF)(a,{span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程名称",prop:"processDefinitionName"},{default:(0,g.k6)(()=>[(0,g.bF)(O,{modelValue:(0,k.R1)(Z).processDefinitionName,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,k.R1)(Z).processDefinitionName=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,g.bF)(a,{span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程标识",prop:"processDefinitionKey"},{default:(0,g.k6)(()=>[(0,g.bF)(O,{modelValue:(0,k.R1)(Z).processDefinitionKey,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,k.R1)(Z).processDefinitionKey=e),disabled:(0,k.R1)(fe)},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,g.bF)(a,{span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程分类",prop:"categoryId"},{default:(0,g.k6)(()=>[(0,g.bF)(W,{modelValue:(0,k.R1)(Z).categoryId,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,k.R1)(Z).categoryId=e),placeholder:"",loading:(0,k.R1)(re).loading,onVisibleChange:(0,k.R1)(re).onVisibleChange},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(re).dropdownList,e=>((0,g.uX)(),(0,g.Wv)(N,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1}),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:1,span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"工单编码"},{default:(0,g.k6)(()=>[(0,g.bF)(S,{type:"flex",align:"middle",style:{"flex-wrap":"nowrap"}},{default:(0,g.k6)(()=>[(0,g.bF)(O,{modelValue:(0,k.R1)(Z).encodedRule.prefix,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,k.R1)(Z).encodedRule.prefix=e),style:{width:"150px"},placeholder:"前缀",disabled:!(0,k.R1)(Z).encodedRule.calculateWhenView},{prepend:(0,g.k6)(()=>[(0,g.bF)(B,{modelValue:(0,k.R1)(Z).encodedRule.calculateWhenView,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,k.R1)(Z).encodedRule.calculateWhenView=e)},null,8,["modelValue"])]),_:1},8,["modelValue","disabled"]),(0,g.bF)(W,{modelValue:(0,k.R1)(Z).encodedRule.precisionTo,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,k.R1)(Z).encodedRule.precisionTo=e),style:{width:"160px","margin-left":"5px"},placeholder:"日期精度",disabled:!(0,k.R1)(Z).encodedRule.calculateWhenView},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(D.SysAutoCodeType).getList(),e=>((0,g.uX)(),(0,g.Wv)(N,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),(0,g.bF)(O,{modelValue:(0,k.R1)(Z).encodedRule.middle,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,k.R1)(Z).encodedRule.middle=e),style:{width:"80px","margin-left":"5px"},placeholder:"后缀",disabled:!(0,k.R1)(Z).encodedRule.calculateWhenView},null,8,["modelValue","disabled"]),(0,g.bF)(U,{modelValue:(0,k.R1)(Z).encodedRule.idWidth,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,k.R1)(Z).encodedRule.idWidth=e),style:{width:"100px","margin-left":"5px"},controls:!1,placeholder:"序号宽度",disabled:!(0,k.R1)(Z).encodedRule.calculateWhenView},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Z).bindFormType===(0,k.R1)(D.SysFlowEntryBindFormType).ONLINE_FORM&&(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:2,span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程页面",prop:"pageId"},{default:(0,g.k6)(()=>[(0,g.bF)(W,{modelValue:(0,k.R1)(Z).pageId,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,k.R1)(Z).pageId=e),disabled:(0,k.R1)(fe),placeholder:"",loading:(0,k.R1)(de).loading,onVisibleChange:(0,k.R1)(de).onVisibleChange,onChange:Le},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(de).dropdownList,e=>((0,g.uX)(),(0,g.Wv)(N,{key:e.pageId,value:e.pageId,label:e.pageName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","loading","onVisibleChange"])]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Z).bindFormType===(0,k.R1)(D.SysFlowEntryBindFormType).ONLINE_FORM&&(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:3,span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"默认表单",prop:"defaultFormId"},{default:(0,g.k6)(()=>[(0,g.bF)(W,{modelValue:(0,k.R1)(Z).defaultFormId,"onUpdate:modelValue":t[11]||(t[11]=e=>(0,k.R1)(Z).defaultFormId=e),placeholder:"",loading:(0,k.R1)(ce).loading,onVisibleChange:(0,k.R1)(ce).onVisibleChange},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(ce).dropdownList,e=>((0,g.uX)(),(0,g.Wv)(N,{key:e.formId,value:e.formId,label:e.formName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Z).bindFormType===(0,k.R1)(D.SysFlowEntryBindFormType).ROUTER_FORM&&(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:4,span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"默认表单",prop:"defaultRouterName"},{default:(0,g.k6)(()=>[(0,g.bF)(O,{modelValue:(0,k.R1)(Z).defaultRouterName,"onUpdate:modelValue":t[12]||(t[12]=e=>(0,k.R1)(Z).defaultRouterName=e),clearable:"",placeholder:"请填写路由名称"},null,8,["modelValue"])]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,g.bF)(a,{span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程图标",prop:"imageData"},{default:(0,g.k6)(()=>[(0,g.bF)(z,{class:"upload-image-item","show-file-list":!1,headers:(0,k.R1)(M),name:"uploadFile",accept:"image/*",action:(0,k.R1)(X)((0,k.R1)(P.x)+"/mobile/mobileEntry/uploadImage"),"on-success":be,"on-remove":ye},{default:(0,g.k6)(()=>[null!=(0,k.R1)(Z).imageData?((0,g.uX)(),(0,g.CE)("div",vi,[(0,g.Lk)("img",{class:"upload-image-show",src:(0,k.R1)(ke)},null,8,fi),(0,g.Lk)("div",{class:"upload-img-del el-icon-close",onClick:t[13]||(t[13]=(0,R.D$)(e=>ye(),["stop"]))})])):((0,g.uX)(),(0,g.CE)("i",gi))]),_:1},8,["headers","action"])]),_:1})]),_:1}),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:5,span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程摘要",prop:"flowSummary"},{default:(0,g.k6)(()=>[(0,g.bF)(O,{modelValue:(0,k.R1)(Z).flowSummary,"onUpdate:modelValue":t[14]||(t[14]=e=>(0,k.R1)(Z).flowSummary=e),placeholder:"流程摘要将显示在待办任务列表中"},null,8,["modelValue"])]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:6,span:12},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"流程复活"},{default:(0,g.k6)(()=>[(0,g.bF)(K,{modelValue:(0,k.R1)(Z).supportRevive,"onUpdate:modelValue":t[15]||(t[15]=e=>(0,k.R1)(Z).supportRevive=e)},null,8,["modelValue"])]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:7,span:12},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"有效天数"},{default:(0,g.k6)(()=>[(0,g.bF)(U,{modelValue:(0,k.R1)(Z).keptReviveDays,"onUpdate:modelValue":t[16]||(t[16]=e=>(0,k.R1)(Z).keptReviveDays=e),disabled:!(0,k.R1)(Z).supportRevive,placeholder:"不输入代表永久有效","controls-position":"right",min:1},null,8,["modelValue","disabled"])]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:8,span:12},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"级联删除"},{default:(0,g.k6)(()=>[(0,g.bF)(S,{type:"flex",align:"middle",justify:"space-between"},{default:(0,g.k6)(()=>[(0,g.bF)(K,{modelValue:(0,k.R1)(Z).cascadeDeleteBusinessData,"onUpdate:modelValue":t[17]||(t[17]=e=>(0,k.R1)(Z).cascadeDeleteBusinessData=e)},null,8,["modelValue"]),(0,g.bF)(q,{type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:(0,g.k6)(()=>t[32]||(t[32]=[(0,g.eW)(" 级联删除业务数据 ")])),_:1,__:[32]})]),_:1})]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(fe)&&(0,k.R1)(ge).length>0&&(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).NORMAL?((0,g.uX)(),(0,g.Wv)(a,{key:9,span:12},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"工单分享"},{default:(0,g.k6)(()=>[(0,g.bF)(S,{type:"flex"},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(ge),e=>((0,g.uX)(),(0,g.Wv)(_,{key:e.formId,class:(0,h.C4)(e.formCode),"data-clipboard-text":De(e),title:"生成分享链接",onClick:t=>Ne(e.formCode)},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(e.formName),1)]),_:2},1032,["class","data-clipboard-text","onClick"]))),128))]),_:1})]),_:1})]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Z).flowType===(0,k.R1)(D.FlowEntryType).AUTO_TASK?((0,g.uX)(),(0,g.Wv)(a,{key:"autoParamList",span:24},{default:(0,g.k6)(()=>[(0,g.bF)(L,{label:"输入参数"},{default:(0,g.k6)(()=>[(0,g.bF)(W,{modelValue:(0,k.R1)(ee),"onUpdate:modelValue":t[18]||(t[18]=e=>(0,k.i9)(ee)?ee.value=e:null),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:""},{default:(0,g.k6)(()=>[((0,g.uX)(!0),(0,g.CE)(g.FK,null,(0,g.pI)((0,k.R1)(ee),e=>((0,g.uX)(),(0,g.Wv)(N,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,g.Q3)("",!0)]),_:1})]),_:1},8,["model"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).PROCESS_VARIABLE?((0,g.uX)(),(0,g.Wv)(a,{key:1,class:"main-box",span:16},{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(ae),"header-cell-class-name":"table-header-gray",key:"processVariableList",size:(0,k.R1)(G),"row-config":{isHover:!0}},{empty:(0,g.k6)(()=>t[35]||(t[35]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",type:"seq",width:"70px"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"变量名称",field:"showName"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"变量标识",field:"variableName"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"变量类型"},{default:(0,g.k6)(e=>[(0,g.bF)(Q,{size:(0,k.R1)(G),effect:"dark",type:e.row.variableType===(0,k.R1)(D.SysFlowVariableType).TASK?"primary":"success"},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)((0,k.R1)(D.SysFlowVariableType).getValue(e.row.variableType)),1)]),_:2},1032,["size","type"])]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"内置变量"},{default:(0,g.k6)(e=>[(0,g.bF)(Q,{size:(0,k.R1)(G),effect:"dark",type:e.row.builtin?"success":"danger"},{default:(0,g.k6)(()=>[(0,g.eW)((0,h.v_)(e.row.builtin?"是":"否"),1)]),_:2},1032,["size","type"])]),_:1}),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"100px"},{default:(0,g.k6)(e=>[(0,g.bF)(_,{size:(0,k.R1)(G),type:"primary",link:"",disabled:e.row.builtin,onClick:t=>Pe(e.row),style:{padding:"0"}},{default:(0,g.k6)(()=>t[33]||(t[33]=[(0,g.eW)("编辑")])),_:2,__:[33]},1032,["size","disabled","onClick"]),(0,g.bF)(_,{size:(0,k.R1)(G),type:"danger",link:"",disabled:e.row.builtin,onClick:t=>We(e.row),style:{padding:"0"}},{default:(0,g.k6)(()=>t[34]||(t[34]=[(0,g.eW)("删除")])),_:2,__:[34]},1032,["size","disabled","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,g.bF)(_,{class:"btn-add",icon:(0,k.R1)(I.Plus),onClick:Oe,size:(0,k.R1)(G)},{default:(0,g.k6)(()=>t[36]||(t[36]=[(0,g.eW)("添加变量")])),_:1,__:[36]},8,["icon","size"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).PROCESS_STATUS?((0,g.uX)(),(0,g.Wv)(a,{key:2,class:"main-box",span:16},{default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.CP),{data:(0,k.R1)(Z).extensionData.approvalStatusDict,"row-config":{isHover:!0},"header-cell-class-name":"table-header-gray",key:"processStatusList",size:(0,k.R1)(G)},{empty:(0,g.k6)(()=>t[39]||(t[39]=[(0,g.Lk)("div",{class:"table-empty unified-font"},[(0,g.Lk)("img",{src:F}),(0,g.Lk)("span",null,"暂无数据")],-1)])),default:(0,g.k6)(()=>[(0,g.bF)((0,k.R1)(T.Wq),{title:"序号",type:"seq",width:"70px"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"状态显示名",field:"name"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"状态标识",field:"id"}),(0,g.bF)((0,k.R1)(T.Wq),{title:"操作",width:"100px"},{default:(0,g.k6)(e=>[(0,g.bF)(_,{size:(0,k.R1)(G),type:"primary",link:"",disabled:e.row.builtin,onClick:t=>Be(e.row),style:{padding:"0"}},{default:(0,g.k6)(()=>t[37]||(t[37]=[(0,g.eW)("编辑")])),_:2,__:[37]},1032,["size","disabled","onClick"]),(0,g.bF)(_,{size:(0,k.R1)(G),type:"danger",link:"",disabled:e.row.builtin,onClick:t=>Ue(e.row),style:{padding:"0"}},{default:(0,g.k6)(()=>t[38]||(t[38]=[(0,g.eW)("删除")])),_:2,__:[38]},1032,["size","disabled","onClick"])]),_:1})]),_:1},8,["data","size"]),(0,g.bF)(_,{class:"btn-add",icon:(0,k.R1)(I.Plus),size:(0,k.R1)(G),onClick:t[20]||(t[20]=e=>Be(null))},{default:(0,g.k6)(()=>t[40]||(t[40]=[(0,g.eW)("新建状态")])),_:1,__:[40]},8,["icon","size"])]),_:1})):(0,g.Q3)("",!0),(0,k.R1)(Y)===(0,k.R1)(D.SysFlowEntryStep).PROCESS_DESIGN?((0,g.uX)(),(0,g.Wv)(a,{key:3,class:"main-box",span:24,style:{"min-width":"1100px",padding:"0"}},{default:(0,g.k6)(()=>[(0,g.bF)(mi,{ref_key:"designer",ref:H,flowEntryInfo:(0,k.R1)(Z),onSave:ze},null,8,["flowEntryInfo"])]),_:1})):(0,g.Q3)("",!0)]),_:1})]),_:1},8,["style"])]),_:1})])]),_:1},8,["locale"])}}});const Ri=(0,_e.A)(hi,[["__scopeId","data-v-133cb655"]]);var Fi=Ri},4849:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var l=a(52920),n=(a(97042),a(95509),a(21929)),i=(a(98421),a(65451)),s=(a(63390),a(32465),a(14022)),r=(a(72343),a(68368)),o=(a(81208),a(25136)),u=(a(69957),a(3740)),d=(a(42899),a(47001),a(77195)),p=(a(38389),a(61688),a(44114),a(18111),a(22489),a(7588),a(61701),a(18237),a(56768)),m=a(90144),c=a(57477),b=a(71066),y=a(82572),v=a(27007),f=a(22414);const g={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}},k={class:"table-box form-box"};var h=(0,p.pM)({__name:"formSetOnlineFormAuth",props:{formAuth:{},formWidgetConfig:{},bindFormType:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,y.l5)(),a=e,{thirdParams:h,onCloseThirdDialog:R}=(0,b.P)(a),F=(0,m.KR)("pc"),T=(0,m.KR)([]),E=(0,m.KR)([]),_=(0,m.KR)({variableName:""}),S=(0,m.KR)(),I=(0,m.KR)(),w=(0,p.EW)(()=>"pc"===F.value?T.value:E.value),A={variableName:[{required:!0,message:"组件标识不能为空",trigger:"blur"}]},x=(0,p.EW)(()=>({formAuth:a.formAuth||h.value.formAuth||{},formWidgetConfig:a.formWidgetConfig||h.value.formWidgetConfig||{},bindFormType:a.bindFormType||h.value.bindFormType||""})),V=(0,p.EW)(()=>x.value.bindFormType===f.SysFlowEntryBindFormType.ONLINE_FORM),C=()=>{T.value.push({variableName:_.value.variableName,disabled:!1,hidden:!1}),_.value.variableName="",S.value.hide(),I.value.resetFields()},L=e=>{T.value=T.value.filter(t=>t!==e)},D=()=>{a.dialog?a.dialog.cancel():R(!1)},N=(e,t)=>{(e.disabled||e.hidden)&&(t[e.variableName]=`${e.disabled?1:0},${e.hidden?1:0}`),Array.isArray(e.children)&&e.children.length&&e.children.forEach(e=>{N(e,t)})},P=()=>{let e={pc:{},mobile:{}};T.value.forEach(t=>{N(t,e.pc)}),E.value.forEach(t=>{N(t,e.mobile)}),console.log(e),a.dialog?a.dialog.submit(e):R(!0,void 0,e)},W=(e,t,a)=>{if(null==e)return;let l=(0,v.I_)(w.value,e.formId,"formId","children");Array.isArray(l)&&l.forEach(e=>{e[t]=a})},O=(e,t,a)=>{null!=e&&(e[t]=a,Array.isArray(e.children)&&e.children.length&&e.children.forEach(e=>{O(e,t,a)}))},B=(e,t)=>{t?O(e,"disabled",t):W(e,"disabled",t),"pc"===F.value?T.value=[...T.value]:E.value=[...E.value]},U=(e,t)=>{t?O(e,"hidden",t):W(e,"hidden",t),"pc"===F.value?T.value=[...T.value]:E.value=[...E.value]},z=(e,t)=>{let a=t[e.variableName]||[0,0];return{...e,disabled:1===a[0],hidden:1===a[1],children:Array.isArray(e.children)?e.children.map(e=>z(e,t)):void 0}};return(0,p.sV)(()=>{x.value.formWidgetConfig.pc?F.value="pc":F.value="mobile";let e={pc:Object.keys(x.value.formAuth.pc||{}).reduce((e,t)=>(e[t]=x.value.formAuth.pc[t].split(",").map(e=>parseInt(e)),e),{}),mobile:Object.keys(x.value.formAuth.mobile||{}).reduce((e,t)=>(e[t]=x.value.formAuth.mobile[t].split(",").map(e=>parseInt(e)),e),{})};x.value.formWidgetConfig.pc&&x.value.formWidgetConfig.pc.widgetList?T.value=x.value.formWidgetConfig.pc.widgetList.map(t=>z(t,e.pc)):(console.warn("PC端表单配置不存在",e),T.value=Object.keys(e.pc||{}).map(t=>z({variableName:t},e.pc))),x.value.formWidgetConfig.mobile&&x.value.formWidgetConfig.mobile.widgetList?E.value=x.value.formWidgetConfig.mobile.widgetList.map(t=>z(t,e.mobile)):E.value=[]}),(e,a)=>{const b=d.v$,y=d.q,v=r.o8,f=u.qi,h=o.S2,R=r.Up,T=s.WK,E=n.xE,N=i.S2,W=n.US,O=l.Vc;return(0,p.uX)(),(0,p.CE)("div",g,[(0,p.Lk)("div",k,[(0,p.bF)(y,{modelValue:(0,m.R1)(F),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,m.i9)(F)?F.value=e:null)},{default:(0,p.k6)(()=>[(0,m.R1)(x).formWidgetConfig.pc?((0,p.uX)(),(0,p.Wv)(b,{key:0,label:"PC端表单",name:"pc"})):(0,p.Q3)("",!0),(0,m.R1)(x).formWidgetConfig.mobile&&(0,m.R1)(V)?((0,p.uX)(),(0,p.Wv)(b,{key:1,label:"移动端表单",name:"mobile"})):(0,p.Q3)("",!0)]),_:1},8,["modelValue"]),(0,p.bF)(R,{data:(0,m.R1)(w),"row-key":"formId",height:"100%",style:{"flex-grow":"1",height:"100%"},"default-expand-all":!0},{default:(0,p.k6)(()=>[(0,m.R1)(V)?((0,p.uX)(),(0,p.Wv)(v,{key:0,label:"组件名称",prop:"showName"})):(0,p.Q3)("",!0),(0,p.bF)(v,{label:"组件标识",prop:"variableName"}),(0,p.bF)(v,{label:"禁用"},{default:(0,p.k6)(e=>[(0,p.bF)(f,{modelValue:e.row.disabled,"onUpdate:modelValue":t=>e.row.disabled=t,size:"default",onChange:t=>B(e.row,t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),(0,p.bF)(v,{label:"隐藏"},{default:(0,p.k6)(e=>[(0,p.bF)(f,{modelValue:e.row.hidden,"onUpdate:modelValue":t=>e.row.hidden=t,size:"default",onChange:t=>U(e.row,t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),(0,m.R1)(V)?(0,p.Q3)("",!0):((0,p.uX)(),(0,p.Wv)(v,{key:1,label:"操作",width:"100"},{default:(0,p.k6)(e=>[(0,p.bF)(h,{class:"delete-btn",size:"default",type:"text",onClick:t=>L(e.row)},{default:(0,p.k6)(()=>a[6]||(a[6]=[(0,p.eW)(" 删除 ")])),_:2,__:[6]},1032,["onClick"])]),_:1}))]),_:1},8,["data"]),(0,p.bF)(O,{ref_key:"addVariablePopover",ref:S,placement:"bottom-end",width:400,trigger:"click",onHide:a[3]||(a[3]=()=>{(0,m.R1)(_).variableName="",(0,m.R1)(I).resetFields()})},{reference:(0,p.k6)(()=>[(0,m.R1)(V)?(0,p.Q3)("",!0):((0,p.uX)(),(0,p.Wv)(h,{key:0,class:"add-btn",size:"default",icon:(0,m.R1)(c.Plus),type:"primary"},{default:(0,p.k6)(()=>a[7]||(a[7]=[(0,p.eW)(" 添加 ")])),_:1,__:[7]},8,["icon"]))]),default:(0,p.k6)(()=>[(0,p.bF)(W,{ref_key:"addFormRef",ref:I,model:(0,m.R1)(_),rules:A,"label-width":"80px"},{default:(0,p.k6)(()=>[(0,p.bF)(E,{label:"组件标识",prop:"variableName"},{default:(0,p.k6)(()=>[(0,p.bF)(T,{modelValue:(0,m.R1)(_).variableName,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,m.R1)(_).variableName=e),size:(0,m.R1)(t).defaultFormItemSize,placeholder:"请输入组件标识"},null,8,["modelValue","size"])]),_:1}),(0,p.bF)(N,{type:"flex",justify:"end",style:{width:"100%"}},{default:(0,p.k6)(()=>[(0,p.bF)(h,{size:(0,m.R1)(t).defaultFormItemSize,onClick:a[2]||(a[2]=e=>(0,m.R1)(S).hide())},{default:(0,p.k6)(()=>a[8]||(a[8]=[(0,p.eW)(" 取消 ")])),_:1,__:[8]},8,["size"]),(0,p.bF)(h,{type:"primary",size:(0,m.R1)(t).defaultFormItemSize,onClick:C},{default:(0,p.k6)(()=>a[9]||(a[9]=[(0,p.eW)(" 确认添加 ")])),_:1,__:[9]},8,["size"])]),_:1})]),_:1},8,["model"])]),_:1},512)]),(0,p.bF)(N,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,p.k6)(()=>[(0,p.bF)(h,{size:(0,m.R1)(t).defaultFormItemSize,plain:!0,onClick:a[4]||(a[4]=e=>D(!1))},{default:(0,p.k6)(()=>a[10]||(a[10]=[(0,p.eW)(" 取消 ")])),_:1,__:[10]},8,["size"]),(0,p.bF)(h,{type:"primary",size:(0,m.R1)(t).defaultFormItemSize,onClick:a[5]||(a[5]=e=>P())},{default:(0,p.k6)(()=>a[11]||(a[11]=[(0,p.eW)(" 保存 ")])),_:1,__:[11]},8,["size"])]),_:1})])}}}),R=a(71241);const F=(0,R.A)(h,[["__scopeId","data-v-11ac111e"]]);var T=F},8571:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var l=a(65451),n=(a(97042),a(63390),a(25136)),i=(a(69957),a(21929)),s=(a(98421),a(18888)),r=(a(3172),a(14022)),o=(a(72343),a(32465),a(85415)),u=(a(22243),a(7409),a(56768)),d=a(90144),p=a(45130),m=a(22414),c=a(27007),b=a(71066),y=a(82572),v=a(61617);const f={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}};var g=(0,u.pM)({__name:"editInsertData",props:{dblinkId:{default:void 0},tableName:{default:void 0},srcDblinkId:{default:void 0},srcTableName:{default:void 0},data:{default:void 0},flowVariableList:{default:void 0},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,y.l5)(),a=e,{thirdParams:g,onCloseThirdDialog:k}=(0,b.P)(a),h=(0,d.KR)(),R=(0,d.KR)({type:m.AutoTaskValueType.FIXED,destColumnName:"",srcValue:""}),F=(0,d.KR)([]),T=(0,d.KR)([]),E=(0,d.KR)({destColumnName:[{required:!0,message:"请输入字段名",trigger:"blur"}],srcValue:[{required:!0,message:"请输入字段值",trigger:"blur"}]}),_=(0,u.EW)(()=>({dblinkId:a.dblinkId||g.value.dblinkId,tableName:a.tableName||g.value.tableName,srcDblinkId:a.srcDblinkId||g.value.srcDblinkId,srcTableName:a.srcTableName||g.value.srcTableName,data:a.data||g.value.data,flowVariableList:a.flowVariableList||g.value.flowVariableList||[]})),S=()=>{null!=_.value.dblinkId&&null!=_.value.tableName&&v.V7.listDblinkTableColumns({dblinkId:_.value.dblinkId,tableName:_.value.tableName}).then(e=>{F.value=e.data})},I=()=>{null!=_.value.srcDblinkId&&null!=_.value.srcTableName&&""!==_.value.srcDblinkId&&""!==_.value.srcTableName&&v.V7.listDblinkTableColumns({dblinkId:_.value.srcDblinkId,tableName:_.value.srcTableName}).then(e=>{T.value=e.data})},w=()=>{R.value.srcValue=void 0},A=()=>{a.dialog?a.dialog.cancel():k(!1)},x=()=>{h.value.validate(e=>{if(e){let e;e=R.value.srcValue,R.value.type===m.AutoTaskValueType.VARIABLE&&(e=Array.isArray(R.value.srcValue)?R.value.srcValue[R.value.srcValue.length-1]:void 0);let t={...R.value,srcValue:e};a.dialog?a.dialog.submit(t):k(!0,_.value.data,t)}})};return(0,u.sV)(()=>{if(S(),I(),_.value.data){let e=_.value.data.srcValue;_.value.data.type===m.AutoTaskValueType.VARIABLE&&(e=(0,c.Zi)(_.value.flowVariableList,e)),R.value={...R.value,..._.value.data,srcValue:e}}}),(e,a)=>{const c=o.P9,b=o.AV,y=i.xE,v=r.WK,g=s._m,k=i.US,S=n.S2,I=l.S2;return(0,u.uX)(),(0,u.CE)("div",f,[(0,u.bF)(k,{ref_key:"form",ref:h,model:(0,d.R1)(R),class:"full-width-input form-box",rules:(0,d.R1)(E),style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(t).defaultFormItemSize,"label-position":"right",onSubmit:a[5]||(a[5]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(y,{label:"目标表字段",prop:"destColumnName"},{default:(0,u.k6)(()=>[(0,u.bF)(b,{modelValue:(0,d.R1)(R).destColumnName,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,d.R1)(R).destColumnName=e),clearable:"",filterable:"",disabled:null!=(0,d.R1)(_).data,placeholder:"请选择字段名"},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(F),e=>((0,u.uX)(),(0,u.Wv)(c,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),(0,u.bF)(y,{label:"字段值类型"},{default:(0,u.k6)(()=>[(0,u.bF)(b,{modelValue:(0,d.R1)(R).type,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,d.R1)(R).type=e),clearable:"",placeholder:"请选择值类型",onChange:w},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:(0,d.R1)(m.AutoTaskValueType).getValue((0,d.R1)(m.AutoTaskValueType).FIXED),value:(0,d.R1)(m.AutoTaskValueType).FIXED},null,8,["label","value"]),null!=(0,d.R1)(_).srcDblinkId&&null!=(0,d.R1)(_).srcTableName?((0,u.uX)(),(0,u.Wv)(c,{key:0,label:(0,d.R1)(m.AutoTaskValueType).getValue((0,d.R1)(m.AutoTaskValueType).FIELD),value:(0,d.R1)(m.AutoTaskValueType).FIELD},null,8,["label","value"])):(0,u.Q3)("",!0),(0,u.bF)(c,{label:(0,d.R1)(m.AutoTaskValueType).getValue((0,d.R1)(m.AutoTaskValueType).VARIABLE),value:(0,d.R1)(m.AutoTaskValueType).VARIABLE},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1}),(0,u.bF)(y,{label:"字段值",prop:"srcValue"},{default:(0,u.k6)(()=>[(0,d.R1)(R).type===(0,d.R1)(m.AutoTaskValueType).FIXED?((0,u.uX)(),(0,u.Wv)(v,{key:0,modelValue:(0,d.R1)(R).srcValue,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,d.R1)(R).srcValue=e),clearable:"",placeholder:"请输入字段值"},null,8,["modelValue"])):(0,d.R1)(R).type===(0,d.R1)(m.AutoTaskValueType).FIELD?((0,u.uX)(),(0,u.Wv)(b,{key:1,modelValue:(0,d.R1)(R).srcValue,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,d.R1)(R).srcValue=e),clearable:"",filterable:"",placeholder:"请选择字段名"},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(T),e=>((0,u.uX)(),(0,u.Wv)(c,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(0,d.R1)(R).type===(0,d.R1)(m.AutoTaskValueType).VARIABLE?((0,u.uX)(),(0,u.Wv)(g,{key:2,options:(0,d.R1)(_).flowVariableList,props:{value:"id",label:"name",children:"children"},modelValue:(0,d.R1)(R).srcValue,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,d.R1)(R).srcValue=e),clearable:"",filterable:"",placeholder:"请选择流程变量"},null,8,["options","modelValue"])):(0,u.Q3)("",!0)]),_:1})]),_:1},8,["model","rules","size"]),(0,u.bF)(I,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,u.k6)(()=>[(0,u.bF)(S,{size:(0,d.R1)(t).defaultFormItemSize,plain:!0,onClick:a[6]||(a[6]=e=>A())},{default:(0,u.k6)(()=>a[8]||(a[8]=[(0,u.eW)(" 取消 ")])),_:1,__:[8]},8,["size"]),(0,u.bF)(S,{type:"primary",size:(0,d.R1)(t).defaultFormItemSize,onClick:a[7]||(a[7]=e=>x())},{default:(0,u.k6)(()=>a[9]||(a[9]=[(0,u.eW)(" 保存 ")])),_:1,__:[9]},8,["size"])]),_:1})])}}});const k=g;var h=k},11128:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return R}});var l=a(65451),n=(a(97042),a(63390),a(25136)),i=(a(69957),a(21929)),s=(a(98421),a(18888)),r=(a(3172),a(14022)),o=(a(72343),a(32465),a(85415)),u=(a(22243),a(7409),a(56768)),d=a(90144),p=a(45130),m=a(22414),c=a(61617),b=a(21016),y=a(27007),v=a(71066),f=a(82572);const g={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}};var k=(0,u.pM)({__name:"editSrcTableFilter",props:{dblinkId:{default:void 0},tableName:{default:void 0},data:{default:void 0},flowVariableList:{default:void 0},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,f.l5)(),a=e,{thirdParams:k,onCloseThirdDialog:h}=(0,v.P)(a),R=(0,d.KR)(),F=(0,d.KR)({id:void 0,filterColumnName:"",filterType:0,valueType:m.AutoTaskValueType.FIXED,filterValue:""}),T=(0,d.KR)([]),E={filterColumnName:[{required:!0,message:"请选择过滤字段",trigger:"blur"}],filterType:[{required:!0,message:"请选择过滤类型",trigger:"blur"}],filterValue:[{required:!0,message:"请输入过滤值",trigger:"blur"}]},_=(0,u.EW)(()=>({dblinkId:a.dblinkId||k.value.dblinkId,tableName:a.tableName||k.value.tableName,data:a.data||k.value.data,flowVariableList:a.flowVariableList||k.value.flowVariableList})),S=()=>{F.value.filterValue=void 0},I=()=>{null!=_.value.dblinkId&&null!=_.value.tableName&&c.V7.listDblinkTableColumns({dblinkId:_.value.dblinkId,tableName:_.value.tableName}).then(e=>{T.value=e.data})},w=()=>{a.dialog?a.dialog.cancel():h(!1)},A=()=>{R.value.validate(e=>{if(e){let e;F.value.valueType===m.AutoTaskValueType.VARIABLE&&(e=Array.isArray(F.value.filterValue)?F.value.filterValue[F.value.filterValue.length-1]:void 0);let t={...F.value,filterValue:e||F.value.filterValue};null==t.id&&(t.id=(new Date).getTime()),a.dialog?a.dialog.submit(t):h(!0,_.value.data,t)}})};return(0,u.sV)(()=>{if(I(),_.value.data){let e=_.value.data.filterValue;_.value.data.valueType===m.AutoTaskValueType.VARIABLE&&(e=(0,y.Zi)(_.value.flowVariableList,e)),F.value={..._.value.data,valueType:_.value.data.valueType||0,filterValue:e}}}),(e,a)=>{const c=o.P9,y=o.AV,v=i.xE,f=r.WK,k=s._m,h=i.US,I=n.S2,x=l.S2;return(0,u.uX)(),(0,u.CE)("div",g,[(0,u.bF)(h,{ref_key:"form",ref:R,model:(0,d.R1)(F),class:"full-width-input form-box",rules:E,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(t).defaultFormItemSize,"label-position":"right",onSubmit:a[5]||(a[5]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(v,{label:"过滤字段",prop:"filterColumnName"},{default:(0,u.k6)(()=>[(0,u.bF)(y,{modelValue:(0,d.R1)(F).filterColumnName,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,d.R1)(F).filterColumnName=e),clearable:"",filterable:"",disabled:null!=(0,d.R1)(_).data,placeholder:"请选择过滤字段"},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(T),e=>((0,u.uX)(),(0,u.Wv)(c,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),(0,u.bF)(v,{label:"过滤类型"},{default:(0,u.k6)(()=>[(0,u.bF)(y,{modelValue:(0,d.R1)(F).filterType,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,d.R1)(F).filterType=e),placeholder:"请选择过滤类型"},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(b.CriteriaFilterType).getList(),e=>((0,u.uX)(),(0,u.Wv)(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,u.bF)(v,{label:"字段值类型"},{default:(0,u.k6)(()=>[(0,u.bF)(y,{modelValue:(0,d.R1)(F).valueType,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,d.R1)(F).valueType=e),placeholder:"请选择过滤值类型",onChange:S},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:(0,d.R1)(m.AutoTaskValueType).getValue((0,d.R1)(m.AutoTaskValueType).FIXED),value:(0,d.R1)(m.AutoTaskValueType).FIXED},null,8,["label","value"]),(0,u.bF)(c,{label:(0,d.R1)(m.AutoTaskValueType).getValue((0,d.R1)(m.AutoTaskValueType).VARIABLE),value:(0,d.R1)(m.AutoTaskValueType).VARIABLE},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1}),(0,u.bF)(v,{label:"过滤值",prop:"filterValue"},{default:(0,u.k6)(()=>[(0,d.R1)(F).valueType===(0,d.R1)(m.AutoTaskValueType).FIXED?((0,u.uX)(),(0,u.Wv)(f,{key:0,modelValue:(0,d.R1)(F).filterValue,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,d.R1)(F).filterValue=e),clearable:"",placeholder:"请输入过滤值"},null,8,["modelValue"])):(0,d.R1)(F).valueType===(0,d.R1)(m.AutoTaskValueType).VARIABLE?((0,u.uX)(),(0,u.Wv)(k,{key:1,options:(0,d.R1)(_).flowVariableList,props:{value:"id",label:"name",children:"children"},modelValue:(0,d.R1)(F).filterValue,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,d.R1)(F).filterValue=e),clearable:"",filterable:"",placeholder:"请选择流程变量"},null,8,["options","modelValue"])):(0,u.Q3)("",!0)]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(x,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,u.k6)(()=>[(0,u.bF)(I,{size:(0,d.R1)(t).defaultFormItemSize,plain:!0,onClick:a[6]||(a[6]=e=>w())},{default:(0,u.k6)(()=>a[8]||(a[8]=[(0,u.eW)(" 取消 ")])),_:1,__:[8]},8,["size"]),(0,u.bF)(I,{type:"primary",size:(0,d.R1)(t).defaultFormItemSize,onClick:a[7]||(a[7]=e=>A())},{default:(0,u.k6)(()=>a[9]||(a[9]=[(0,u.eW)(" 保存 ")])),_:1,__:[9]},8,["size"])]),_:1})])}}});const h=k;var R=h},15340:function(){},22369:function(e,t,a){"use strict";a.d(t,{A:function(){return p}});var l=a(25136),n=(a(97042),a(69957),a(56768)),i=a(90144),s=a(57477),r=a(82572),o=(0,n.pM)({__name:"RightAddBtn",props:{size:{default:"default"}},setup(e){const t=(0,r.l5)();return(e,a)=>{const r=l.S2;return(0,n.uX)(),(0,n.Wv)(r,(0,n.v6)(e.$attrs,{type:"primary",class:"right-add-btn",size:(0,i.R1)(t).defaultFormItemSize,link:"",icon:(0,i.R1)(s.CirclePlusFilled)}),{default:(0,n.k6)(()=>[(0,n.RG)(e.$slots,"default")]),_:3},16,["size","icon"])}}}),u=a(71241);const d=(0,u.A)(o,[["__scopeId","data-v-efc91e7a"]]);var p=d},22609:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return F}});var l=a(25136),n=(a(97042),a(69957),a(21929)),i=(a(98421),a(65451)),s=(a(63390),a(14022)),r=(a(72343),a(76408)),o=(a(87535),a(32465),a(18888)),u=(a(3172),a(44114),a(18111),a(7588),a(61701),a(56768)),d=a(90144),p=a(45130),m=a(26695),c=a(61617),b=a(27007),y=a(22414),v=a(36525),f=a(71066),g=a(82572);const k={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var h=(0,u.pM)({__name:"formEditFlowEntryVariable",props:{entryId:{},datasource:{},rowData:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,g.l5)(),a=e,{thirdParams:h,onCloseThirdDialog:R}=(0,f.P)(a),F=(0,u.EW)(()=>t.defaultFormItemSize||h.value.defaultFormItemSize?.value),T=(0,d.KR)(),E={showName:[{required:!0,message:"变量名称不能为空！",trigger:"blur"}],variableName:[{required:!0,message:"变量标识不能为空！",trigger:"blur"},{type:"string",pattern:/^[a-z][a-zA-Z]+$/,message:"变量标识必须是小驼峰命名",trigger:"blur"}]},_=(0,d.KR)([]),S=(0,d.KR)({showName:void 0,variableName:void 0,variableType:y.SysFlowVariableType.TASK,bindDatasourceId:void 0,bindRelationId:void 0,bindColumnId:void 0,builtIn:!1}),I=(0,u.EW)(()=>({entryId:a.entryId||h.value.entryId,datasource:a.datasource||h.value.datasource,rowData:a.rowData||h.value.rowData})),w=(0,u.EW)(()=>{if(null==I.value.datasource)return[];{let e=[{label:I.value.datasource.datasourceName,value:I.value.datasource.datasourceId,tableId:I.value.datasource.masterTableId,children:I.value.datasource.columnList.map(e=>({label:e.objectFieldName,value:e.columnId,tag:e})),tag:I.value.datasource}];return Array.isArray(I.value.datasource.relationList)&&I.value.datasource.relationList.forEach(t=>{t.relationType===v.SysOnlineRelationType.ONE_TO_ONE&&e.push({label:t.relationName,value:t.relationId,tableId:t.slaveTableId,children:t.columnList.map(e=>({label:e.objectFieldName,value:e.columnId,tag:e})),tag:t})}),e}}),A=e=>{if(S.value.bindDatasourceId=I.value.datasource?.datasourceId,S.value.bindRelationId=void 0,S.value.bindColumnId=void 0,Array.isArray(e)&&e.length>0){let t=e[e.length-1];if(t){e[0]!==S.value.bindDatasourceId&&(S.value.bindRelationId=e[0]);let a=(0,b.Ee)(w.value,t,"value");null!=a&&null!=a.tag&&(S.value.showName=a.tag.columnComment,S.value.variableName=a.tag.objectFieldName,S.value.bindColumnId=a.value)}}},x=()=>{a.dialog?a.dialog.cancel():R(!1)},V=()=>{T.value.validate(e=>{if(e){let e={flowEntryVariableDto:{...S.value,entryId:I.value.entryId}},t=null==I.value.rowData?c.nY.add(e):c.nY.update(e);t.then(e=>{m.nk.success("保存成功！"),a.dialog?a.dialog.submit(e):R(!0)}).catch(e=>{console.warn(e)})}})};return(0,u.sV)(()=>{null!=I.value.rowData&&(S.value={...S.value,...I.value.rowData},null!=S.value.bindColumnId&&null!=I.value.datasource&&(_.value=[S.value.bindRelationId||S.value.bindDatasourceId,S.value.bindColumnId]))}),(e,t)=>{const a=o._m,m=n.xE,c=r.uD,b=s.WK,y=i.S2,v=n.US,f=l.S2;return(0,u.uX)(),(0,u.CE)("div",k,[(0,u.bF)(v,{ref_key:"form",ref:T,model:(0,d.R1)(S),class:"full-width-input form-box",rules:E,style:{width:"100%"},"label-width":"80px",size:(0,d.R1)(F),"label-position":"right",onSubmit:t[3]||(t[3]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(y,{gutter:20},{default:(0,u.k6)(()=>[null!=(0,d.R1)(I).datasource?((0,u.uX)(),(0,u.Wv)(c,{key:0,span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"绑定字段"},{default:(0,u.k6)(()=>[(0,u.bF)(a,{class:"input-item",modelValue:(0,d.R1)(_),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,d.i9)(_)?_.value=e:null),filterable:"",placeholder:"变量绑定的数据源字段",options:(0,d.R1)(w),disabled:null==(0,d.R1)(I).datasource,onChange:A},null,8,["modelValue","options","disabled"])]),_:1})]),_:1})):(0,u.Q3)("",!0),(0,u.bF)(c,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"变量名称",prop:"showName"},{default:(0,u.k6)(()=>[(0,u.bF)(b,{class:"input-item",modelValue:(0,d.R1)(S).showName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,d.R1)(S).showName=e),clearable:!0,placeholder:"变量名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,u.bF)(c,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"变量标识",prop:"variableName"},{default:(0,u.k6)(()=>[(0,u.bF)(b,{class:"input-item",modelValue:(0,d.R1)(S).variableName,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,d.R1)(S).variableName=e),clearable:!0,placeholder:"变量标识"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(y,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{size:(0,d.R1)(F),plain:!0,onClick:x},{default:(0,u.k6)(()=>t[4]||(t[4]=[(0,u.eW)(" 取消 ")])),_:1,__:[4]},8,["size"]),(0,u.bF)(f,{type:"primary",size:(0,d.R1)(F),onClick:V},{default:(0,u.k6)(()=>t[5]||(t[5]=[(0,u.eW)(" 保存 ")])),_:1,__:[5]},8,["size"])]),_:1})])}}});const R=h;var F=R},32990:function(e,t,a){"use strict";a(18111),a(13579);var l=a(83639).zN,n={FailedJobRetryTimeCycle:["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateCatchEvent","bpmn:Activity"],Connector:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"],Field:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"]};function i(e,t){return e&&"function"===typeof e.$instanceOf&&e.$instanceOf(t)}function s(e){return e&&e.length}function r(e,t){return s(e)&&l(e,function(e){return i(e,t)})}function o(e,t){return l(t,function(t){return i(e,t)})}function u(e,t,a){var l=t.name,i=n[l.replace(/flowable:/,"")];return l===e&&o(a,i)}function d(e){e.on("property.clone",function(e){var t=e.newElement,a=e.propertyDescriptor;this.canCloneProperty(t,a)},this)}d.$inject=["eventBus"],d.prototype.canCloneProperty=function(e,t){return u("flowable:FailedJobRetryTimeCycle",t,e)?r(e.eventDefinitions,"bpmn:TimerEventDefinition")||r(e.eventDefinitions,"bpmn:SignalEventDefinition")||i(e.loopCharacteristics,"bpmn:MultiInstanceLoopCharacteristics"):u("flowable:Connector",t,e)||u("flowable:Field",t,e)?r(e.eventDefinitions,"bpmn:MessageEventDefinition"):void 0},e.exports=d},36947:function(e,t,a){"use strict";a.d(t,{aq:function(){return d},hp:function(){return u},PC:function(){return o},yu:function(){return i},S1:function(){return s},k$:function(){return b},NZ:function(){return c},Pr:function(){return r},Uz:function(){return p},jk:function(){return m}});var l=a(55583),n=a(18384);class i extends l.w{static list(e,t){return super.post(n.x+"/online/onlineDblink/list",e,t)}static listDblinkTables(e,t){return super.get(n.x+"/online/onlineDblink/listDblinkTables",e,t)}static listDblinkTableColumns(e,t){return super.get(n.x+"/online/onlineDblink/listDblinkTableColumns",e,t)}static view(e,t){return super.get(n.x+"/online/onlineDblink/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineDblink/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineDblink/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineDblink/delete",e,t)}static testConnection(e,t){return super.get(n.x+"/online/onlineDblink/testConnection",e,t)}}class s extends l.w{static list(e,t){return super.post(n.x+"/online/onlineDict/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineDict/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineDict/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineDict/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineDict/delete",e,t)}static listAllGlobalDict(e,t){return super.post(n.x+"/online/onlineDict/listAllGlobalDict",e,t)}}class r extends l.w{static list(e,t){return super.post(n.x+"/online/onlinePage/list",e,t)}static listAllPageAndForm(e,t){return super.post(n.x+"/online/onlinePage/listAllPageAndForm",e,t)}static view(e,t){return super.get(n.x+"/online/onlinePage/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlinePage/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlinePage/update",e,t)}static updatePublished(e,t){return super.post(n.x+"/online/onlinePage/updatePublished",e,t)}static delete(e,t){return super.post(n.x+"/online/onlinePage/delete",e,t)}static updateStatus(e,t){return super.post(n.x+"/online/onlinePage/updateStatus",e,t)}static listOnlinePageDatasource(e,t){return super.post(n.x+"/online/onlinePage/listOnlinePageDatasource",e,t)}static listNotInOnlinePageDatasource(e,t){return super.post(n.x+"/online/onlinePage/listNotInOnlinePageDatasource",e,t)}static addOnlinePageDatasource(e,t){return super.post(n.x+"/online/onlinePage/addOnlinePageDatasource",e,t)}static deleteOnlinePageDatasource(e,t){return super.post(n.x+"/online/onlinePage/deleteOnlinePageDatasource",e,t)}static updateOnlinePageDatasource(e,t){return super.post(n.x+"/online/onlinePage/updateOnlinePageDatasource",e,t)}static viewOnlinePageDatasource(e,t){return super.get(n.x+"/online/onlinePage/viewOnlinePageDatasource",e,t)}static getDblinkIdByPageId(e,t){return super.get(n.x+"/online/onlinePage/getDblinkIdByPageId",e,t)}}class o extends l.w{static list(e,t){return super.post(n.x+"/online/onlineDatasourceRelation/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineDatasourceRelation/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineDatasourceRelation/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineDatasourceRelation/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineDatasourceRelation/delete",e,t)}}class u extends l.w{static list(e,t){return super.post(n.x+"/online/onlineDatasource/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineDatasource/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineDatasource/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineDatasource/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineDatasource/delete",e,t)}}class d extends l.w{static list(e,t){return super.post(n.x+"/online/onlineColumn/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineColumn/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineColumn/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineColumn/update",e,t)}static refreshColumn(e,t){return super.post(n.x+"/online/onlineColumn/refresh",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineColumn/delete",e,t)}static listOnlineColumnRule(e,t){return super.post(n.x+"/online/onlineColumn/listOnlineColumnRule",e,t)}static listNotInOnlineColumnRule(e,t){return super.post(n.x+"/online/onlineColumn/listNotInOnlineColumnRule",e,t)}static addOnlineColumnRule(e,t){return super.post(n.x+"/online/onlineColumn/addOnlineColumnRule",e,t)}static deleteOnlineColumnRule(e,t){return super.post(n.x+"/online/onlineColumn/deleteOnlineColumnRule",e,t)}static updateOnlineColumnRule(e,t){return super.post(n.x+"/online/onlineColumn/updateOnlineColumnRule",e,t)}static viewOnlineColumnRule(e,t){return super.post(n.x+"/online/onlineColumn/viewOnlineColumnRule",e,t)}}class p extends l.w{static list(e,t){return super.post(n.x+"/online/onlineRule/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineRule/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineRule/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineRule/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineRule/delete",e,t)}}class m extends l.w{static list(e,t){return super.post(n.x+"/online/onlineVirtualColumn/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineVirtualColumn/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineVirtualColumn/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineVirtualColumn/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineVirtualColumn/delete",e,t)}}class c extends l.w{static listDict(e,t){return super.post(n.x+"/online/onlineOperation/listDict",e,t)}static listByDatasourceId(e,t){return super.post(n.x+"/online/onlineOperation/listByDatasourceId",e,t)}static listByOneToManyRelationId(e,t){return super.post(n.x+"/online/onlineOperation/listByOneToManyRelationId",e,t)}static addDatasource(e,t){return super.post(n.x+"/online/onlineOperation/addDatasource",e,t)}static addOneToManyRelation(e,t){return super.post(n.x+"/online/onlineOperation/addOneToManyRelation",e,t)}static updateDatasource(e,t){return super.post(n.x+"/online/onlineOperation/updateDatasource",e,t)}static updateOneToManyRelation(e,t){return super.post(n.x+"/online/onlineOperation/updateOneToManyRelation",e,t)}static viewByDatasourceId(e,t){return super.get(n.x+"/online/onlineOperation/viewByDatasourceId",e,t)}static viewByOneToManyRelationId(e,t){return super.get(n.x+"/online/onlineOperation/viewByOneToManyRelationId",e,t)}static deleteDatasource(e,t){return super.post(n.x+"/online/onlineOperation/deleteDatasource",e,t)}static deleteOneToManyRelation(e,t){return super.post(n.x+"/online/onlineOperation/deleteOneToManyRelation",e,t)}static getColumnRuleCode(e,t){return super.get(n.x+"/online/onlineOperation/getColumnRuleCode",e,t)}static getPrintTemplate(e,t){return super.post(n.x+"/report/reportPrint/listAll",e,t)}static listTableDict(e,t){return super.post(n.x+"/online/onlineOperation/listTableDict",e,t)}static listTableDictByIds(e,t){return super.post(n.x+"/online/onlineOperation/listTableDictByIds",e,t)}}class b extends l.w{static list(e,t){return super.post(n.x+"/online/onlineForm/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineForm/view",e,t)}static render(e,t){return super.get(n.x+"/online/onlineForm/render",e,t)}static add(e,t){return super.post(n.x+"/online/onlineForm/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineForm/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineForm/delete",e,t)}static clone(e,t){return super.post(n.x+"/online/onlineForm/clone",e,t)}static saveFormUserExt(e,t){return super.post(n.x+"/online/onlineForm/saveFormUserExt",e,t)}}a(83283),a(3736)},37032:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var l=a(65451),n=(a(97042),a(63390),a(25136)),i=(a(69957),a(21929)),s=(a(98421),a(85415)),r=(a(22243),a(7409),a(14022)),o=(a(72343),a(32465),a(18888)),u=(a(3172),a(18111),a(13579),a(56768)),d=a(90144),p=a(45130),m=a(26695),c=a(27007),b=a(71066),y=a(82572);const v={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}};var f=(0,u.pM)({__name:"editResponseData",props:{data:{default:void 0},usedFieldList:{default:void 0},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,d.KR)(["String","Number","Boolean","Object","Array"]),a=(0,y.l5)(),f=e,{thirdParams:g,onCloseThirdDialog:k}=(0,b.P)(f),h=(0,d.KR)(),R=(0,d.KR)({id:void 0,parentId:void 0,fieldName:"",fieldType:"String"}),F=(0,d.KR)([]),T={fieldName:[{required:!0,message:"请输入字段名",trigger:"blur"}],fieldType:[{required:!0,message:"请输入字段类型",trigger:"blur"}]},E=(0,u.EW)(()=>({data:f.data||g.value.data,usedFieldList:f.usedFieldList||g.value.usedFieldList||[]})),_=(0,u.EW)(()=>{let e=(0,c.I_)(E.value.usedFieldList,R.value.parentId);return e?e[e.length-1]:null}),S=e=>{R.value.parentId=F.value[F.value.length-1]},I=()=>{f.dialog?f.dialog.cancel():k(!1)},w=()=>{let e=_.value?_.value.children:E.value.usedFieldList;(e||[]).some(e=>e.fieldName===R.value.fieldName)?m.nk.error("字段名已存在"):h.value.validate(e=>{e&&(R.value.parentId=_.value?_.value.id:void 0,R.value.id=_.value?_.value.id+"."+R.value.fieldName:R.value.fieldName,f.dialog?f.dialog.submit(R.value):k(!0,E.value.data,R.value))})};return(0,u.sV)(()=>{E.value.data&&(R.value={...R.value,...E.value.data},F.value=(0,c.Zi)(E.value.usedFieldList,E.value.data.parentId))}),(e,m)=>{const c=o._m,b=i.xE,y=r.WK,f=s.P9,g=s.AV,k=i.US,_=n.S2,A=l.S2;return(0,u.uX)(),(0,u.CE)("div",v,[(0,u.bF)(k,{ref_key:"form",ref:h,model:(0,d.R1)(R),class:"full-width-input form-box",rules:T,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(a).defaultFormItemSize,"label-position":"right",onSubmit:m[3]||(m[3]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(b,{label:"父字段"},{default:(0,u.k6)(()=>[(0,u.bF)(c,{modelValue:(0,d.R1)(F),"onUpdate:modelValue":m[0]||(m[0]=e=>(0,d.i9)(F)?F.value=e:null),options:(0,d.R1)(E).usedFieldList,props:{value:"id",label:"fieldName",children:"children",checkStrictly:!0,disabled:"disabled"},clearable:"",filterable:"",disabled:null!=(0,d.R1)(E).data,placeholder:"请选择父字段",onChange:S},null,8,["modelValue","options","disabled"])]),_:1}),(0,u.bF)(b,{label:"字段名",prop:"fieldName"},{default:(0,u.k6)(()=>[(0,u.bF)(y,{modelValue:(0,d.R1)(R).fieldName,"onUpdate:modelValue":m[1]||(m[1]=e=>(0,d.R1)(R).fieldName=e),clearable:"",disabled:null!=(0,d.R1)(E).data},null,8,["modelValue","disabled"])]),_:1}),(0,u.bF)(b,{label:"字段类型",prop:"fieldType"},{default:(0,u.k6)(()=>[(0,u.bF)(g,{modelValue:(0,d.R1)(R).fieldType,"onUpdate:modelValue":m[2]||(m[2]=e=>(0,d.R1)(R).fieldType=e),clearable:"",placeholder:"请选择字段类型"},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,d.R1)(t),e=>((0,u.uX)(),(0,u.Wv)(f,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(A,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,u.k6)(()=>[(0,u.bF)(_,{size:(0,d.R1)(a).defaultFormItemSize,plain:!0,onClick:m[4]||(m[4]=e=>I())},{default:(0,u.k6)(()=>m[6]||(m[6]=[(0,u.eW)(" 取消 ")])),_:1,__:[6]},8,["size"]),(0,u.bF)(_,{type:"primary",size:(0,d.R1)(a).defaultFormItemSize,onClick:m[5]||(m[5]=e=>w())},{default:(0,u.k6)(()=>m[7]||(m[7]=[(0,u.eW)(" 保存 ")])),_:1,__:[7]},8,["size"])]),_:1})])}}});const g=f;var k=g},39585:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var l=a(21929),n=(a(97042),a(98421),a(65451)),i=(a(63390),a(25136)),s=(a(69957),a(77649)),r=(a(87603),a(76408)),o=(a(87535),a(32465),a(14022)),u=(a(72343),a(44114),a(18111),a(61701),a(56768)),d=a(90144),p=a(45130),m=a(26695),c=a(61617),b=a(71066),y=a(82572);const v={class:"form-single-fragment",style:{position:"relative"}};var f=(0,u.pM)({__name:"formEditFlowEntryStatus",props:{flowEntry:{},rowData:{},usedVariableList:{default:()=>[]},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,y.l5)(),a=e,{thirdParams:f,onCloseThirdDialog:g}=(0,b.P)(a),k=(0,u.EW)(()=>t.defaultFormItemSize||f.value.defaultFormItemSize?.value),h=(0,d.KR)(),R=(0,d.KR)({name:void 0,id:void 0}),F={id:[{required:!0,message:"状态标识不能为空！",trigger:"blur"}],name:[{required:!0,message:"状态显示名不能为空！",trigger:"blur"}]},T=(0,u.EW)(()=>({flowEntry:a.flowEntry||f.value.flowEntry,usedVariableList:a.usedVariableList||f.value.usedVariableList,rowData:a.rowData||f.value.rowData})),E=(0,u.EW)(()=>null!=a.rowData),_=()=>{a.dialog?a.dialog.cancel():g(!1)},S=()=>{h.value.validate(e=>{if(!e)return;if(-1!==T.value.usedVariableList.indexOf(R.value.id))return void m.nk.error("状态标识已存在！");let t=[];E.value?t=T.value.flowEntry.extensionData.approvalStatusDict.map(e=>e.name===a.rowData?.name?R.value:e):(t=[...T.value.flowEntry.extensionData.approvalStatusDict],t.push(R.value));let l={flowEntryDto:{...T.value.flowEntry,extensionData:JSON.stringify({approvalStatusDict:t,notifyTypes:T.value.flowEntry.notifyTypes})}};c.Dy.update(l).then(()=>{m.nk.success("保存成功！"),a.dialog?a.dialog.submit(t):g(!0,void 0,t)}).catch(e=>{console.warn(e)})})};return(0,u.sV)(()=>{T.value.rowData&&(R.value={...R.value,...T.value.rowData})}),(e,t)=>{const a=o.WK,m=l.xE,c=r.uD,b=s.lq,y=i.S2,f=n.S2,g=l.US;return(0,u.uX)(),(0,u.CE)("div",v,[(0,u.bF)(g,{ref_key:"form",ref:h,model:(0,d.R1)(R),class:"full-width-input",rules:F,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(k),"label-position":"right",onSubmit:t[2]||(t[2]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(f,{gutter:20},{default:(0,u.k6)(()=>[(0,u.bF)(c,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"状态显示名",prop:"name"},{default:(0,u.k6)(()=>[(0,u.bF)(a,{class:"input-item",modelValue:(0,d.R1)(R).name,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,d.R1)(R).name=e),clearable:!0,placeholder:"状态显示名"},null,8,["modelValue"])]),_:1})]),_:1}),(0,u.bF)(c,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(m,{label:"状态标识",prop:"id"},{default:(0,u.k6)(()=>[(0,u.bF)(b,{class:"input-item",modelValue:(0,d.R1)(R).id,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,d.R1)(R).id=e),clearable:"",controls:!1,"step-strictly":!0,placeholder:"状态标识"},null,8,["modelValue"])]),_:1})]),_:1}),(0,u.bF)(c,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,u.k6)(()=>[(0,u.bF)(y,{size:(0,d.R1)(k),plain:!0,onClick:_},{default:(0,u.k6)(()=>t[3]||(t[3]=[(0,u.eW)(" 取消 ")])),_:1,__:[3]},8,["size"]),(0,u.bF)(y,{type:"primary",size:(0,d.R1)(k),onClick:S},{default:(0,u.k6)(()=>t[4]||(t[4]=[(0,u.eW)(" 保存 ")])),_:1,__:[4]},8,["size"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])])}}});const g=f;var k=g},42421:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var l=a(65451),n=(a(97042),a(63390),a(21929)),i=(a(98421),a(18888)),s=(a(3172),a(25136)),r=(a(69957),a(32465),a(85415)),o=(a(22243),a(7409),a(44114),a(18111),a(22489),a(7588),a(61701),a(56768)),u=a(90144),d=a(45130),p=a(26695),m=a(57477),c=a(27007),b=a(99397),y=a(19183),v=a(99564),f=a(31372),g=a(22414),k=a(71066),h=a(82572);const R={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var F=(0,o.pM)({__name:"addCopyForItem",props:{deptList:{},postList:{},deptPostList:{},roleList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,h.l5)(),a=e,{thirdParams:F,onCloseThirdDialog:T}=(0,k.P)(a),E=(0,u.KR)(),_=(0,u.KR)([]),S=(0,u.KR)({type:g.SysFlowCopyForType.USER,id:void 0}),I=(0,u.KR)([]),w=(0,o.EW)(()=>({deptList:a.deptList||F.value.deptList,postList:a.postList||F.value.postList,deptPostList:a.deptPostList||F.value.deptPostList,roleList:a.roleList||F.value.roleList})),A=(0,o.EW)(()=>{let e=Array.isArray(E.value)?E.value[E.value.length-1]:void 0;return null==e?[]:w.value.deptPostList.filter(t=>t.deptId===e)}),x=()=>{a.dialog?a.dialog.cancel():T(!1)},V=()=>{if(S.value.type===g.SysFlowCopyForType.DEPT_POST&&(null==E.value||""===E.value))return void p.nk.warning("请选择抄送部门");if((null==S.value.id||""===S.value.id)&&S.value.type!==g.SysFlowCopyForType.SELF_DEPT_LEADER&&S.value.type!==g.SysFlowCopyForType.UP_DEPT_LEADER)return void p.nk.warning("请选择"+g.SysFlowCopyForType.getValue(S.value.type));let e=null;switch(S.value.type){case g.SysFlowCopyForType.ROLE:e=S.value.id.join(",");break;case g.SysFlowCopyForType.USER:case g.SysFlowCopyForType.DEPT:e=S.value.id;break;case g.SysFlowCopyForType.POST:case g.SysFlowCopyForType.SELF_DEPT_POST:case g.SysFlowCopyForType.SLIBING_DEPT_POST:case g.SysFlowCopyForType.UP_DEPT_POST:case g.SysFlowCopyForType.DEPT_POST:e=S.value.id.join(",");break;default:e="";break}const t={type:S.value.type,id:e,userName:I.value};a.dialog?a.dialog.submit(t):T(!1,void 0,t)},C=()=>{S.value.id=void 0},L=()=>{S.value.id=void 0,E.value=void 0,I.value=[],_.value=[]},D=()=>{let e=null==S.value.id||""===S.value.id?[]:S.value.id.split(",");f.l.show("添加抄送人",y["default"],{area:["1000px","650px"]},{multiple:!0,props:{label:"showName",value:"userId"},usedUserIdList:e,path:"thirdTaskUserSelect"},{width:"1000px",height:"690px",pathName:"/thirdParty/thirdTaskUserSelect"}).then(e=>{N(e)}).catch(e=>{console.warn(e)})},N=e=>{if(Array.isArray(e)){let t=I.value.map(e=>e.id);const a=[];e.forEach(e=>{-1===t.indexOf(e.loginName)&&a.push({id:e.loginName,name:e.showName||e.loginName})}),I.value=I.value.concat(a)}else I.value=e?[{id:e.loginName,name:e.showName||e.loginName}]:[]},P=()=>{let e=null==S.value.id||""===S.value.id?[]:S.value.id.split(",");f.l.show("选择部门",v["default"],{area:["600px","600px"]},{allGroupList:w.value.deptList,usedIdList:e,path:"thirdTaskGroupSelect"},{width:"600px",height:"630px",pathName:"/thirdParty/thirdTaskGroupSelect"}).then(e=>{W(e)}).catch(e=>{console.warn(e)})},W=e=>{if(Array.isArray(e)){const t=[];e.forEach(e=>{null==(0,c.PH)(_.value,e.id,"id")&&t.push(e)}),_.value=t}S.value.id=Array.isArray(_.value)?_.value.map(e=>e.id).join(","):""};return(0,o.wB)(I,e=>{let t=e.map(e=>e.id);S.value.id=t.join(",")},{deep:!0}),(e,a)=>{const p=r.P9,c=r.AV,y=n.xE,v=s.S2,f=i._m,k=n.US,h=l.S2;return(0,o.uX)(),(0,o.CE)("div",R,[(0,o.bF)(k,{ref:"form",model:(0,u.R1)(S),class:"full-width-input form-box",style:{width:"100%"},"label-width":"90px",size:(0,u.R1)(t).defaultFormItemSize,"label-position":"right",onSubmit:a[7]||(a[7]=(0,d.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(y,{label:"抄送类型",prop:"type"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{class:"input-item",modelValue:(0,u.R1)(S).type,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,u.R1)(S).type=e),placeholder:"抄送类型",onChange:L},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,u.R1)(g.SysFlowCopyForType).getList(),e=>((0,o.uX)(),(0,o.Wv)(p,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,u.R1)(S).type===(0,u.R1)(g.SysFlowCopyForType).USER?((0,o.uX)(),(0,o.Wv)(y,{key:0,label:"抄送人",prop:"id"},{default:(0,o.k6)(()=>[(0,o.bF)(b.A,{value:(0,u.R1)(I),"onUpdate:value":a[1]||(a[1]=e=>(0,u.i9)(I)?I.value=e:null)},{append:(0,o.k6)(()=>[(0,o.bF)(v,{class:"append-add",type:"default",icon:(0,u.R1)(m.Plus),onClick:D},null,8,["icon"])]),_:1},8,["value"])]),_:1})):(0,o.Q3)("",!0),(0,u.R1)(S).type===(0,u.R1)(g.SysFlowCopyForType).ROLE?((0,o.uX)(),(0,o.Wv)(y,{key:1,label:"抄送角色",prop:"id"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{modelValue:(0,u.R1)(S).id,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,u.R1)(S).id=e),placeholder:"",multiple:!0},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,u.R1)(w).roleList,e=>((0,o.uX)(),(0,o.Wv)(p,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,u.R1)(S).type===(0,u.R1)(g.SysFlowCopyForType).DEPT?((0,o.uX)(),(0,o.Wv)(y,{key:2,label:"抄送部门",prop:"id"},{default:(0,o.k6)(()=>[(0,o.bF)(b.A,{value:(0,u.R1)(_),"onUpdate:value":a[3]||(a[3]=e=>(0,u.i9)(_)?_.value=e:null)},{append:(0,o.k6)(()=>[(0,o.bF)(v,{class:"append-add",type:"default",icon:(0,u.R1)(m.Plus),onClick:P},null,8,["icon"])]),_:1},8,["value"])]),_:1})):(0,o.Q3)("",!0),-1!==[(0,u.R1)(g.SysFlowCopyForType).POST,(0,u.R1)(g.SysFlowCopyForType).SELF_DEPT_POST,(0,u.R1)(g.SysFlowCopyForType).SLIBING_DEPT_POST,(0,u.R1)(g.SysFlowCopyForType).UP_DEPT_POST].indexOf((0,u.R1)(S).type)?((0,o.uX)(),(0,o.Wv)(y,{key:3,label:(0,u.R1)(g.SysFlowCopyForType).getValue((0,u.R1)(S).type),prop:"id"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{modelValue:(0,u.R1)(S).id,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,u.R1)(S).id=e),placeholder:"",multiple:!0},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,u.R1)(w).postList,e=>((0,o.uX)(),(0,o.Wv)(p,{key:e.postId,label:e.postName,value:e.postId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):(0,o.Q3)("",!0),(0,u.R1)(S).type===(0,u.R1)(g.SysFlowCopyForType).DEPT_POST?((0,o.uX)(),(0,o.Wv)(y,{key:4,label:"抄送部门",prop:"deptId"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:(0,u.R1)(E),"onUpdate:modelValue":a[5]||(a[5]=e=>(0,u.i9)(E)?E.value=e:null),clearable:!0,size:(0,u.R1)(t).defaultFormItemSize,placeholder:"",props:{value:"id",label:"name",checkStrictly:!0},options:(0,u.R1)(w).deptList,onChange:C},null,8,["modelValue","size","options"])]),_:1})):(0,o.Q3)("",!0),(0,u.R1)(S).type===(0,u.R1)(g.SysFlowCopyForType).DEPT_POST?((0,o.uX)(),(0,o.Wv)(y,{key:5,label:"抄送岗位",prop:"id"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{modelValue:(0,u.R1)(S).id,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,u.R1)(S).id=e),placeholder:"",multiple:!0},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,u.R1)(A),e=>((0,o.uX)(),(0,o.Wv)(p,{key:e.deptPostId,label:e.postShowName,value:e.deptPostId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(0,o.Q3)("",!0)]),_:1},8,["model","size"]),(0,o.bF)(h,{type:"flex",justify:"end",class:"no-scroll menu-box"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{size:(0,u.R1)(t).defaultFormItemSize,plain:!0,onClick:x},{default:(0,o.k6)(()=>a[8]||(a[8]=[(0,o.eW)(" 取消 ")])),_:1,__:[8]},8,["size"]),(0,o.bF)(v,{type:"primary",size:(0,u.R1)(t).defaultFormItemSize,onClick:V},{default:(0,o.k6)(()=>a[9]||(a[9]=[(0,o.eW)(" 保存 ")])),_:1,__:[9]},8,["size"])]),_:1})])}}}),T=a(71241);const E=(0,T.A)(F,[["__scopeId","data-v-6e74d280"]]);var _=E},63019:function(e,t,a){"use strict";a.d(t,{A:function(){return h}});var l=a(21929),n=(a(97042),a(32465),a(91542)),i=(a(37985),a(54620)),s=(a(53086),a(65451)),r=(a(63390),a(56768)),o=a(24232),u=a(90144),d=a(45130),p=a(37972),m=a(57477),c=a(22369);const b={class:"item",style:{width:"100%",padding:"0 15px"}},y={key:1},v={class:"right",style:{"line-height":"20px","font-size":"12px"}};var f=(0,r.pM)({__name:"index",props:{label:{},data:{},disabled:{type:Boolean,default:!1},maxCount:{},supportSort:{type:Boolean,default:!1},supportAdd:{type:Boolean,default:!0},dragGroup:{default:"componentsGroup"},prop:{default:()=>({label:"name",value:"id",disabled:void 0})},addText:{}},emits:["add","edit","delete","update:data"],setup(e,{emit:t}){const a=t,f=e,g=(0,r.Ht)();console.log("slots",g);const k=(0,r.EW)(()=>(console.log("addDisabled",f.label,f.disabled,!f.supportAdd,f.maxCount,(R.value||[]).length),f.disabled||!f.supportAdd||f.maxCount&&f.maxCount<=(R.value||[]).length)),h=(0,r.EW)(()=>(console.log("getCurrentInstance.slots",(0,r.nI)()?.slots),(0,r.nI)()?.slots.default)),R=(0,r.EW)({get:()=>(console.log("dataList 0>>>",f.data),null==f.data?[]:Array.isArray(f.data)?f.data:[f.data]),set:e=>{console.log("MultiItemList data change",e),a("update:data",e)}}),F=e=>{let t=!1;return null!=e&&null!=f.prop.disabled&&(t="function"===typeof f.prop.disabled?f.prop.disabled(e):e[f.prop.disabled]),f.disabled||null==e||t},T=e=>{f.disabled||(null==e?a("add"):a("edit",e))},E=e=>{F(e)||a("delete",e)},_=e=>"function"===typeof f.prop.value?f.prop.value(e):e[f.prop.value],S=e=>"function"===typeof f.prop.label?f.prop.label(e):e[f.prop.label];return(e,t)=>{const a=s.S2,f=i.C4,g=n.tk,I=l.xE;return(0,r.uX)(),(0,r.Wv)(I,{class:(0,o.C4)(["multi-item-list",{empty:((0,u.R1)(R)||[]).length<=0}])},{label:(0,r.k6)(()=>[(0,r.bF)(a,{justify:"space-between",align:"middle",style:{width:"100%"}},{default:(0,r.k6)(()=>[(0,r.Lk)("span",null,(0,o.v_)(e.label),1),(0,r.bF)(c.A,{class:"add-btn",disabled:(0,u.R1)(k),onClick:t[0]||(t[0]=(0,d.D$)(e=>T(null),["prevent","stop"]))},{default:(0,r.k6)(()=>[(0,r.eW)((0,o.v_)(e.addText?e.addText:"添加"),1)]),_:1},8,["disabled"])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)((0,u.R1)(p.MA),{draggable:".list-item",modelValue:(0,u.R1)(R),"onUpdate:modelValue":t[1]||(t[1]=e=>(0,u.i9)(R)?R.value=e:null),group:e.dragGroup,style:{display:"inline-block",overflow:"hidden",width:"100%",height:"100%"},disabled:!e.supportSort},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,u.R1)(R),t=>((0,r.uX)(),(0,r.Wv)(a,{class:"list-item",key:_(t),align:"middle",justify:"space-between",style:{width:"100%","flex-wrap":"nowrap"}},{default:(0,r.k6)(()=>[(0,r.Lk)("div",b,[(0,r.bF)(a,{align:"middle",justify:"space-between",style:{"min-height":"32px",padding:"6px 0"}},{default:(0,r.k6)(()=>[(0,r.bF)(f,{style:{"font-size":"12px",color:"#333","line-height":"20px"},disabled:e.disabled,onClick:e=>T(t)},{default:(0,r.k6)(()=>[(0,u.R1)(h)?(0,r.RG)(e.$slots,"default",{key:0,data:t}):((0,r.uX)(),(0,r.CE)("span",y,(0,o.v_)(S(t)),1))]),_:2},1032,["disabled","onClick"]),(0,r.Lk)("div",v,[(0,r.RG)(e.$slots,"right",{data:t})])]),_:2},1024)]),(0,r.bF)(g,{style:{"margin-left":"8px",color:"#333"},class:(0,o.C4)(["close-btn",{disabled:F(t)}]),onClick:(0,d.D$)(e=>E(t),["stop"])},{default:(0,r.k6)(()=>[(0,r.bF)((0,u.R1)(m.Remove))]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:3},8,["modelValue","group","disabled"])]),_:3},8,["class"])}}}),g=a(71241);const k=(0,g.A)(f,[["__scopeId","data-v-6dcd60d8"]]);var h=k},64379:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var l=a(54880),n=(a(97042),a(51582),a(60713),a(38840)),i=(a(95304),a(68368)),s=(a(81208),a(12687)),r=(a(31112),a(47001),a(25136)),o=(a(69957),a(65451)),u=(a(63390),a(18888)),d=(a(3172),a(17851)),p=(a(68489),a(20709),a(18111),a(22489),a(61701),a(56768)),m=a(90144),c=a(45130),b=a(24232),y=a(61473),v=a(71066),f=a(82572);const g={class:"base-card-header"},k={class:"base-card-operation"};var h=(0,p.pM)({__name:"TaskPostSelect",props:{deptList:{},postList:{},deptPostList:{},usedIdList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:a,onCloseThirdDialog:h}=(0,v.P)(t),R=(0,f.l5)(),F=(0,m.KR)({deptType:"allDeptPost",deptId:void 0,postId:void 0}),T=(0,m.KR)([]),E=(0,p.EW)(()=>({deptList:t.deptList||a.value.deptList,postList:t.postList||a.value.postList,deptPostList:t.deptPostList||a.value.deptPostList,usedIdList:t.usedIdList||a.value.usedIdList})),_=(0,p.EW)(()=>"deptPost"!==F.value.deptType?E.value.postList||[]:(E.value.deptPostList||[]).filter(e=>e.deptId===(Array.isArray(F.value.deptId)?F.value.deptId[F.value.deptId.length-1]:F.value.deptId))),S=e=>!(Array.isArray(E.value.usedIdList)&&E.value.usedIdList.length>0)||-1===E.value.usedIdList.map(e=>e.split("__")[1]).indexOf(e.deptPostId||e.postId),I=e=>{T.value=e},w=()=>{const e=T.value.map(e=>({id:`${F.value.deptType}__${e.deptPostId||e.postId}`,deptType:F.value.deptType,deptPostId:"deptPost"===F.value.deptType?e.deptPostId:void 0,postId:"deptPost"===F.value.deptType?void 0:e.postId}));t.dialog?t.dialog.submit(e):h(!0,void 0,e)};return(e,t)=>{const a=d.Zh,v=d.MQ,f=u._m,h=o.S2,A=r.S2,x=i.o8,V=s.u,C=i.Up,L=n.Ik,D=l.ZO,N=l.lX;return(0,p.uX)(),(0,p.Wv)(N,null,{default:(0,p.k6)(()=>[(0,p.bF)(D,{style:{"background-color":"white"}},{default:(0,p.k6)(()=>[(0,p.bF)(L,{class:"base-card",shadow:"never","body-style":{padding:"16px"},style:{border:"none"}},{header:(0,p.k6)(()=>[(0,p.Lk)("div",g,[(0,p.bF)(h,{align:"middle",style:{"flex-wrap":"nowrap"}},{default:(0,p.k6)(()=>[(0,p.bF)(v,{modelValue:(0,m.R1)(F).deptType,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,m.R1)(F).deptType=e),size:(0,m.R1)(R).defaultFormItemSize,onChange:t[1]||(t[1]=e=>(0,m.R1)(F).deptId=void 0)},{default:(0,p.k6)(()=>[(0,p.bF)(a,{value:"allDeptPost"},{default:(0,p.k6)(()=>t[4]||(t[4]=[(0,p.eW)("全部")])),_:1,__:[4]}),(0,p.bF)(a,{value:"selfDeptPost"},{default:(0,p.k6)(()=>t[5]||(t[5]=[(0,p.eW)("本部门")])),_:1,__:[5]}),(0,p.bF)(a,{value:"siblingDeptPost"},{default:(0,p.k6)(()=>t[6]||(t[6]=[(0,p.eW)("同级部门")])),_:1,__:[6]}),(0,p.bF)(a,{value:"upDeptPost"},{default:(0,p.k6)(()=>t[7]||(t[7]=[(0,p.eW)("上级部门")])),_:1,__:[7]}),(0,p.bF)(a,{value:"deptPost"},{default:(0,p.k6)(()=>t[8]||(t[8]=[(0,p.eW)("指定部门")])),_:1,__:[8]})]),_:1},8,["modelValue","size"]),(0,p.bo)((0,p.Lk)("div",null,[(0,p.bF)(f,{modelValue:(0,m.R1)(F).deptId,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,m.R1)(F).deptId=e),clearable:!0,size:(0,m.R1)(R).defaultFormItemSize,placeholder:"选择部门",props:{value:"id",label:"name",checkStrictly:!0},options:(0,m.R1)(E).deptList},null,8,["modelValue","size","options"])],512),[[c.aG,"deptPost"===(0,m.R1)(F).deptType]])]),_:1}),(0,p.Lk)("div",k,[(0,p.bF)(A,{type:"primary",size:(0,m.R1)(R).defaultFormItemSize,disabled:(0,m.R1)(T).length<=0,onClick:t[3]||(t[3]=e=>w())},{default:(0,p.k6)(()=>t[9]||(t[9]=[(0,p.eW)(" 添加岗位 ")])),_:1,__:[9]},8,["size","disabled"])])])]),default:(0,p.k6)(()=>[(0,p.bF)(C,{data:(0,m.R1)(_),size:(0,m.R1)(R).defaultFormItemSize,height:"470px","header-cell-class-name":"table-header-gray","row-key":"deptPost"===(0,m.R1)(F).deptType?"deptPostId":"postId",onSelectionChange:I},{empty:(0,p.k6)(()=>t[10]||(t[10]=[(0,p.Lk)("div",{class:"table-empty unified-font"},[(0,p.Lk)("img",{src:y}),(0,p.Lk)("span",null,"暂无数据")],-1)])),default:(0,p.k6)(()=>[(0,p.bF)(x,{type:"selection",width:"50px",selectable:S}),(0,p.bF)(x,{label:"岗位名称"},{default:(0,p.k6)(e=>[(0,p.Lk)("span",null,(0,b.v_)(e.row.postShowName||e.row.postName),1)]),_:1}),(0,p.bF)(x,{label:"领导岗位"},{default:(0,p.k6)(e=>[(0,p.bF)(V,{size:(0,m.R1)(R).defaultFormItemSize,type:e.row.leaderPost?"success":"danger"},{default:(0,p.k6)(()=>[(0,p.eW)((0,b.v_)(e.row.leaderPost?"是":"否"),1)]),_:2},1032,["size","type"])]),_:1}),(0,p.bF)(x,{label:"岗位级别",prop:"postLevel"})]),_:1},8,["data","size","row-key"])]),_:1})]),_:1})]),_:1})}}}),R=a(71241);const F=(0,R.A)(h,[["__scopeId","data-v-4b6f04a2"]]);var T=F},78935:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var l=a(65451),n=(a(97042),a(63390),a(25136)),i=(a(69957),a(21929)),s=(a(98421),a(14022)),r=(a(72343),a(32465),a(85415)),o=(a(22243),a(7409),a(56768)),u=a(90144),d=a(45130),p=a(22414),m=a(71066),c=a(82572),b=a(61617);const y={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}};var v=(0,o.pM)({__name:"editAggregationData",props:{srcDblinkId:{default:void 0},srcTableName:{default:void 0},data:{default:void 0},flowVariableList:{default:void 0},dialog:{default:void 0},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,c.l5)(),a=e,{thirdParams:v,onCloseThirdDialog:f}=(0,m.P)(a),g=(0,u.KR)(),k=(0,u.KR)({id:void 0,aggregationFunction:p.AutoTaskAggregationType.SUM,aggregationColumn:"",alias:""}),h=(0,u.KR)({aggregationFunction:[{required:!0,message:"请选择聚合函数",trigger:"blur"}],aggregationColumn:[{required:!0,message:"请选择聚合字段",trigger:"blur"}],alias:[{required:!0,message:"请输入聚合字段别名",trigger:"blur"},{pattern:/^[a-zA-Z]+$/,message:"聚合字段别名只允许英文字符",trigger:"blur"}]}),R=(0,u.KR)([]),F=(0,o.EW)(()=>({srcDblinkId:a.srcDblinkId||v.value.srcDblinkId,srcTableName:a.srcTableName||v.value.srcTableName,data:a.data||v.value.data,flowVariableList:a.flowVariableList||v.value.flowVariableList})),T=()=>{null!=F.value.srcDblinkId&&null!=F.value.srcTableName&&""!==F.value.srcDblinkId&&""!==F.value.srcTableName&&b.V7.listDblinkTableColumns({dblinkId:F.value.srcDblinkId,tableName:F.value.srcTableName}).then(e=>{R.value=e.data})},E=()=>{g.value.validate(e=>{if(e){let e={...k.value};null==e.id&&(e.id=(new Date).getTime()),a.dialog?a.dialog.submit(e):f(!0,F.value.data,e)}})},_=()=>{a.dialog?a.dialog.cancel():f(!1)};return(0,o.sV)(()=>{T(),F.value.data&&(k.value={...F.value.data})}),(e,a)=>{const m=r.P9,c=r.AV,b=i.xE,v=s.WK,f=i.US,F=n.S2,T=l.S2;return(0,o.uX)(),(0,o.CE)("div",y,[(0,o.bF)(f,{ref_key:"form",ref:g,model:(0,u.R1)(k),class:"full-width-input form-box",rules:(0,u.R1)(h),style:{width:"100%"},"label-width":"100px",size:(0,u.R1)(t).defaultFormItemSize,"label-position":"right",onSubmit:a[3]||(a[3]=(0,d.D$)(()=>{},["prevent"]))},{default:(0,o.k6)(()=>[(0,o.bF)(b,{label:"聚合函数",prop:"aggregationFunction"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{modelValue:(0,u.R1)(k).aggregationFunction,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,u.R1)(k).aggregationFunction=e),placeholder:"请选择聚合函数"},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,u.R1)(p.AutoTaskAggregationType).getList(),e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,o.bF)(b,{label:"聚合字段",prop:"aggregationColumn"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{modelValue:(0,u.R1)(k).aggregationColumn,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,u.R1)(k).aggregationColumn=e),clearable:"",filterable:"",placeholder:"请选择聚合字段"},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,u.R1)(R),e=>((0,o.uX)(),(0,o.Wv)(m,{key:e.columnName,label:e.columnName,value:e.columnName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,o.bF)(b,{label:"字段别名",prop:"alias"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{modelValue:(0,u.R1)(k).alias,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,u.R1)(k).alias=e),clearable:"",placeholder:"请输入聚合字段别名（只允许英文）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules","size"]),(0,o.bF)(T,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,o.k6)(()=>[(0,o.bF)(F,{size:(0,u.R1)(t).defaultFormItemSize,plain:!0,onClick:a[4]||(a[4]=e=>_())},{default:(0,o.k6)(()=>a[6]||(a[6]=[(0,o.eW)(" 取消 ")])),_:1,__:[6]},8,["size"]),(0,o.bF)(F,{type:"primary",size:(0,u.R1)(t).defaultFormItemSize,onClick:a[5]||(a[5]=e=>E())},{default:(0,o.k6)(()=>a[7]||(a[7]=[(0,o.eW)(" 保存 ")])),_:1,__:[7]},8,["size"])]),_:1})])}}});const f=v;var g=f},79838:function(){},82859:function(e,t,a){e.exports={__init__:["FlowableModdleExtension"],FlowableModdleExtension:["type",a(32990)]}},83283:function(e,t,a){"use strict";a.d(t,{A:function(){return i}});var l=a(55583),n=a(18384);class i extends l.w{static testScript(e,t){return super.post(n.x+"/online/onlineApi/testScript",e,t)}static list(e,t){return super.post(n.x+"/online/onlineApi/list",e,t)}static view(e,t){return super.get(n.x+"/online/onlineApi/view",e,t)}static add(e,t){return super.post(n.x+"/online/onlineApi/add",e,t)}static update(e,t){return super.post(n.x+"/online/onlineApi/update",e,t)}static delete(e,t){return super.post(n.x+"/online/onlineApi/delete",e,t)}static deleteBatch(e,t){return super.post(n.x+"/online/onlineApi/deleteBatch",e,t)}}},86221:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var l=a(65451),n=(a(97042),a(63390),a(25136)),i=(a(69957),a(21929)),s=(a(98421),a(18888)),r=(a(3172),a(85415)),o=(a(22243),a(7409),a(32465),a(14022)),u=(a(72343),a(18111),a(22489),a(56768)),d=a(90144),p=a(45130),m=a(26695),c=a(22414),b=a(27007),y=a(71066),v=a(82572);const f={class:"form-single-fragment third-party-dlg",style:{position:"relative",height:"100%"}};var g=(0,u.pM)({__name:"editHttpHeader",props:{data:{default:void 0},flowVariableList:{default:void 0},usedKeyList:{default:void 0},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,v.l5)(),a=e,{thirdParams:g,onCloseThirdDialog:k}=(0,y.P)(a),h=(0,d.KR)(),R=(0,d.KR)({key:"",type:c.AutoTaskValueType.FIXED,srcValue:""}),F={key:[{required:!0,message:"请输入Key",trigger:"blur"}],srcValue:[{required:!0,message:"请输入Value",trigger:"blur"}]},T=(0,u.EW)(()=>({data:a.data||g.value.data,flowVariableList:a.flowVariableList||g.value.flowVariableList,usedKeyList:a.usedKeyList||g.value.usedKeyList})),E=((0,u.EW)(()=>T.value.data?T.value.usedKeyList.filter(e=>e!==T.value.data.key):T.value.usedKeyList),()=>{a.dialog?a.dialog.cancel():k(!1)}),_=()=>{(T.value.usedKeyList||[]).includes(R.value.key)?m.nk.error("Key已存在"):h.value.validate(e=>{if(e){let e;e=R.value.srcValue,R.value.type===c.AutoTaskValueType.VARIABLE&&(e=Array.isArray(R.value.srcValue)?R.value.srcValue[R.value.srcValue.length-1]:void 0);let t={...R.value,srcValue:e};a.dialog?a.dialog.submit(t):k(!0,T.value.data,t)}})};return(0,u.sV)(()=>{if(T.value.data){let e,t;e=T.value.data.srcValue,t=T.value.data.type===c.AutoTaskValueType.VARIABLE?(0,b.Zi)(T.value.flowVariableList,e):void 0,R.value={...R.value,...T.value.data,srcValue:t||e}}}),(e,a)=>{const m=o.WK,b=i.xE,y=r.P9,v=r.AV,g=s._m,k=i.US,S=n.S2,I=l.S2;return(0,u.uX)(),(0,u.CE)("div",f,[(0,u.bF)(k,{ref_key:"form",ref:h,model:(0,d.R1)(R),class:"full-width-input form-box",rules:F,style:{width:"100%"},"label-width":"100px",size:(0,d.R1)(t).defaultFormItemSize,"label-position":"right",onSubmit:a[4]||(a[4]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(b,{label:"Key",prop:"key"},{default:(0,u.k6)(()=>[(0,u.bF)(m,{modelValue:(0,d.R1)(R).key,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,d.R1)(R).key=e),clearable:"",disabled:null!=(0,d.R1)(T).data},null,8,["modelValue","disabled"])]),_:1}),(0,u.bF)(b,{label:"绑定值类型",prop:"type"},{default:(0,u.k6)(()=>[(0,u.bF)(v,{modelValue:(0,d.R1)(R).type,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,d.R1)(R).type=e),clearable:"",placeholder:"请选择绑定值类型"},{default:(0,u.k6)(()=>[(0,u.bF)(y,{label:(0,d.R1)(c.AutoTaskValueType).getValue((0,d.R1)(c.AutoTaskValueType).FIXED),value:(0,d.R1)(c.AutoTaskValueType).FIXED},null,8,["label","value"]),(0,u.bF)(y,{label:(0,d.R1)(c.AutoTaskValueType).getValue((0,d.R1)(c.AutoTaskValueType).VARIABLE),value:(0,d.R1)(c.AutoTaskValueType).VARIABLE},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1}),(0,u.bF)(b,{label:"绑定值",prop:"srcValue"},{default:(0,u.k6)(()=>[(0,d.R1)(R).type===(0,d.R1)(c.AutoTaskValueType).FIXED?((0,u.uX)(),(0,u.Wv)(m,{key:0,modelValue:(0,d.R1)(R).srcValue,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,d.R1)(R).srcValue=e),clearable:"",placeholder:"请输入绑定值"},null,8,["modelValue"])):(0,d.R1)(R).type===(0,d.R1)(c.AutoTaskValueType).VARIABLE?((0,u.uX)(),(0,u.Wv)(g,{key:1,options:(0,d.R1)(T).flowVariableList,props:{value:"id",label:"name",children:"children"},modelValue:(0,d.R1)(R).srcValue,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,d.R1)(R).srcValue=e),clearable:"",filterable:"",placeholder:"请选择流程变量"},null,8,["options","modelValue"])):(0,u.Q3)("",!0)]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(I,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end",style:{"padding-top":"10px"}},{default:(0,u.k6)(()=>[(0,u.bF)(S,{size:(0,d.R1)(t).defaultFormItemSize,plain:!0,onClick:a[5]||(a[5]=e=>E())},{default:(0,u.k6)(()=>a[7]||(a[7]=[(0,u.eW)(" 取消 ")])),_:1,__:[7]},8,["size"]),(0,u.bF)(S,{type:"primary",size:(0,d.R1)(t).defaultFormItemSize,onClick:a[6]||(a[6]=e=>_())},{default:(0,u.k6)(()=>a[8]||(a[8]=[(0,u.eW)(" 保存 ")])),_:1,__:[8]},8,["size"])]),_:1})])}}});const k=g;var h=k}}]);