"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,1116,6339,8720],{21013:function(e,t,s){s.d(t,{A:function(){return n}});var r=s(55583),a=s(18384);class n extends r.w{static getUserList(e,t){return super.post(a.x+"/upms/sysUser/list",e,t)}static addUser(e,t){return super.post(a.x+"/upms/sysUser/add",e,t)}static updateUser(e,t){return super.post(a.x+"/upms/sysUser/update",e,t)}static deleteUser(e,t){return super.post(a.x+"/upms/sysUser/delete",e,t)}static viewMenu(e,t){return super.post(a.x+"/upms/sysMenu/view",e,t)}static syncAzureUser(e){return super.post(a.x+"/upms/sysUser/syncAzureUser",e)}static getUser(e,t){return super.get(a.x+"/upms/sysUser/view",e,t)}static resetUserPassword(e,t){return super.post(a.x+"/upms/sysUser/resetPassword",e,t)}static listSysPermWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysPermWithDetail",e,t)}static listSysPermCodeWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysPermCodeWithDetail",e,t)}static listSysMenuWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysMenuWithDetail",e,t)}}},43377:function(e,t,s){s.r(t),s.d(t,{default:function(){return b}});var r=s(21929),a=(s(97042),s(98421),s(65451)),n=(s(63390),s(14022)),i=(s(72343),s(25136)),u=(s(69957),s(76408)),l=(s(87535),s(32465),s(44114),s(18111),s(7588),s(61701),s(56768)),o=s(90144),p=s(45130),d=s(57477),c=s(99397),m=s(19183),y=s(9924),g=s(61617),x=s(31372),w=s(71066),D=s(82572);const h={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var f=(0,l.pM)({__name:"formInterposeInstance",props:{processInstanceId:{},processDefinitionId:{},taskId:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,D.l5)(),s=e,{thirdParams:f,onCloseThirdDialog:v}=(0,w.P)(s),P=(0,l.EW)(()=>t.defaultFormItemSize||f.value.defaultFormItemSize?.value),b=(0,o.KR)(),I=(0,o.KR)({taskComment:void 0,delegateAssignee:void 0,targetTaskKey:void 0}),S={taskComment:[{required:!0,message:"请输入干预原因",trigger:"blur"}]},k=(0,o.KR)(),U=(0,o.KR)([]),R=(0,o.KR)(),M=(0,l.EW)(()=>({taskId:s.taskId||f.value.taskId,processDefinitionId:s.processDefinitionId||f.value.processDefinitionId,processInstanceId:s.processInstanceId||f.value.processInstanceId})),C=()=>{s.dialog?s.dialog.cancel():v(!1)},E=()=>{b.value.validate(e=>{if(e){let e={processInstanceId:M.value.processInstanceId,taskId:M.value.taskId,delegateAssignee:I.value.delegateAssignee,targetTaskKey:I.value.targetTaskKey,taskComment:I.value.taskComment};g.wI.interveneRuntimeTask(e).then(e=>{s.dialog?s.dialog.submit(e):v(!0)}).catch(e=>{console.warn(e)})}})},_=e=>{if(Array.isArray(e)){let t=U.value.map(e=>e.id);const s=[];e.forEach(e=>{-1===t.indexOf(e.loginName)&&s.push({id:e.loginName,name:e.showName||e.loginName})}),U.value=U.value?U.value.concat(s):s}},A=()=>{let e=null==I.value.delegateAssignee||""===I.value.delegateAssignee?[]:I.value.delegateAssignee.split(",");x.l.show("选择用户",m["default"],{area:["1000px","600px"]},{showAssignee:!1,showStartUser:!1,multiple:!0,usedUserIdList:e,path:"thirdTaskUserSelect"},{width:"1000px",height:"640px",pathName:"/thirdParty/thirdTaskUserSelect"}).then(e=>{_(e)}).catch(e=>{console.warn(e)})},F=()=>{let e={processDefinitionId:M.value.processDefinitionId};g.wI.viewProcessBpmn(e).then(e=>{k.value=e.data}).catch(e=>{console.warn(e)})},W=()=>{if(null==M.value.processInstanceId||""===M.value.processInstanceId)return;let e={processInstanceId:M.value.processInstanceId};g.wI.viewHighlightFlowData(e).then(e=>{R.value=e.data}).catch(e=>{console.warn(e)})};return(0,l.wB)(U,e=>{if(e){let t=e.map(e=>e.id);I.value.delegateAssignee=t.join(",")}},{deep:!0}),(0,l.sV)(()=>{F(),W()}),(e,t)=>{const s=r.xE,m=u.uD,g=i.S2,x=n.WK,w=a.S2,D=r.US;return(0,l.uX)(),(0,l.CE)("div",h,[(0,l.bF)(D,{ref_key:"form",ref:b,model:(0,o.R1)(I),class:"full-width-input form-box",style:{width:"100%"},"label-width":"100px",size:(0,o.R1)(P),"label-position":"right",onSubmit:t[3]||(t[3]=(0,p.D$)(()=>{},["prevent"])),rules:S},{default:(0,l.k6)(()=>[(0,l.bF)(w,{gutter:20},{default:(0,l.k6)(()=>[(0,l.bF)(m,{span:24},{default:(0,l.k6)(()=>[(0,l.bF)(s,{label:"跳转节点",prop:"targetTaskKey"},{default:(0,l.k6)(()=>[(0,l.bF)(y.A,{value:(0,o.R1)(I).targetTaskKey,"onUpdate:value":t[0]||(t[0]=e=>(0,o.R1)(I).targetTaskKey=e),xml:(0,o.R1)(k),placeholder:"请选择跳转任务节点",disabled:null==(0,o.R1)(k),finishedInfo:(0,o.R1)(R)},null,8,["value","xml","disabled","finishedInfo"])]),_:1})]),_:1}),(0,l.bF)(m,{span:24},{default:(0,l.k6)(()=>[(0,l.bF)(s,{label:"处理用户",prop:"delegateAssignee"},{default:(0,l.k6)(()=>[(0,l.bF)(c.A,{value:(0,o.R1)(U),"onUpdate:value":t[1]||(t[1]=e=>(0,o.i9)(U)?U.value=e:null)},{append:(0,l.k6)(()=>[(0,l.bF)(g,{class:"append-add",type:"default",icon:(0,o.R1)(d.Plus),onClick:A},null,8,["icon"])]),_:1},8,["value"])]),_:1})]),_:1}),(0,l.bF)(m,{span:24},{default:(0,l.k6)(()=>[(0,l.bF)(s,{label:"干预原因",prop:"taskComment"},{default:(0,l.k6)(()=>[(0,l.bF)(x,{modelValue:(0,o.R1)(I).taskComment,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.R1)(I).taskComment=e),clearable:"",placeholder:"请输入干预原因"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,l.bF)(w,{class:"no-scroll flex-box menu-box",type:"flex",justify:"end"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{size:(0,o.R1)(P),plain:!0,onClick:C},{default:(0,l.k6)(()=>t[4]||(t[4]=[(0,l.eW)(" 取消 ")])),_:1,__:[4]},8,["size"]),(0,l.bF)(g,{type:"primary",size:(0,o.R1)(P),onClick:E},{default:(0,l.k6)(()=>t[5]||(t[5]=[(0,l.eW)(" 提交 ")])),_:1,__:[5]},8,["size"])]),_:1})])}}}),v=s(71241);const P=(0,v.A)(f,[["__scopeId","data-v-837e8232"]]);var b=P},54428:function(e,t,s){s.d(t,{v9:function(){return i},n5:function(){return u},lE:function(){return x},_4:function(){return h},C7:function(){return p},If:function(){return f},qY:function(){return o},ek:function(){return d},$z:function(){return c},$D:function(){return D},S_:function(){return g},fe:function(){return l},sV:function(){return m},r0:function(){return y.A}});s(18111),s(61701);var r=s(55583),a=s(52081),n=s(18384);class i extends r.w{static dictSysRole(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysRole/listDict",e,t).then(e=>{const t=new a.w("角色字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictGlobalDict(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/globalDict/listDict",e,t).then(e=>{const t=new a.w("编码字典",(e.data||[]).map(e=>({...e,disabled:1===e.status})));s(t)}).catch(e=>{r(e)})})}static dictGlobalDictByIds(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/globalDict/listDictByIds",e,t).then(e=>{const t=new a.w("编码字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictAllMenu(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysMenu/listDict",e,t).then(e=>{const t=new a.w("菜单字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysMenu(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysMenu/listMenuDict",e,t).then(e=>{const t=new a.w("菜单字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictDeptPost(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysDept/listSysDeptPostWithRelation",e,t).then(e=>{s(e.data)}).catch(e=>{r(e)})})}static dictSysPost(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysPost/listDict",e,t).then(e=>{const t=new a.w("岗位字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictReportDblink(e,t){return new Promise((s,r)=>{super.get(n.x+"/report/reportDblink/listDict",e,t).then(e=>{const t=new a.w("数据库链接",e.data);s(t)}).catch(e=>{r(e)})})}static dictReportDict(e,t){return new Promise((s,r)=>{super.get(n.x+"/report/reportDict/listDict",e,t).then(e=>{const t=new a.w("字典管理",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysUser(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysUser/listDict",e,t).then(e=>{let t=new a.w("用户字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysDept(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysDept/listDict",e,t).then(e=>{let t=new a.w("部门字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysDeptByParentId(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysDept/listDictByParentId",e,t).then(e=>{let t=new a.w("部门字典",e.data);s(t)}).catch(e=>{r(e)})})}}class u extends r.w{static listSysLoginUser(e,t){return super.post(n.x+"/upms/loginUser/list",e,t)}static deleteSysLoginUser(e,t){return super.post(n.x+"/upms/loginUser/delete",e,t)}}class l extends r.w{static getMenuPermList(e,t){return super.post(n.x+"/upms/sysMenu/list",e,t)}static addMenu(e,t){return super.post(n.x+"/upms/sysMenu/add",e,t)}static updateMenu(e,t){return super.post(n.x+"/upms/sysMenu/update",e,t)}static deleteMenu(e,t){return super.post(n.x+"/upms/sysMenu/delete",e,t)}static viewMenu(e,t){return super.get(n.x+"/upms/sysMenu/view",e,t)}static listMenuPermCode(e,t){return super.get(n.x+"/upms/sysMenu/listMenuPerm",e,t)}static listSysPermByMenuIdWithDetail(e,t){return super.get(n.x+"/upms/sysMenu/listSysPermWithDetail",e,t)}static listSysUserByMenuIdWithDetail(e,t){return super.get(n.x+"/upms/sysMenu/listSysUserWithDetail",e,t)}}class o extends r.w{static updateSysConf(e,t){return super.post(n.x+"/upms/sysConf/update",e,t)}static getSysConf(e,t){return super.get(n.x+"/upms/sysConf/view",e,t)}}class p extends r.w{static getPermCodeList(e,t){return super.get(n.x+"/upms/login/getAllPermCodes",e,t)}}class d extends r.w{static add(e,t){return super.post(n.x+"/upms/sysDataPerm/add",e,t)}static update(e,t){return super.post(n.x+"/upms/sysDataPerm/update",e,t)}static delete(e,t){return super.post(n.x+"/upms/sysDataPerm/delete",e,t)}static list(e,t){return super.post(n.x+"/upms/sysDataPerm/list",e,t)}static view(e,t){return super.get(n.x+"/upms/sysDataPerm/view",e,t)}static listDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/listDataPermUser",e,t)}static addDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/addDataPermUser",e,t)}static deleteDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/deleteDataPermUser",e,t)}static listNotInDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/listNotInDataPermUser",e,t)}}class c extends r.w{static list(e,t){return super.post(n.x+"/upms/sysDept/list",e,t)}static view(e,t){return super.get(n.x+"/upms/sysDept/view",e,t)}static export(e,t){return super.download(n.x+"/upms/sysDept/export",e,t)}static add(e,t){return super.post(n.x+"/upms/sysDept/add",e,t)}static update(e,t){return super.post(n.x+"/upms/sysDept/update",e,t)}static delete(e,t){return super.post(n.x+"/upms/sysDept/delete",e,t)}static listNotInSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/listNotInSysDeptPost",e,t)}static listSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/listSysDeptPost",e,t)}static addSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/addSysDeptPost",e,t)}static updateSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/updateSysDeptPost",e,t)}static deleteSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/deleteSysDeptPost",e,t)}static viewSysDeptPost(e,t){return super.get(n.x+"/upms/sysDept/viewSysDeptPost",e,t)}}class m extends r.w{static getRoleList(e,t){return super.post(n.x+"/upms/sysRole/list",e,t)}static getRole(e,t){return super.get(n.x+"/upms/sysRole/view",e,t)}static deleteRole(e,t){return super.post(n.x+"/upms/sysRole/delete",e,t)}static addRole(e,t){return super.post(n.x+"/upms/sysRole/add",e,t)}static updateRole(e,t){return super.post(n.x+"/upms/sysRole/update",e,t)}static listRoleUser(e,t){return super.post(n.x+"/upms/sysRole/listUserRole",e,t)}static listNotInUserRole(e,t){return super.post(n.x+"/upms/sysRole/listNotInUserRole",e,t)}static addRoleUser(e,t){return super.post(n.x+"/upms/sysRole/addUserRole",e,t)}static deleteRoleUser(e,t){return super.post(n.x+"/upms/sysRole/deleteUserRole",e,t)}}var y=s(21013);class g extends r.w{static list(e,t){return super.post(n.x+"/upms/sysPost/list",e,t)}static view(e,t){return super.get(n.x+"/upms/sysPost/view",e,t)}static add(e,t){return super.post(n.x+"/upms/sysPost/add",e,t)}static update(e,t){return super.post(n.x+"/upms/sysPost/update",e,t)}static delete(e,t){return super.post(n.x+"/upms/sysPost/delete",e,t)}}class x extends r.w{static list(e,t){return super.post(n.x+"/mobile/mobileEntry/list",e,t)}static view(e,t){return super.get(n.x+"/mobile/mobileEntry/view",e,t)}static add(e,t){return super.post(n.x+"/mobile/mobileEntry/add",e,t)}static update(e,t){return super.post(n.x+"/mobile/mobileEntry/update",e,t)}static delete(e,t){return super.post(n.x+"/mobile/mobileEntry/delete",e,t)}static uploadImage(e,t){return super.post(n.x+"/mobile/mobileEntry/uploadImage",e,t)}static downloadImage(e,t){return super.post(n.x+"/mobile/mobileEntry/downloadImage",e,t)}}var w=s(53155);class D{static list(e,t){return(0,w.bE)(n.x+"/upms/globalDict/list",e,t)}static listAll(e,t){return(0,w.Jt)(n.x+"/upms/globalDict/listAll",e,t)}static add(e,t){return(0,w.bE)(n.x+"/upms/globalDict/add",e,t)}static update(e,t){return(0,w.bE)(n.x+"/upms/globalDict/update",e,t)}static delete(e,t){return(0,w.bE)(n.x+"/upms/globalDict/delete",e,t)}static addItem(e,t){return(0,w.bE)(n.x+"/upms/globalDict/addItem",e,t)}static updateItem(e,t){return(0,w.bE)(n.x+"/upms/globalDict/updateItem",e,t)}static updateItemStatus(e,t){return(0,w.bE)(n.x+"/upms/globalDict/updateItemStatus",e,t)}static deleteItem(e,t){return(0,w.bE)(n.x+"/upms/globalDict/deleteItem",e,t)}static reloadCachedData(e,t){return(0,w.Jt)(n.x+"/upms/globalDict/reloadCachedData",e,t)}}class h extends r.w{static listSysOperationLog(e,t){return super.post(n.x+"/upms/sysOperationLog/list",e,t)}}class f extends r.w{static list(e,t){return super.post(n.x+"/commonext/bizwidget/list",e,t)}static viewByIds(e,t){return super.post(n.x+"/commonext/bizwidget/view",e,t)}}},61473:function(e,t,s){e.exports=s.p+"img/empty.7e47f88a.png"},68489:function(e,t,s){s(97042)},71066:function(e,t,s){s.d(t,{P:function(){return u},i:function(){return l}});var r=s(81387),a=s(27007),n=s(56768),i=s(90144);const u=e=>{console.log("接收到的第三方参数",e);const t=(0,i.KR)(0),s=(0,n.EW)(()=>{let t={};try{e.thirdParamsString&&(t=JSON.parse(e.thirdParamsString))}catch(s){console.log(s),t={}}return t});console.log("thirdParams",s);const r=(r,a,n)=>{console.log("onCloseThirdDialog",a,n),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:t.value,dialogKey:e.dialogKey,path:s.value.path,rowData:a?JSON.parse(JSON.stringify(a)):void 0,data:n?JSON.parse(JSON.stringify(n)):void 0,isSuccess:r}},"*")},u=(e,s)=>{switch(e){case"setToken":s.token&&(0,a.WG)(s.token);break;case"dialogIndex":t.value=s;break;case"refreshData":break;case"message":break}},l=e=>{u(e.data.type,e.data.data)};return(0,n.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",l,!1)}),(0,n.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",l)}),{thirdParams:s,onCloseThirdDialog:r}},l=()=>{let e;const t=(0,r.lq)(),s=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==t.path.indexOf("/thirdParty/")&&((0,n.sV)(()=>{(0,a.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),s()},18e4))}),(0,n.hi)(()=>{e&&clearInterval(e)}))}}}]);