"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[658],{7502:function(e,t,a){a.d(t,{s:function(){return l}});var s=a(31372),r=a(56768);const l=()=>{const e=(0,r.WQ)("defaultFormItemSize","default"),t=(t,a,r,l,i)=>(l||(l={}),l.defaultFormItemSize=e,s.l.show(t,a,r,l,i));return{show:t}}},21013:function(e,t,a){a.d(t,{A:function(){return l}});var s=a(55583),r=a(18384);class l extends s.w{static getUserList(e,t){return super.post(r.x+"/upms/sysUser/list",e,t)}static addUser(e,t){return super.post(r.x+"/upms/sysUser/add",e,t)}static updateUser(e,t){return super.post(r.x+"/upms/sysUser/update",e,t)}static deleteUser(e,t){return super.post(r.x+"/upms/sysUser/delete",e,t)}static viewMenu(e,t){return super.post(r.x+"/upms/sysMenu/view",e,t)}static syncAzureUser(e){return super.post(r.x+"/upms/sysUser/syncAzureUser",e)}static getUser(e,t){return super.get(r.x+"/upms/sysUser/view",e,t)}static resetUserPassword(e,t){return super.post(r.x+"/upms/sysUser/resetPassword",e,t)}static listSysPermWithDetail(e,t){return super.get(r.x+"/upms/sysUser/listSysPermWithDetail",e,t)}static listSysPermCodeWithDetail(e,t){return super.get(r.x+"/upms/sysUser/listSysPermCodeWithDetail",e,t)}static listSysMenuWithDetail(e,t){return super.get(r.x+"/upms/sysUser/listSysMenuWithDetail",e,t)}}},30058:function(e,t,a){a.d(t,{A:function(){return g}});var s=a(65451),r=(a(97042),a(63390),a(91542)),l=(a(37985),a(25136)),i=(a(69957),a(76408)),n=(a(87535),a(18111),a(22489),a(56768)),u=a(90144),o=a(24232),d=a(57477);const p={style:{"margin-right":"4px","font-size":"14px"}},m={key:2,style:{"flex-grow":"1","min-width":"10px"}};var y=(0,n.pM)({__name:"index",props:{hasSearch:{type:Boolean,default:!0},hasReset:{type:Boolean,default:!0}},emits:["reset","search"],setup(e,{emit:t}){const a=(0,n.Ht)(),y=t,c=(0,u.KR)(!1),f=()=>{y("search")},g=()=>{y("reset")},b=(0,n.EW)(()=>{let e=a.default?a.default():[];return e.filter(e=>e.type&&e.type.name&&null!==e.type.name)}),h=(0,n.EW)(()=>{if(c.value){let e=b.value.length%4;return 0===e?24:6*(4-e)}return b.value.length<=3?6*(4-b.value.length):6});return(0,n.sV)(()=>{null!=a.operation&&(c.value=!0)}),(e,t)=>{const y=i.uD,P=l.S2,S=r.tk,D=s.S2;return(0,n.uX)(),(0,n.Wv)(D,{class:"flex-box",type:"flex"},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,u.R1)(b),(e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:t},[t<((0,u.R1)(c)?(0,u.R1)(b).length:3)?((0,n.uX)(),(0,n.Wv)(y,{key:0,span:6},{default:(0,n.k6)(()=>[((0,n.uX)(),(0,n.Wv)((0,n.$y)(e),{style:{width:"100%"}}))]),_:2},1024)):(0,n.Q3)("",!0)],64))),128)),e.hasSearch?((0,n.uX)(),(0,n.Wv)(y,{key:0,span:(0,u.R1)(h),class:"search-box"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{type:"flex",align:"middle"},{default:(0,n.k6)(()=>[(0,n.bF)(P,{class:"search-btn",type:"default",plain:"",onClick:f,icon:(0,u.R1)(d.Search)},{default:(0,n.k6)(()=>t[1]||(t[1]=[(0,n.eW)(" 查询 ")])),_:1,__:[1]},8,["icon"]),e.hasReset?((0,n.uX)(),(0,n.Wv)(P,{key:0,type:"default",plain:"",onClick:g,style:{width:"72px"}},{default:(0,n.k6)(()=>t[2]||(t[2]=[(0,n.eW)("重置")])),_:1,__:[2]})):(0,n.Q3)("",!0),(0,u.R1)(b).length>3&&null==(0,u.R1)(a).operation?((0,n.uX)(),(0,n.Wv)(D,{key:1,type:"flex",align:"middle",class:"expand-btn",onClick:t[0]||(t[0]=e=>c.value=!(0,u.R1)(c))},{default:(0,n.k6)(()=>[(0,n.Lk)("span",p,(0,o.v_)((0,u.R1)(c)?"收起":"展开"),1),(0,n.bF)(S,null,{default:(0,n.k6)(()=>[(0,u.R1)(c)?((0,n.uX)(),(0,n.Wv)((0,u.R1)(d.ArrowUp),{key:0})):((0,n.uX)(),(0,n.Wv)((0,u.R1)(d.ArrowDown),{key:1}))]),_:1})]),_:1})):(0,n.Q3)("",!0),(0,u.R1)(a).operation?((0,n.uX)(),(0,n.CE)("div",m)):(0,n.Q3)("",!0),(0,n.RG)(e.$slots,"operation")]),_:3})]),_:3},8,["span"])):(0,n.Q3)("",!0)]),_:3})}}}),c=a(71241);const f=(0,c.A)(y,[["__scopeId","data-v-3d53564d"]]);var g=f},54428:function(e,t,a){a.d(t,{v9:function(){return i},n5:function(){return n},lE:function(){return g},_4:function(){return P},C7:function(){return d},If:function(){return S},qY:function(){return o},ek:function(){return p},$z:function(){return m},$D:function(){return h},S_:function(){return f},fe:function(){return u},sV:function(){return y},r0:function(){return c.A}});a(18111),a(61701);var s=a(55583),r=a(52081),l=a(18384);class i extends s.w{static dictSysRole(e,t){return new Promise((a,s)=>{super.get(l.x+"/upms/sysRole/listDict",e,t).then(e=>{const t=new r.w("角色字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictGlobalDict(e,t){return new Promise((a,s)=>{super.get(l.x+"/upms/globalDict/listDict",e,t).then(e=>{const t=new r.w("编码字典",(e.data||[]).map(e=>({...e,disabled:1===e.status})));a(t)}).catch(e=>{s(e)})})}static dictGlobalDictByIds(e,t){return new Promise((a,s)=>{super.get(l.x+"/upms/globalDict/listDictByIds",e,t).then(e=>{const t=new r.w("编码字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictAllMenu(e,t){return new Promise((a,s)=>{super.get(l.x+"/upms/sysMenu/listDict",e,t).then(e=>{const t=new r.w("菜单字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysMenu(e,t){return new Promise((a,s)=>{super.get(l.x+"/upms/sysMenu/listMenuDict",e,t).then(e=>{const t=new r.w("菜单字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictDeptPost(e,t){return new Promise((a,s)=>{super.get(l.x+"/upms/sysDept/listSysDeptPostWithRelation",e,t).then(e=>{a(e.data)}).catch(e=>{s(e)})})}static dictSysPost(e,t){return new Promise((a,s)=>{super.get(l.x+"/upms/sysPost/listDict",e,t).then(e=>{const t=new r.w("岗位字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictReportDblink(e,t){return new Promise((a,s)=>{super.get(l.x+"/report/reportDblink/listDict",e,t).then(e=>{const t=new r.w("数据库链接",e.data);a(t)}).catch(e=>{s(e)})})}static dictReportDict(e,t){return new Promise((a,s)=>{super.get(l.x+"/report/reportDict/listDict",e,t).then(e=>{const t=new r.w("字典管理",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysUser(e,t){return new Promise((a,s)=>{super.get("/admin/upms/sysUser/listDict",e,t).then(e=>{let t=new r.w("用户字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysDept(e,t){return new Promise((a,s)=>{super.get("/admin/upms/sysDept/listDict",e,t).then(e=>{let t=new r.w("部门字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysDeptByParentId(e,t){return new Promise((a,s)=>{super.get("/admin/upms/sysDept/listDictByParentId",e,t).then(e=>{let t=new r.w("部门字典",e.data);a(t)}).catch(e=>{s(e)})})}}class n extends s.w{static listSysLoginUser(e,t){return super.post(l.x+"/upms/loginUser/list",e,t)}static deleteSysLoginUser(e,t){return super.post(l.x+"/upms/loginUser/delete",e,t)}}class u extends s.w{static getMenuPermList(e,t){return super.post(l.x+"/upms/sysMenu/list",e,t)}static addMenu(e,t){return super.post(l.x+"/upms/sysMenu/add",e,t)}static updateMenu(e,t){return super.post(l.x+"/upms/sysMenu/update",e,t)}static deleteMenu(e,t){return super.post(l.x+"/upms/sysMenu/delete",e,t)}static viewMenu(e,t){return super.get(l.x+"/upms/sysMenu/view",e,t)}static listMenuPermCode(e,t){return super.get(l.x+"/upms/sysMenu/listMenuPerm",e,t)}static listSysPermByMenuIdWithDetail(e,t){return super.get(l.x+"/upms/sysMenu/listSysPermWithDetail",e,t)}static listSysUserByMenuIdWithDetail(e,t){return super.get(l.x+"/upms/sysMenu/listSysUserWithDetail",e,t)}}class o extends s.w{static updateSysConf(e,t){return super.post(l.x+"/upms/sysConf/update",e,t)}static getSysConf(e,t){return super.get(l.x+"/upms/sysConf/view",e,t)}}class d extends s.w{static getPermCodeList(e,t){return super.get(l.x+"/upms/login/getAllPermCodes",e,t)}}class p extends s.w{static add(e,t){return super.post(l.x+"/upms/sysDataPerm/add",e,t)}static update(e,t){return super.post(l.x+"/upms/sysDataPerm/update",e,t)}static delete(e,t){return super.post(l.x+"/upms/sysDataPerm/delete",e,t)}static list(e,t){return super.post(l.x+"/upms/sysDataPerm/list",e,t)}static view(e,t){return super.get(l.x+"/upms/sysDataPerm/view",e,t)}static listDataPermUser(e,t){return super.post(l.x+"/upms/sysDataPerm/listDataPermUser",e,t)}static addDataPermUser(e,t){return super.post(l.x+"/upms/sysDataPerm/addDataPermUser",e,t)}static deleteDataPermUser(e,t){return super.post(l.x+"/upms/sysDataPerm/deleteDataPermUser",e,t)}static listNotInDataPermUser(e,t){return super.post(l.x+"/upms/sysDataPerm/listNotInDataPermUser",e,t)}}class m extends s.w{static list(e,t){return super.post(l.x+"/upms/sysDept/list",e,t)}static view(e,t){return super.get(l.x+"/upms/sysDept/view",e,t)}static export(e,t){return super.download(l.x+"/upms/sysDept/export",e,t)}static add(e,t){return super.post(l.x+"/upms/sysDept/add",e,t)}static update(e,t){return super.post(l.x+"/upms/sysDept/update",e,t)}static delete(e,t){return super.post(l.x+"/upms/sysDept/delete",e,t)}static listNotInSysDeptPost(e,t){return super.post(l.x+"/upms/sysDept/listNotInSysDeptPost",e,t)}static listSysDeptPost(e,t){return super.post(l.x+"/upms/sysDept/listSysDeptPost",e,t)}static addSysDeptPost(e,t){return super.post(l.x+"/upms/sysDept/addSysDeptPost",e,t)}static updateSysDeptPost(e,t){return super.post(l.x+"/upms/sysDept/updateSysDeptPost",e,t)}static deleteSysDeptPost(e,t){return super.post(l.x+"/upms/sysDept/deleteSysDeptPost",e,t)}static viewSysDeptPost(e,t){return super.get(l.x+"/upms/sysDept/viewSysDeptPost",e,t)}}class y extends s.w{static getRoleList(e,t){return super.post(l.x+"/upms/sysRole/list",e,t)}static getRole(e,t){return super.get(l.x+"/upms/sysRole/view",e,t)}static deleteRole(e,t){return super.post(l.x+"/upms/sysRole/delete",e,t)}static addRole(e,t){return super.post(l.x+"/upms/sysRole/add",e,t)}static updateRole(e,t){return super.post(l.x+"/upms/sysRole/update",e,t)}static listRoleUser(e,t){return super.post(l.x+"/upms/sysRole/listUserRole",e,t)}static listNotInUserRole(e,t){return super.post(l.x+"/upms/sysRole/listNotInUserRole",e,t)}static addRoleUser(e,t){return super.post(l.x+"/upms/sysRole/addUserRole",e,t)}static deleteRoleUser(e,t){return super.post(l.x+"/upms/sysRole/deleteUserRole",e,t)}}var c=a(21013);class f extends s.w{static list(e,t){return super.post(l.x+"/upms/sysPost/list",e,t)}static view(e,t){return super.get(l.x+"/upms/sysPost/view",e,t)}static add(e,t){return super.post(l.x+"/upms/sysPost/add",e,t)}static update(e,t){return super.post(l.x+"/upms/sysPost/update",e,t)}static delete(e,t){return super.post(l.x+"/upms/sysPost/delete",e,t)}}class g extends s.w{static list(e,t){return super.post(l.x+"/mobile/mobileEntry/list",e,t)}static view(e,t){return super.get(l.x+"/mobile/mobileEntry/view",e,t)}static add(e,t){return super.post(l.x+"/mobile/mobileEntry/add",e,t)}static update(e,t){return super.post(l.x+"/mobile/mobileEntry/update",e,t)}static delete(e,t){return super.post(l.x+"/mobile/mobileEntry/delete",e,t)}static uploadImage(e,t){return super.post(l.x+"/mobile/mobileEntry/uploadImage",e,t)}static downloadImage(e,t){return super.post(l.x+"/mobile/mobileEntry/downloadImage",e,t)}}var b=a(53155);class h{static list(e,t){return(0,b.bE)(l.x+"/upms/globalDict/list",e,t)}static listAll(e,t){return(0,b.Jt)(l.x+"/upms/globalDict/listAll",e,t)}static add(e,t){return(0,b.bE)(l.x+"/upms/globalDict/add",e,t)}static update(e,t){return(0,b.bE)(l.x+"/upms/globalDict/update",e,t)}static delete(e,t){return(0,b.bE)(l.x+"/upms/globalDict/delete",e,t)}static addItem(e,t){return(0,b.bE)(l.x+"/upms/globalDict/addItem",e,t)}static updateItem(e,t){return(0,b.bE)(l.x+"/upms/globalDict/updateItem",e,t)}static updateItemStatus(e,t){return(0,b.bE)(l.x+"/upms/globalDict/updateItemStatus",e,t)}static deleteItem(e,t){return(0,b.bE)(l.x+"/upms/globalDict/deleteItem",e,t)}static reloadCachedData(e,t){return(0,b.Jt)(l.x+"/upms/globalDict/reloadCachedData",e,t)}}class P extends s.w{static listSysOperationLog(e,t){return super.post(l.x+"/upms/sysOperationLog/list",e,t)}}class S extends s.w{static list(e,t){return super.post(l.x+"/commonext/bizwidget/list",e,t)}static viewByIds(e,t){return super.post(l.x+"/commonext/bizwidget/view",e,t)}}},80658:function(e,t,a){a.r(t),a.d(t,{default:function(){return ae}});var s=a(77195),r=(a(97042),a(38389),a(61688),a(56768)),l=a(90144),i=a(26695),n=a(54898),u=a(70944),o=a(65451),d=(a(63390),a(69080)),p=(a(25374),a(12687)),m=(a(31112),a(25136)),y=(a(69957),a(21929)),c=(a(98421),a(30058)),f=a(14022),g=(a(72343),a(32465),a(85415)),b=(a(22243),a(7409),a(18111),a(22489),a(7588),a(61701),a(24232)),h=a(45130),P=a(164),S=a(57477),D=a(60265),x=a(54428),k=a(7502),w=a(21016),F=a(82572),v=a(2403),R=(a(63266),a(76408)),_=(a(87535),a(44114),a(61473)),C=a(50942),U=a(27007);const I={class:"form-single-fragment",style:{position:"relative"}},L={key:0,class:"table-empty unified-font",style:{"margin-top":"35px"}},z={key:0,class:"table-empty unified-font",style:{"margin-top":"50px"}},T={key:0,class:"table-empty unified-font",style:{"margin-top":"50px"}},E={key:0,class:"table-empty unified-font",style:{"margin-top":"50px"}};var N=(0,r.pM)({__name:"index",props:{dataPermId:{},dialog:{}},setup(e){const t=(0,F.l5)(),a=e,u=(0,r.EW)(()=>t.defaultFormItemSize),{checkPermCodeExist:d}=(0,n.S)(),p=(0,l.KR)(),c=(0,l.KR)(),P=(0,l.KR)(),D=(0,l.KR)(),k=(0,l.KR)(),N=(0,l.KR)([]),W=(0,l.KR)([]),M=(0,l.KR)([]),V=(0,l.KR)([]),A=(0,l.KR)(null),K={label:"name"},q={label:"name"},X={label:"entryName"},Q=(0,l.Kh)({SysDataPerm:{}}),B={"SysDataPerm.dataPermName":[{required:!0,message:"请输入数据权限名称",trigger:"blur"}],"SysDataPerm.ruleType":[{required:!0,message:"请选择过滤规则",trigger:"blur"}],"SysDataPerm.customSql":[{required:!0,message:"请输入自定义SQL",trigger:"blur"}]},O=()=>{a.dialog&&a.dialog.cancel()},$=(e,t)=>!e||(!t.deptName||-1!==t.deptName.indexOf(e)),j=()=>{let e={};x.v9.dictSysDept(e).then(e=>{N.value=(0,U.BN)(e.getList(),"id"),Array.isArray(Q.SysDataPerm.dataPermDeptList)&&c.value.setCheckedKeys(Q.SysDataPerm.dataPermDeptList.map(e=>e.deptId))}).catch(e=>{console.warn(e)})},G=()=>{let e={};x.v9.dictSysMenu(e).then(e=>{V.value=(0,U.BN)(e.getList(),"id"),Array.isArray(Q.SysDataPerm.dataPermMenuList)&&P.value.setCheckedKeys(Q.SysDataPerm.dataPermMenuList.map(e=>e.menuId))}).catch(e=>{console.warn(e)})},H=()=>{M.value=[],W.value=[],x.lE.list({}).then(e=>{let t=[],a=[];if(e.data.dataList.forEach(e=>{e.entryType===w.MobileEntryType.BANNER?t.push(e):a.push(e)}),W.value=(0,U.BN)(a,"entryId"),M.value=t,Array.isArray(Q.SysDataPerm.dataPermMobileEntryList)){let e=Q.SysDataPerm.dataPermMobileEntryList.map(e=>e.entryId);D.value.setCheckedKeys(e),k.value.setCheckedKeys(e)}}).catch(e=>{console.warn(e)})},J=()=>{p.value.validate(e=>{if(!e)return;let t={sysDataPermDto:{dataPermId:a.dataPermId,ruleType:Q.SysDataPerm.ruleType,dataPermName:Q.SysDataPerm.dataPermName,extraData:JSON.stringify({customSql:Q.SysDataPerm.customSql})}};if(Q.SysDataPerm.ruleType===w.SysDataPermType.CUSTOM_DEPT_AND_CHILD||Q.SysDataPerm.ruleType===w.SysDataPermType.CUSTOM_DEPT){let e=c.value.getCheckedKeys();if(e.length<=0)return void i.nk.error("请选择数据权限部门");t.deptIdListString=Array.isArray(e)?e.join(","):void 0}let s=P.value.getCheckedKeys();t.menuIdListString=Array.isArray(s)?s.join(","):void 0;let r=D.value.getCheckedKeys();r=r.concat(k.value.getCheckedKeys()),t.entryIdListString=Array.isArray(r)?r.join(","):void 0,null==a.dataPermId?x.ek.add(t).then(e=>{i.nk.success("添加成功"),a.dialog&&a.dialog.submit(e)}).catch(e=>{console.warn(e)}):x.ek.update(t).then(e=>{i.nk.success("编辑成功"),a.dialog&&a.dialog.submit(e)}).catch(e=>{console.warn(e)})})},Y=()=>new Promise((e,t)=>{if(null==a.dataPermId)e(null);else{let s={dataPermId:a.dataPermId};x.ek.view(s).then(t=>{let a={};null!=t.data.extraData&&""!==t.data.extraData&&(a=JSON.parse(t.data.extraData)),Q.SysDataPerm={...t.data,customSql:a.customSql},e(t)}).catch(e=>{console.warn(e),t()})}}),Z=()=>{let e=[Y()];Promise.all(e).then(()=>{j(),G(),H()}).catch(e=>{console.warn(e)})};return(0,r.sV)(()=>{Z()}),(0,r.wB)(A,e=>{c.value.filter(e)}),(e,t)=>{const a=f.WK,i=y.xE,n=R.uD,x=g.P9,F=g.AV,U=v.kA,j=o.S2,G=s.v$,H=s.q,Y=m.S2,Z=y.US;return(0,r.uX)(),(0,r.CE)("div",I,[(0,r.bF)(Z,{ref_key:"form",ref:p,model:(0,l.R1)(Q),class:"full-width-input",rules:B,style:{width:"100%"},"label-width":"110px",size:(0,l.R1)(u),"label-position":"right",onSubmit:t[5]||(t[5]=(0,h.D$)(()=>{},["prevent"]))},{default:(0,r.k6)(()=>[(0,r.bF)(j,{gutter:20},{default:(0,r.k6)(()=>[(0,r.bF)(n,{span:12},{default:(0,r.k6)(()=>[(0,r.bF)(i,{label:"权限名称",prop:"SysDataPerm.dataPermName"},{default:(0,r.k6)(()=>[(0,r.bF)(a,{class:"input-item",modelValue:(0,l.R1)(Q).SysDataPerm.dataPermName,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,l.R1)(Q).SysDataPerm.dataPermName=e),clearable:!0,placeholder:"显示名称",maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),(0,r.bF)(n,{span:12},{default:(0,r.k6)(()=>[(0,r.bF)(i,{label:"过滤规则",prop:"SysDataPerm.ruleType","label-width":"80px"},{default:(0,r.k6)(()=>[(0,r.bF)(F,{class:"input-item",modelValue:(0,l.R1)(Q).SysDataPerm.ruleType,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,l.R1)(Q).SysDataPerm.ruleType=e),clearable:!0,placeholder:"过滤规则"},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,l.R1)(w.SysDataPermType).getList(),e=>((0,r.uX)(),(0,r.Wv)(x,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,l.R1)(Q).SysDataPerm.ruleType===(0,l.R1)(w.SysDataPermType).SQL?((0,r.uX)(),(0,r.Wv)(n,{key:0,span:24},{default:(0,r.k6)(()=>[(0,r.bF)(i,{label:"自定义SQL",prop:"SysDataPerm.customSql"},{default:(0,r.k6)(()=>[(0,r.bF)(a,{type:"textarea",style:{height:"50px"},placeholder:"不能使用逻辑操作符 AND/OR 开头，SQL 中可使用变量 loginUserId、loginDeptId、loginName、loginPostIds、loginDeptPostIds、loginRoleIds，变量使用方式为 ${loginUserId}",modelValue:(0,l.R1)(Q).SysDataPerm.customSql,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,l.R1)(Q).SysDataPerm.customSql=e),clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):(0,r.Q3)("",!0),(0,r.bF)(n,{span:24},{default:(0,r.k6)(()=>[(0,r.bF)(H,{class:"dataperm-data",type:"border-card"},{default:(0,r.k6)(()=>[(0,r.bF)(G,{label:"部门列表"},{default:(0,r.k6)(()=>[(0,r.bF)(j,null,{default:(0,r.k6)(()=>[(0,r.bF)(n,{span:24,style:{"margin-bottom":"15px"}},{default:(0,r.k6)(()=>[(0,r.bF)(a,{size:(0,l.R1)(u),modelValue:(0,l.R1)(A),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,l.i9)(A)?A.value=e:null),placeholder:"输入部门名称过滤",style:{width:"250px"},clearable:"","suffix-icon":(0,l.R1)(S.Search)},null,8,["size","modelValue","suffix-icon"])]),_:1}),(0,r.bF)(n,{span:24},{default:(0,r.k6)(()=>[(0,r.bF)(U,{style:(0,b.Tr)({height:(0,l.R1)(Q).SysDataPerm.ruleType===(0,l.R1)(w.SysDataPermType).SQL?"215px":"283px"}),"wrap-class":"scrollbar_dropdown__wrap"},{default:(0,r.k6)(()=>[(0,l.R1)(N).length<=0?((0,r.uX)(),(0,r.CE)("div",L,t[6]||(t[6]=[(0,r.Lk)("img",{src:_},null,-1),(0,r.Lk)("span",null,"暂无数据",-1)]))):(0,r.Q3)("",!0),(0,r.bo)((0,r.bF)((0,l.R1)(C.qk),{ref_key:"deptTreeNode",ref:c,data:(0,l.R1)(N),"show-checkbox":"","node-key":"id","default-expand-all":"","check-strictly":!0,props:{...K,disabled:()=>(0,l.R1)(Q).SysDataPerm.ruleType!=(0,l.R1)(w.SysDataPermType).CUSTOM_DEPT_AND_CHILD&&(0,l.R1)(Q).SysDataPerm.ruleType!=(0,l.R1)(w.SysDataPermType).CUSTOM_DEPT},"filter-node-method":$},null,8,["data","props"]),[[h.aG,(0,l.R1)(N).length>0]])]),_:1},8,["style"])]),_:1})]),_:1})]),_:1}),(0,r.bF)(G,{label:"菜单列表"},{default:(0,r.k6)(()=>[(0,r.bF)(U,{style:(0,b.Tr)({height:(0,l.R1)(Q).SysDataPerm.ruleType===(0,l.R1)(w.SysDataPermType).SQL?"262px":"330px"}),"wrap-class":"scrollbar_dropdown__wrap"},{default:(0,r.k6)(()=>[(0,l.R1)(V).length<=0?((0,r.uX)(),(0,r.CE)("div",z,t[7]||(t[7]=[(0,r.Lk)("img",{src:_},null,-1),(0,r.Lk)("span",null,"暂无数据",-1)]))):(0,r.Q3)("",!0),(0,r.bo)((0,r.bF)((0,l.R1)(C.qk),{ref_key:"menuTreeNode",ref:P,data:(0,l.R1)(V),"show-checkbox":"","node-key":"id","default-expand-all":"","check-strictly":!1,props:{...q}},null,8,["data","props"]),[[h.aG,(0,l.R1)(V).length>0]])]),_:1},8,["style"])]),_:1}),(0,r.bF)(G,{label:"九宫格"},{default:(0,r.k6)(()=>[(0,r.bF)(U,{style:(0,b.Tr)({height:(0,l.R1)(Q).SysDataPerm.ruleType===(0,l.R1)(w.SysDataPermType).SQL?"262px":"330px"}),"wrap-class":"scrollbar_dropdown__wrap"},{default:(0,r.k6)(()=>[(0,l.R1)(W).length<=0?((0,r.uX)(),(0,r.CE)("div",T,t[8]||(t[8]=[(0,r.Lk)("img",{src:_},null,-1),(0,r.Lk)("span",null,"暂无数据",-1)]))):(0,r.Q3)("",!0),(0,r.bo)((0,r.bF)((0,l.R1)(C.qk),{ref_key:"sudokuTreeNode",ref:D,data:(0,l.R1)(W),"show-checkbox":"","node-key":"entryId","default-expand-all":"","check-strictly":!1,props:{...X}},null,8,["data","props"]),[[h.aG,(0,l.R1)(W).length>0]])]),_:1},8,["style"])]),_:1}),(0,r.bF)(G,{label:"轮播图"},{default:(0,r.k6)(()=>[(0,r.bF)(U,{style:(0,b.Tr)({height:(0,l.R1)(Q).SysDataPerm.ruleType===(0,l.R1)(w.SysDataPermType).SQL?"262px":"330px"}),"wrap-class":"scrollbar_dropdown__wrap"},{default:(0,r.k6)(()=>[(0,l.R1)(M).length<=0?((0,r.uX)(),(0,r.CE)("div",E,t[9]||(t[9]=[(0,r.Lk)("img",{src:_},null,-1),(0,r.Lk)("span",null,"暂无数据",-1)]))):(0,r.Q3)("",!0),(0,r.bo)((0,r.bF)((0,l.R1)(C.qk),{ref_key:"bannerTreeNode",ref:k,data:(0,l.R1)(M),"show-checkbox":"","node-key":"entryId","default-expand-all":"","check-strictly":!1,props:{...X}},null,8,["data","props"]),[[h.aG,(0,l.R1)(M).length>0]])]),_:1},8,["style"])]),_:1})]),_:1})]),_:1})]),_:1}),(0,r.bF)(n,{span:24,style:{"margin-top":"20px"}},{default:(0,r.k6)(()=>[(0,r.bF)(j,{type:"flex",justify:"end"},{default:(0,r.k6)(()=>[(0,r.bF)(Y,{size:(0,l.R1)(u),plain:!0,onClick:O},{default:(0,r.k6)(()=>t[10]||(t[10]=[(0,r.eW)(" 取消 ")])),_:1,__:[10]},8,["size"]),(0,r.bF)(Y,{type:"primary",size:(0,l.R1)(u),onClick:t[4]||(t[4]=e=>J()),disabled:!((0,l.R1)(d)("formSysDataPerm:fragmentSysDataPerm:add")||(0,l.R1)(d)("formSysDataPerm:fragmentSysDataPerm:update"))},{default:(0,r.k6)(()=>t[11]||(t[11]=[(0,r.eW)(" 保存 ")])),_:1,__:[11]},8,["size","disabled"])]),_:1})]),_:1})]),_:1},8,["model","size"])])}}}),W=a(71241);const M=(0,W.A)(N,[["__scopeId","data-v-6e674af5"]]);var V=M,A=(0,r.pM)({__name:"TabContentDataPerm",setup(e,{expose:t}){const a=(0,k.s)(),s=(0,F.l5)(),v=(0,r.WQ)("mainContextHeight",200),{checkPermCodeExist:R}=(0,n.S)(),_=(0,l.KR)(),C=e=>(e.sysDataPermDtoFilter={searchString:L.formFilterCopy.sysDataPermName,ruleType:L.formFilterCopy.sysDatapermType},new Promise((t,a)=>{x.ek.list(e).then(e=>{e.data.dataList.forEach(e=>{e.bannerCount=(e.dataPermMobileEntryList||[]).filter(e=>e.entryType===w.MobileEntryType.BANNER).length,e.sodukuCount=(e.dataPermMobileEntryList||[]).length-e.bannerCount}),t({dataList:e.data.dataList.map(e=>({...e})),totalCount:e.data.totalCount})}).catch(e=>{a(e)})})),U=()=>(L.formFilterCopy.sysDatapermType=L.formFilter.sysDatapermType,L.formFilterCopy.sysDataPermName=L.formFilter.sysDataPermName,!0),I={loadTableData:C,verifyTableParameter:U,paged:!0},L=(0,l.Kh)({formFilter:{sysDatapermType:void 0,sysDataPermName:void 0},formFilterCopy:{sysDatapermType:void 0,sysDataPermName:void 0},SysDataPerm:{impl:(0,D.K)(I)},isInit:!1}),z=()=>{_.value.resetFields(),T(!0)},T=(e=!1)=>{e?L.SysDataPerm.impl.refreshTable(!0,1):L.SysDataPerm.impl.refreshTable(),L.isInit=!0},E=()=>{let e={};a.show("新建数据权限",V,{area:["800px","auto"],offset:"100px"},e).then(()=>{T()}).catch(e=>{console.warn(e)})},N=e=>{let t={dataPermId:e.dataPermId};a.show("编辑数据权限",V,{area:["800px","600px"]},t).then(()=>{L.SysDataPerm.impl.refreshTable()}).catch(e=>{console.warn(e)})},W=e=>{let t={dataPermId:e.dataPermId};P.s.confirm(`是否删除数据权限【${e.dataPermName}】？`,"",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{x.ek.delete(t).then(()=>{i.nk.success("删除成功"),L.SysDataPerm.impl.refreshTable()}).catch(e=>{console.warn(e)})}).catch(()=>{})};return t({refreshFragmentSysDataPerm:T}),(e,t)=>{const a=g.P9,i=g.AV,n=y.xE,P=f.WK,D=c.A,x=y.US,k=m.S2,F=(0,r.g2)("vxe-column"),C=p.u,U=d.aQ,I=o.S2,M=u.A;return(0,r.uX)(),(0,r.CE)("div",{class:"tab-content-box",style:(0,b.Tr)("min-height:"+((0,l.R1)(v)-76)+"px")},[(0,r.bF)(x,{ref_key:"form",ref:_,model:L,"label-width":"100px",size:(0,l.R1)(s).defaultFormItemSize,"label-position":"right",onSubmit:t[3]||(t[3]=(0,h.D$)(()=>{},["prevent"]))},{default:(0,r.k6)(()=>[(0,r.bF)(D,{"item-width":350,onSearch:t[2]||(t[2]=e=>T(!0)),onReset:z},{default:(0,r.k6)(()=>[(0,r.bF)(n,{label:"过滤规则",prop:"formFilter.sysDatapermType","label-width":"75px"},{default:(0,r.k6)(()=>[(0,r.bF)(i,{class:"filter-item",modelValue:L.formFilter.sysDatapermType,"onUpdate:modelValue":t[0]||(t[0]=e=>L.formFilter.sysDatapermType=e),clearable:!0,placeholder:"过滤规则"},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,l.R1)(w.SysDataPermType).getList(),e=>((0,r.uX)(),(0,r.Wv)(a,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(n,{label:"权限名称",prop:"formFilter.sysDataPermName"},{default:(0,r.k6)(()=>[(0,r.bF)(P,{class:"filter-item",modelValue:L.formFilter.sysDataPermName,"onUpdate:modelValue":t[1]||(t[1]=e=>L.formFilter.sysDataPermName=e),clearable:!0,placeholder:"数据权限名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,r.bF)(M,{class:"page-table",data:L.SysDataPerm.impl.dataList,size:(0,l.R1)(s).defaultFormItemSize,onSortChange:L.SysDataPerm.impl.onSortChange,"seq-config":{startIndex:(L.SysDataPerm.impl.currentPage-1)*L.SysDataPerm.impl.pageSize},onRefresh:t[5]||(t[5]=e=>T(!0))},{operator:(0,r.k6)(()=>[(0,r.bF)(k,{type:"primary",icon:(0,l.R1)(S.Plus),size:(0,l.R1)(s).defaultFormItemSize,disabled:!(0,l.R1)(R)("formSysDataPerm:fragmentSysDataPerm:add"),onClick:t[4]||(t[4]=e=>E())},{default:(0,r.k6)(()=>t[6]||(t[6]=[(0,r.eW)(" 新建 ")])),_:1,__:[6]},8,["icon","size","disabled"])]),pagination:(0,r.k6)(()=>[(0,r.bF)(I,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,r.k6)(()=>[(0,r.bF)(U,{total:L.SysDataPerm.impl.totalCount,"current-page":L.SysDataPerm.impl.currentPage,"page-size":L.SysDataPerm.impl.pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:L.SysDataPerm.impl.onCurrentPageChange,onSizeChange:L.SysDataPerm.impl.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,{title:"序号",type:"seq",width:"55px",index:L.SysDataPerm.impl.getTableIndex},null,8,["index"]),(0,r.bF)(F,{title:"权限名称",field:"dataPermName"}),(0,r.bF)(F,{title:"过滤规则"},{default:(0,r.k6)(e=>[(0,r.Lk)("span",null,(0,b.v_)((0,l.R1)(w.SysDataPermType).getValue(e.row.ruleType)),1)]),_:1}),(0,r.bF)(F,{title:"指定菜单"},{default:(0,r.k6)(e=>[(0,r.bF)(C,{size:"default",type:Array.isArray(e.row.dataPermMenuList)&&e.row.dataPermMenuList.length>0?"success":"danger"},{default:(0,r.k6)(()=>[(0,r.eW)((0,b.v_)(Array.isArray(e.row.dataPermMenuList)&&e.row.dataPermMenuList.length>0?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),(0,r.bF)(F,{title:"指定轮播图"},{default:(0,r.k6)(e=>[(0,r.bF)(C,{size:"default",type:e.row.bannerCount>0?"success":"danger"},{default:(0,r.k6)(()=>[(0,r.eW)((0,b.v_)(e.row.bannerCount>0?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),(0,r.bF)(F,{title:"指定九宫格"},{default:(0,r.k6)(e=>[(0,r.bF)(C,{size:"default",type:e.row.sodukuCount>0?"success":"danger"},{default:(0,r.k6)(()=>[(0,r.eW)((0,b.v_)(e.row.sodukuCount>0?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),(0,r.bF)(F,{title:"操作",fixed:"right",width:"100px"},{default:(0,r.k6)(e=>[(0,r.bF)(k,{onClick:t=>N(e.row),type:"primary",link:"",size:(0,l.R1)(s).defaultFormItemSize,disabled:!(0,l.R1)(R)("formSysDataPerm:fragmentSysDataPerm:update")},{default:(0,r.k6)(()=>t[7]||(t[7]=[(0,r.eW)(" 编辑 ")])),_:2,__:[7]},1032,["onClick","size","disabled"]),(0,r.bF)(k,{onClick:t=>W(e.row),type:"danger",link:"",size:(0,l.R1)(s).defaultFormItemSize,disabled:!(0,l.R1)(R)("formSysDataPerm:fragmentSysDataPerm:delete")},{default:(0,r.k6)(()=>t[8]||(t[8]=[(0,r.eW)(" 删除 ")])),_:2,__:[8]},1032,["onClick","size","disabled"])]),_:1})]),_:1},8,["data","size","onSortChange","seq-config"])],4)}}});const K=A;var q=K,X=a(99080),Q=a(99540);const B={style:{height:"490px"}};var O=(0,r.pM)({__name:"formSetSysDataPermUser",props:{dataPermId:{}},setup(e){const t=(0,F.l5)(),a=e,s=(0,r.EW)(()=>t.defaultFormItemSize),n=(0,l.KR)(),u=(0,l.KR)(),P=(0,l.KR)([]),S=(0,r.EW)(()=>s.value),k=e=>(e.dataPermId=a.dataPermId,e.sysUserDtoFilter={loginName:U.formFilterCopy.sysUserLoginName,userStatus:U.formFilterCopy.sysUserStatus},u.value.clearCheckboxRow(),new Promise((t,a)=>{x.ek.listNotInDataPermUser(e).then(e=>{t({dataList:e.data.dataList,totalCount:e.data.totalCount})}).catch(e=>{a(e)})})),v=()=>(U.formFilterCopy.sysUserLoginName=U.formFilter.sysUserLoginName,U.formFilterCopy.sysUserStatus=U.formFilter.sysUserStatus,!0),C={loadTableData:k,verifyTableParameter:v,paged:!0},U=(0,l.Kh)({formFilter:{sysUserStatus:void 0,sysUserLoginName:void 0},formFilterCopy:{sysUserStatus:void 0,sysUserLoginName:void 0},SysUser:{impl:(0,D.K)(C)},isInit:!1}),I=(e=!1)=>{e?U.SysUser.impl.refreshTable(!0,1):U.SysUser.impl.refreshTable(),U.isInit=!0},L=()=>{n.value.resetFields(),I(!0)},z=e=>e===w.SysUserStatus.NORMAL?"success":e===w.SysUserStatus.LOCKED?"danger":"info",T=()=>{u.value&&(P.value=u.value.getCheckboxRecords(!0))},E=()=>{let e={dataPermId:a.dataPermId,userIdListString:P.value.map(e=>e.userId).join(",")};x.ek.addDataPermUser(e).then(()=>{i.nk.success("授权成功"),I(!0),u.value.clearCheckboxRow(),P.value=[]}).catch(e=>{console.warn(e)})};return(0,r.sV)(()=>{I(!0)}),(e,t)=>{const a=g.P9,i=g.AV,D=y.xE,x=f.WK,k=m.S2,F=c.A,v=y.US,C=p.u,N=d.aQ,W=o.S2,M=R.uD;return(0,r.uX)(),(0,r.CE)("div",B,[(0,r.bF)(v,{ref_key:"form",ref:n,model:U,"label-width":"75px",size:(0,l.R1)(s),"label-position":"right",onSubmit:t[3]||(t[3]=(0,h.D$)(()=>{},["prevent"])),style:{overflow:"hidden"}},{default:(0,r.k6)(()=>[(0,r.bF)(F,{"item-width":325,onSearch:t[2]||(t[2]=e=>I(!0)),onReset:L,style:{padding:"0",margin:"0"}},{operation:(0,r.k6)(()=>[(0,r.bF)(k,{style:{float:"right"},size:(0,l.R1)(s),type:"primary",plain:!1,onClick:E,disabled:null==P.value||P.value.length<=0},{default:(0,r.k6)(()=>t[4]||(t[4]=[(0,r.eW)("授权人员")])),_:1,__:[4]},8,["size","disabled"])]),default:(0,r.k6)(()=>[(0,r.bF)(D,{label:"用户状态",prop:"formFilter.sysUserStatus"},{default:(0,r.k6)(()=>[(0,r.bF)(i,{class:"filter-item",modelValue:U.formFilter.sysUserStatus,"onUpdate:modelValue":t[0]||(t[0]=e=>U.formFilter.sysUserStatus=e),clearable:!0,placeholder:"用户状态"},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,l.R1)(w.SysUserStatus).getList(),e=>((0,r.uX)(),(0,r.Wv)(a,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,r.bF)(D,{label:"用户名",prop:"formFilter.sysUserLoginName"},{default:(0,r.k6)(()=>[(0,r.bF)(x,{class:"filter-item",modelValue:U.formFilter.sysUserLoginName,"onUpdate:modelValue":t[1]||(t[1]=e=>U.formFilter.sysUserLoginName=e),clearable:!0,placeholder:"用户名"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,r.bF)(W,null,{default:(0,r.k6)(()=>[(0,r.bF)(M,{span:24},{default:(0,r.k6)(()=>[(0,r.bF)((0,l.R1)(Q.CP),{data:U.SysUser.impl.dataList,"header-cell-class-name":"table-header-gray",height:"400px",size:(0,l.R1)(S),ref_key:"userTable",ref:u,"row-config":{isHover:!0},"seq-config":{startIndex:(U.SysUser.impl.currentPage-1)*U.SysUser.impl.pageSize},onCheckboxChange:T,onCheckboxAll:T},{empty:(0,r.k6)(()=>t[5]||(t[5]=[(0,r.Lk)("div",{class:"table-empty unified-font"},[(0,r.Lk)("img",{src:_}),(0,r.Lk)("span",null,"暂无数据")],-1)])),default:(0,r.k6)(()=>[(0,r.bF)((0,l.R1)(Q.Wq),{"header-align":"center",align:"center",type:"checkbox",width:"50px","reserve-selection":!0}),(0,r.bF)((0,l.R1)(Q.Wq),{title:"序号",type:"seq",width:"50px"}),(0,r.bF)((0,l.R1)(Q.Wq),{title:"用户名",field:"loginName"}),(0,r.bF)((0,l.R1)(Q.Wq),{title:"昵称",field:"showName"}),(0,r.bF)((0,l.R1)(Q.Wq),{title:"账号类型"},{default:(0,r.k6)(e=>[(0,r.Lk)("span",null,(0,b.v_)((0,l.R1)(w.SysUserType).getValue(e.row.userType)),1)]),_:1}),(0,r.bF)((0,l.R1)(Q.Wq),{title:"状态"},{default:(0,r.k6)(e=>[(0,r.bF)(C,{type:z(e.row.userStatus),size:(0,l.R1)(s)},{default:(0,r.k6)(()=>[(0,r.eW)((0,b.v_)((0,l.R1)(w.SysUserStatus).getValue(e.row.userStatus)),1)]),_:2},1032,["type","size"])]),_:1})]),_:1},8,["data","size","seq-config"]),(0,r.bF)(M,{span:24},{default:(0,r.k6)(()=>[(0,r.bF)(W,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,r.k6)(()=>[(0,r.bF)(N,{total:U.SysUser.impl.totalCount,"current-page":U.SysUser.impl.currentPage,"page-size":U.SysUser.impl.pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:U.SysUser.impl.onCurrentPageChange,onSizeChange:U.SysUser.impl.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),_:1})]),_:1})]),_:1})])}}});const $=O;var j=$,G=(0,r.pM)({__name:"TabContentDataPermUser",setup(e){const t=(0,k.s)(),a=(0,F.l5)(),s=(0,r.WQ)("mainContextHeight",200),{checkPermCodeExist:v}=(0,n.S)(),R=(0,l.KR)(),_=()=>new Promise((e,t)=>{let a={};x.ek.list(a).then(t=>{e({dataList:t.data.dataList})}).catch(e=>{t(e)})}),C={loadData:_},U=e=>new Promise((t,a)=>{if(!z.formFilter.dataPermId)return i.nk.error("请选择数据权限"),void t({dataList:[],totalCount:0});e.dataPermId=z.formFilter.dataPermId,e.searchString=z.formFilter.searchString,x.ek.listDataPermUser(e).then(e=>{t({dataList:e.data.dataList,totalCount:e.data.totalCount})}).catch(e=>{a(e)})}),I=()=>!0,L={loadTableData:U,verifyTableParameter:I,paged:!0},z=(0,l.Kh)({formFilter:{dataPermId:void 0,searchString:void 0},dataPermId:{impl:(0,X.B)(C)},SysDataPermUserList:{impl:(0,D.K)(L)},isInit:!1}),T=(e=!1)=>{e?z.SysDataPermUserList.impl.refreshTable(!0,1):z.SysDataPermUserList.impl.refreshTable(),z.isInit=!0},E=()=>{R.value.resetFields(),T(!0)},N=()=>{T(!0)},W=e=>e===w.SysUserStatus.NORMAL?"success":e===w.SysUserStatus.LOCKED?"danger":"info",M=()=>{let e={dataPermId:z.formFilter.dataPermId};t.show("授权用户",j,{area:["1100px"],end:()=>{T(!0)}},e).then(()=>{T(!0)}).catch(()=>{T(!0)})},V=e=>{P.s.confirm(`是否移除用户【${e.showName}】？`,"",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t={dataPermId:z.formFilter.dataPermId,userId:e.userId};x.ek.deleteDataPermUser(t).then(()=>{T(!0),i.nk.success("移除成功")}).catch(e=>{console.log(e)})})};return(e,t)=>{const i=g.P9,n=g.AV,P=y.xE,D=f.WK,x=c.A,k=y.US,F=m.S2,_=(0,r.g2)("vxe-column"),C=p.u,U=d.aQ,I=o.S2,L=u.A;return(0,r.uX)(),(0,r.CE)("div",{class:"tab-content-box",style:(0,b.Tr)("min-height:"+((0,l.R1)(s)-76)+"px")},[(0,r.bF)(k,{ref_key:"form",ref:R,model:z,"label-width":"75px",size:(0,l.R1)(a).defaultFormItemSize,"label-position":"right",onSubmit:t[4]||(t[4]=(0,h.D$)(()=>{},["prevent"]))},{default:(0,r.k6)(()=>[(0,r.bF)(x,{"item-width":350,onSearch:t[3]||(t[3]=e=>T(!0)),onReset:E},{default:(0,r.k6)(()=>[(0,r.bF)(P,{label:"数据权限",prop:"formFilter.dataPermId"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{class:"filter-item",modelValue:z.formFilter.dataPermId,"onUpdate:modelValue":t[0]||(t[0]=e=>z.formFilter.dataPermId=e),clearable:"",placeholder:"数据权限",loading:z.dataPermId.impl.loading,onVisibleChange:z.dataPermId.impl.onVisibleChange,onChange:N},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(z.dataPermId.impl.dropdownList,e=>((0,r.uX)(),(0,r.Wv)(i,{key:e.dataPermId,value:e.dataPermId,label:e.dataPermName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1}),(0,r.bF)(P,{label:"用户名",prop:"formFilter.searchString"},{default:(0,r.k6)(()=>[(0,r.bF)(D,{class:"filter-item",modelValue:z.formFilter.searchString,"onUpdate:modelValue":t[1]||(t[1]=e=>z.formFilter.searchString=e),clearable:!0,placeholder:"输入用户名 / 昵称查询",onChange:t[2]||(t[2]=e=>T(!0))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,r.bF)(L,{class:"page-table",data:z.SysDataPermUserList.impl.dataList,size:(0,l.R1)(a).defaultFormItemSize,onSortChange:z.SysDataPermUserList.impl.onSortChange,"seq-config":{startIndex:(z.SysDataPermUserList.impl.currentPage-1)*z.SysDataPermUserList.impl.pageSize},onRefresh:t[6]||(t[6]=e=>T(!0))},{operator:(0,r.k6)(()=>[(0,r.bF)(F,{type:"primary",icon:(0,l.R1)(S.Plus),size:(0,l.R1)(a).defaultFormItemSize,onClick:t[5]||(t[5]=e=>M()),disabled:!(0,l.R1)(v)("formSysDataPerm:fragmentSysDataPermUser:addDataPermUser")||!z.formFilter.dataPermId},{default:(0,r.k6)(()=>t[7]||(t[7]=[(0,r.eW)(" 添加用户 ")])),_:1,__:[7]},8,["icon","size","disabled"])]),pagination:(0,r.k6)(()=>[(0,r.bF)(I,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,r.k6)(()=>[(0,r.bF)(U,{total:z.SysDataPermUserList.impl.totalCount,"current-page":z.SysDataPermUserList.impl.currentPage,"page-size":z.SysDataPermUserList.impl.pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:z.SysDataPermUserList.impl.onCurrentPageChange,onSizeChange:z.SysDataPermUserList.impl.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(_,{title:"序号",type:"seq",width:"55px",index:z.SysDataPermUserList.impl.getTableIndex},null,8,["index"]),(0,r.bF)(_,{title:"用户名",field:"loginName"}),(0,r.bF)(_,{title:"昵称",field:"showName"}),(0,r.bF)(_,{title:"账号类型"},{default:(0,r.k6)(e=>[(0,r.Lk)("span",null,(0,b.v_)((0,l.R1)(w.SysUserType).getValue(e.row.userType)),1)]),_:1}),(0,r.bF)(_,{title:"状态"},{default:(0,r.k6)(e=>[(0,r.bF)(C,{type:W(e.row.userStatus),size:(0,l.R1)(a).defaultFormItemSize},{default:(0,r.k6)(()=>[(0,r.eW)((0,b.v_)((0,l.R1)(w.SysUserStatus).getValue(e.row.userStatus)),1)]),_:2},1032,["type","size"])]),_:1}),(0,r.bF)(_,{title:"操作",fixed:"right",width:"80px"},{default:(0,r.k6)(e=>[(0,r.bF)(F,{link:"",type:"danger",size:(0,l.R1)(a).defaultFormItemSize,disabled:!(0,l.R1)(v)("formSysDataPerm:fragmentSysDataPermUser:deleteDataPermUser"),onClick:t=>V(e.row)},{default:(0,r.k6)(()=>t[8]||(t[8]=[(0,r.eW)("移除")])),_:2,__:[8]},1032,["size","disabled","onClick"])]),_:1})]),_:1},8,["data","size","onSortChange","seq-config"])],4)}}});const H=G;var J=H;const Y={class:"tab-dialog-box",style:{position:"relative"}},Z={name:"formSysDataPerm"};var ee=(0,r.pM)({...Z,setup(e){const{checkPermCodeExist:t}=(0,n.S)();let a=[];const u=(0,l.KR)(),o=e=>{if(e!=u.value){for(let t=0;t<a.length;t++)if(a[t].key===e)return u.value=e,a[t].refresh&&a[t].refresh(),!0;return!1}},d=(0,l.KR)(),p=()=>{d.value.refreshFragmentSysDataPerm()},m=()=>{a=[{key:"fragmentSysDataPerm",permCode:"formSysDataPerm:fragmentSysDataPerm",refresh:p},{key:"fragmentSysDataPermUser",permCode:"formSysDataPerm:fragmentSysDataPermUser"}]},y=()=>{for(let e=0;e<a.length;e++)if(t(a[e].permCode))return u.value=a[e].key,a[e]},c=()=>{m();let e=y();null==e?i.nk.error("您没有访问这个页面的权限，请与系统管理员联系！"):e.refresh&&e.refresh()};return(0,r.sV)(()=>{c()}),(e,a)=>{const i=s.v$,n=s.q;return(0,r.uX)(),(0,r.CE)("div",Y,[(0,r.bF)(n,{modelValue:(0,l.R1)(u),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,l.i9)(u)?u.value=e:null),"before-leave":o},{default:(0,r.k6)(()=>[(0,l.R1)(t)("formSysDataPerm:fragmentSysDataPerm")?((0,r.uX)(),(0,r.Wv)(i,{key:0,label:"数据权限",name:"fragmentSysDataPerm",style:{width:"100%"}},{default:(0,r.k6)(()=>[(0,r.bF)(q,{ref_key:"tabDataPerm",ref:d},null,512)]),_:1})):(0,r.Q3)("",!0),(0,l.R1)(t)("formSysDataPerm:fragmentSysDataPermUser")?((0,r.uX)(),(0,r.Wv)(i,{key:1,label:"用户授权",name:"fragmentSysDataPermUser",style:{width:"100%"}},{default:(0,r.k6)(()=>[(0,r.bF)(J)]),_:1})):(0,r.Q3)("",!0)]),_:1},8,["modelValue"])])}}});const te=(0,W.A)(ee,[["__scopeId","data-v-69d08024"]]);var ae=te}}]);