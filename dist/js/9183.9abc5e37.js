"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[9183],{19183:function(e,l,a){a.r(l),a.d(l,{default:function(){return S}});var t=a(69080),s=(a(97042),a(25374),a(76408)),i=(a(87535),a(17851)),o=(a(68489),a(68368)),r=(a(81208),a(62436),a(47001),a(21929)),d=(a(98421),a(25136)),n=(a(69957),a(65451)),u=(a(63390),a(18888)),p=(a(3172),a(32465),a(14022)),m=(a(72343),a(18111),a(22489),a(56768)),g=a(90144),f=a(45130),h=a(24232),y=a(61473),b=a(54428),c=a(60265),v=a(99080),F=a(27007),w=a(65185),U=a(71066),k=a(82572);const C={class:"form-single-fragment",style:{position:"relative"}};var I=(0,m.pM)({__name:"TaskUserSelect",props:{showAssignee:{type:Boolean,default:!0},showStartUser:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},usedUserIdList:{default:()=>[]},filterObject:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e,{expose:l}){const a=e,{thirdParams:I,onCloseThirdDialog:R}=(0,U.P)(a),_=(0,k.l5)(),{formatDateByStatsType:S}=(0,w.S)(),z=(0,g.KR)(),L=(0,g.KR)(),N=(0,g.KR)([]),W=(0,g.KR)([]),x=(0,m.EW)(()=>(console.log("dialogParams",a),{showAssignee:a.showAssignee||I.value.showAssignee,showStartUser:a.showStartUser||I.value.showStartUser,multiple:a.multiple||I.value.multiple,usedUserIdList:a.usedUserIdList||I.value.usedUserIdList,filterObject:a.filterObject||I.value.filterObject})),V=(0,m.EW)(()=>x.value.multiple?N.value.length>0:null!=L.value&&""!==L.value||null!=z.value),A=e=>(e.widgetType="upms_user",e.filter={...x.value.filterObject,deptId:j.formFilterCopy.deptId,loginName:j.formFilterCopy.sysUserLoginName,showName:j.formFilterCopy.showName},new Promise((l,a)=>{b.If.list(e).then(e=>{l({dataList:e.data.dataList,totalCount:e.data.totalCount})}).catch(e=>{a(e)})})),P=()=>(j.formFilterCopy.deptId=j.formFilter.deptId,j.formFilterCopy.sysUserLoginName=j.formFilter.sysUserLoginName,j.formFilterCopy.showName=j.formFilter.showName,!0),T={loadTableData:A,verifyTableParameter:P,paged:!0},K=()=>new Promise((e,l)=>{let a={widgetType:"upms_dept"};b.If.list(a).then(l=>{e({dataList:(0,F.BN)(l.data.dataList,"deptId")})}).catch(e=>{l(e)})}),D={loadData:K,idKey:"deptId"},j=(0,g.Kh)({formFilter:{deptId:void 0,sysUserLoginName:void 0,showName:void 0},formFilterCopy:{deptId:void 0,sysUserLoginName:void 0,showName:void 0},sysUserWidget:(0,c.K)(T),deptId:{impl:(0,v.B)(D)},isInit:!1}),B=e=>{j.deptId.impl.onVisibleChange(e).catch(e=>{console.warn(e)})},O=e=>{j.formFilter.deptId=Array.isArray(e)?e[e.length-1]:void 0,q(!0)},X=()=>{let e=N.value;if(!x.value.multiple){if(null!=z.value&&""!==z.value){const e={loginName:z.value};return void(a.dialog?a.dialog.submit(e):R(!0,void 0,e))}e=(0,F.PH)(j.sysUserWidget.dataList,L.value,"userId")}a.dialog?a.dialog.submit(e):R(!0,void 0,e)},E=()=>{a.dialog&&a.dialog.submit(null)},M=()=>{const e={loginName:"${startUserName}"};a.dialog?a.dialog.submit(e):R(!0,void 0,e)},Q=()=>{const e={loginName:"${appointedAssignee}"};a.dialog?a.dialog.submit(e):R(!0,void 0,e)},$=e=>!(Array.isArray(x.value.usedUserIdList)&&x.value.usedUserIdList.length>0)||-1===x.value.usedUserIdList.indexOf(e.loginName),H=e=>{N.value=e},q=(e=!1)=>{e?j.sysUserWidget.refreshTable(!0,1):j.sysUserWidget.refreshTable(),j.isInit=!0};return(0,m.sV)(()=>{q()}),l({onClear:E}),(e,l)=>{const a=p.WK,b=r.xE,c=u._m,v=n.S2,F=d.S2,w=r.US,U=o.o8,k=i.ll,I=o.Up,R=i.MQ,N=s.uD,A=t.aQ;return(0,m.uX)(),(0,m.CE)("div",C,[(0,m.bF)(w,{"label-width":"100px",size:(0,g.R1)(_).defaultFormItemSize,"label-position":"right",onSubmit:l[6]||(l[6]=(0,f.D$)(()=>{},["prevent"]))},{default:(0,m.k6)(()=>[(0,m.bF)(v,{style:{"flex-wrap":"nowrap"}},{default:(0,m.k6)(()=>[(0,m.bF)(b,{label:"登录名称"},{default:(0,m.k6)(()=>[(0,m.bF)(a,{class:"filter-item",modelValue:(0,g.R1)(j).formFilter.sysUserLoginName,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,g.R1)(j).formFilter.sysUserLoginName=e),onChange:l[1]||(l[1]=e=>q(!0)),clearable:!0,placeholder:"登录名称",style:{width:"170px"}},null,8,["modelValue"])]),_:1}),(0,m.bF)(b,{label:"用户昵称"},{default:(0,m.k6)(()=>[(0,m.bF)(a,{class:"filter-item",modelValue:(0,g.R1)(j).formFilter.showName,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,g.R1)(j).formFilter.showName=e),onChange:l[3]||(l[3]=e=>q(!0)),clearable:!0,placeholder:"用户昵称",style:{width:"170px"}},null,8,["modelValue"])]),_:1}),(0,m.bF)(b,{label:"所属部门"},{default:(0,m.k6)(()=>[(0,m.bF)(c,{class:"filter-item",modelValue:(0,g.R1)(W),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,g.i9)(W)?W.value=e:null),clearable:!0,placeholder:"所属部门",loading:(0,g.R1)(j).deptId.impl.loading,props:{value:"deptId",label:"deptName",checkStrictly:!0},onVisibleChange:B,options:(0,g.R1)(j).deptId.impl.dropdownList,onChange:O},null,8,["modelValue","loading","options"])]),_:1}),(0,m.bF)(a,{disabled:(0,g.R1)(x).multiple,size:(0,g.R1)(_).defaultFormItemSize,modelValue:(0,g.R1)(z),"onUpdate:modelValue":l[5]||(l[5]=e=>(0,g.i9)(z)?z.value=e:null),placeholder:"自定义用户",style:{width:"200px","margin-bottom":"16px","margin-left":"20px","flex-grow":"1"}},null,8,["disabled","size","modelValue"])]),_:1}),(0,m.bF)(v,{type:"flex",justify:"end",style:{"margin-bottom":"15px"}},{default:(0,m.k6)(()=>[(0,g.R1)(x).showStartUser?((0,m.uX)(),(0,m.Wv)(F,{key:0,type:"primary",size:(0,g.R1)(_).defaultFormItemSize,onClick:M},{default:(0,m.k6)(()=>l[8]||(l[8]=[(0,m.eW)(" 流程发起人 ")])),_:1,__:[8]},8,["size"])):(0,m.Q3)("",!0),(0,g.R1)(x).showAssignee?((0,m.uX)(),(0,m.Wv)(F,{key:1,type:"primary",size:(0,g.R1)(_).defaultFormItemSize,onClick:Q},{default:(0,m.k6)(()=>l[9]||(l[9]=[(0,m.eW)(" 使用指定审批人 ")])),_:1,__:[9]},8,["size"])):(0,m.Q3)("",!0),(0,m.bF)(F,{type:"primary",size:(0,g.R1)(_).defaultFormItemSize,onClick:X,disabled:!(0,g.R1)(V)},{default:(0,m.k6)(()=>l[10]||(l[10]=[(0,m.eW)(" 添加用户 ")])),_:1,__:[10]},8,["size","disabled"])]),_:1})]),_:1},8,["size"]),(0,m.bF)(v,null,{default:(0,m.k6)(()=>[(0,m.bF)(N,{span:24},{default:(0,m.k6)(()=>[(0,m.bF)(R,{class:"radio-table",modelValue:(0,g.R1)(L),"onUpdate:modelValue":l[7]||(l[7]=e=>(0,g.i9)(L)?L.value=e:null),style:{width:"100%"}},{default:(0,m.k6)(()=>[(0,m.bF)(I,{data:(0,g.R1)(j).sysUserWidget.dataList,size:(0,g.R1)(_).defaultFormItemSize,height:"410px","header-cell-class-name":"table-header-gray","row-key":"userId",onSortChange:(0,g.R1)(j).sysUserWidget.onSortChange,onSelectionChange:H},{empty:(0,m.k6)(()=>l[11]||(l[11]=[(0,m.Lk)("div",{class:"table-empty unified-font"},[(0,m.Lk)("img",{src:y}),(0,m.Lk)("span",null,"暂无数据")],-1)])),default:(0,m.k6)(()=>[(0,g.R1)(x).multiple?((0,m.uX)(),(0,m.Wv)(U,{key:0,"header-align":"center","reserve-selection":(0,g.R1)(x).multiple,align:"center",type:"selection",width:"50px",selectable:$},null,8,["reserve-selection"])):((0,m.uX)(),(0,m.Wv)(U,{key:1,label:"","header-align":"center",align:"center",width:"50px"},{default:(0,m.k6)(e=>[(0,m.bF)(k,{value:e.row.userId},null,8,["value"])]),_:1})),(0,m.bF)(U,{label:"用户名",prop:"loginName"}),(0,m.bF)(U,{label:"昵称",prop:"showName"}),(0,m.bF)(U,{label:"所属部门",prop:"deptIdDictMap.name"}),(0,m.bF)(U,{label:"账号类型",prop:"userTypeDictMap.name"}),(0,m.bF)(U,{label:"创建时间"},{default:(0,m.k6)(e=>[(0,m.Lk)("span",null,(0,h.v_)((0,g.R1)(S)(e.row.createTime,"day")),1)]),_:1})]),_:1},8,["data","size","onSortChange"])]),_:1},8,["modelValue"])]),_:1}),(0,m.bF)(N,{span:24},{default:(0,m.k6)(()=>[(0,m.bF)(v,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,m.k6)(()=>[(0,m.bF)(A,{total:(0,g.R1)(j).sysUserWidget.totalCount,"current-page":(0,g.R1)(j).sysUserWidget.currentPage,"page-size":(0,g.R1)(j).sysUserWidget.pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,g.R1)(j).sysUserWidget.onCurrentPageChange,onSizeChange:(0,g.R1)(j).sysUserWidget.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),_:1})]),_:1})])}}}),R=a(71241);const _=(0,R.A)(I,[["__scopeId","data-v-16d68636"]]);var S=_}}]);