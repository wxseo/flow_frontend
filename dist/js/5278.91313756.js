"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[5278],{348:function(e,a,t){t.r(a),t.d(a,{default:function(){return b}});var l=t(65451),i=(t(97042),t(63390),t(25136)),o=(t(69957),t(18111),t(61701),t(56768)),d=t(90144),n=t(71066),s=t(82572),u=t(47434);const r={class:"edit-dataset-param third-party-dlg"},m={class:"form-box",span:24},c={class:"menu-box",span:24,style:{"margin-top":"15px"}};var p=(0,o.pM)({__name:"editDatasetParam",props:{paramList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const a=(0,s.l5)(),t=e,{thirdParams:p,onCloseThirdDialog:v}=(0,n.P)(t),b=(0,o.EW)(()=>a.defaultFormItemSize||p.value.defaultFormItemSize?.value),f=(0,d.KR)([]),g=(0,o.EW)(()=>({paramList:t.paramList||p.value.paramList||[]})),h=()=>{t.dialog?t.dialog.cancel():v(!1)},y=()=>{t.dialog?t.dialog.submit(f.value):v(!0,void 0,f.value)};return(0,o.wB)(()=>g.value.paramList,e=>{f.value=(e||[]).map(e=>({...e}))},{immediate:!0}),(e,a)=>{const t=i.S2,n=l.S2;return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",m,[(0,o.bF)(u.A,{datasetParamList:(0,d.R1)(f)},null,8,["datasetParamList"])]),(0,o.Lk)("div",c,[(0,o.bF)(n,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,o.k6)(()=>[(0,o.bF)(t,{size:(0,d.R1)(b),plain:!0,onClick:h},{default:(0,o.k6)(()=>a[1]||(a[1]=[(0,o.eW)(" 取消 ")])),_:1,__:[1]},8,["size"]),(0,o.bF)(t,{type:"primary",size:(0,d.R1)(b),onClick:a[0]||(a[0]=e=>y())},{default:(0,o.k6)(()=>a[2]||(a[2]=[(0,o.eW)(" 保存 ")])),_:1,__:[2]},8,["size"])]),_:1})])])}}});const v=p;var b=v},3740:function(e,a,t){t.d(a,{qi:function(){return _}});var l=t(56768),i=t(90144),o=t(24232),d=t(45130),n=t(91542),s=t(57477),u=t(93889),r=t(99077),m=t(44216),c=t(37207),p=t(93513),v=t(93558),b=t(92056),f=t(86894),g=t(12235);const h="ElSwitch",y=(0,l.pM)({name:h}),k=(0,l.pM)({...y,props:u.Z,emits:u.x,setup(e,{expose:a,emit:t}){const u=e,{formItem:r}=(0,m.j)(),y=(0,c.NV)(),k=(0,p.DU)("switch"),{inputId:R}=(0,m.W)(u,{formItemContext:r}),I=(0,c.CB)((0,l.EW)(()=>u.loading)),_=(0,i.KR)(!1!==u.modelValue),w=(0,i.KR)(),C=(0,i.KR)(),L=(0,l.EW)(()=>[k.b(),k.m(y.value),k.is("disabled",I.value),k.is("checked",W.value)]),F=(0,l.EW)(()=>[k.e("label"),k.em("label","left"),k.is("active",!W.value)]),V=(0,l.EW)(()=>[k.e("label"),k.em("label","right"),k.is("active",W.value)]),T=(0,l.EW)(()=>({width:(0,v._V)(u.width)}));(0,l.wB)(()=>u.modelValue,()=>{_.value=!0});const x=(0,l.EW)(()=>!!_.value&&u.modelValue),W=(0,l.EW)(()=>x.value===u.activeValue);[u.activeValue,u.inactiveValue].includes(x.value)||(t(b.l4,u.inactiveValue),t(b.YU,u.inactiveValue),t(b.qs,u.inactiveValue)),(0,l.wB)(W,e=>{var a;w.value.checked=e,u.validateEvent&&(null==(a=null==r?void 0:r.validate)||a.call(r,"change").catch(e=>(0,f.U)(e)))});const D=()=>{const e=W.value?u.inactiveValue:u.activeValue;t(b.l4,e),t(b.YU,e),t(b.qs,e),(0,l.dY)(()=>{w.value.checked=W.value})},E=()=>{if(I.value)return;const{beforeChange:e}=u;if(!e)return void D();const a=e(),t=[(0,o.yL)(a),(0,g.Lm)(a)].includes(!0);t||(0,f.$)(h,"beforeChange must return type `Promise<boolean>` or `boolean`"),(0,o.yL)(a)?a.then(e=>{e&&D()}).catch(e=>{(0,f.U)(h,`some error occurred: ${e}`)}):a&&D()},N=()=>{var e,a;null==(a=null==(e=w.value)?void 0:e.focus)||a.call(e)};return(0,l.sV)(()=>{w.value.checked=W.value}),a({focus:N,checked:W}),(e,a)=>((0,l.uX)(),(0,l.CE)("div",{class:(0,o.C4)((0,i.R1)(L)),onClick:(0,d.D$)(E,["prevent"])},[(0,l.Lk)("input",{id:(0,i.R1)(R),ref_key:"input",ref:w,class:(0,o.C4)((0,i.R1)(k).e("input")),type:"checkbox",role:"switch","aria-checked":(0,i.R1)(W),"aria-disabled":(0,i.R1)(I),"aria-label":e.ariaLabel,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:(0,i.R1)(I),tabindex:e.tabindex,onChange:D,onKeydown:(0,d.jR)(E,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),e.inlinePrompt||!e.inactiveIcon&&!e.inactiveText?(0,l.Q3)("v-if",!0):((0,l.uX)(),(0,l.CE)("span",{key:0,class:(0,o.C4)((0,i.R1)(F))},[e.inactiveIcon?((0,l.uX)(),(0,l.Wv)((0,i.R1)(n.tk),{key:0},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(e.inactiveIcon)))]),_:1})):(0,l.Q3)("v-if",!0),!e.inactiveIcon&&e.inactiveText?((0,l.uX)(),(0,l.CE)("span",{key:1,"aria-hidden":(0,i.R1)(W)},(0,o.v_)(e.inactiveText),9,["aria-hidden"])):(0,l.Q3)("v-if",!0)],2)),(0,l.Lk)("span",{ref_key:"core",ref:C,class:(0,o.C4)((0,i.R1)(k).e("core")),style:(0,o.Tr)((0,i.R1)(T))},[e.inlinePrompt?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,o.C4)((0,i.R1)(k).e("inner"))},[e.activeIcon||e.inactiveIcon?((0,l.uX)(),(0,l.Wv)((0,i.R1)(n.tk),{key:0,class:(0,o.C4)((0,i.R1)(k).is("icon"))},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)((0,i.R1)(W)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,o.C4)((0,i.R1)(k).is("text")),"aria-hidden":!(0,i.R1)(W)},(0,o.v_)((0,i.R1)(W)?e.activeText:e.inactiveText),11,["aria-hidden"])):(0,l.Q3)("v-if",!0)],2)):(0,l.Q3)("v-if",!0),(0,l.Lk)("div",{class:(0,o.C4)((0,i.R1)(k).e("action"))},[e.loading?((0,l.uX)(),(0,l.Wv)((0,i.R1)(n.tk),{key:0,class:(0,o.C4)((0,i.R1)(k).is("loading"))},{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(s.Loading))]),_:1},8,["class"])):(0,i.R1)(W)?(0,l.RG)(e.$slots,"active-action",{key:1},()=>[e.activeActionIcon?((0,l.uX)(),(0,l.Wv)((0,i.R1)(n.tk),{key:0},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(e.activeActionIcon)))]),_:1})):(0,l.Q3)("v-if",!0)]):(0,i.R1)(W)?(0,l.Q3)("v-if",!0):(0,l.RG)(e.$slots,"inactive-action",{key:2},()=>[e.inactiveActionIcon?((0,l.uX)(),(0,l.Wv)((0,i.R1)(n.tk),{key:0},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(e.inactiveActionIcon)))]),_:1})):(0,l.Q3)("v-if",!0)])],2)],6),e.inlinePrompt||!e.activeIcon&&!e.activeText?(0,l.Q3)("v-if",!0):((0,l.uX)(),(0,l.CE)("span",{key:1,class:(0,o.C4)((0,i.R1)(V))},[e.activeIcon?((0,l.uX)(),(0,l.Wv)((0,i.R1)(n.tk),{key:0},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.Wv)((0,l.$y)(e.activeIcon)))]),_:1})):(0,l.Q3)("v-if",!0),!e.activeIcon&&e.activeText?((0,l.uX)(),(0,l.CE)("span",{key:1,"aria-hidden":!(0,i.R1)(W)},(0,o.v_)(e.activeText),9,["aria-hidden"])):(0,l.Q3)("v-if",!0)],2))],10,["onClick"]))}});var R=(0,r.A)(k,[["__file","switch.vue"]]),I=t(25376);const _=(0,I.GU)(R)},10115:function(e,a,t){t.d(a,{A:function(){return p}});var l=t(56768),i=t(90144),o=t(37569);const d={triggerCharacters:["."],getCompletions:function(e,a,t,l,i){const o=a.getLine(t.row),d=o.substring(0,t.column),n=d.includes("//")||d.includes("/*");if(n)return void i(null,[]);const s=d.split("."),u=(s[s.length-1],{instance:[{caption:"formData",value:"formData",meta:"property",docText:"表单数据对象",type:"object",score:100},{caption:"props",value:"props",meta:"property",docText:"组件props对象",type:"object",score:100},{caption:"formProps",value:"formProps",meta:"property",docText:"表单props对象",type:"object",score:100},{caption:"loginStore",value:"loginStore",meta:"property",docText:"登录状态管理对象",type:"object",score:100},{caption:"ElMessage",value:"ElMessage('')",meta:"method",docText:"Element Plus消息提示组件",type:"object",score:100},{caption:"router",value:"router",meta:"property",docText:"路由对象",type:"object",score:100},{caption:"Dialog",value:"Dialog",meta:"property",docText:"对话框组件",type:"object",score:100},{caption:"showDialog",value:"showDialog",meta:"method",docText:"显示对话框方法",type:"function",score:100},{caption:"showOnlineDialog",value:"showOnlineDialog",meta:"method",docText:"显示在线对话框方法",type:"function",score:100},{caption:"getFormWidget",value:"getFormWidget()",meta:"method",docText:"获取表单组件实例",type:"function",score:100},{caption:"showMessage",value:"showMessage(type, message)",meta:"method",docText:"显示消息提示",type:"function",score:100},{caption:"close",value:"close()",meta:"method",docText:"关闭当前页面",type:"function",score:100},{caption:"refresh",value:"refresh()",meta:"method",docText:"刷新当前页面",type:"function",score:100},{caption:"axios",value:"axios",meta:"property",docText:"axios请求对象，包含post和get方法",type:"object",score:100},{caption:"tableInstance",value:"tableInstance",meta:"property",docText:"表格实例对象",type:"object",score:100}]});let r=[];r=u.instance,i(null,r)}},n=[{name:"consl",tabTrigger:"console.log",content:"console.log('${1:message}');"},{name:"conserr",tabTrigger:"console.error",content:"console.error('${1:message}');"},{name:"select*",tabTrigger:"select",content:"select * from ${1:table} where ${2:condition}"},{name:"insert*",tabTrigger:"insert",content:"insert into ${1:table} (${2:column1}, ${3:column2}) values (${4:value1}, ${5:value2})"},{name:"update*",tabTrigger:"update",content:"update ${1:table} set ${2:column1} = ${3:value1}, ${4:column2} = ${5:value2} where ${6:condition}"},{name:"delete*",tabTrigger:"delete",content:"delete from ${1:table} where ${2:condition}"},{name:"useDbLink*",tabTrigger:"useDbLink",content:"api.useDblink('${1:数据源名称}', true);"},{name:"newQueryBuilder*",tabTrigger:"newQueryBuilder",content:'var queryBuilder = new ApiQueryBuilder()\n    .sql("${1:sql}")\n    .addParams(${2:params})\n    .pageParam(new MyPageParam(${3:pageNum}, ${4:pageSize}))\n    .relations(${5:relations})\n    .dictRelations(${6:relationDicts});\n    '},{name:"axiosget*",tabTrigger:"axios.get",content:"axios.get('${1:url}', ${2:params})\n    .then(res => {\n      console.log(res);\n    })\n    .catch(err => {\n      console.error(err);\n    });\n    "},{name:"axiospost*",tabTrigger:"axios.post",content:"axios.post('${1:url}', ${2:params})\n    .then(res => {\n      console.log(res);\n    })\n    .catch(err => {\n      console.error(err);\n    });\n    "}];var s=t(1145),u=t.n(s);t(69931),t(85306),t(80776),t(15612);const r={useWrapMode:!1,enableSnippets:!0,useWorker:!1,enableLiveAutocompletion:!0,enableBasicAutocompletion:!0,tabSize:2,fontSize:14};var m=(0,l.pM)({__name:"index",props:{value:{},type:{default:"javascript"},options:{default:()=>r},completer:{}},emits:["update:value","save"],setup(e,{expose:a,emit:t}){const s=t,m=e,c=(0,i.KR)();let p=null;(0,l.wB)(()=>m.value,e=>{p&&p.getValue()!==e&&(p.setValue(e||""),p.moveCursorTo(0,0))},{deep:!0,immediate:!0}),(0,l.sV)(()=>{let e={...r,...m.options};p=(0,o.edit)(c.value,e),p.getSession().setMode("ace/mode/javascript"),p.session.setMode("ace/mode/javascript");const a=window.ace.require("ace/ext/language_tools"),t=window.ace.require("ace/snippets").snippetManager;t.register(n,"javascript"),p.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),a.addCompleter(d),p.getSession().on("change",()=>{p&&s("update:value",p.getValue())}),m.value&&p.setValue(m.value),p.commands.addCommand({name:"saveCommand",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:e=>{s("save")}})}),(0,l.wB)(()=>m.completer,e=>{if(p&&e&&"function"===typeof e.getCompletions){const a=window.ace.require("ace/ext/language_tools");a.addCompleter(e)}},{deep:!0}),(0,l.xo)(()=>{p&&(p.destroy(),p.container.remove(),p=null)});const v=()=>{if(p){var e=p.getValue(),a=u().js_beautify(e);p.setValue(a)}};return a({formatCode:v}),(e,a)=>((0,l.uX)(),(0,l.CE)("div",{ref_key:"root",ref:c,style:{position:"absolute","font-size":"14px"}},null,512))}});const c=m;var p=c},20709:function(e,a,t){t(97042)},42899:function(e,a,t){t(97042)},47434:function(e,a,t){t.d(a,{A:function(){return f}});var l=t(25136),i=(t(97042),t(69957),t(88284)),o=(t(36715),t(77649)),d=(t(87603),t(85415)),n=(t(22243),t(7409),t(14022)),s=(t(72343),t(56768)),u=t(90144),r=t(24232),m=t(61473),c=t(99540);const p={key:1};var v=(0,s.pM)({__name:"datasetParamList",props:{height:{default:"450px"},datasetParamList:{},supportDelete:{type:Boolean,default:!1}},emits:["delete"],setup(e,{emit:a}){const t=a,v=e=>{t("delete",e)};return(e,a)=>{const t=n.WK,b=d.P9,f=d.AV,g=o.lq,h=i.MG,y=l.S2;return(0,s.uX)(),(0,s.Wv)((0,u.R1)(c.CP),{data:e.datasetParamList,size:"default","header-cell-class-name":"table-header-gray",height:e.height,"row-config":{isHover:!0},style:{width:"100%"}},{empty:(0,s.k6)(()=>a[1]||(a[1]=[(0,s.Lk)("div",{class:"table-empty unified-font"},[(0,s.Lk)("img",{src:m}),(0,s.Lk)("span",null,"暂无数据")],-1)])),default:(0,s.k6)(()=>[e.supportDelete?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)((0,u.R1)(c.Wq),{key:0,type:"seq",width:"55px",title:"序号"})),(0,s.bF)((0,u.R1)(c.Wq),{title:"参数名称",field:"paramName","max-width":"200px"},{default:(0,s.k6)(e=>[e.row.isEdit?((0,s.uX)(),(0,s.Wv)(t,{key:0,modelValue:e.row.paramName,"onUpdate:modelValue":a=>e.row.paramName=a,size:"default",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):((0,s.uX)(),(0,s.CE)("span",p,(0,r.v_)(e.row.paramName),1))]),_:1}),(0,s.bF)((0,u.R1)(c.Wq),{title:"参数类型",field:"paramType",width:"150px"},{default:(0,s.k6)(e=>[(0,s.bF)(f,{modelValue:e.row.paramType,"onUpdate:modelValue":a=>e.row.paramType=a,placeholder:"",size:"default"},{default:(0,s.k6)(()=>[(0,s.bF)(b,{title:"字符串",value:"String"}),(0,s.bF)(b,{title:"数字",value:"Number"}),(0,s.bF)(b,{title:"日期",value:"Date"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),(0,s.bF)((0,u.R1)(c.Wq),{title:"默认值",field:"defaultValue"},{default:(0,s.k6)(e=>["String"===e.row.paramType?((0,s.uX)(),(0,s.Wv)(t,{key:0,modelValue:e.row.defaultValue,"onUpdate:modelValue":a=>e.row.defaultValue=a,size:"default",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):(0,s.Q3)("",!0),"Number"===e.row.paramType?((0,s.uX)(),(0,s.Wv)(g,{key:1,modelValue:e.row.defaultValue,"onUpdate:modelValue":a=>e.row.defaultValue=a,size:"default",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):(0,s.Q3)("",!0),"Date"===e.row.paramType?((0,s.uX)(),(0,s.Wv)(h,{key:2,type:"datetime",modelValue:e.row.defaultValue,"onUpdate:modelValue":a=>e.row.defaultValue=a,size:"default",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):(0,s.Q3)("",!0)]),_:1}),e.supportDelete?((0,s.uX)(),(0,s.Wv)((0,u.R1)(c.Wq),{key:1,width:"55px",title:"操作"},{default:(0,s.k6)(e=>[(0,s.bF)(y,{link:"",type:"danger",size:"default",onClick:a=>v(e.row)},{default:(0,s.k6)(()=>a[0]||(a[0]=[(0,s.eW)(" 删除 ")])),_:2,__:[0]},1032,["onClick"])]),_:1})):(0,s.Q3)("",!0)]),_:1},8,["data","height"])}}});const b=v;var f=b},55278:function(e,a,t){t.r(a),t.d(a,{default:function(){return me}});var l=t(54880),i=(t(97042),t(51582),t(60713),t(69225),t(65451)),o=(t(63390),t(25136)),d=(t(69957),t(56768)),n=t(90144),s=t(24232),u=t(26695),r=t(57632),m=t(85285),c=t(27007),p=t(52081),v=t(92380),b=t(54428),f=t(34894),g=t(71066),h=t(82572),y=t(21929),k=(t(98421),t(17851)),R=(t(68489),t(62436),t(18888)),I=(t(3172),t(14022)),_=(t(72343),t(76408)),w=(t(87535),t(32465),t(85415)),C=(t(22243),t(7409),t(44114),t(18111),t(22489),t(7588),t(61701),t(18237),t(17642),t(58004),t(33853),t(45876),t(32475),t(15024),t(31698),t(45130)),L=t(31372),F=t(10115),V=t(99080),T=t(348),x=t(47434);const W={class:"form-single-fragment edit-dataset-basic",style:{position:"relative"}},D={style:{height:"300px"}};var E=(0,d.pM)({__name:"editDatasetBasicInfo",props:{dataset:{},groupList:{default:()=>[]}},setup(e,{expose:a}){const t=(0,h.l5)(),l=e,s=(0,d.EW)(()=>t.defaultFormItemSize),u=(0,n.KR)(),r=()=>new Promise((e,a)=>{b.v9.dictReportDblink({}).then(a=>{e({dataList:a.getList()})}).catch(e=>{a(e)})}),m={loadData:r},p=(0,n.Kh)((0,V.B)(m)),g=()=>new Promise((e,a)=>{null!=S.value.dblinkId&&""!==S.value.dblinkId?f.fh.listAllTables({dblinkId:S.value.dblinkId}).then(a=>{e({dataList:a.data.map(e=>({tableName:e}))})}).catch(e=>{a(e)}):e({dataList:[]})}),E={loadData:g},N=(0,n.Kh)((0,V.B)(E)),S=(0,n.KR)({datasetId:void 0,datasetName:void 0,groupId:void 0,dblinkId:void 0,datasetType:v.DatasetType.TABLE,datasetInfo:{},tableName:void 0,groupPath:[],sql:void 0,paramList:[]}),z={datasetName:[{required:!0,message:"数据集名称不能为空",trigger:"change"}],groupId:[{required:!0,message:"请选择所属分组",trigger:"change"}],dblinkId:[{required:!0,message:"请选择数据库链接",trigger:"change"}],datasetType:[{required:!0,message:"请选择数据集类型",trigger:"change"}],tableName:[{required:!0,message:"请选择数据表",trigger:"change"}],sql:[{required:!0,message:"请输入SQL语句",trigger:"change"}],"datasetInfo.url":[{required:!0,message:"请输入接口URL",trigger:"change"}],"datasetInfo.method":[{required:!0,message:"请选择请求方式",trigger:"change"}]},P=()=>{N.refresh(!1),S.value.tableName=void 0},A=e=>{S.value.groupId=Array.isArray(e)?e[e.length-1]:void 0},X=()=>new Promise((e,a)=>{u.value.validate(t=>{t?(S.value.datasetType===v.DatasetType.SQL&&K(),e(S.value)):a()})}),U=()=>{u.value&&u.value.clearValidate()},q=()=>{S.value=Object.keys(S.value).reduce((e,a)=>(e[a]=l.dataset?l.dataset[a]:void 0,e),{}),S.value.datasetType=S.value.datasetType||v.DatasetType.TABLE,Array.isArray(S.value.paramList)&&S.value.paramList.forEach(e=>{e.isEdit=S.value.datasetType===v.DatasetType.API}),p.onVisibleChange(!0).catch(e=>{console.warn(e)})},K=()=>{let e=[];if(S.value.datasetType===v.DatasetType.SQL&&null!=S.value.sql&&""!==S.value.sql){let a=/\$\{(.+?)\}/g,t=S.value.sql.match(a)||[];if(Array.isArray(t)&&t.length>0){let e=new Set;t=t.filter(a=>!e?.has(a)&&(e?.add(a),!0)),e=null,t=t.map(e=>e.substring(2,e.length-1))}e=t.map(e=>{let a=(0,c.PH)(S.value.paramList,e,"paramName");return null!=a?a:{paramName:e,paramType:"String",defaultValue:void 0}})}S.value.paramList=e},B=()=>{K(),L.l.show("参数设置",T["default"],{area:["900px","600px"]},{paramList:S.value.paramList,path:"thirdEditDatasetParam"},{width:"900px",height:"600px",pathName:"/thirdParty/thirdEditDatasetParam"}).then(e=>{S.value.paramList=e}).catch(e=>{console.warn(e)})},Q=e=>{S.value.paramList=[],e===v.DatasetType.API?S.value.datasetInfo={sql:void 0,method:"get"}:S.value.datasetInfo={}},$=()=>{null==S.value.paramList&&(S.value.paramList=[]),S.value.paramList.push({paramName:void 0,paramType:"String",defaultValue:void 0,isEdit:!0})},M=e=>{S.value.paramList=S.value.paramList.filter(a=>a!==e)};return a({getBasicInfo:X,clearValidate:U}),(0,d.wB)(()=>l.dataset,()=>{q()},{immediate:!0}),(e,a)=>{const t=w.P9,l=w.AV,r=y.xE,m=_.uD,c=I.WK,b=R._m,f=k.ll,g=k.MQ,h=o.S2,L=i.S2,V=y.US;return(0,d.uX)(),(0,d.CE)("div",W,[(0,d.bF)(V,{ref_key:"basicInfo",ref:u,model:(0,n.R1)(S),rules:z,style:{width:"100%"},"label-width":"110px",size:(0,n.R1)(s),"label-position":"top",onSubmit:a[9]||(a[9]=(0,C.D$)(()=>{},["prevent"]))},{default:(0,d.k6)(()=>[(0,d.bF)(L,{gutter:20},{default:(0,d.k6)(()=>[(0,d.bF)(m,{span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"数据集类型",prop:"datasetType"},{default:(0,d.k6)(()=>[(0,d.bF)(l,{class:"input-item",modelValue:(0,n.R1)(S).datasetType,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,n.R1)(S).datasetType=e),disabled:null!=(0,n.R1)(S).datasetId,clearable:"",filterable:"",placeholder:"数据集类型",onChange:Q},{default:(0,d.k6)(()=>[((0,d.uX)(!0),(0,d.CE)(d.FK,null,(0,d.pI)((0,n.R1)(v.DatasetType).getList(),e=>((0,d.uX)(),(0,d.Wv)(t,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),(0,d.bF)(m,{span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"数据集名称",prop:"datasetName"},{default:(0,d.k6)(()=>[(0,d.bF)(c,{class:"input-item",modelValue:(0,n.R1)(S).datasetName,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,n.R1)(S).datasetName=e),clearable:"",placeholder:"数据集名称"},null,8,["modelValue"])]),_:1})]),_:1}),(0,d.bF)(m,{span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"所属分组",prop:"groupId"},{default:(0,d.k6)(()=>[(0,d.bF)(b,{class:"input-item",modelValue:(0,n.R1)(S).groupPath,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,n.R1)(S).groupPath=e),options:e.groupList,filterable:"",clearable:!0,"show-all-levels":!1,placeholder:"所属分组",props:{value:"groupId",label:"groupName",checkStrictly:!0},onChange:A},null,8,["modelValue","options"])]),_:1})]),_:1}),(0,n.R1)(v.DatasetType).API!==(0,n.R1)(S).datasetType?((0,d.uX)(),(0,d.Wv)(m,{key:0,span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"数据库",prop:"dblinkId"},{default:(0,d.k6)(()=>[(0,d.bF)(l,{class:"input-item",modelValue:(0,n.R1)(S).dblinkId,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,n.R1)(S).dblinkId=e),clearable:!0,filterable:"",placeholder:"数据库",loading:(0,n.R1)(p).loading,onVisibleChange:(0,n.R1)(p).onVisibleChange,onChange:P},{default:(0,d.k6)(()=>[((0,d.uX)(!0),(0,d.CE)(d.FK,null,(0,d.pI)((0,n.R1)(p).dropdownList,e=>((0,d.uX)(),(0,d.Wv)(t,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1})):(0,d.Q3)("",!0),(0,n.R1)(v.DatasetType).TABLE===(0,n.R1)(S).datasetType?((0,d.uX)(),(0,d.Wv)(m,{key:1,span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"数据表",prop:"tableName"},{default:(0,d.k6)(()=>[(0,d.bF)(l,{class:"input-item",modelValue:(0,n.R1)(S).tableName,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,n.R1)(S).tableName=e),clearable:!0,filterable:"",placeholder:"数据表",loading:(0,n.R1)(N).loading,onVisibleChange:(0,n.R1)(N).onVisibleChange},{default:(0,d.k6)(()=>[((0,d.uX)(!0),(0,d.CE)(d.FK,null,(0,d.pI)((0,n.R1)(N).dropdownList,e=>((0,d.uX)(),(0,d.Wv)(t,{key:e.tableName,value:e.tableName,label:e.tableName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1})):(0,d.Q3)("",!0),(0,n.R1)(v.DatasetType).API===(0,n.R1)(S).datasetType?((0,d.uX)(),(0,d.Wv)(m,{key:2,span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"接口URL",prop:"datasetInfo.url"},{default:(0,d.k6)(()=>[(0,d.bF)(c,{class:"input-item",modelValue:(0,n.R1)(S).datasetInfo.url,"onUpdate:modelValue":a[5]||(a[5]=e=>(0,n.R1)(S).datasetInfo.url=e),clearable:!0,filterable:"",placeholder:"接口URL",loading:(0,n.R1)(N).loading,onVisibleChange:(0,n.R1)(N).onVisibleChange},null,8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1})):(0,d.Q3)("",!0),(0,n.R1)(v.DatasetType).API===(0,n.R1)(S).datasetType?((0,d.uX)(),(0,d.Wv)(m,{key:3,span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"请求方式",prop:"datasetInfo.method"},{default:(0,d.k6)(()=>[(0,d.bF)(g,{modelValue:(0,n.R1)(S).datasetInfo.method,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,n.R1)(S).datasetInfo.method=e)},{default:(0,d.k6)(()=>[(0,d.bF)(f,{value:"get"},{default:(0,d.k6)(()=>a[10]||(a[10]=[(0,d.eW)("GET")])),_:1,__:[10]}),(0,d.bF)(f,{value:"post"},{default:(0,d.k6)(()=>a[11]||(a[11]=[(0,d.eW)("POST")])),_:1,__:[11]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):(0,d.Q3)("",!0),(0,n.R1)(v.DatasetType).API===(0,n.R1)(S).datasetType?((0,d.uX)(),(0,d.Wv)(m,{key:4,span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"请求参数"},{label:(0,d.k6)(()=>[(0,d.bF)(L,{style:{display:"inline-block",width:"550px"}},{default:(0,d.k6)(()=>[a[13]||(a[13]=(0,d.Lk)("span",null,"请求参数",-1)),(0,d.bF)(h,{type:"primary",size:"default",link:"",style:{float:"right","margin-left":"10px"},onClick:$},{default:(0,d.k6)(()=>a[12]||(a[12]=[(0,d.eW)("添加参数")])),_:1,__:[12]})]),_:1,__:[13]})]),default:(0,d.k6)(()=>[(0,d.bF)(L,{style:{width:"100%"}},{default:(0,d.k6)(()=>[(0,d.bF)(x.A,{datasetParamList:(0,n.R1)(S).paramList,"onUpdate:datasetParamList":a[7]||(a[7]=e=>(0,n.R1)(S).paramList=e),height:"300px",supportDelete:!0,onDelete:M},null,8,["datasetParamList"])]),_:1})]),_:1})]),_:1})):(0,d.Q3)("",!0),(0,n.R1)(v.DatasetType).SQL===(0,n.R1)(S).datasetType?((0,d.uX)(),(0,d.Wv)(m,{key:5,span:24},{default:(0,d.k6)(()=>[(0,d.bF)(r,{label:"SQL语句",prop:"sql"},{label:(0,d.k6)(()=>[(0,d.bF)(L,{style:{display:"inline-block",width:"536px"}},{default:(0,d.k6)(()=>[a[15]||(a[15]=(0,d.Lk)("span",null,"SQL 语句",-1)),(0,d.bF)(h,{type:"primary",size:"default",link:"",style:{float:"right","margin-left":"10px"},onClick:B},{default:(0,d.k6)(()=>a[14]||(a[14]=[(0,d.eW)("参数设置")])),_:1,__:[14]})]),_:1,__:[15]})]),default:(0,d.k6)(()=>[(0,d.Lk)("div",D,[(0,d.bF)(F.A,{value:(0,n.R1)(S).sql,"onUpdate:value":a[8]||(a[8]=e=>(0,n.R1)(S).sql=e),type:"sql",style:{width:"100%",height:"300px",border:"1px solid #f0f0f0"},options:{useWrapMode:!0}},null,8,["value"])])]),_:1})]),_:1})):(0,d.Q3)("",!0)]),_:1})]),_:1},8,["model","size"])])}}}),N=t(71241);const S=(0,N.A)(E,[["__scopeId","data-v-24780f98"]]);var z=S,P=t(61473),A=t(99540),X=t(57477);const U={class:"form-single-fragment edit-dataset-preview",style:{position:"relative"}},q=["title"];var K=(0,d.pM)({__name:"datasetPreview",props:{datasetId:{},height:{}},setup(e){const a=(0,h.l5)(),t=e,l=(0,d.EW)(()=>a.defaultFormItemSize),u=(0,n.KR)(),r=(0,n.KR)({dataList:[],columnMetaList:[]}),m=()=>{r.value={dataList:[],columnMetaList:[]}},c=()=>{null!=t.datasetId&&""!==t.datasetId?f.TR.previewDataset({datasetId:t.datasetId,pageParam:{pageNum:1,pageSize:u.value||1e3}}).then(e=>{const a=e.data;a.dataList=a.dataList?.map(e=>({...e}))||[],a.columnMetaList=a.columnMetaList?.map(e=>({...e}))||[],r.value=a}).catch(e=>{console.warn(e),m()}):m()};return(0,d.wB)(()=>t.datasetId,()=>{c()},{immediate:!0}),(e,a)=>{const t=o.S2,m=I.WK,p=y.xE,v=y.US,b=i.S2;return(0,d.uX)(),(0,d.CE)("div",U,[(0,d.bF)(v,{"label-width":"80px",size:(0,n.R1)(l),"label-position":"left",onSubmit:a[1]||(a[1]=(0,C.D$)(()=>{},["prevent"]))},{default:(0,d.k6)(()=>[(0,d.bF)(p,{label:"显示行数"},{default:(0,d.k6)(()=>[(0,d.bF)(m,{modelValue:(0,n.R1)(u),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,n.i9)(u)?u.value=e:null),placeholder:"",style:{width:"200px"}},{append:(0,d.k6)(()=>[(0,d.bF)(t,{icon:(0,n.R1)(X.Search),onClick:c},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["size"]),(0,d.bF)(b,null,{default:(0,d.k6)(()=>[(0,d.bF)((0,n.R1)(A.CP),{data:(0,n.R1)(r).dataList,size:(0,n.R1)(l),"header-cell-class-name":"table-header-gray",height:e.height?e.height-100+"px":"","row-config":{isHover:!0},style:{width:"100%"}},{empty:(0,d.k6)(()=>a[2]||(a[2]=[(0,d.Lk)("div",{class:"table-empty unified-font"},[(0,d.Lk)("img",{src:P}),(0,d.Lk)("span",null,"暂无数据")],-1)])),default:(0,d.k6)(()=>[((0,d.uX)(!0),(0,d.CE)(d.FK,null,(0,d.pI)((0,n.R1)(r).columnMetaList,e=>((0,d.uX)(),(0,d.Wv)((0,n.R1)(A.Wq),{key:e.columnName,title:e.columnName,field:e.columnName,"show-overflow":"tooltip","min-width":"120px"},{default:(0,d.k6)(a=>[(0,d.Lk)("span",{class:"table-cell",title:a.row[e.columnName]},(0,s.v_)(a.row[e.columnName]),9,q)]),_:2},1032,["title","field"]))),128))]),_:1},8,["data","size","height"])]),_:1})])}}});const B=(0,N.A)(K,[["__scopeId","data-v-0fa9b77a"]]);var Q=B,$=t(3740),M=(t(42899),t(20709),t(164));const O={class:"form-single-fragment edit-dataset-column",style:{position:"relative"}},j={key:1},H={key:1};var Z=(0,d.pM)({__name:"editDatasetColumn",props:{dataset:{},height:{},datasetColumnList:{},dictList:{}},emits:["saveColumn","syncColumns","refreshColumns"],setup(e,{emit:a}){const t=(0,h.l5)(),l=a,r=e,m=(0,d.EW)(()=>t.defaultFormItemSize),p=(0,n.KR)(),b=(0,n.KR)({dimension:"",columnName:""}),g=(0,n.KR)([]),R=["String","Integer","Long","Double","BigDecimal","Date","Boolean","Object","Array"],_=(0,n.KR)([]),L=(0,n.KR)([]),F=(0,d.EW)(()=>(r.dataset||{}).datasetType===v.DatasetType.API),V=(0,d.EW)(()=>{let e=(g.value||[]).filter(e=>(!b.value.columnName||-1!==e.columnName.indexOf(b.value.columnName))&&(""===b.value.dimension||e.dimension===b.value.dimension)),a=[];e.forEach(e=>{let t=(0,c.PH)(g.value,e.parentId,"columnId");while(t){if(null!=(0,c.PH)(a,t.columnId,"columnId"))break;t.children=void 0,a.push(t),t=(0,c.PH)(g.value,t.parentId,"columnId")}null==(0,c.PH)(a,e.columnId,"columnId")&&(e.children=void 0,a.push(e))});const t=F.value?(0,c.BN)(a,"columnId","parentId"):a;return(0,d.dY)(()=>{L.value.forEach(e=>{p.value.setTreeExpand(e,!0)})}),t}),T=e=>e.userFilter?"userFilter":e.deptFilter?"deptFilter":void 0,x=(e,a)=>{a.userFilter="userFilter"===e,a.deptFilter="deptFilter"===e},W=()=>{l("syncColumns")},D=(e,a=!1)=>{if(null==e||F.value)return g.value.forEach(a=>{console.log(a==e,a,e.columnId===a.columnId),e.columnId===a.columnId&&(a.parentId=e.parentId,a.columnComment=e.columnComment,a.dictId=e.dictId,a.columnName=e.columnName,a.fieldType=e.fieldType,a.image=e.image,a.dimension=e.dimension)}),void console.log("columnList",g.value);if(null==e.columnComment||""===e.columnComment)return void u.nk.error("字段显示名不能为空！");let t={reportDatasetColumnDto:{...e}};f.Tu.update(t).then(()=>{a&&l("refreshColumns")}).catch(e=>{console.warn(e)})},E=(e=null)=>{e&&q({row:e,expanded:!0}),g.value.push({parentId:(e||{}).columnId,columnId:(new Date).getTime(),columnComment:g.value.length>0?void 0:"data",dictId:void 0,columnName:g.value.length>0?void 0:"data",fieldType:void 0,image:!1,dimension:!0})},N=e=>{e.children&&e.children.length>0?u.nk.error("请删除子字段！"):M.s.confirm("是否删除此字段？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{g.value=g.value.filter(a=>a.columnId!==e.columnId)}).catch(e=>{console.warn(e)})},S=e=>{if(null==e)return null;let a=null;return null!=e.fieldType&&""!==e.fieldType||(a="字段类型不能为空！"),null!=e.columnName&&""!==e.columnName||(a="字段名不能为空！"),null!=e.columnComment&&""!==e.columnComment||(a="字段显示名不能为空！"),a},z=()=>{if(console.log(">>> checkColumn",g.value),Array.isArray(g.value)&&g.value.length>0){let e=null;for(let a=0;a<g.value.length;a++){let t=g.value[a];if(e=S(t),null!=e)break}return null==e||(u.nk.error(e),!1)}return u.nk.error("请添加数据集字段！"),!1},X=()=>{z()&&l("saveColumn",g.value.map(e=>({...e,children:void 0,_level:void 0,_parent:void 0})))},U=e=>"Object"===e.fieldType||"Array"===e.fieldType,q=({row:e,expanded:a})=>{a?-1===_.value?.indexOf(e.columnId)&&_.value.push(e.columnId):_.value=_.value?.filter(a=>a!==e.columnId),L.value=[...p.value.getTreeExpandRecords()]},K=({row:e})=>S(e)?"error-row":void 0;return(0,d.sV)(()=>{Array.isArray(V.value)&&V.value.length>0&&(_.value=[V.value[0].columnId],L.value=p.value&&p.value.treeExpandeds?[...p.value.getTreeExpandRecords()]:[])}),(0,d.wB)(()=>r.datasetColumnList,e=>{g.value=(e||[]).map(e=>({...e}))},{immediate:!0}),(e,a)=>{const t=k.Zh,l=k.MQ,u=y.xE,r=I.WK,c=o.S2,v=y.US,f=w.P9,h=w.AV,L=$.qi,S=i.S2;return(0,d.uX)(),(0,d.CE)("div",O,[(0,d.bF)(v,{"label-width":"0px",size:(0,n.R1)(m),"label-position":"left",inline:!0,onSubmit:a[4]||(a[4]=(0,C.D$)(()=>{},["prevent"]))},{default:(0,d.k6)(()=>[(0,d.bF)(u,{label:""},{default:(0,d.k6)(()=>[(0,d.bF)(l,{modelValue:(0,n.R1)(b).dimension,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,n.R1)(b).dimension=e)},{default:(0,d.k6)(()=>[(0,d.bF)(t,{value:void 0},{default:(0,d.k6)(()=>a[5]||(a[5]=[(0,d.eW)("全部")])),_:1,__:[5]}),(0,d.bF)(t,{value:!0},{default:(0,d.k6)(()=>a[6]||(a[6]=[(0,d.eW)("维度")])),_:1,__:[6]}),(0,d.bF)(t,{value:!1},{default:(0,d.k6)(()=>a[7]||(a[7]=[(0,d.eW)("指标")])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1}),(0,d.bF)(u,{label:""},{default:(0,d.k6)(()=>[(0,d.bF)(r,{modelValue:(0,n.R1)(b).columnName,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,n.R1)(b).columnName=e),clearable:"",placeholder:"字段名称"},null,8,["modelValue"])]),_:1}),(0,n.R1)(F)?(0,d.Q3)("",!0):((0,d.uX)(),(0,d.Wv)(c,{key:0,style:{float:"right"},onClick:W,size:(0,n.R1)(m)},{default:(0,d.k6)(()=>a[8]||(a[8]=[(0,d.eW)("同步字段")])),_:1,__:[8]},8,["size"])),(0,n.R1)(F)?((0,d.uX)(),(0,d.Wv)(c,{key:1,style:{float:"right"},type:"primary",onClick:a[2]||(a[2]=e=>X()),size:(0,n.R1)(m)},{default:(0,d.k6)(()=>a[9]||(a[9]=[(0,d.eW)("保存")])),_:1,__:[9]},8,["size"])):(0,d.Q3)("",!0),(0,n.R1)(F)?((0,d.uX)(),(0,d.Wv)(c,{key:2,style:{float:"right","margin-right":"10px"},onClick:a[3]||(a[3]=e=>E()),size:(0,n.R1)(m),disabled:(0,n.R1)(g).length>0},{default:(0,d.k6)(()=>a[10]||(a[10]=[(0,d.eW)(" 添加字段 ")])),_:1,__:[10]},8,["size","disabled"])):(0,d.Q3)("",!0)]),_:1},8,["size"]),(0,d.bF)(S,null,{default:(0,d.k6)(()=>[(0,d.bF)((0,n.R1)(A.CP),{ref_key:"columnTable",ref:p,class:"dataset-column-table","row-config":{keyField:"columnId",isHover:!0},data:(0,n.R1)(V),size:(0,n.R1)(m),height:e.height-100+"px","tree-config":{rowField:"columnId",parentField:"parentId",expandRowKeys:(0,n.R1)(_)},onToggleTreeExpand:q,"header-cell-class-name":"table-header-gray","row-class-name":K,style:{width:"100%"}},{empty:(0,d.k6)(()=>a[13]||(a[13]=[(0,d.Lk)("div",{class:"table-empty unified-font"},[(0,d.Lk)("img",{src:P}),(0,d.Lk)("span",null,"暂无数据")],-1)])),default:(0,d.k6)(()=>[(0,d.bF)((0,n.R1)(A.Wq),{title:"显示名",width:"200px","tree-node":""},{default:(0,d.k6)(e=>[(0,d.bF)(r,{size:"default",clearable:"",modelValue:e.row.columnComment,"onUpdate:modelValue":a=>e.row.columnComment=a,style:{width:"100%"},onKeydown:(0,C.jR)(a=>D(e.row),["enter"]),onChange:a=>D(e.row)},null,8,["modelValue","onUpdate:modelValue","onKeydown","onChange"])]),_:1}),(0,n.R1)(F)?(0,d.Q3)("",!0):((0,d.uX)(),(0,d.Wv)((0,n.R1)(A.Wq),{key:0,title:"字典绑定",field:"dictId","min-width":"150px"},{default:(0,d.k6)(a=>[(0,d.bF)(h,{size:"default",modelValue:a.row.dictId,"onUpdate:modelValue":e=>a.row.dictId=e,placeholder:"",clearable:"",disabled:U(a.row),onChange:e=>D(a.row)},{default:(0,d.k6)(()=>[((0,d.uX)(!0),(0,d.CE)(d.FK,null,(0,d.pI)(e.dictList,e=>((0,d.uX)(),(0,d.Wv)(f,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:1})),(0,d.bF)((0,n.R1)(A.Wq),{title:"字段名",field:"columnName","min-width":"200px"},{default:(0,d.k6)(e=>[(0,n.R1)(F)?((0,d.uX)(),(0,d.Wv)(r,{key:0,size:"default",clearable:"",modelValue:e.row.columnName,"onUpdate:modelValue":a=>e.row.columnName=a,onKeydown:(0,C.jR)(a=>D(e.row),["enter"]),onChange:a=>D(e.row)},null,8,["modelValue","onUpdate:modelValue","onKeydown","onChange"])):((0,d.uX)(),(0,d.CE)("span",j,(0,s.v_)(e.row.columnName),1))]),_:1}),(0,d.bF)((0,n.R1)(A.Wq),{title:"字段类型",field:"fieldType","min-width":"100px"},{default:(0,d.k6)(e=>[(0,n.R1)(F)?((0,d.uX)(),(0,d.Wv)(h,{key:0,size:"default",modelValue:e.row.fieldType,"onUpdate:modelValue":a=>e.row.fieldType=a,placeholder:"",clearable:"",onChange:a=>D(e.row)},{default:(0,d.k6)(()=>[((0,d.uX)(),(0,d.CE)(d.FK,null,(0,d.pI)(R,e=>(0,d.bF)(f,{key:e,value:e,label:e},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):((0,d.uX)(),(0,d.CE)("span",H,(0,s.v_)(e.row.fieldType),1))]),_:1}),(0,n.R1)(F)?(0,d.Q3)("",!0):((0,d.uX)(),(0,d.Wv)((0,n.R1)(A.Wq),{key:1,title:"原始类型",field:"columnType","min-width":"100px"})),(0,d.bF)((0,n.R1)(A.Wq),{title:"图片字段","min-width":"80px"},{default:(0,d.k6)(e=>[(0,d.bF)(L,{modelValue:e.row.image,"onUpdate:modelValue":a=>e.row.image=a,disabled:U(e.row),onChange:a=>D(e.row)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:1}),(0,n.R1)(F)?(0,d.Q3)("",!0):((0,d.uX)(),(0,d.Wv)((0,n.R1)(A.Wq),{key:2,title:"数据权限","min-width":"150px"},{default:(0,d.k6)(e=>[(0,d.bF)(h,{size:"default",placeholder:"",clearable:"","model-value":T(e.row),onChange:a=>{x(a,e.row),D(e.row,!0)}},{default:(0,d.k6)(()=>[(0,d.bF)(f,{label:"用户过滤字段",value:"userFilter"}),(0,d.bF)(f,{label:"部门过滤字段",value:"deptFilter"})]),_:2},1032,["model-value","onChange"])]),_:1})),(0,n.R1)(F)?(0,d.Q3)("",!0):((0,d.uX)(),(0,d.Wv)((0,n.R1)(A.Wq),{key:3,title:"逻辑删除","min-width":"80px"},{default:(0,d.k6)(e=>[(0,d.bF)(L,{modelValue:e.row.logicDelete,"onUpdate:modelValue":a=>e.row.logicDelete=a,onChange:a=>D(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})),(0,d.bF)((0,n.R1)(A.Wq),{title:"维度 / 指标","min-width":"150px"},{default:(0,d.k6)(e=>[(0,d.bF)(h,{modelValue:e.row.dimension,"onUpdate:modelValue":a=>e.row.dimension=a,placeholder:"",size:"default",disabled:U(e.row),onChange:a=>D(e.row)},{default:(0,d.k6)(()=>[(0,d.bF)(f,{label:"维度",value:!0}),(0,d.bF)(f,{label:"指标",value:!1})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:1}),(0,n.R1)(F)?((0,d.uX)(),(0,d.Wv)((0,n.R1)(A.Wq),{key:4,title:"操作",width:"150px"},{default:(0,d.k6)(e=>[(0,d.bF)(c,{link:"",type:"primary",size:(0,n.R1)(m),disabled:!U(e.row),onClick:a=>E(e.row)},{default:(0,d.k6)(()=>a[11]||(a[11]=[(0,d.eW)(" 添加子字段 ")])),_:2,__:[11]},1032,["size","disabled","onClick"]),(0,d.bF)(c,{link:"",type:"danger",size:(0,n.R1)(m),onClick:a=>N(e.row)},{default:(0,d.k6)(()=>a[12]||(a[12]=[(0,d.eW)(" 删除 ")])),_:2,__:[12]},1032,["size","onClick"])]),_:1})):(0,d.Q3)("",!0)]),_:1},8,["data","size","height","tree-config"])]),_:1})])}}});const G=(0,N.A)(Z,[["__scopeId","data-v-1001ff40"]]);var Y=G,J=t(68368),ee=(t(81208),t(47001),t(95160));const ae={class:"form-single-fragment edit-dataset-relation",style:{position:"relative"}};var te=(0,d.pM)({__name:"editDatasetRelation",props:{dataset:{},datasetList:{}},setup(e){const a=(0,h.l5)(),t=e,l=(0,d.EW)(()=>a.defaultFormItemSize),s=(0,n.KR)([]),u=e=>{M.s.confirm("是否删除此关联？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>f.$D.delete({relationId:e.relationId})).then(()=>{m()}).catch(e=>{console.warn(e)})},r=e=>{L.l.show("编辑关联",ee["default"],{area:["600px"]},{masterDataset:t.dataset,rowData:e,datasetList:t.datasetList,path:"thirdEditDatasetRelation"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditDatasetRelation"}).then(()=>{m()}).catch(e=>{console.warn(e)})},m=()=>{s.value=[];let e={reportDatasetRelationDtoFilter:{masterDatasetId:(t.dataset||{}).datasetId}};f.$D.list(e).then(e=>{s.value=e.data.dataList}).catch(e=>{console.warn(e)})};return(0,d.wB)(()=>t.dataset,()=>{m()},{immediate:!0}),(e,a)=>{const t=J.o8,m=o.S2,c=J.Up,p=_.uD,v=i.S2;return(0,d.uX)(),(0,d.CE)("div",ae,[(0,d.bF)(v,null,{default:(0,d.k6)(()=>[(0,d.bF)(p,{span:24},{default:(0,d.k6)(()=>[(0,d.bF)(c,{data:(0,n.R1)(s),size:(0,n.R1)(l),"header-cell-class-name":"table-header-gray"},{empty:(0,d.k6)(()=>a[3]||(a[3]=[(0,d.Lk)("div",{class:"table-empty unified-font"},[(0,d.Lk)("img",{src:P}),(0,d.Lk)("span",null,"暂无数据")],-1)])),default:(0,d.k6)(()=>[(0,d.bF)(t,{label:"序号",type:"index",width:"60px"}),(0,d.bF)(t,{label:"关联标识",prop:"variableName"}),(0,d.bF)(t,{label:"主数据集",prop:"masterDatasetIdDictMap.name"}),(0,d.bF)(t,{label:"主数据集字段",prop:"masterColumnIdDictMap.name"}),(0,d.bF)(t,{label:"关联类型",prop:"relationTypeDictMap.name"}),(0,d.bF)(t,{label:"关联数据集",prop:"slaveDatasetIdDictMap.name"}),(0,d.bF)(t,{label:"关联数据集字段",prop:"slaveColumnIdDictMap.name"}),(0,d.bF)(t,{label:"操作",width:"120px"},{default:(0,d.k6)(e=>[(0,d.bF)(m,{type:"primary",link:"",size:"default",onClick:a=>r(e.row)},{default:(0,d.k6)(()=>a[1]||(a[1]=[(0,d.eW)("编辑")])),_:2,__:[1]},1032,["onClick"]),(0,d.bF)(m,{type:"danger",link:"",size:"default",onClick:a=>u(e.row)},{default:(0,d.k6)(()=>a[2]||(a[2]=[(0,d.eW)("删除")])),_:2,__:[2]},1032,["onClick"])]),_:1})]),_:1},8,["data","size"]),(0,d.bF)(m,{class:"full-button",size:(0,n.R1)(l),icon:(0,n.R1)(X.Plus),onClick:a[0]||(a[0]=e=>r())},{default:(0,d.k6)(()=>a[4]||(a[4]=[(0,d.eW)("新增数据表")])),_:1,__:[4]},8,["size","icon"])]),_:1})]),_:1})])}}});const le=(0,N.A)(te,[["__scopeId","data-v-23abaf29"]]);var ie=le;const oe={key:0},de={key:1},ne={key:2},se={key:3};var ue=(0,d.pM)({__name:"editReportDataset",props:{datasetId:{},groupList:{},datasetList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const a=(0,h.l5)(),t=e,{thirdParams:y,onCloseThirdDialog:k}=(0,g.P)(t),R=(0,d.EW)(()=>a.defaultFormItemSize||y.value.defaultFormItemSize?.value),I=(0,n.KR)(),_=new p.w("报表数据集编辑步骤",[{id:0,name:"基础信息",symbol:"BASIC"},{id:1,name:"数据预览",symbol:"PREVIEW"},{id:2,name:"字段管理",symbol:"COLUMN"},{id:3,name:"数据关联",symbol:"RELATION"}]),w=(0,n.KR)(_.BASIC),C=(0,n.KR)({dataset:void 0,datasetColumnList:[]}),L=(0,n.KR)([]),F=(0,d.EW)(()=>({datasetId:t.datasetId||y.value.datasetId,groupList:t.groupList||y.value.groupList||[],datasetList:t.datasetList||y.value.datasetList||[]})),V=()=>{C.value.datasetColumnList=[],C.value.dataset=void 0},T=()=>{L.value=[],b.v9.dictReportDict({}).then(e=>{L.value=e.getList()}).catch(e=>{console.warn(e)})},x=e=>{if(!e)return void V();let a={datasetId:e};f.TR.view(a).then(e=>{let a=null;try{a=JSON.parse(e.data.datasetInfo)}catch(t){a={tableName:void 0,sql:void 0,paramList:[],variables:void 0,url:void 0,method:"get",columnList:void 0}}C.value.dataset={datasetId:e.data.datasetId,datasetName:e.data.datasetName,groupId:e.data.groupId,dblinkId:e.data.dblinkId,datasetType:e.data.datasetType,datasetInfo:a,tableName:e.data.tableName,sql:a.sql,paramList:a.paramList,variables:a.variables,groupPath:(0,c.Zi)(F.value.groupList,e.data.groupId,"groupId")},e.data.datasetType===v.DatasetType.API?C.value.datasetColumnList=a.columnList:C.value.datasetColumnList=e.data.columnList}).catch(e=>{console.log(e)})},W=()=>{switch(w.value){case _.RELATION:w.value=_.COLUMN;break;case _.COLUMN:C.value.dataset.datasetType===v.DatasetType.API?w.value=_.BASIC:w.value=_.PREVIEW;break;case _.PREVIEW:w.value=_.BASIC;break}},D=()=>{switch(w.value){case _.BASIC:A().then(()=>{C.value.dataset?C.value.dataset.datasetType===v.DatasetType.API?w.value=_.COLUMN:w.value=_.PREVIEW:console.warn("formData.value.dataset is undefined")}).catch(e=>{console.warn(e)});break;case _.PREVIEW:w.value=_.COLUMN;break;case _.COLUMN:C.value.dataset.datasetType!==v.DatasetType.API&&(w.value=_.RELATION);break}},E=()=>{x(C.value.dataset.datasetId)},N=()=>{let e={datasetId:C.value.dataset.datasetId};f.TR.syncColumns(e).then(e=>{u.nk.success("同步成功！"),C.value.datasetColumnList=e.data}).catch(e=>{console.warn(e)})},S=e=>{null==C.value.dataset&&(C.value.dataset={}),null==C.value.dataset.datasetInfo&&(C.value.dataset.datasetInfo={}),C.value.dataset.datasetInfo.columnList=e,P({datasetId:C.value.dataset.datasetId,datasetName:C.value.dataset.datasetName,groupId:C.value.dataset.groupId,dblinkId:C.value.dataset.dblinkId,datasetType:C.value.dataset.datasetType,tableName:C.value.dataset.tableName,sql:C.value.dataset.sql,paramList:C.value.dataset.paramList,variables:C.value.dataset.variables,datasetInfo:{...C.value.dataset.datasetInfo}}).then(()=>{x(C.value.dataset.datasetId),u.nk.success("保存成功")}).catch(e=>{console.warn(e)})},P=e=>null==e?Promise.reject():new Promise((a,t)=>{let l=null;l=null==e.datasetId?{reportDatasetDto:{datasetName:e.datasetName,groupId:e.groupId,dblinkId:e.dblinkId,datasetType:e.datasetType,tableName:e.tableName,datasetInfo:JSON.stringify({tableName:e.tableName,sql:e.sql,paramList:e.paramList,variables:e.variables,url:(e.datasetInfo||{}).url,method:(e.datasetInfo||{}).method,columnList:(e.datasetInfo||{}).columnList})}}:{reportDatasetDto:{datasetId:e.datasetId,datasetName:e.datasetName,groupId:e.groupId,dblinkId:e.dblinkId,datasetType:e.datasetType,tableName:e.tableName,datasetInfo:JSON.stringify({tableName:e.tableName,sql:e.sql,paramList:e.paramList,variables:e.variables,url:(e.datasetInfo||{}).url,method:(e.datasetInfo||{}).method,columnList:(e.datasetInfo||{}).columnList})}};let i=null==e.datasetId?f.TR.add(l):f.TR.update(l);i.then(t=>{a(t.data||e.datasetId)}).catch(e=>{console.log(e),t(e)})}),A=()=>w.value===_.BASIC?new Promise((e,a)=>{I.value.getBasicInfo().then(e=>P(e)).then(a=>{x(a),u.nk.success("保存成功"),e(!0)}).catch(e=>{a(e)})}):Promise.resolve(),X=()=>{t.dialog?t.dialog.cancel():k(!0)};return(0,d.sV)(()=>{T()}),(0,d.wB)(()=>F.value.datasetId,e=>{x(e)},{immediate:!0}),(e,t)=>{const u=o.S2,c=i.S2,p=l.bZ,b=l.ZO,f=l.lX;return(0,d.uX)(),(0,d.Wv)(f,{class:"edit-report-dataset"},{default:(0,d.k6)(()=>[(0,d.bF)(p,{class:"step-header",style:{overflow:"hidden",height:"72px",background:"white","border-bottom":"1px solid #ebeef5"}},{default:(0,d.k6)(()=>[(0,d.bF)(c,{type:"flex",justify:"space-between",align:"middle",style:{height:"100%"}},{default:(0,d.k6)(()=>[t[4]||(t[4]=(0,d.Lk)("div",{class:"title",style:{display:"flex",width:"200px",height:"40px","line-height":"40px"}},[(0,d.Lk)("span",{style:{"font-size":"22px",color:"#333","font-weight":"bold"}},"数据集")],-1)),(0,d.bF)(r.A,{class:"step",value:(0,n.R1)(w)},{default:(0,d.k6)(()=>[(0,d.bF)(m.A,{icon:"online-icon icon-basic-info",name:(0,n.R1)(_).BASIC},{default:(0,d.k6)(()=>[(0,d.eW)((0,s.v_)((0,n.R1)(_).getValue((0,n.R1)(_).BASIC)),1)]),_:1},8,["name"]),((0,n.R1)(C).dataset||{}).datasetType!==(0,n.R1)(v.DatasetType).API?((0,d.uX)(),(0,d.Wv)(m.A,{key:0,icon:"online-icon icon-data",name:(0,n.R1)(_).PREVIEW},{default:(0,d.k6)(()=>[(0,d.eW)((0,s.v_)((0,n.R1)(_).getValue((0,n.R1)(_).PREVIEW)),1)]),_:1},8,["name"])):(0,d.Q3)("",!0),(0,d.bF)(m.A,{icon:"online-icon icon-basic-info",name:(0,n.R1)(_).COLUMN},{default:(0,d.k6)(()=>[(0,d.eW)((0,s.v_)((0,n.R1)(_).getValue((0,n.R1)(_).COLUMN)),1)]),_:1},8,["name"]),((0,n.R1)(C).dataset||{}).datasetType!==(0,n.R1)(v.DatasetType).API?((0,d.uX)(),(0,d.Wv)(m.A,{key:1,icon:"online-icon icon-basic-info",name:(0,n.R1)(_).RELATION},{default:(0,d.k6)(()=>[(0,d.eW)((0,s.v_)((0,n.R1)(_).getValue((0,n.R1)(_).RELATION)),1)]),_:1},8,["name"])):(0,d.Q3)("",!0)]),_:1},8,["value"]),(0,d.bF)(c,{class:"operation",style:{width:"200px"},type:"flex",justify:"end"},{default:(0,d.k6)(()=>[(0,d.bF)(u,{size:(0,n.R1)(R),disabled:(0,n.R1)(w)===(0,n.R1)(_).BASIC,onClick:W},{default:(0,d.k6)(()=>t[0]||(t[0]=[(0,d.eW)(" 上一步 ")])),_:1,__:[0]},8,["size","disabled"]),(0,d.bF)(u,{disabled:(0,n.R1)(w)===(0,n.R1)(_).RELATION||(0,n.R1)(w)===(0,n.R1)(_).COLUMN&&(0,n.R1)(C).dataset.datasetType===(0,n.R1)(v.DatasetType).API,size:(0,n.R1)(R),type:"primary",onClick:D},{default:(0,d.k6)(()=>t[1]||(t[1]=[(0,d.eW)(" 下一步 ")])),_:1,__:[1]},8,["disabled","size"]),(0,n.R1)(w)===(0,n.R1)(_).BASIC?((0,d.uX)(),(0,d.Wv)(u,{key:0,size:(0,n.R1)(R),type:"primary",onClick:A},{default:(0,d.k6)(()=>t[2]||(t[2]=[(0,d.eW)(" 保存 ")])),_:1,__:[2]},8,["size"])):(0,d.Q3)("",!0),(0,d.bF)(u,{size:(0,n.R1)(R),onClick:X},{default:(0,d.k6)(()=>t[3]||(t[3]=[(0,d.eW)("退出")])),_:1,__:[3]},8,["size"])]),_:1})]),_:1,__:[4]})]),_:1}),(0,d.bF)(b,{style:{padding:"15px","background-color":"#f9f9f9"}},{default:(0,d.k6)(()=>[(0,d.bF)(c,{type:"flex",justify:"center",style:{height:"100%"}},{default:(0,d.k6)(()=>[(0,n.R1)(w)===(0,n.R1)(_).BASIC?((0,d.uX)(),(0,d.CE)("div",oe,[(0,d.bF)(z,{ref_key:"basicInfo",ref:I,dataset:(0,n.R1)(C).dataset,defaultFormItemSize:(0,n.R1)(a).defaultFormItemSize,groupList:(0,n.R1)(F).groupList},null,8,["dataset","defaultFormItemSize","groupList"])])):(0,d.Q3)("",!0),(0,n.R1)(w)===(0,n.R1)(_).PREVIEW?((0,d.uX)(),(0,d.CE)("div",de,[(0,d.bF)(Q,{datasetId:((0,n.R1)(C).dataset||{}).datasetId,defaultFormItemSize:(0,n.R1)(a).defaultFormItemSize,height:(0,n.R1)(a).documentClientHeight-100},null,8,["datasetId","defaultFormItemSize","height"])])):(0,d.Q3)("",!0),(0,n.R1)(w)===(0,n.R1)(_).COLUMN?((0,d.uX)(),(0,d.CE)("div",ne,[(0,d.bF)(Y,{dataset:(0,n.R1)(C).dataset,height:(0,n.R1)(a).documentClientHeight-100,datasetColumnList:(0,n.R1)(C).datasetColumnList,dictList:(0,n.R1)(L),defaultFormItemSize:(0,n.R1)(a).defaultFormItemSize,onRefreshColumns:E,onSyncColumns:N,onSaveColumn:S},null,8,["dataset","height","datasetColumnList","dictList","defaultFormItemSize"])])):(0,d.Q3)("",!0),(0,n.R1)(w)===(0,n.R1)(_).RELATION?((0,d.uX)(),(0,d.CE)("div",se,[(0,d.bF)(ie,{dataset:(0,n.R1)(C).dataset,height:(0,n.R1)(a).documentClientHeight-100,datasetList:(0,n.R1)(F).datasetList,defaultFormItemSize:(0,n.R1)(a).defaultFormItemSize},null,8,["dataset","height","datasetList","defaultFormItemSize"])])):(0,d.Q3)("",!0)]),_:1})]),_:1})]),_:1})}}});const re=(0,N.A)(ue,[["__scopeId","data-v-770c7fad"]]);var me=re},68489:function(e,a,t){t(97042)},93889:function(e,a,t){t.d(a,{Z:function(){return r},x:function(){return m}});var l=t(3027),i=t(47378),o=t(20464),d=t(58501),n=t(92056),s=t(12235),u=t(24232);const r=(0,i.b_)({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:l.x},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:o.Ze},activeActionIcon:{type:o.Ze},activeIcon:{type:o.Ze},inactiveIcon:{type:o.Ze},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:(0,i.jq)(Function)},id:String,tabindex:{type:[String,Number]},...(0,d.l)(["ariaLabel"])}),m={[n.l4]:e=>(0,s.Lm)(e)||(0,u.Kg)(e)||(0,s.Et)(e),[n.YU]:e=>(0,s.Lm)(e)||(0,u.Kg)(e)||(0,s.Et)(e),[n.qs]:e=>(0,s.Lm)(e)||(0,u.Kg)(e)||(0,s.Et)(e)}},95160:function(e,a,t){t.r(a),t.d(a,{default:function(){return R}});var l=t(25136),i=(t(97042),t(69957),t(21929)),o=(t(98421),t(65451)),d=(t(63390),t(85415)),n=(t(22243),t(7409),t(76408)),s=(t(87535),t(32465),t(14022)),u=(t(72343),t(18111),t(22489),t(56768)),r=t(90144),m=t(45130),c=t(26695),p=t(34894),v=t(92380),b=t(99080),f=t(71066),g=t(82572);const h={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var y=(0,u.pM)({__name:"editReportRelation",props:{masterDataset:{},rowData:{},datasetList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const a=(0,g.l5)(),t=e,{thirdParams:y,onCloseThirdDialog:k}=(0,f.P)(t),R=(0,u.EW)(()=>a.defaultFormItemSize||y.value.defaultFormItemSize?.value),I=(0,r.KR)(),_=(0,r.KR)({relationId:void 0,variableName:void 0,masterDatasetId:void 0,masterColumnId:void 0,slaveDatasetId:void 0,slaveColumnId:void 0,relationType:void 0}),w={variableName:[{required:!0,message:"请输入关联标识",trigger:"blur"}],relationType:[{required:!0,message:"请选择关联类型",trigger:"blur"}],masterDatasetId:[{required:!0,message:"请选择主数据集",trigger:"blur"}],masterColumnId:[{required:!0,message:"请选择主数据集关联字段",trigger:"blur"}],slaveDatasetId:[{required:!0,message:"请选择关联数据集",trigger:"blur"}],slaveColumnId:[{required:!0,message:"请选择关联数据集关联字段",trigger:"blur"}]},C=()=>new Promise((e,a)=>{let t={datasetId:N.value.masterDataset.datasetId};p.TR.view(t).then(a=>{e({dataList:a.data.columnList})}).catch(e=>{a(e)})}),L={loadData:C},F=(0,r.Kh)((0,b.B)(L)),V=()=>Promise.resolve({dataList:N.value.datasetList.filter(e=>e.datasetId!==N.value.masterDataset.datasetId&&e.datasetType!==v.DatasetType.SQL)}),T={loadData:V},x=(0,r.Kh)((0,b.B)(T)),W=()=>new Promise((e,a)=>{if(null==_.value.slaveDatasetId||""===_.value.slaveDatasetId)return void e([]);let t={datasetId:_.value.slaveDatasetId};p.TR.view(t).then(a=>{e({dataList:a.data.columnList})}).catch(e=>{a(e)})}),D={loadData:W},E=(0,r.Kh)((0,b.B)(D)),N=(0,u.EW)(()=>({rowData:t.rowData||y.value.rowData,masterDataset:t.masterDataset||y.value.masterDataset||{},datasetList:t.datasetList||y.value.datasetList||[]})),S=(0,u.EW)(()=>null!=N.value.rowData),z=(0,u.EW)(()=>N.value.masterDataset.datasetName),P=()=>{t.dialog?t.dialog.cancel():k(!1)},A=()=>{I.value.validate(e=>{if(!e)return;let a={reportDatasetRelationDto:{..._.value,masterDatasetId:N.value.masterDataset.datasetId}},l=S.value?p.$D.update(a):p.$D.add(a);l.then(()=>{c.nk.success("保存成功!"),t.dialog?t.dialog.submit(!0):k(!0,!0)}).catch(e=>{console.warn(e)})})},X=()=>{E.refresh(!1),_.value.slaveColumnId=void 0},U=()=>{null!=N.value.rowData&&(_.value={...N.value.rowData},F.onVisibleChange(!0),x.onVisibleChange(!0),E.onVisibleChange(!0))};return(0,u.sV)(()=>{U()}),(e,a)=>{const t=s.WK,c=i.xE,p=n.uD,b=d.P9,f=d.AV,g=o.S2,y=i.US,k=l.S2;return(0,u.uX)(),(0,u.CE)("div",h,[(0,u.bF)(y,{ref_key:"form",ref:I,model:(0,r.R1)(_),class:"full-width-input form-box",rules:w,style:{width:"100%"},"label-width":"120px",size:(0,r.R1)(R),"label-position":"right",onSubmit:a[5]||(a[5]=(0,m.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(g,{gutter:20},{default:(0,u.k6)(()=>[(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"关联标识",prop:"variableName"},{default:(0,u.k6)(()=>[(0,u.bF)(t,{class:"input-item",modelValue:(0,r.R1)(_).variableName,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,r.R1)(_).variableName=e),clearable:!0,placeholder:"关联标识"},null,8,["modelValue"])]),_:1})]),_:1}),(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"关联类型",prop:"relationType"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"input-item",modelValue:(0,r.R1)(_).relationType,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,r.R1)(_).relationType=e),placeholder:"关联类型"},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,r.R1)(v.ReportRelationType).getList(),e=>((0,u.uX)(),(0,u.Wv)(b,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"主数据集"},{default:(0,u.k6)(()=>[(0,u.bF)(t,{class:"input-item",value:(0,r.R1)(z),disabled:""},null,8,["value"])]),_:1})]),_:1}),(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"主数据集字段"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"input-item",modelValue:(0,r.R1)(_).masterColumnId,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,r.R1)(_).masterColumnId=e),clearable:!0,filterable:"",placeholder:"数据集关联字段",loading:(0,r.R1)(F).loading,onVisibleChange:(0,r.R1)(F).onVisibleChange},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,r.R1)(F).dropdownList,e=>((0,u.uX)(),(0,u.Wv)(b,{key:e.columnId,value:e.columnId,label:e.columnName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1}),(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"关联数据集"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"input-item",modelValue:(0,r.R1)(_).slaveDatasetId,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,r.R1)(_).slaveDatasetId=e),clearable:!0,filterable:"",placeholder:"关联数据集",loading:(0,r.R1)(x).loading,onVisibleChange:(0,r.R1)(x).onVisibleChange,onChange:X},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,r.R1)(x).dropdownList,e=>((0,u.uX)(),(0,u.Wv)(b,{key:e.datasetId,value:e.datasetId,label:e.datasetName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1}),(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(c,{label:"关联数据集字段"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{class:"input-item",modelValue:(0,r.R1)(_).slaveColumnId,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,r.R1)(_).slaveColumnId=e),clearable:!0,filterable:"",placeholder:"数据集关联字段",loading:(0,r.R1)(E).loading,onVisibleChange:(0,r.R1)(E).onVisibleChange},{default:(0,u.k6)(()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)((0,r.R1)(E).dropdownList,e=>((0,u.uX)(),(0,u.Wv)(b,{key:e.columnId,value:e.columnId,label:e.columnName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","loading","onVisibleChange"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,u.bF)(g,{class:"menu-box"},{default:(0,u.k6)(()=>[(0,u.bF)(p,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(g,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,u.k6)(()=>[(0,u.bF)(k,{size:(0,r.R1)(R),plain:!0,onClick:P},{default:(0,u.k6)(()=>a[7]||(a[7]=[(0,u.eW)(" 取消 ")])),_:1,__:[7]},8,["size"]),(0,u.bF)(k,{type:"primary",size:(0,r.R1)(R),onClick:a[6]||(a[6]=e=>A())},{default:(0,u.k6)(()=>a[8]||(a[8]=[(0,u.eW)(" 保存 ")])),_:1,__:[8]},8,["size"])]),_:1})]),_:1})]),_:1})])}}});const k=y;var R=k}}]);