"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1095],{5833:function(e,t,a){a.d(t,{A:function(){return f}});var s=a(85415),l=(a(97042),a(22243),a(7409),a(44114),a(18111),a(22489),a(61701),a(56768)),r=a(90144),o=a(27007),i=a(54428),n=a(31372),u=a(60760);const d={class:"user-select"};var p=(0,l.pM)({__name:"index",props:{modelValue:{},size:{default:"default"},placeholder:{},props:{default:()=>({label:"showName",value:"userId"})},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0}},emits:["update:modelValue","change","blur","focus"],setup(e,{emit:t}){const a=t,p=e,c=(0,r.KR)((0,o.yk)()),m=(0,r.KR)([]),f=e=>{m.value=[],p.multiple?Array.isArray(e)&&(m.value=e):null!=e&&m.value.push(e),b()&&h()},v=e=>{e&&n.l.show("用户选择",u["default"],{area:["900px","650px"],offset:"100px"},{value:m.value,props:p.props,path:"thirdSelectUser/"+c.value,multiple:p.multiple},{width:"900px",height:"650px",pathName:"/thirdParty/thirdSelectUser"}).then(e=>{f(e)}).catch(e=>{console.warn(e)})},g=e=>{m.value=m.value.filter(t=>t[p.props.value]!==e),h()},y=()=>{m.value=[],h()},h=()=>{let e;if(p.multiple){let t;e=m.value.map(e=>(null==t&&(t=[]),t.push({id:e[p.props.value],name:e[p.props.label]}),e)),a("update:modelValue",e.map(e=>e[p.props.value])),a("change",e.map(e=>e[p.props.value]),e,t)}else{e=m.value[0]||{};let t={id:e[p.props.value],name:e[p.props.label]};a("update:modelValue",e[p.props.value]),a("change",e[p.props.value],m.value,t)}},b=()=>{let e=p.multiple?(p.modelValue||[]).sort((e,t)=>e===t?0:e<t?-1:1).join(","):p.modelValue||"",t=m.value.sort((e,t)=>e[p.props.value]===t[p.props.value]?0:e[p.props.value]<t[p.props.value]?-1:1).map(e=>e[p.props.value]).join(",");return e!==t},w=()=>{let e={widgetType:"upms_user"};(null==p.modelValue||""===p.modelValue||Array.isArray(p.modelValue)&&p.modelValue.length<=0)&&(m.value=[]),p.multiple?e.fieldValues=Array.isArray(p.modelValue)?p.modelValue:[]:(e.fieldValues=Array.isArray(p.modelValue)?p.modelValue[0]:p.modelValue,e.fieldValues=null==e.fieldValues?[]:[e.fieldValues]),Array.isArray(e.fieldValues)&&e.fieldValues.length>0&&(e.fieldValues=e.fieldValues.join(","),i.If.viewByIds(e,{showMask:!1}).then(e=>{Array.isArray(e.data)&&(m.value=e.data)}).catch(e=>{console.warn(e)}))};return(0,l.wB)(()=>p.modelValue,()=>{p.modelValue&&w()},{immediate:!0}),(e,t)=>{const o=s.P9,i=s.AV;return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(i,{"model-value":e.modelValue,style:{width:"100%"},multiple:e.multiple,disabled:e.disabled,size:e.size,clearable:e.clearable,"collapse-tags":e.collapseTags,placeholder:e.placeholder,teleported:!1,"popper-class":"user-select-popper",onVisibleChange:v,onRemoveTag:g,onClear:y,onBlur:t[0]||(t[0]=()=>a("blur")),onFocus:t[1]||(t[1]=()=>a("focus"))},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,r.R1)(m),t=>((0,l.uX)(),(0,l.Wv)(o,{key:t[e.props.value],label:t[e.props.label],value:t[e.props.value]},null,8,["label","value"]))),128))]),_:1},8,["model-value","multiple","disabled","size","clearable","collapse-tags","placeholder"])])}}}),c=a(71241);const m=(0,c.A)(p,[["__scopeId","data-v-fc984574"]]);var f=m},7502:function(e,t,a){a.d(t,{s:function(){return r}});var s=a(31372),l=a(56768);const r=()=>{const e=(0,l.WQ)("defaultFormItemSize","default"),t=(t,a,l,r,o)=>(r||(r={}),r.defaultFormItemSize=e,s.l.show(t,a,l,r,o));return{show:t}}},8696:function(e,t,a){a(97042),a(44332)},21013:function(e,t,a){a.d(t,{A:function(){return r}});var s=a(55583),l=a(18384);class r extends s.w{static getUserList(e,t){return super.post(l.x+"/upms/sysUser/list",e,t)}static addUser(e,t){return super.post(l.x+"/upms/sysUser/add",e,t)}static updateUser(e,t){return super.post(l.x+"/upms/sysUser/update",e,t)}static deleteUser(e,t){return super.post(l.x+"/upms/sysUser/delete",e,t)}static viewMenu(e,t){return super.post(l.x+"/upms/sysMenu/view",e,t)}static syncAzureUser(e){return super.post(l.x+"/upms/sysUser/syncAzureUser",e)}static getUser(e,t){return super.get(l.x+"/upms/sysUser/view",e,t)}static resetUserPassword(e,t){return super.post(l.x+"/upms/sysUser/resetPassword",e,t)}static listSysPermWithDetail(e,t){return super.get(l.x+"/upms/sysUser/listSysPermWithDetail",e,t)}static listSysPermCodeWithDetail(e,t){return super.get(l.x+"/upms/sysUser/listSysPermCodeWithDetail",e,t)}static listSysMenuWithDetail(e,t){return super.get(l.x+"/upms/sysUser/listSysMenuWithDetail",e,t)}}},30058:function(e,t,a){a.d(t,{A:function(){return g}});var s=a(65451),l=(a(97042),a(63390),a(91542)),r=(a(37985),a(25136)),o=(a(69957),a(76408)),i=(a(87535),a(18111),a(22489),a(56768)),n=a(90144),u=a(24232),d=a(57477);const p={style:{"margin-right":"4px","font-size":"14px"}},c={key:2,style:{"flex-grow":"1","min-width":"10px"}};var m=(0,i.pM)({__name:"index",props:{hasSearch:{type:Boolean,default:!0},hasReset:{type:Boolean,default:!0}},emits:["reset","search"],setup(e,{emit:t}){const a=(0,i.Ht)(),m=t,f=(0,n.KR)(!1),v=()=>{m("search")},g=()=>{m("reset")},y=(0,i.EW)(()=>{let e=a.default?a.default():[];return e.filter(e=>e.type&&e.type.name&&null!==e.type.name)}),h=(0,i.EW)(()=>{if(f.value){let e=y.value.length%4;return 0===e?24:6*(4-e)}return y.value.length<=3?6*(4-y.value.length):6});return(0,i.sV)(()=>{null!=a.operation&&(f.value=!0)}),(e,t)=>{const m=o.uD,b=r.S2,w=l.tk,k=s.S2;return(0,i.uX)(),(0,i.Wv)(k,{class:"flex-box",type:"flex"},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,n.R1)(y),(e,t)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:t},[t<((0,n.R1)(f)?(0,n.R1)(y).length:3)?((0,i.uX)(),(0,i.Wv)(m,{key:0,span:6},{default:(0,i.k6)(()=>[((0,i.uX)(),(0,i.Wv)((0,i.$y)(e),{style:{width:"100%"}}))]),_:2},1024)):(0,i.Q3)("",!0)],64))),128)),e.hasSearch?((0,i.uX)(),(0,i.Wv)(m,{key:0,span:(0,n.R1)(h),class:"search-box"},{default:(0,i.k6)(()=>[(0,i.bF)(k,{type:"flex",align:"middle"},{default:(0,i.k6)(()=>[(0,i.bF)(b,{class:"search-btn",type:"default",plain:"",onClick:v,icon:(0,n.R1)(d.Search)},{default:(0,i.k6)(()=>t[1]||(t[1]=[(0,i.eW)(" 查询 ")])),_:1,__:[1]},8,["icon"]),e.hasReset?((0,i.uX)(),(0,i.Wv)(b,{key:0,type:"default",plain:"",onClick:g,style:{width:"72px"}},{default:(0,i.k6)(()=>t[2]||(t[2]=[(0,i.eW)("重置")])),_:1,__:[2]})):(0,i.Q3)("",!0),(0,n.R1)(y).length>3&&null==(0,n.R1)(a).operation?((0,i.uX)(),(0,i.Wv)(k,{key:1,type:"flex",align:"middle",class:"expand-btn",onClick:t[0]||(t[0]=e=>f.value=!(0,n.R1)(f))},{default:(0,i.k6)(()=>[(0,i.Lk)("span",p,(0,u.v_)((0,n.R1)(f)?"收起":"展开"),1),(0,i.bF)(w,null,{default:(0,i.k6)(()=>[(0,n.R1)(f)?((0,i.uX)(),(0,i.Wv)((0,n.R1)(d.ArrowUp),{key:0})):((0,i.uX)(),(0,i.Wv)((0,n.R1)(d.ArrowDown),{key:1}))]),_:1})]),_:1})):(0,i.Q3)("",!0),(0,n.R1)(a).operation?((0,i.uX)(),(0,i.CE)("div",c)):(0,i.Q3)("",!0),(0,i.RG)(e.$slots,"operation")]),_:3})]),_:3},8,["span"])):(0,i.Q3)("",!0)]),_:3})}}}),f=a(71241);const v=(0,f.A)(m,[["__scopeId","data-v-3d53564d"]]);var g=v},31095:function(e,t,a){a.r(t),a.d(t,{default:function(){return fe}});var s=a(77195),l=(a(97042),a(38389),a(61688),a(56768)),r=a(90144),o=a(70944),i=a(65451),n=(a(63390),a(69080)),u=(a(25374),a(12687)),d=(a(31112),a(25136)),p=(a(69957),a(44114),a(18111),a(7588),a(61701),a(18237),a(13579),a(24232)),c=a(164),m=a(26695),f=a(57477),v=a(60265),g=a(7502),y=a(82572),h=a(21929),b=(a(98421),a(14022)),w=(a(72343),a(88284)),k=(a(36715),a(85415)),D=(a(22243),a(7409),a(32465),a(22489),a(61617)),x=a(5833),C=(a(81148),a(20116),a(27007)),F=a(31372),_=a(54880),S=(a(51582),a(60713),a(30058)),R=(a(24404),a(38840)),P=(a(95304),a(2403)),I=(a(63266),a(50942)),U=(a(8696),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(45130)),A=a(61473),T=a(99540);const V={style:{flex:"1",background:"white","border-radius":"4px"}},K={class:"dialog-footer"},W="default";var N=(0,l.pM)({__name:"FlowSelectDlg",props:{value:{},props:{default:()=>({label:"processDefinitionName",value:"processDefinitionKey"})},flowList:{default:()=>[]},dialog:{}},setup(e){const t=e,a=(0,r.KR)(),s=(0,r.KR)(),o=(0,r.KR)([]),i=(0,r.KR)(),n=(0,r.KR)([]),u=(0,r.KR)([]),p=(0,r.Kh)({categoryId:void 0,processDefinitionName:void 0}),c=(0,r.Kh)({categoryId:void 0,processDefinitionName:void 0}),m=(0,l.EW)(()=>n.value.filter(e=>{let t=!0;return null!=c.processDefinitionName&&""!==c.processDefinitionName&&(t=-1!==e.processDefinitionName.indexOf(c.processDefinitionName)),null!=c.categoryId&&""!==c.categoryId&&"all"!==c.categoryId&&(t=t&&e.categoryId===c.categoryId),t})),f=(0,l.EW)(()=>{const e=(u.value||[]).map(e=>e[t.props.value]);return{highlight:!0,checkStrictly:!0,checkRowKeys:e,showHeader:!1}}),v=()=>{D.VU.dictFlowCategory({}).then(e=>{o.value=e.getList(),o.value.unshift({id:"all",name:"全部"}),i.value=o.value[0],s.value?.setCurrentKey(i.value.id)}).catch(e=>{console.error(e)})},g=(e=!1)=>{c.processDefinitionName=p.processDefinitionName,c.categoryId=p.categoryId},y=()=>{p.processDefinitionName=void 0,g()},w=()=>{if(t.flowList&&t.flowList.length>0)return n.value=t.flowList,void C();const e={flowEntryDtoFilter:{}};D.Dy.listAllByStartFlow(e).then(e=>{n.value=Array.isArray(e.data)?e.data:e.data?.dataList||[],n.value=n.value.map(e=>({...e,processDefinitionName:e.processDefinitionName||"",processDefinitionKey:e.processDefinitionKey||""})),C()}).catch(e=>{console.error(e),n.value=[]})},k=e=>"object"===typeof e?e[t.props.value]:e,x=e=>{const t=k(e);return u.value.some(e=>k(e)===t)},C=()=>{a.value&&Array.isArray(n.value)&&setTimeout(()=>{a.value.clearCheckboxRow();const e=n.value.filter(x);e.length>0&&a.value.setCheckboxRow(e,!0)},50)},F=e=>{i.value=e,p.categoryId=e.id,g(!0)},N=({checked:e,row:t})=>{if(u.value||(u.value=[]),null==t)if(e)m.value.forEach(e=>{x(e)||u.value.push(e)});else{const e=new Set(m.value.map(k));u.value=u.value.filter(t=>!e.has(k(t)))}else if(e)x(t)||u.value.push(t);else{const e=k(t);u.value=u.value.filter(t=>k(t)!==e)}},z=({row:e})=>{const t=a.value.isCheckedByCheckboxRow(e);if(a.value.setCheckboxRow(e,!t),u.value||(u.value=[]),t){const t=k(e);u.value=u.value.filter(e=>k(e)!==t)}else x(e)||u.value.push(e)},E=()=>{t.dialog&&t.dialog.submit(u.value)},M=()=>{t.dialog&&t.dialog.cancel()};return(0,l.sV)(()=>{Array.isArray(t.value)?u.value=t.value.filter(e=>null!=e).map(e=>"object"===typeof e?e:{[t.props.value]:e,[t.props.label]:e}):u.value=[],v(),w()}),(e,n)=>{const u=I.qk,c=P.kA,v=R.Ik,w=_.Mb,k=b.WK,D=h.xE,x=S.A,C=h.US,L=d.S2,B=_.ZO,X=_.lX;return(0,l.uX)(),(0,l.Wv)(X,{class:"flow-select-dialog"},{default:(0,l.k6)(()=>[(0,l.bF)(w,{width:"240px"},{default:(0,l.k6)(()=>[(0,l.bF)(v,{class:"base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none"}},{default:(0,l.k6)(()=>[(0,l.bF)(c,null,{default:(0,l.k6)(()=>[(0,l.bF)(u,{ref_key:"categoryIdTree",ref:s,data:o.value,props:{label:"name"},"node-key":"id","highlight-current":!0,"current-node-key":(i.value||{}).id,onNodeClick:F},null,8,["data","current-node-key"])]),_:1})]),_:1})]),_:1}),(0,l.bF)(B,{style:{"margin-left":"20px",display:"flex","flex-direction":"column"}},{default:(0,l.k6)(()=>[(0,l.bF)(C,{ref:"formFlow",model:p,"label-width":"80px",size:W,"label-position":"right",onSubmit:n[2]||(n[2]=(0,U.D$)(()=>{},["prevent"]))},{default:(0,l.k6)(()=>[(0,l.bF)(x,{"item-width":550,onSearch:n[1]||(n[1]=e=>g()),onReset:y},{default:(0,l.k6)(()=>[(0,l.bF)(D,{label:"流程名称"},{default:(0,l.k6)(()=>[(0,l.bF)(k,{modelValue:p.processDefinitionName,"onUpdate:modelValue":n[0]||(n[0]=e=>p.processDefinitionName=e),clearable:!0,placeholder:"请输入流程名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"]),(0,l.Lk)("div",V,[(0,l.bF)(c,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,r.R1)(T.CP),{ref_key:"table",ref:a,"row-id":t.props.value,data:m.value,height:"490","show-overflow":"title","show-header-overflow":"title","row-config":{height:35,isHover:!0},"checkbox-config":f.value,onCheckboxChange:N,onCheckboxAll:N,onCellClick:z},{empty:(0,l.k6)(()=>n[3]||(n[3]=[(0,l.Lk)("div",{class:"table-empty unified-font"},[(0,l.Lk)("img",{src:A}),(0,l.Lk)("span",null,"暂无数据")],-1)])),default:(0,l.k6)(()=>[(0,l.bF)((0,r.R1)(T.Wq),{type:"checkbox",width:"50"}),(0,l.bF)((0,r.R1)(T.Wq),{title:"流程名称",field:"processDefinitionName"}),(0,l.bF)((0,r.R1)(T.Wq),{title:"流程标识",field:"processDefinitionKey"})]),_:1},8,["row-id","data","checkbox-config"])]),_:1})]),(0,l.Lk)("div",K,[(0,l.bF)(L,{onClick:M},{default:(0,l.k6)(()=>n[4]||(n[4]=[(0,l.eW)("取消")])),_:1,__:[4]}),(0,l.bF)(L,{type:"primary",onClick:E},{default:(0,l.k6)(()=>n[5]||(n[5]=[(0,l.eW)("确认选择")])),_:1,__:[5]})])]),_:1})]),_:1})}}}),z=a(71241);const E=(0,z.A)(N,[["__scopeId","data-v-2323c0a6"]]);var M=E;const L={class:"flow-select"};var B=(0,l.pM)({__name:"index",props:{modelValue:{},size:{default:"default"},placeholder:{},props:{default:()=>({label:"processDefinitionName",value:"processDefinitionKey"})},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0}},emits:["update:modelValue","change","blur","focus"],setup(e,{emit:t}){const a=t,s=e,o=((0,r.KR)((0,C.yk)()),(0,r.KR)([])),i=(0,r.KR)(!0),n=(0,r.KR)([]),u=e=>{o.value=e||[],m(!1)},d=e=>{e&&F.l.show("流程选择",M,{area:["1000px","700px"],offset:"100px"},{value:o.value,props:s.props,flowList:n.value}).then(e=>{u(e)}).catch(e=>{console.warn(e)})},p=e=>{o.value=o.value.filter(t=>t[s.props.value]!==e),m(!1)},c=()=>{o.value=[],m(!1)},m=(e=!0)=>{const t=o.value.map(e=>e[s.props.value]);a("update:modelValue",t),a("change",t,o.value)},f=e=>{if(!e||0===e.length)return o.value=[],void(n.value=[]);const t={flowEntryDtoFilter:{}};D.Dy.listAllByStartFlow(t).then(t=>{const a=Array.isArray(t.data)?t.data:t.data?.dataList||[];n.value=a.map(e=>({...e,processDefinitionName:e.processDefinitionName||"",processDefinitionKey:e.processDefinitionKey||""})),o.value=e.map(e=>{const t=n.value.find(t=>t[s.props.value]===e);return t||{[s.props.value]:e,[s.props.label]:e}})}).catch(t=>{console.warn(t),o.value=e.map(e=>({[s.props.value]:e,[s.props.label]:e})),n.value=[]})};return(0,l.wB)(()=>s.modelValue,e=>{e&&Array.isArray(e)?i.value&&(i.value=!1,e.length>0&&e.every(e=>"object"!==typeof e)?f(e):o.value=e.map(e=>"object"===typeof e?{...e,[s.props.value]:e[s.props.value]||e,[s.props.label]:e[s.props.label]||e}:{[s.props.value]:e,[s.props.label]:e})):o.value=[]},{immediate:!0}),(e,t)=>{const s=k.P9,i=k.AV;return(0,l.uX)(),(0,l.CE)("div",L,[(0,l.bF)(i,{"model-value":e.modelValue,style:{width:"100%"},multiple:!0,disabled:e.disabled,size:e.size,clearable:e.clearable,"collapse-tags":e.collapseTags,placeholder:e.placeholder,teleported:!1,"popper-class":"flow-select-popper",onVisibleChange:d,onRemoveTag:p,onClear:c,onBlur:t[0]||(t[0]=()=>a("blur")),onFocus:t[1]||(t[1]=()=>a("focus"))},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,r.R1)(o),t=>((0,l.uX)(),(0,l.Wv)(s,{key:t[e.props.value],label:t[e.props.label],value:t[e.props.value]},null,8,["label","value"]))),128))]),_:1},8,["model-value","disabled","size","clearable","collapse-tags","placeholder"])])}}});const X=(0,z.A)(B,[["__scopeId","data-v-12a73a9c"]]);var j=X,q=a(71066);const O={class:"form-edit-box"},Q={class:"dialog-footer"};var $;(function(e){e["USER"]="user",e["DEPT"]="dept",e["POST"]="post",e["DEPT_POST"]="dept_post",e["ROLE"]="role"})($||($={}));var H=(0,l.pM)({__name:"formEditAgent",props:{rowData:{},dialog:{},thirdParamsString:{},dialogKey:{}},emits:["success","cancel"],setup(e,{emit:t}){const a=(0,y.l5)(),s=e,{thirdParams:o,onCloseThirdDialog:i}=(0,q.P)(s),n=(0,r.KR)(),u=(0,r.KR)(!1),p=(0,r.Kh)({id:void 0,delegateUsers:void 0,processDefinitionKeys:void 0,delegateScope:void 0,startTime:void 0,endTime:void 0,memo:void 0}),c=(0,l.EW)(()=>({rowData:s.rowData||o.rowData||{}})),f=[{label:"用户",value:$.USER},{label:"部门",value:$.DEPT},{label:"岗位",value:$.POST},{label:"部门岗位",value:$.DEPT_POST},{label:"角色",value:$.ROLE}],v={delegateUsers:[{required:!0,message:"请选择委托人",trigger:"change"}],delegateScope:[{required:!0,message:"请选择委托范围",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"}]},g=()=>{if(c.value.rowData){console.log(c.value.rowData);const e=c.value.rowData.delegateUsers?.split(",").filter(Boolean)||[],t=c.value.rowData.processDefinitionKeys?.split(",").filter(Boolean)||[],a=c.value.rowData.delegateScope?.split(",").filter(Boolean)||[];Object.assign(p,{...c.value.rowData,delegateUsers:e,processDefinitionKeys:t,delegateScope:a})}},C=()=>{n.value.validate(e=>{if(e){u.value=!0,console.log(p.delegateUsers);const e={flowDelegateUserDto:{...p,delegateUsers:Array.isArray(p.delegateUsers)?p.delegateUsers.join(","):p.delegateUsers,processDefinitionKeys:Array.isArray(p.processDefinitionKeys)?p.processDefinitionKeys.join(","):p.processDefinitionKeys,delegateScope:Array.isArray(p.delegateScope)?p.delegateScope.join(","):p.delegateScope}},t=p.id?D.R4.updateDelegateUser(e):D.R4.addDelegateUser(e);t.then(()=>{m.nk.success("保存成功"),s.dialog?s.dialog.submit({}):i(!0)}).catch(e=>{console.warn(e)}).finally(()=>{u.value=!1})}})},F=()=>{s.dialog&&s.dialog.cancel()};return(0,l.sV)(()=>{g()}),(e,t)=>{const s=h.xE,o=k.P9,i=k.AV,c=w.MG,m=b.WK,g=h.US,y=d.S2;return(0,l.uX)(),(0,l.CE)("div",O,[(0,l.bF)(g,{ref_key:"form",ref:n,model:p,rules:v,"label-width":"100px",size:(0,r.R1)(a).defaultFormItemSize},{default:(0,l.k6)(()=>[(0,l.bF)(s,{label:"受委托人",prop:"delegateUsers"},{default:(0,l.k6)(()=>[(0,l.bF)(x.A,{modelValue:p.delegateUsers,"onUpdate:modelValue":t[0]||(t[0]=e=>p.delegateUsers=e),multiple:!0,clearable:!0,collapseTags:!1,placeholder:"请选择受委托人",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),(0,l.bF)(s,{label:"委托流程",prop:"processDefinitionKeys"},{default:(0,l.k6)(()=>[(0,l.bF)(j,{modelValue:p.processDefinitionKeys,"onUpdate:modelValue":t[1]||(t[1]=e=>p.processDefinitionKeys=e),multiple:!0,clearable:!0,collapseTags:!1,placeholder:"未选择委托流程默认全部流程进行委托",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),(0,l.bF)(s,{label:"委托范围",prop:"delegateScope"},{default:(0,l.k6)(()=>[(0,l.bF)(i,{modelValue:p.delegateScope,"onUpdate:modelValue":t[2]||(t[2]=e=>p.delegateScope=e),multiple:!0,clearable:!0,collapseTags:!1,placeholder:"请选择委托范围",style:{width:"100%"}},{default:(0,l.k6)(()=>[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(f,e=>(0,l.bF)(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(s,{label:"开始时间",prop:"startTime"},{default:(0,l.k6)(()=>[(0,l.bF)(c,{modelValue:p.startTime,"onUpdate:modelValue":t[3]||(t[3]=e=>p.startTime=e),type:"datetime",placeholder:"开始时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),(0,l.bF)(s,{label:"结束时间",prop:"endTime"},{default:(0,l.k6)(()=>[(0,l.bF)(c,{modelValue:p.endTime,"onUpdate:modelValue":t[4]||(t[4]=e=>p.endTime=e),type:"datetime",placeholder:"结束时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),(0,l.bF)(s,{label:"委托说明",prop:"memo"},{default:(0,l.k6)(()=>[(0,l.bF)(m,{modelValue:p.memo,"onUpdate:modelValue":t[5]||(t[5]=e=>p.memo=e),type:"textarea",rows:3,placeholder:"请输入委托说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","size"]),(0,l.Lk)("div",Q,[(0,l.bF)(y,{onClick:F},{default:(0,l.k6)(()=>t[6]||(t[6]=[(0,l.eW)("取消")])),_:1,__:[6]}),(0,l.bF)(y,{type:"primary",onClick:C,loading:u.value},{default:(0,l.k6)(()=>t[7]||(t[7]=[(0,l.eW)("确定")])),_:1,__:[7]},8,["loading"])])])}}});const G=(0,z.A)(H,[["__scopeId","data-v-0fa73b4d"]]);var Y=G,J=a(54428),Z=(0,l.pM)({__name:"TabContentMyAgent",setup(e,{expose:t}){const a=(0,g.s)(),s=(0,y.l5)(),h=(0,l.WQ)("mainContextHeight",200),b=e=>{if(e.isChild)switch(e.confirmStatus){case 1:return"success";case 2:return"danger";default:return"info"}const t=new Date,a=new Date(e.endTime);if(t>a)return"danger";const s=e.flowDelegatedUserList?.some(e=>1===e.confirmStatus);return s?"success":"info"},w=e=>{if(e.isChild)switch(e.confirmStatus){case 1:return"已接受";case 2:return"已拒绝";default:return"待确认"}const t=new Date,a=new Date(e.endTime);if(t>a)return"已过期";const s=e.flowDelegatedUserList?.some(e=>1===e.confirmStatus);return s?"生效中":"待确认"},k={user:"用户",dept:"部门",post:"岗位",dept_post:"部门岗位",role:"角色"},x=(0,r.KR)({}),F=(0,r.KR)({}),_=e=>{if(!e.length)return Promise.resolve();const t={widgetType:"upms_user",fieldValues:e.join(",")};return J.If.viewByIds(t,{showMask:!1}).then(e=>{const t=(e.data||[]).reduce((e,t)=>(e[t.userId]=t,e),{});F.value={...F.value,...t}}).catch(e=>{console.warn(e)})},S=()=>{D.Dy.listDictByKey({}).then(e=>{const t={},a=Array.isArray(e.data)?e.data:e.data?.dataList||[];a.forEach(e=>{t[e.id]=e.name}),x.value=t}).catch(e=>{console.warn(e)})},R=e=>{if(!e)return"";const t=e.split(","),a=["user","dept","post","dept_post","role"],s=a.every(e=>t.includes(e));return s?"全部":t.map(e=>k[e]||e).join(",")},P=e=>e?e.split(",").map(e=>x.value[e]||e).join(","):"全部",I=e=>new Promise((t,a)=>{D.R4.listMyDelegate(e).then(e=>{const a=e.data.dataList.reduce((e,t)=>{if(t.delegateUsers){const a=t.delegateUsers.split(",");a.forEach(t=>{F.value[t]||e.push(t)})}return e},[]),s=a.length?_(a):Promise.resolve();s.then(()=>{const a=e.data.dataList.reduce((e,t)=>{const a=t.delegateUsers?.split(",")||[],s={...t,delegateUserNames:a.map(e=>F.value[e]?.showName||e).join(", "),isChild:!1};return e.push(s),t.flowDelegatedUserList?.length&&t.flowDelegatedUserList.forEach((a,s)=>{e.push({id:`${t.id}_${s}`,parentId:t.id,delegateUserNames:F.value[a.userId]?.showName||"",confirmStatus:a.confirmStatus,isChild:!0})}),e},[]),s=(0,C.BN)(a,"id","parentId");t({dataList:s,totalCount:e.data.totalCount})})}).catch(e=>{a(e)})}),U=()=>!0,A={loadTableData:I,verifyTableParameter:U,paged:!0},T=(0,r.Kh)({ProcessAgent:{impl:(0,v.K)(A)},isInit:!1}),V=(e=!1)=>{e?T.ProcessAgent.impl.refreshTable(!0,1):T.ProcessAgent.impl.refreshTable(),T.isInit=!0},K=()=>{a.show("新建委托",Y,{area:["600px","auto"]},{path:"thirdEditAgent"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditAgent"}).then(()=>{V()}).catch(e=>{console.warn(e)})},W=e=>{a.show("编辑委托",Y,{area:["600px","auto"]},{rowData:e,path:"thirdEditAgent"},{width:"600px",height:"500px",pathName:"/thirdParty/thirdEditAgent"}).then(()=>{V()}).catch(e=>{console.warn(e)})},N=e=>{c.s.confirm("是否删除该委托记录？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t={id:e.id};D.R4.deleteDelegateUser(t).then(()=>{m.nk.success("删除成功"),T.ProcessAgent.impl.refreshTable()}).catch(e=>{console.warn(e)})}).catch(()=>{})},z=()=>{S(),V(!0)};return(0,l.sV)(()=>{z()}),t({refreshFragmentMyAgent:V}),(e,t)=>{const a=d.S2,c=(0,l.g2)("vxe-column"),m=u.u,v=n.aQ,g=i.S2,y=o.A;return(0,l.uX)(),(0,l.CE)("div",{class:"tab-content-box",style:(0,p.Tr)("min-height:"+((0,r.R1)(h)-76)+"px")},[(0,l.bF)(y,{class:"page-table",data:T.ProcessAgent.impl.dataList,"tree-config":{rowField:"id",parentField:"parentId"},onRefresh:t[1]||(t[1]=e=>V(!0))},{operator:(0,l.k6)(()=>[(0,l.bF)(a,{type:"primary",size:(0,r.R1)(s).defaultFormItemSize,icon:(0,r.R1)(f.Plus),onClick:t[0]||(t[0]=e=>K())},{default:(0,l.k6)(()=>t[2]||(t[2]=[(0,l.eW)(" 新建 ")])),_:1,__:[2]},8,["size","icon"])]),pagination:(0,l.k6)(()=>[(0,l.bF)(g,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,l.k6)(()=>[(0,l.bF)(v,{total:T.ProcessAgent.impl.totalCount,"current-page":T.ProcessAgent.impl.currentPage,"page-size":T.ProcessAgent.impl.pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:T.ProcessAgent.impl.onCurrentPageChange,onSizeChange:T.ProcessAgent.impl.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),default:(0,l.k6)(()=>[(0,l.bF)(c,{title:"序号",type:"seq",width:"80px","tree-node":""}),(0,l.bF)(c,{title:"受委托人",field:"delegateUserNames","show-overflow":"title"}),(0,l.bF)(c,{title:"委托范围","show-overflow":"title"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,p.v_)(e.isChild?"":R(e.delegateScope)),1)]),_:1}),(0,l.bF)(c,{title:"委托流程","show-overflow":"title"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,p.v_)(e.isChild?"":P(e.processDefinitionKeys)),1)]),_:1}),(0,l.bF)(c,{title:"开始时间"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,p.v_)(e.isChild?"":e.startTime),1)]),_:1}),(0,l.bF)(c,{title:"结束时间"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,p.v_)(e.isChild?"":e.endTime),1)]),_:1}),(0,l.bF)(c,{title:"委托状态"},{default:(0,l.k6)(({row:e})=>[(0,l.bF)(m,{type:b(e),size:(0,r.R1)(s).defaultFormItemSize},{default:(0,l.k6)(()=>[(0,l.eW)((0,p.v_)(w(e)),1)]),_:2},1032,["type","size"])]),_:1}),(0,l.bF)(c,{title:"委托说明",field:"memo","show-overflow":"title"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,p.v_)(e.isChild?"":e.memo),1)]),_:1}),(0,l.bF)(c,{title:"操作",fixed:"right",width:"120px"},{default:(0,l.k6)(({row:e})=>[e.isChild?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.bF)(a,{onClick:t=>W(e),type:"primary",link:"",size:(0,r.R1)(s).defaultFormItemSize},{default:(0,l.k6)(()=>t[3]||(t[3]=[(0,l.eW)(" 编辑 ")])),_:2,__:[3]},1032,["onClick","size"]),(0,l.bF)(a,{onClick:t=>N(e),link:"",type:"danger",size:(0,r.R1)(s).defaultFormItemSize},{default:(0,l.k6)(()=>t[4]||(t[4]=[(0,l.eW)(" 删除 ")])),_:2,__:[4]},1032,["onClick","size"])],64))]),_:1})]),_:1},8,["data"])],4)}}});const ee=Z;var te=ee,ae=(0,l.pM)({__name:"TabContentAgentToMe",setup(e,{expose:t}){const a=(0,y.l5)(),s=(0,l.WQ)("mainContextHeight",200),f=(0,r.KR)({}),g=e=>{if(!e.length)return Promise.resolve();const t={widgetType:"upms_user",fieldValues:e.join(",")};return J.If.viewByIds(t,{showMask:!1}).then(e=>{const t=(e.data||[]).reduce((e,t)=>(e[t.userId]=t,e),{});f.value={...f.value,...t}}).catch(e=>{console.warn(e)})},h={user:"用户",dept:"部门",post:"岗位",dept_post:"部门岗位",role:"角色"},b=(0,r.KR)({}),w={PENDING:0,APPROVED:1,REJECTED:2},k=()=>{D.Dy.listDictByKey({}).then(e=>{const t={},a=Array.isArray(e.data)?e.data:e.data?.dataList||[];a.forEach(e=>{t[e.id]=e.name}),b.value=t}).catch(e=>{console.warn(e)})},x=e=>{if(!e)return"";const t=e.split(","),a=["user","dept","post","dept_post","role"],s=a.every(e=>t.includes(e));return s?"全部":t.map(e=>h[e]||e).join(",")},C=e=>e?e.split(",").map(e=>b.value[e]||e).join(","):"全部",F=e=>new Promise((t,a)=>{D.R4.listMyDelegated(e).then(e=>{const a=e.data.dataList.reduce((e,t)=>(t.createUserId&&!f.value[t.createUserId]&&e.push(t.createUserId),e),[]),s=a.length?g(a):Promise.resolve();s.then(()=>{const a=e.data.dataList.map(e=>({...e,delegateUserName:f.value[e.createUserId]?.showName||e.createUserId}));t({dataList:a,totalCount:e.data.totalCount})})}).catch(a)}),_=()=>!0,S={loadTableData:F,verifyTableParameter:_,paged:!0},R=(0,r.Kh)({ProcessAgent:{impl:(0,v.K)(S)},isInit:!1}),P=(e=!1)=>{e?R.ProcessAgent.impl.refreshTable(!0,1):R.ProcessAgent.impl.refreshTable(),R.isInit=!0},I=(e,t)=>{const a=t?"接受":"拒绝";c.s.confirm(`是否${a}该委托申请？`,"",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const s={delegateId:e.id,confirmStatus:t?w.APPROVED:w.REJECTED};D.R4.updateDelegatedUserConfirm(s).then(()=>{m.nk.success(`${a}成功`),R.ProcessAgent.impl.refreshTable()}).catch(e=>{console.warn(e)})}).catch(()=>{})},U=()=>{k(),P(!0)};(0,l.sV)(()=>{U()});const A=e=>{const t=new Date,a=new Date(e.endTime),s=t>a;if(s&&0===e.flowDelegatedUser?.confirmStatus)return"danger";switch(e.flowDelegatedUser?.confirmStatus){case 1:return"success";case 2:return"danger";default:return"info"}},T=e=>{const t=new Date,a=new Date(e.endTime),s=t>a;if(s&&0===e.flowDelegatedUser?.confirmStatus)return"已过期";switch(e.flowDelegatedUser?.confirmStatus){case 1:return"已接受";case 2:return"已拒绝";default:return"待确认"}};return t({refreshFragmentAgentToMe:P}),(e,t)=>{const c=(0,l.g2)("vxe-column"),m=u.u,f=d.S2,v=n.aQ,g=i.S2,y=o.A;return(0,l.uX)(),(0,l.CE)("div",{class:"tab-content-box",style:(0,p.Tr)("min-height:"+((0,r.R1)(s)-76)+"px")},[(0,l.bF)(y,{class:"page-table",data:R.ProcessAgent.impl.dataList,onSortChange:R.ProcessAgent.impl.onSortChange,onRefresh:t[0]||(t[0]=e=>P(!0)),"seq-config":{startIndex:(R.ProcessAgent.impl.currentPage-1)*R.ProcessAgent.impl.pageSize}},{pagination:(0,l.k6)(()=>[(0,l.bF)(g,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,l.k6)(()=>[(0,l.bF)(v,{total:R.ProcessAgent.impl.totalCount,"current-page":R.ProcessAgent.impl.currentPage,"page-size":R.ProcessAgent.impl.pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:R.ProcessAgent.impl.onCurrentPageChange,onSizeChange:R.ProcessAgent.impl.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),default:(0,l.k6)(()=>[(0,l.bF)(c,{title:"序号",type:"seq",width:"60px"}),(0,l.bF)(c,{title:"委托人",field:"delegateUserName"}),(0,l.bF)(c,{title:"委托范围","show-overflow":"title"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,p.v_)(x(e.delegateScope)),1)]),_:1}),(0,l.bF)(c,{title:"委托流程","show-overflow":"title"},{default:(0,l.k6)(({row:e})=>[(0,l.eW)((0,p.v_)(C(e.processDefinitionKeys)),1)]),_:1}),(0,l.bF)(c,{title:"开始时间",field:"startTime"}),(0,l.bF)(c,{title:"结束时间",field:"endTime"}),(0,l.bF)(c,{title:"委托说明",field:"memo","show-overflow":"title"}),(0,l.bF)(c,{title:"确认状态"},{default:(0,l.k6)(({row:e})=>[(0,l.bF)(m,{type:A(e),size:(0,r.R1)(a).defaultFormItemSize},{default:(0,l.k6)(()=>[(0,l.eW)((0,p.v_)(T(e)),1)]),_:2},1032,["type","size"])]),_:1}),(0,l.bF)(c,{title:"操作",fixed:"right",width:"120px"},{default:(0,l.k6)(({row:e})=>[(0,l.bF)(f,{onClick:t=>I(e,!0),type:"primary",link:"",size:(0,r.R1)(a).defaultFormItemSize,disabled:0!==e.flowDelegatedUser?.confirmStatus||new Date>=new Date(e.endTime)},{default:(0,l.k6)(()=>t[1]||(t[1]=[(0,l.eW)(" 接受 ")])),_:2,__:[1]},1032,["onClick","size","disabled"]),(0,l.bF)(f,{onClick:t=>I(e,!1),type:"danger",link:"",size:(0,r.R1)(a).defaultFormItemSize,disabled:0!==e.flowDelegatedUser?.confirmStatus||new Date>=new Date(e.endTime)},{default:(0,l.k6)(()=>t[2]||(t[2]=[(0,l.eW)(" 拒绝 ")])),_:2,__:[2]},1032,["onClick","size","disabled"])]),_:1})]),_:1},8,["data","onSortChange","seq-config"])],4)}}});const se=(0,z.A)(ae,[["__scopeId","data-v-1c27f012"]]);var le=se,re=a(81387),oe=a(22414),ie=(0,l.pM)({__name:"TabContentMyTask",setup(e,{expose:t}){const a=(0,re.rd)(),s=(0,y.l5)(),u=(0,l.WQ)("mainContextHeight",200),c=(0,r.KR)(),f=(0,r.KR)([]),g=()=>{D.R4.listDictEffectiveDelegate({}).then(e=>{e.data&&(f.value=e.data)}).catch(e=>{console.warn(e)})},w=e=>F.value.formFilter.delegateUserId?(null==e&&(e={}),e={processDefinitionName:F.value.formFilterCopy.processDefinitionName,processDefinitionKey:F.value.formFilterCopy.processDefinitionKey,taskName:F.value.formFilterCopy.taskName,delegateUserId:F.value.formFilterCopy.delegateUserId,...e},new Promise((t,a)=>{D.wI.listRuntimeTask(e).then(e=>{t({dataList:e.data.dataList,totalCount:e.data.totalCount})}).catch(e=>{a(e)})})):(m.nk.warning("请选择委托用户"),new Promise((e,t)=>{e({dataList:[],totalCount:0})})),x=()=>(F.value.formFilterCopy.processDefinitionName=F.value.formFilter.processDefinitionName,F.value.formFilterCopy.processDefinitionKey=F.value.formFilter.processDefinitionKey,F.value.formFilterCopy.taskName=F.value.formFilter.taskName,F.value.formFilterCopy.delegateUserId=F.value.formFilter.delegateUserId,!0),C={loadTableData:w,verifyTableParameter:x,paged:!0,orderFieldName:"entryId",ascending:!0},F=(0,r.KR)({formFilter:{processDefinitionName:void 0,processDefinitionKey:void 0,taskName:void 0,delegateUserId:void 0},formFilterCopy:{processDefinitionName:void 0,processDefinitionKey:void 0,taskName:void 0,delegateUserId:void 0},taskWidget:(0,v.K)(C),isInit:!1}),_=(e=!1)=>{e?F.value.taskWidget.refreshTable(!0,1):F.value.taskWidget.refreshTable()},R=()=>{c.value.resetFields(),_(!0)},P=()=>{_()},I=e=>{let t={processInstanceId:e.processInstanceId,processDefinitionId:e.processDefinitionId,taskId:e.taskId,delegateUserId:F.value.formFilterCopy.delegateUserId};D.wI.viewRuntimeTaskInfo(t).then(t=>{t.data&&a.push({name:t.data.routerName||"handlerFlowTask",query:{isRuntime:"true",isDraft:e.isDraft,taskId:e.taskId,processDefinitionKey:e.processDefinitionKey,processInstanceId:e.processInstanceId,processDefinitionId:e.processDefinitionId,formId:t.data.formId,routerName:t.data.routerName,readOnly:t.data.readOnly,taskName:e.taskName,flowEntryName:e.processDefinitionName,processInstanceInitiator:e.showName,delegateUserId:F.value.formFilterCopy.delegateUserId,operationList:JSON.stringify((t.data.operationList||[]).filter(e=>e.type!==oe.SysFlowTaskOperationType.CO_SIGN&&e.type!==oe.SysFlowTaskOperationType.REVOKE&&e.type!==oe.SysFlowTaskOperationType.SIGN_REDUCTION)),variableList:JSON.stringify(t.data.variableList)}})}).catch(e=>{console.warn(e)})};return(0,l.sV)(()=>{g()}),(0,l.n)(()=>{P()}),t({onResume:P}),(e,t)=>{const a=k.P9,m=k.AV,v=h.xE,g=b.WK,y=S.A,w=h.US,D=(0,l.g2)("vxe-column"),x=d.S2,C=n.aQ,P=i.S2,A=o.A;return(0,l.uX)(),(0,l.CE)("div",{class:"tab-content-box",style:(0,p.Tr)("min-height:"+((0,r.R1)(u)-76)+"px")},[(0,l.bF)(w,{ref_key:"form",ref:c,model:F.value,"label-width":"80px",size:(0,r.R1)(s).defaultFormItemSize,"label-position":"right",onSubmit:t[5]||(t[5]=(0,U.D$)(()=>{},["prevent"]))},{default:(0,l.k6)(()=>[(0,l.bF)(y,{"item-width":350,onSearch:t[4]||(t[4]=e=>_(!0)),onReset:R},{default:(0,l.k6)(()=>[(0,l.bF)(v,{label:"委托用户",prop:"formFilter.delegateUserId",rules:[{required:!0,message:"请选择委托用户",trigger:["blur","change"]}]},{default:(0,l.k6)(()=>[(0,l.bF)(m,{modelValue:F.value.formFilter.delegateUserId,"onUpdate:modelValue":t[0]||(t[0]=e=>F.value.formFilter.delegateUserId=e),clearable:!0,placeholder:"请选择委托用户",style:{width:"100%"}},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(f.value,e=>((0,l.uX)(),(0,l.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(v,{label:"流程名称",prop:"formFilter.processDefinitionName"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{class:"filter-item",modelValue:F.value.formFilter.processDefinitionName,"onUpdate:modelValue":t[1]||(t[1]=e=>F.value.formFilter.processDefinitionName=e),clearable:!0,placeholder:"流程名称"},null,8,["modelValue"])]),_:1}),(0,l.bF)(v,{label:"流程标识",prop:"formFilter.processDefinitionKey"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{class:"filter-item",modelValue:F.value.formFilter.processDefinitionKey,"onUpdate:modelValue":t[2]||(t[2]=e=>F.value.formFilter.processDefinitionKey=e),clearable:!0,placeholder:"流程标识"},null,8,["modelValue"])]),_:1}),(0,l.bF)(v,{label:"任务名称",prop:"formFilter.taskName"},{default:(0,l.k6)(()=>[(0,l.bF)(g,{class:"filter-item",modelValue:F.value.formFilter.taskName,"onUpdate:modelValue":t[3]||(t[3]=e=>F.value.formFilter.taskName=e),clearable:!0,placeholder:"任务名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,l.bF)(A,{class:"page-table",data:F.value.taskWidget.dataList,size:(0,r.R1)(s).defaultFormItemSize,onSortChange:F.value.taskWidget.onSortChange,onRefresh:t[6]||(t[6]=e=>_(!0)),"seq-config":{startIndex:(F.value.taskWidget.currentPage-1)*F.value.taskWidget.pageSize},hasExtend:!1},{pagination:(0,l.k6)(()=>[(0,l.bF)(P,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,l.k6)(()=>[(0,l.bF)(C,{total:F.value.taskWidget.totalCount,"current-page":F.value.taskWidget.currentPage,"page-size":F.value.taskWidget.pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:F.value.taskWidget.onCurrentPageChange,onSizeChange:F.value.taskWidget.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),default:(0,l.k6)(()=>[(0,l.bF)(D,{title:"序号",type:"seq",width:"70px",index:F.value.taskWidget.getTableIndex},null,8,["index"]),(0,l.bF)(D,{title:"流程名称",field:"processDefinitionName"}),(0,l.bF)(D,{title:"流程主题",field:"summaryData"}),(0,l.bF)(D,{title:"当前任务",field:"taskName"}),(0,l.bF)(D,{title:"发起人登录名",field:"processInstanceInitiator"}),(0,l.bF)(D,{title:"发起人昵称",field:"showName"}),(0,l.bF)(D,{title:"任务发起时间",field:"processInstanceStartTime"}),(0,l.bF)(D,{title:"操作",width:"80px"},{default:(0,l.k6)(e=>[(0,l.bF)(x,{size:(0,r.R1)(s).defaultFormItemSize,link:"",type:"primary",onClick:t=>I(e.row)},{default:(0,l.k6)(()=>t[7]||(t[7]=[(0,l.eW)("办理")])),_:2,__:[7]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size","onSortChange","seq-config"])],4)}}});const ne=ie;var ue=ne;const de={class:"tab-dialog-box",style:{position:"relative"}},pe={name:"formSysAgent"};var ce=(0,l.pM)({...pe,setup(e){const t=(0,r.KR)("fragmentMyAgent"),a=(0,r.KR)(),o=(0,r.KR)(),i=(0,r.KR)(),n=e=>{if(e!==t.value)return t.value=e,"fragmentMyAgent"===e?u():"fragmentAgentToMe"===e?d():"fragmentMyTask"===e&&p(),!0},u=()=>{a.value?.refreshFragmentMyAgent()},d=()=>{o.value?.refreshFragmentAgentToMe()},p=()=>{i.value?.onResume()};return(0,l.sV)(()=>{u()}),(e,r)=>{const u=s.v$,d=s.q;return(0,l.uX)(),(0,l.CE)("div",de,[(0,l.bF)(d,{modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=e=>t.value=e),"before-leave":n},{default:(0,l.k6)(()=>[(0,l.bF)(u,{label:"我的委托",name:"fragmentMyAgent",style:{width:"100%"}},{default:(0,l.k6)(()=>["fragmentMyAgent"===t.value?((0,l.uX)(),(0,l.Wv)(te,{key:0,ref_key:"tabMyAgent",ref:a},null,512)):(0,l.Q3)("",!0)]),_:1}),(0,l.bF)(u,{label:"委托给我",name:"fragmentAgentToMe",style:{width:"100%"}},{default:(0,l.k6)(()=>["fragmentAgentToMe"===t.value?((0,l.uX)(),(0,l.Wv)(le,{key:0,ref_key:"tabAgentToMe",ref:o},null,512)):(0,l.Q3)("",!0)]),_:1}),(0,l.bF)(u,{label:"委托待办",name:"fragmentMyTask",style:{width:"100%"}},{default:(0,l.k6)(()=>["fragmentMyTask"===t.value?((0,l.uX)(),(0,l.Wv)(ue,{key:0,ref_key:"tabMyTask",ref:i},null,512)):(0,l.Q3)("",!0)]),_:1})]),_:1},8,["modelValue"])])}}});const me=(0,z.A)(ce,[["__scopeId","data-v-10d71536"]]);var fe=me},38840:function(e,t,a){a.d(t,{Ik:function(){return m}});var s=a(56768),l=a(24232),r=a(90144),o=a(84565),i=a(99077),n=a(93513);const u=(0,s.pM)({name:"ElCard"}),d=(0,s.pM)({...u,props:o.b,setup(e){const t=(0,n.DU)("card");return(e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,l.C4)([(0,r.R1)(t).b(),(0,r.R1)(t).is(`${e.shadow}-shadow`)])},[e.$slots.header||e.header?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,l.C4)([(0,r.R1)(t).e("header"),e.headerClass])},[(0,s.RG)(e.$slots,"header",{},()=>[(0,s.eW)((0,l.v_)(e.header),1)])],2)):(0,s.Q3)("v-if",!0),(0,s.Lk)("div",{class:(0,l.C4)([(0,r.R1)(t).e("body"),e.bodyClass]),style:(0,l.Tr)(e.bodyStyle)},[(0,s.RG)(e.$slots,"default")],6),e.$slots.footer||e.footer?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,l.C4)([(0,r.R1)(t).e("footer"),e.footerClass])},[(0,s.RG)(e.$slots,"footer",{},()=>[(0,s.eW)((0,l.v_)(e.footer),1)])],2)):(0,s.Q3)("v-if",!0)],2))}});var p=(0,i.A)(d,[["__file","card.vue"]]),c=a(25376);const m=(0,c.GU)(p)},54428:function(e,t,a){a.d(t,{v9:function(){return o},n5:function(){return i},lE:function(){return g},_4:function(){return b},C7:function(){return d},If:function(){return w},qY:function(){return u},ek:function(){return p},$z:function(){return c},$D:function(){return h},S_:function(){return v},fe:function(){return n},sV:function(){return m},r0:function(){return f.A}});a(18111),a(61701);var s=a(55583),l=a(52081),r=a(18384);class o extends s.w{static dictSysRole(e,t){return new Promise((a,s)=>{super.get(r.x+"/upms/sysRole/listDict",e,t).then(e=>{const t=new l.w("角色字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictGlobalDict(e,t){return new Promise((a,s)=>{super.get(r.x+"/upms/globalDict/listDict",e,t).then(e=>{const t=new l.w("编码字典",(e.data||[]).map(e=>({...e,disabled:1===e.status})));a(t)}).catch(e=>{s(e)})})}static dictGlobalDictByIds(e,t){return new Promise((a,s)=>{super.get(r.x+"/upms/globalDict/listDictByIds",e,t).then(e=>{const t=new l.w("编码字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictAllMenu(e,t){return new Promise((a,s)=>{super.get(r.x+"/upms/sysMenu/listDict",e,t).then(e=>{const t=new l.w("菜单字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysMenu(e,t){return new Promise((a,s)=>{super.get(r.x+"/upms/sysMenu/listMenuDict",e,t).then(e=>{const t=new l.w("菜单字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictDeptPost(e,t){return new Promise((a,s)=>{super.get(r.x+"/upms/sysDept/listSysDeptPostWithRelation",e,t).then(e=>{a(e.data)}).catch(e=>{s(e)})})}static dictSysPost(e,t){return new Promise((a,s)=>{super.get(r.x+"/upms/sysPost/listDict",e,t).then(e=>{const t=new l.w("岗位字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictReportDblink(e,t){return new Promise((a,s)=>{super.get(r.x+"/report/reportDblink/listDict",e,t).then(e=>{const t=new l.w("数据库链接",e.data);a(t)}).catch(e=>{s(e)})})}static dictReportDict(e,t){return new Promise((a,s)=>{super.get(r.x+"/report/reportDict/listDict",e,t).then(e=>{const t=new l.w("字典管理",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysUser(e,t){return new Promise((a,s)=>{super.get("/admin/upms/sysUser/listDict",e,t).then(e=>{let t=new l.w("用户字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysDept(e,t){return new Promise((a,s)=>{super.get("/admin/upms/sysDept/listDict",e,t).then(e=>{let t=new l.w("部门字典",e.data);a(t)}).catch(e=>{s(e)})})}static dictSysDeptByParentId(e,t){return new Promise((a,s)=>{super.get("/admin/upms/sysDept/listDictByParentId",e,t).then(e=>{let t=new l.w("部门字典",e.data);a(t)}).catch(e=>{s(e)})})}}class i extends s.w{static listSysLoginUser(e,t){return super.post(r.x+"/upms/loginUser/list",e,t)}static deleteSysLoginUser(e,t){return super.post(r.x+"/upms/loginUser/delete",e,t)}}class n extends s.w{static getMenuPermList(e,t){return super.post(r.x+"/upms/sysMenu/list",e,t)}static addMenu(e,t){return super.post(r.x+"/upms/sysMenu/add",e,t)}static updateMenu(e,t){return super.post(r.x+"/upms/sysMenu/update",e,t)}static deleteMenu(e,t){return super.post(r.x+"/upms/sysMenu/delete",e,t)}static viewMenu(e,t){return super.get(r.x+"/upms/sysMenu/view",e,t)}static listMenuPermCode(e,t){return super.get(r.x+"/upms/sysMenu/listMenuPerm",e,t)}static listSysPermByMenuIdWithDetail(e,t){return super.get(r.x+"/upms/sysMenu/listSysPermWithDetail",e,t)}static listSysUserByMenuIdWithDetail(e,t){return super.get(r.x+"/upms/sysMenu/listSysUserWithDetail",e,t)}}class u extends s.w{static updateSysConf(e,t){return super.post(r.x+"/upms/sysConf/update",e,t)}static getSysConf(e,t){return super.get(r.x+"/upms/sysConf/view",e,t)}}class d extends s.w{static getPermCodeList(e,t){return super.get(r.x+"/upms/login/getAllPermCodes",e,t)}}class p extends s.w{static add(e,t){return super.post(r.x+"/upms/sysDataPerm/add",e,t)}static update(e,t){return super.post(r.x+"/upms/sysDataPerm/update",e,t)}static delete(e,t){return super.post(r.x+"/upms/sysDataPerm/delete",e,t)}static list(e,t){return super.post(r.x+"/upms/sysDataPerm/list",e,t)}static view(e,t){return super.get(r.x+"/upms/sysDataPerm/view",e,t)}static listDataPermUser(e,t){return super.post(r.x+"/upms/sysDataPerm/listDataPermUser",e,t)}static addDataPermUser(e,t){return super.post(r.x+"/upms/sysDataPerm/addDataPermUser",e,t)}static deleteDataPermUser(e,t){return super.post(r.x+"/upms/sysDataPerm/deleteDataPermUser",e,t)}static listNotInDataPermUser(e,t){return super.post(r.x+"/upms/sysDataPerm/listNotInDataPermUser",e,t)}}class c extends s.w{static list(e,t){return super.post(r.x+"/upms/sysDept/list",e,t)}static view(e,t){return super.get(r.x+"/upms/sysDept/view",e,t)}static export(e,t){return super.download(r.x+"/upms/sysDept/export",e,t)}static add(e,t){return super.post(r.x+"/upms/sysDept/add",e,t)}static update(e,t){return super.post(r.x+"/upms/sysDept/update",e,t)}static delete(e,t){return super.post(r.x+"/upms/sysDept/delete",e,t)}static listNotInSysDeptPost(e,t){return super.post(r.x+"/upms/sysDept/listNotInSysDeptPost",e,t)}static listSysDeptPost(e,t){return super.post(r.x+"/upms/sysDept/listSysDeptPost",e,t)}static addSysDeptPost(e,t){return super.post(r.x+"/upms/sysDept/addSysDeptPost",e,t)}static updateSysDeptPost(e,t){return super.post(r.x+"/upms/sysDept/updateSysDeptPost",e,t)}static deleteSysDeptPost(e,t){return super.post(r.x+"/upms/sysDept/deleteSysDeptPost",e,t)}static viewSysDeptPost(e,t){return super.get(r.x+"/upms/sysDept/viewSysDeptPost",e,t)}}class m extends s.w{static getRoleList(e,t){return super.post(r.x+"/upms/sysRole/list",e,t)}static getRole(e,t){return super.get(r.x+"/upms/sysRole/view",e,t)}static deleteRole(e,t){return super.post(r.x+"/upms/sysRole/delete",e,t)}static addRole(e,t){return super.post(r.x+"/upms/sysRole/add",e,t)}static updateRole(e,t){return super.post(r.x+"/upms/sysRole/update",e,t)}static listRoleUser(e,t){return super.post(r.x+"/upms/sysRole/listUserRole",e,t)}static listNotInUserRole(e,t){return super.post(r.x+"/upms/sysRole/listNotInUserRole",e,t)}static addRoleUser(e,t){return super.post(r.x+"/upms/sysRole/addUserRole",e,t)}static deleteRoleUser(e,t){return super.post(r.x+"/upms/sysRole/deleteUserRole",e,t)}}var f=a(21013);class v extends s.w{static list(e,t){return super.post(r.x+"/upms/sysPost/list",e,t)}static view(e,t){return super.get(r.x+"/upms/sysPost/view",e,t)}static add(e,t){return super.post(r.x+"/upms/sysPost/add",e,t)}static update(e,t){return super.post(r.x+"/upms/sysPost/update",e,t)}static delete(e,t){return super.post(r.x+"/upms/sysPost/delete",e,t)}}class g extends s.w{static list(e,t){return super.post(r.x+"/mobile/mobileEntry/list",e,t)}static view(e,t){return super.get(r.x+"/mobile/mobileEntry/view",e,t)}static add(e,t){return super.post(r.x+"/mobile/mobileEntry/add",e,t)}static update(e,t){return super.post(r.x+"/mobile/mobileEntry/update",e,t)}static delete(e,t){return super.post(r.x+"/mobile/mobileEntry/delete",e,t)}static uploadImage(e,t){return super.post(r.x+"/mobile/mobileEntry/uploadImage",e,t)}static downloadImage(e,t){return super.post(r.x+"/mobile/mobileEntry/downloadImage",e,t)}}var y=a(53155);class h{static list(e,t){return(0,y.bE)(r.x+"/upms/globalDict/list",e,t)}static listAll(e,t){return(0,y.Jt)(r.x+"/upms/globalDict/listAll",e,t)}static add(e,t){return(0,y.bE)(r.x+"/upms/globalDict/add",e,t)}static update(e,t){return(0,y.bE)(r.x+"/upms/globalDict/update",e,t)}static delete(e,t){return(0,y.bE)(r.x+"/upms/globalDict/delete",e,t)}static addItem(e,t){return(0,y.bE)(r.x+"/upms/globalDict/addItem",e,t)}static updateItem(e,t){return(0,y.bE)(r.x+"/upms/globalDict/updateItem",e,t)}static updateItemStatus(e,t){return(0,y.bE)(r.x+"/upms/globalDict/updateItemStatus",e,t)}static deleteItem(e,t){return(0,y.bE)(r.x+"/upms/globalDict/deleteItem",e,t)}static reloadCachedData(e,t){return(0,y.Jt)(r.x+"/upms/globalDict/reloadCachedData",e,t)}}class b extends s.w{static listSysOperationLog(e,t){return super.post(r.x+"/upms/sysOperationLog/list",e,t)}}class w extends s.w{static list(e,t){return super.post(r.x+"/commonext/bizwidget/list",e,t)}static viewByIds(e,t){return super.post(r.x+"/commonext/bizwidget/view",e,t)}}},60760:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var s=a(25136),l=(a(97042),a(69957),a(69080)),r=(a(25374),a(76408)),o=(a(87535),a(21929)),i=(a(98421),a(65451)),n=(a(63390),a(32465),a(14022)),u=(a(72343),a(44114),a(18111),a(22489),a(61701),a(56768)),d=a(45130),p=a(90144),c=a(61473),m=a(99540),f=a(60265),v=a(54428),g=a(27007),y=a(71066);const h={style:{width:"100%"}};var b=(0,u.pM)({__name:"UserSelectDlg",props:{value:{},props:{default:()=>({label:"showName",value:"userId"})},multiple:{type:Boolean,default:!1},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:a,onCloseThirdDialog:b}=(0,y.P)(t),w=(0,p.KR)(),k=(0,p.Kh)({sysUserLoginName:void 0}),D=(0,p.KR)(),x=(0,u.EW)(()=>({value:t.value||a.value.value,props:t.props||null==a.value.props?t.props:a.value.props||{},multiple:t.multiple||null==a.value.multiple?t.multiple:a.value.multiple})),C=(0,u.EW)(()=>{let e=x.value.multiple&&Array.isArray(D.value)?(D.value||[]).map(e=>e[x.value.props.value]):(D.value||{})[x.value.props.value];return{highlight:!0,checkStrictly:!0,checkRowKeys:x.value.multiple?e:void 0,checkRowKey:x.value.multiple?void 0:e,showHeader:!1}}),F=()=>{null!=w.value&&Array.isArray(P.dataList)&&setTimeout(()=>{if(w.value.clearRadioRow(),w.value.clearCheckboxRow(),x.value.multiple)w.value.setCheckboxRow(P.dataList.filter(e=>null!=(0,g.PH)(D.value,e[x.value.props.value],x.value.props.value)),!0);else{let e=(0,g.PH)(P.dataList,(D.value||{})[x.value.props.value],x.value.props.value);w.value.setRadioRow(e)}},50)},_=e=>(e.widgetType="upms_user",e.filter={loginName:k.sysUserLoginName},new Promise((t,a)=>{v.If.list(e).then(e=>{t({dataList:e.data.dataList,totalCount:e.data.totalCount}),(0,u.dY)(()=>{F()})}).catch(e=>{a(e)})})),S=()=>!0,R={loadTableData:_,verifyTableParameter:S,paged:!0},P=(0,p.Kh)((0,f.K)(R)),I=(e=!1)=>{e?P.refreshTable(!0,1):P.refreshTable()},U=({checked:e,row:t})=>{x.value.multiple?null==t?(D.value=[],e&&(D.value=P.dataList)):(null==D.value&&(D.value=[]),e?D.value.push(t):D.value=D.value.filter(e=>e[x.value.props.value]!==t[x.value.props.value])):D.value=t},A=()=>{t.dialog?t.dialog.submit(D.value):b(!0,x.value.value,D.value)},T=()=>{t.dialog&&t.dialog.cancel()},V=({row:e})=>{if(x.value.multiple){const t=w.value.isCheckedByCheckboxRow(e);w.value.setCheckboxRow(e,!t),D.value||(D.value=[]),t?D.value=D.value.filter(t=>t[x.value.props.value]!==e[x.value.props.value]):D.value.push(e)}else w.value.setRadioRow(e),D.value=e};return(0,u.sV)(()=>{Array.isArray(x.value.value)&&x.value.value.length>0&&(x.value.multiple?D.value=x.value.value.map(e=>({...e})):D.value={...x.value.value[0]}),I(!0)}),(e,t)=>{const a=n.WK,f=o.xE,v=i.S2,g=o.US,y=r.uD,b=l.aQ,D=s.S2;return(0,u.uX)(),(0,u.CE)("div",h,[(0,u.bF)(g,{ref:"formSysUser",model:k,"label-width":"75px",size:"default","label-position":"right",onSubmit:t[2]||(t[2]=(0,d.D$)(()=>{},["prevent"]))},{default:(0,u.k6)(()=>[(0,u.bF)(v,{type:"flex",justify:"space-between"},{default:(0,u.k6)(()=>[(0,u.bF)(f,{label:"登录名称",prop:"sysUserLoginName"},{default:(0,u.k6)(()=>[(0,u.bF)(a,{modelValue:k.sysUserLoginName,"onUpdate:modelValue":t[0]||(t[0]=e=>k.sysUserLoginName=e),style:{width:"200px"},clearable:!0,placeholder:"登录名称",onChange:t[1]||(t[1]=e=>I(!0))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"]),(0,u.bF)(v,null,{default:(0,u.k6)(()=>[(0,u.bF)(y,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)((0,p.R1)(m.CP),{ref_key:"table",ref:w,"row-id":x.value.props.value,data:P.dataList,height:"468","show-overflow":"title","show-header-overflow":"title","row-config":{height:35,isHover:!0},"radio-config":{highlight:!0},"checkbox-config":C.value,onRadioChange:U,onCheckboxChange:U,onCheckboxAll:U,onCellClick:V},{empty:(0,u.k6)(()=>t[3]||(t[3]=[(0,u.Lk)("div",{class:"table-empty unified-font"},[(0,u.Lk)("img",{src:c}),(0,u.Lk)("span",null,"暂无数据")],-1)])),default:(0,u.k6)(()=>[(0,u.bF)((0,p.R1)(m.Wq),{type:x.value.multiple?"checkbox":"radio",width:50},null,8,["type"]),(0,u.bF)((0,p.R1)(m.Wq),{title:"用户名",field:"loginName"}),(0,u.bF)((0,p.R1)(m.Wq),{title:"昵称",field:"showName"}),(0,u.bF)((0,p.R1)(m.Wq),{title:"所属部门",field:"deptIdDictMap.name"})]),_:1},8,["row-id","data","checkbox-config"])]),_:1}),(0,u.bF)(y,{span:24},{default:(0,u.k6)(()=>[(0,u.bF)(v,{type:"flex",justify:"space-between",style:{"margin-top":"12px"}},{default:(0,u.k6)(()=>[(0,u.bF)(b,{total:P.totalCount,"current-page":P.currentPage,"page-size":P.pageSize,layout:"total, prev, pager, next",onCurrentChange:P.onCurrentPageChange,onSizeChange:P.onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"]),(0,u.Lk)("div",null,[(0,u.bF)(D,{onClick:T},{default:(0,u.k6)(()=>t[4]||(t[4]=[(0,u.eW)("取消")])),_:1,__:[4]}),(0,u.bF)(D,{type:"primary",onClick:A},{default:(0,u.k6)(()=>t[5]||(t[5]=[(0,u.eW)("确认选择")])),_:1,__:[5]})])]),_:1})]),_:1})]),_:1})])}}}),w=a(71241);const k=(0,w.A)(b,[["__scopeId","data-v-66825c4e"]]);var D=k},84565:function(e,t,a){a.d(t,{b:function(){return l}});var s=a(47378);const l=(0,s.b_)({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:(0,s.jq)([String,Object,Array]),default:""},headerClass:String,bodyClass:String,footerClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}})},95304:function(e,t,a){a(97042)}}]);