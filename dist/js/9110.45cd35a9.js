"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[9110],{21013:function(e,t,s){s.d(t,{A:function(){return n}});var r=s(55583),a=s(18384);class n extends r.w{static getUserList(e,t){return super.post(a.x+"/upms/sysUser/list",e,t)}static addUser(e,t){return super.post(a.x+"/upms/sysUser/add",e,t)}static updateUser(e,t){return super.post(a.x+"/upms/sysUser/update",e,t)}static deleteUser(e,t){return super.post(a.x+"/upms/sysUser/delete",e,t)}static viewMenu(e,t){return super.post(a.x+"/upms/sysMenu/view",e,t)}static syncAzureUser(e){return super.post(a.x+"/upms/sysUser/syncAzureUser",e)}static getUser(e,t){return super.get(a.x+"/upms/sysUser/view",e,t)}static resetUserPassword(e,t){return super.post(a.x+"/upms/sysUser/resetPassword",e,t)}static listSysPermWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysPermWithDetail",e,t)}static listSysPermCodeWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysPermCodeWithDetail",e,t)}static listSysMenuWithDetail(e,t){return super.get(a.x+"/upms/sysUser/listSysMenuWithDetail",e,t)}}},23855:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var r=s(65451),a=(s(97042),s(63390),s(56768)),n=s(90144),i=s(40299),u=s(61617),l=s(71066);const o={class:"form-single-fragment",style:{position:"relative"}};var p=(0,a.pM)({__name:"formTaskProcessViewer",props:{processDefinitionId:{},processInstanceId:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=e,{thirdParams:s}=(0,l.P)(t),p=(0,n.KR)(),c=(0,n.KR)(),d=(0,n.KR)(),m=(0,a.EW)(()=>({processDefinitionId:t.processDefinitionId||s.value.processDefinitionId,processInstanceId:t.processInstanceId||s.value.processInstanceId})),y=()=>{d.value=[],null!=m.value.processInstanceId&&""!==m.value.processInstanceId&&u.wI.listFlowTaskComment({processInstanceId:m.value.processInstanceId}).then(e=>{console.log("loadProcessCommentList",e),d.value=e.data}).catch(e=>{console.warn(e)})},f=()=>{if(null==m.value.processInstanceId||""===m.value.processInstanceId)return;let e={processInstanceId:m.value.processInstanceId};u.wI.viewHighlightFlowData(e).then(e=>{p.value=e.data}).catch(e=>{console.warn(e)})},w=()=>{let e={processDefinitionId:m.value.processDefinitionId};u.wI.viewProcessBpmn(e).then(e=>{c.value=e.data}).catch(e=>{console.warn(e)})};return(0,a.sV)(()=>{f(),w(),y()}),(e,t)=>{const s=r.S2;return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(s,null,{default:(0,a.k6)(()=>[null!=(0,n.R1)(p)?((0,a.uX)(),(0,a.Wv)(i.A,{key:0,xml:(0,n.R1)(c),finishedInfo:(0,n.R1)(p),allCommentList:(0,n.R1)(d),style:{height:"655px"}},null,8,["xml","finishedInfo","allCommentList"])):(0,a.Q3)("",!0)]),_:1})])}}});const c=p;var d=c},40299:function(e,t,s){s.d(t,{A:function(){return R}});var r=s(25136),a=(s(97042),s(19784),s(69957),s(9267)),n=(s(48493),s(65451)),i=(s(63390),s(68368)),u=(s(81208),s(12687)),l=(s(31112),s(47001),s(18111),s(22489),s(20116),s(7588),s(56768)),o=s(90144),p=s(45130),c=s(24232),d=s(61473),m=s(57477),y=s(47887),f=s(22414),w=s(64772),x=s(82572);const g={class:"process-viewer",style:{width:"100%"}},h={key:1,style:{position:"absolute",top:"0",left:"0",width:"100%"}};var D=(0,l.pM)({__name:"ProcessViewer",props:{xml:{},finishedInfo:{},allCommentList:{}},setup(e){const t=e,s=(0,x.l5)(),D=(0,o.KR)(),v=(0,o.KR)(),b=(0,o.KR)(!1),R=(0,o.KR)(),I=(0,o.KR)(1),P=(0,o.KR)(!0);let k=null;const S=(0,o.KR)(),U=(0,o.KR)(),M=(0,o.KR)(),E=(0,o.KR)(f.DiagramType.ORDINARY),L=()=>{I.value=1,k&&k.get("canvas").zoom("fit-viewport","auto")},T=(e=.1)=>{let t=Math.floor(100*I.value+100*e)/100;if(t>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");I.value=t,k&&k.get("canvas").zoom(I.value)},F=(e=.1)=>{let t=Math.floor(100*I.value-100*e)/100;if(t<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");I.value=t,k&&k.get("canvas").zoom(I.value)},C=e=>{switch(e){case f.SysFlowTaskOperationType.AGREE:case f.SysFlowTaskOperationType.MULTI_AGREE:return"success";case f.SysFlowTaskOperationType.REFUSE:case f.SysFlowTaskOperationType.PARALLEL_REFUSE:case f.SysFlowTaskOperationType.MULTI_REFUSE:return"warning";case f.SysFlowTaskOperationType.STOP:return"danger";default:return""}},_=()=>{D.value&&(D.value.innerHTML=""),k&&k.destroy(),k=null},A=()=>{if(!k)return;const e=k.get("canvas"),t=e._svg;t.appendChild(v.value)},z=(e=null)=>{U.value=void 0,R.value=void 0,null!=S.value&&null!=S.value.finishedTaskSet&&null!=e&&-1!==S.value.finishedTaskSet.indexOf(e.id)&&(U.value=e.id,R.value=e.businessObject?e.businessObject.name:void 0,M.value=(t.allCommentList||[]).filter(e=>e.taskKey===U.value),b.value=!0)},O=async e=>{if(_(),null!=e&&""!==e)try{if(k=new y.A({container:D.value,readOnly:!0}),k?k.on("element.click",({element:e})=>{z(e)}):console.warn("bpmnViewer is undefined"),P.value=!0,k){await k.importXML(e);const t=k.get("elementRegistry").find(e=>"bpmn:Process"===e.type);t?.businessObject?.extensionElements?.values&&t.businessObject.extensionElements.values.forEach(e=>{"flowable:Properties"!==e.$type&&"flowable:properties"!==e.$type||(e.values||e.$children).forEach(e=>{"$OrangeDiagramType"===e.name&&(E.value=e.value||0)})})}A()}catch(s){console.error(s),_()}finally{P.value=!1,t.finishedInfo&&W(t.finishedInfo)}},W=e=>{if(S.value=e,P.value||null==S.value||null==k)return;let{finishedSequenceFlowSet:t,finishedTaskSet:s,unfinishedTaskSet:r}=S.value;const a=k.get("canvas"),n=k.get("elementRegistry");Array.isArray(t)&&t.forEach(e=>{if(null!=e){let t=n.get(e);if(t){a.addMarker(e,"success");const s=t.businessObject.conditionExpression;s&&a.addMarker(e,"condition-expression")}}}),Array.isArray(s)&&s.forEach(e=>{if(null!=e){let t=n.get(e);t&&a.addMarker(e,"success")}}),Array.isArray(r)&&r.forEach(e=>{if(null!=e){let t=n.get(e);t&&a.addMarker(e,"current")}})};return(0,l.sV)(()=>{t.xml&&O(t.xml)}),(0,l.hi)(()=>{_()}),(0,l.wB)(()=>t.xml,e=>{e&&O(e)},{deep:!0}),(0,l.wB)(()=>t.finishedInfo,e=>{e&&W(e)},{deep:!0,immediate:!0}),(e,t)=>{const y=i.o8,x=u.u,S=i.Up,U=n.S2,_=a.kZ,A=r.S2,O=r.fg;return(0,l.uX)(),(0,l.CE)("div",g,[!(0,o.R1)(P)&&(0,o.R1)(k)&&(0,o.R1)(E)==(0,o.R1)(f.DiagramType).DINGDING?((0,l.uX)(),(0,l.Wv)(w.A,{key:0,bpmnModeler:(0,o.R1)(k),onElementClick:z,readonly:!0,finishedInfo:e.finishedInfo},null,8,["bpmnModeler","finishedInfo"])):(0,l.Q3)("",!0),(0,l.bo)((0,l.Lk)("div",{class:"process-canvas",style:{height:"100%"},ref_key:"processCanvas",ref:D},null,512),[[p.aG,!(0,o.R1)(P)&&(0,o.R1)(E)==(0,o.R1)(f.DiagramType).ORDINARY]]),(0,l.Lk)("defs",{ref_key:"customDefs",ref:v},t[4]||(t[4]=[(0,l.Lk)("marker",{id:"sequenceflow-end-white-success",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"},[(0,l.Lk)("path",{class:"success-arrow",d:"M 1 5 L 11 10 L 1 15 Z",style:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"}})],-1),(0,l.Lk)("marker",{id:"conditional-flow-marker-white-success",viewBox:"0 0 20 20",refX:"-1",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"},[(0,l.Lk)("path",{class:"success-conditional",d:"M 0 10 L 8 6 L 16 10 L 8 14 Z",style:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"}})],-1)]),512),(0,l.bF)(_,{class:"comment-dialog",title:(0,o.R1)(R)||"审批记录",modelValue:(0,o.R1)(b),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.i9)(b)?b.value=e:null),"append-to-body":!0},{default:(0,l.k6)(()=>[(0,l.bF)(U,null,{default:(0,l.k6)(()=>[(0,l.bF)(S,{data:(0,o.R1)(M),size:(0,o.R1)(s).defaultFormItemSize,border:"","header-cell-class-name":"table-header-gray",height:"500px"},{empty:(0,l.k6)(()=>t[5]||(t[5]=[(0,l.Lk)("div",{class:"table-empty unified-font"},[(0,l.Lk)("img",{src:d}),(0,l.Lk)("span",null,"暂无数据")],-1)])),default:(0,l.k6)(()=>[(0,l.bF)(y,{label:"序号","header-align":"center",align:"center",type:"index",width:"70px"}),(0,l.bF)(y,{label:"执行人",prop:"createUsername",width:"150px"}),(0,l.bF)(y,{label:"操作",width:"150px"},{default:(0,l.k6)(e=>[(0,l.bF)(x,{size:(0,o.R1)(s).defaultFormItemSize,type:C(e.row.approvalType),effect:"dark"},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)((0,o.R1)(f.SysFlowTaskOperationType).getValue(e.row.approvalType)),1)]),_:2},1032,["size","type"]),null!=e.row.delegateAssignee?((0,l.uX)(),(0,l.Wv)(x,{key:0,size:(0,o.R1)(s).defaultFormItemSize,type:"success",effect:"plain",style:{"margin-left":"10px"}},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(e.row.delegateAssignee),1)]),_:2},1032,["size"])):(0,l.Q3)("",!0)]),_:1}),(0,l.bF)(y,{label:"审批意见"},{default:(0,l.k6)(e=>[(0,l.Lk)("span",null,(0,c.v_)(e.row.taskComment?e.row.taskComment:""),1)]),_:1}),(0,l.bF)(y,{label:"处理时间",prop:"createTime",width:"180px"})]),_:1},8,["data","size"])]),_:1})]),_:1},8,["title","modelValue"]),(0,o.R1)(E)==(0,o.R1)(f.DiagramType).ORDINARY?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.bF)(U,{type:"flex",justify:"end"},{default:(0,l.k6)(()=>[(0,l.bF)(O,{key:"scale-control",size:"default"},{default:(0,l.k6)(()=>[(0,l.bF)(A,{size:"default",type:"default",plain:!0,disabled:(0,o.R1)(I)<=.3,icon:(0,o.R1)(m.ZoomOut),onClick:t[1]||(t[1]=e=>F())},null,8,["disabled","icon"]),(0,l.bF)(A,{size:"default",type:"default",style:{width:"90px"}},{default:(0,l.k6)(()=>[(0,l.eW)((0,c.v_)(Math.floor(10*(0,o.R1)(I)*10)+"%"),1)]),_:1}),(0,l.bF)(A,{size:"default",type:"default",plain:!0,disabled:(0,o.R1)(I)>=3.9,icon:(0,o.R1)(m.ZoomIn),onClick:t[2]||(t[2]=e=>T())},null,8,["disabled","icon"]),(0,l.bF)(A,{size:"default",type:"default",icon:(0,o.R1)(m.ScaleToOriginal),onClick:t[3]||(t[3]=e=>L())},null,8,["icon"]),(0,l.RG)(e.$slots,"default")]),_:3})]),_:3})])):(0,l.Q3)("",!0)])}}}),v=s(71241);const b=(0,v.A)(D,[["__scopeId","data-v-3aa8666a"]]);var R=b},54428:function(e,t,s){s.d(t,{v9:function(){return i},n5:function(){return u},lE:function(){return w},_4:function(){return h},C7:function(){return p},If:function(){return D},qY:function(){return o},ek:function(){return c},$z:function(){return d},$D:function(){return g},S_:function(){return f},fe:function(){return l},sV:function(){return m},r0:function(){return y.A}});s(18111),s(61701);var r=s(55583),a=s(52081),n=s(18384);class i extends r.w{static dictSysRole(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysRole/listDict",e,t).then(e=>{const t=new a.w("角色字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictGlobalDict(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/globalDict/listDict",e,t).then(e=>{const t=new a.w("编码字典",(e.data||[]).map(e=>({...e,disabled:1===e.status})));s(t)}).catch(e=>{r(e)})})}static dictGlobalDictByIds(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/globalDict/listDictByIds",e,t).then(e=>{const t=new a.w("编码字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictAllMenu(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysMenu/listDict",e,t).then(e=>{const t=new a.w("菜单字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysMenu(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysMenu/listMenuDict",e,t).then(e=>{const t=new a.w("菜单字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictDeptPost(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysDept/listSysDeptPostWithRelation",e,t).then(e=>{s(e.data)}).catch(e=>{r(e)})})}static dictSysPost(e,t){return new Promise((s,r)=>{super.get(n.x+"/upms/sysPost/listDict",e,t).then(e=>{const t=new a.w("岗位字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictReportDblink(e,t){return new Promise((s,r)=>{super.get(n.x+"/report/reportDblink/listDict",e,t).then(e=>{const t=new a.w("数据库链接",e.data);s(t)}).catch(e=>{r(e)})})}static dictReportDict(e,t){return new Promise((s,r)=>{super.get(n.x+"/report/reportDict/listDict",e,t).then(e=>{const t=new a.w("字典管理",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysUser(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysUser/listDict",e,t).then(e=>{let t=new a.w("用户字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysDept(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysDept/listDict",e,t).then(e=>{let t=new a.w("部门字典",e.data);s(t)}).catch(e=>{r(e)})})}static dictSysDeptByParentId(e,t){return new Promise((s,r)=>{super.get("/admin/upms/sysDept/listDictByParentId",e,t).then(e=>{let t=new a.w("部门字典",e.data);s(t)}).catch(e=>{r(e)})})}}class u extends r.w{static listSysLoginUser(e,t){return super.post(n.x+"/upms/loginUser/list",e,t)}static deleteSysLoginUser(e,t){return super.post(n.x+"/upms/loginUser/delete",e,t)}}class l extends r.w{static getMenuPermList(e,t){return super.post(n.x+"/upms/sysMenu/list",e,t)}static addMenu(e,t){return super.post(n.x+"/upms/sysMenu/add",e,t)}static updateMenu(e,t){return super.post(n.x+"/upms/sysMenu/update",e,t)}static deleteMenu(e,t){return super.post(n.x+"/upms/sysMenu/delete",e,t)}static viewMenu(e,t){return super.get(n.x+"/upms/sysMenu/view",e,t)}static listMenuPermCode(e,t){return super.get(n.x+"/upms/sysMenu/listMenuPerm",e,t)}static listSysPermByMenuIdWithDetail(e,t){return super.get(n.x+"/upms/sysMenu/listSysPermWithDetail",e,t)}static listSysUserByMenuIdWithDetail(e,t){return super.get(n.x+"/upms/sysMenu/listSysUserWithDetail",e,t)}}class o extends r.w{static updateSysConf(e,t){return super.post(n.x+"/upms/sysConf/update",e,t)}static getSysConf(e,t){return super.get(n.x+"/upms/sysConf/view",e,t)}}class p extends r.w{static getPermCodeList(e,t){return super.get(n.x+"/upms/login/getAllPermCodes",e,t)}}class c extends r.w{static add(e,t){return super.post(n.x+"/upms/sysDataPerm/add",e,t)}static update(e,t){return super.post(n.x+"/upms/sysDataPerm/update",e,t)}static delete(e,t){return super.post(n.x+"/upms/sysDataPerm/delete",e,t)}static list(e,t){return super.post(n.x+"/upms/sysDataPerm/list",e,t)}static view(e,t){return super.get(n.x+"/upms/sysDataPerm/view",e,t)}static listDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/listDataPermUser",e,t)}static addDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/addDataPermUser",e,t)}static deleteDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/deleteDataPermUser",e,t)}static listNotInDataPermUser(e,t){return super.post(n.x+"/upms/sysDataPerm/listNotInDataPermUser",e,t)}}class d extends r.w{static list(e,t){return super.post(n.x+"/upms/sysDept/list",e,t)}static view(e,t){return super.get(n.x+"/upms/sysDept/view",e,t)}static export(e,t){return super.download(n.x+"/upms/sysDept/export",e,t)}static add(e,t){return super.post(n.x+"/upms/sysDept/add",e,t)}static update(e,t){return super.post(n.x+"/upms/sysDept/update",e,t)}static delete(e,t){return super.post(n.x+"/upms/sysDept/delete",e,t)}static listNotInSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/listNotInSysDeptPost",e,t)}static listSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/listSysDeptPost",e,t)}static addSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/addSysDeptPost",e,t)}static updateSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/updateSysDeptPost",e,t)}static deleteSysDeptPost(e,t){return super.post(n.x+"/upms/sysDept/deleteSysDeptPost",e,t)}static viewSysDeptPost(e,t){return super.get(n.x+"/upms/sysDept/viewSysDeptPost",e,t)}}class m extends r.w{static getRoleList(e,t){return super.post(n.x+"/upms/sysRole/list",e,t)}static getRole(e,t){return super.get(n.x+"/upms/sysRole/view",e,t)}static deleteRole(e,t){return super.post(n.x+"/upms/sysRole/delete",e,t)}static addRole(e,t){return super.post(n.x+"/upms/sysRole/add",e,t)}static updateRole(e,t){return super.post(n.x+"/upms/sysRole/update",e,t)}static listRoleUser(e,t){return super.post(n.x+"/upms/sysRole/listUserRole",e,t)}static listNotInUserRole(e,t){return super.post(n.x+"/upms/sysRole/listNotInUserRole",e,t)}static addRoleUser(e,t){return super.post(n.x+"/upms/sysRole/addUserRole",e,t)}static deleteRoleUser(e,t){return super.post(n.x+"/upms/sysRole/deleteUserRole",e,t)}}var y=s(21013);class f extends r.w{static list(e,t){return super.post(n.x+"/upms/sysPost/list",e,t)}static view(e,t){return super.get(n.x+"/upms/sysPost/view",e,t)}static add(e,t){return super.post(n.x+"/upms/sysPost/add",e,t)}static update(e,t){return super.post(n.x+"/upms/sysPost/update",e,t)}static delete(e,t){return super.post(n.x+"/upms/sysPost/delete",e,t)}}class w extends r.w{static list(e,t){return super.post(n.x+"/mobile/mobileEntry/list",e,t)}static view(e,t){return super.get(n.x+"/mobile/mobileEntry/view",e,t)}static add(e,t){return super.post(n.x+"/mobile/mobileEntry/add",e,t)}static update(e,t){return super.post(n.x+"/mobile/mobileEntry/update",e,t)}static delete(e,t){return super.post(n.x+"/mobile/mobileEntry/delete",e,t)}static uploadImage(e,t){return super.post(n.x+"/mobile/mobileEntry/uploadImage",e,t)}static downloadImage(e,t){return super.post(n.x+"/mobile/mobileEntry/downloadImage",e,t)}}var x=s(53155);class g{static list(e,t){return(0,x.bE)(n.x+"/upms/globalDict/list",e,t)}static listAll(e,t){return(0,x.Jt)(n.x+"/upms/globalDict/listAll",e,t)}static add(e,t){return(0,x.bE)(n.x+"/upms/globalDict/add",e,t)}static update(e,t){return(0,x.bE)(n.x+"/upms/globalDict/update",e,t)}static delete(e,t){return(0,x.bE)(n.x+"/upms/globalDict/delete",e,t)}static addItem(e,t){return(0,x.bE)(n.x+"/upms/globalDict/addItem",e,t)}static updateItem(e,t){return(0,x.bE)(n.x+"/upms/globalDict/updateItem",e,t)}static updateItemStatus(e,t){return(0,x.bE)(n.x+"/upms/globalDict/updateItemStatus",e,t)}static deleteItem(e,t){return(0,x.bE)(n.x+"/upms/globalDict/deleteItem",e,t)}static reloadCachedData(e,t){return(0,x.Jt)(n.x+"/upms/globalDict/reloadCachedData",e,t)}}class h extends r.w{static listSysOperationLog(e,t){return super.post(n.x+"/upms/sysOperationLog/list",e,t)}}class D extends r.w{static list(e,t){return super.post(n.x+"/commonext/bizwidget/list",e,t)}static viewByIds(e,t){return super.post(n.x+"/commonext/bizwidget/view",e,t)}}}}]);