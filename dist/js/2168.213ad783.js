"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,2168,6339,8720],{53273:function(e,a,t){t.r(a),t.d(a,{default:function(){return g}});var o=t(25136),l=(t(97042),t(69957),t(68368)),i=(t(81208),t(3740)),n=(t(42899),t(47001),t(44114),t(56768)),r=t(90144),s=t(27007),u=t(71066);const d={class:"custom-config"},c={class:"menu-box"};var p=(0,n.pM)({name:"CustomConfig",__name:"index",props:{data:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const a=e,{thirdParams:t,onCloseThirdDialog:p}=(0,u.P)(a),v=(0,n.EW)(()=>({data:a.data||t.value.data})),h=(0,r.KR)([]),g=()=>{a.dialog?.cancel?a.dialog.cancel(!1):p(!1)},f=()=>{a.dialog?a.dialog.submit(h.value):p(!0,v.value.data,h.value)};return(0,n.sV)(()=>{(0,s.DS)(v.value.data||[],e=>{h.value.push({...e})})}),(e,a)=>{const t=l.o8,s=i.qi,u=l.Up,p=o.S2;return(0,n.uX)(),(0,n.CE)("div",d,[(0,n.bF)(u,{data:(0,r.R1)(h),size:e.defaultFormItemSize,"header-cell-class-name":"table-header-gray",height:"400px"},{default:(0,n.k6)(()=>[(0,n.bF)(t,{type:"index",label:"序号",width:"60px"}),(0,n.bF)(t,{label:"表格列名",prop:"showName"}),(0,n.bF)(t,{label:"是否显示",prop:"show"},{default:(0,n.k6)(e=>[(0,n.bF)(s,{modelValue:e.row.show,"onUpdate:modelValue":a=>e.row.show=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data","size"]),(0,n.Lk)("div",c,[(0,n.bF)(p,{size:e.defaultFormItemSize,onClick:g},{default:(0,n.k6)(()=>a[0]||(a[0]=[(0,n.eW)("取消")])),_:1,__:[0]},8,["size"]),(0,n.bF)(p,{type:"primary",size:e.defaultFormItemSize,onClick:f},{default:(0,n.k6)(()=>a[1]||(a[1]=[(0,n.eW)("保存")])),_:1,__:[1]},8,["size"])])])}}}),v=t(71241);const h=(0,v.A)(p,[["__scopeId","data-v-cdb28efa"]]);var g=h},61473:function(e,a,t){e.exports=t.p+"img/empty.7e47f88a.png"},70944:function(e,a,t){t.d(a,{A:function(){return _}});var o=t(21929),l=(t(97042),t(98421),t(91542)),i=(t(37985),t(14022)),n=(t(72343),t(65451)),r=(t(63390),t(25136)),s=(t(69957),t(44114),t(18111),t(22489),t(20116),t(7588),t(61701),t(18237),t(56768)),u=t(90144),d=t(45130),c=t(24232),p=t(61473),v=t(26695),h=t(99540),g=t(82572),f=t(31372),m=t(27007),w=t(76659),y=t(53273);const x={class:"table-box"},k={key:0,class:"extend-box"},b=["title"],C={class:"vxe-table-box"},R={key:1,class:"table-empty unified-font"};var S=(0,s.pM)({__name:"index",props:{data:{},value:{},height:{default:"auto"},hasImageColumn:{type:Boolean,default:!1},hasExtend:{type:Boolean,default:!0},supportTableConfig:{type:Boolean,default:!1},checkedMethod:{type:Function,default:()=>!0},inlineRules:{default:void 0},rowKey:{default:void 0},customQueryOptions:{},customConfig:{},showSearchString:{type:Boolean,default:!1},searchStringPlaceholder:{default:"请输入查询条件"},supportGroup:{type:Boolean,default:!1},editConfig:{default:void 0},extConfig:{default:void 0}},emits:["refresh","update:value","checkbox-select-change","radio-select-change","change","custom-query","table-config"],setup(e,{expose:a,emit:t}){const S=(0,g.l5)(),D=(0,s.OA)(),E=t,_=e,O=(0,u.KR)(),N=(0,u.KR)(),z=(0,u.KR)({rowData:void 0,rowCopy:void 0,isDirty:!1,autoEditNext:!1,nextRow:void 0,isNew:!1}),F=(0,u.KR)(""),I=(0,u.KR)(!0);let K=[];const Q=(new Date).getTime(),T=(0,u.KR)("default"),L=(0,s.EW)(()=>{const e=D["tree-config"];return e&&!e.toggleMethod&&(e.toggleMethod=({expanded:e,row:a})=>{if(P.value){let t=a[P.value];t&&(e?-1===K.indexOf(t)&&K.push(t):K=K.filter(e=>e!==t))}return!0}),e}),P=(0,s.EW)(()=>L.value?L.value.rowField:void 0),W=(0,s.EW)(()=>{const e=["row-height-"+T.value];return _.hasImageColumn&&e.push("row-height-image"),e}),V=()=>{E("refresh")},G=()=>F.value,A=()=>{I.value=!I.value,O.value&&O.value.setAllRowGroupExpand(I.value)},M=()=>{null!=_.customQueryOptions&&f.l.show("高级查询",w["default"],{area:["1000px"]},{data:[],dictList:_.customQueryOptions.dictList,fieldList:_.customQueryOptions.fieldList,getDictDataList:_.customQueryOptions.getDictDataList,customQueryHistory:_.customQueryOptions.customQueryHistory}).then(e=>{E("custom-query",e)}).catch(()=>{console.log("cancel")})},X=()=>{if(!_.supportTableConfig||null==_.customConfig)return;let e=[];(0,m.DS)(_.customConfig.tableColumnList,a=>{null!=a.isGroup&&a.isGroup||e.push({...a,children:void 0,column:void 0,table:void 0})}),f.l.show("表格配置",y["default"],{area:["800px","545px"]},{data:e||[],path:"thirdTableCustomConfig"},{width:"800px",height:"545px",pathName:"/thirdParty/thirdTableCustomConfig"}).then(e=>{let a=(e||[]).reduce((e,a)=>(e[a.columnId]={show:a.show},e),{});E("table-config",a)}).catch(()=>{console.log("cancel")})};(0,s.Gt)("inlineEditConfig",z.value);const $=()=>z.value,B=e=>z.value.rowData===e,J=()=>null!=z.value.rowData,U=()=>{N.value&&N.value.clearValidate()},j=e=>{if(N.value&&e)return N.value.validate(e)},q=(e,a)=>{null!=e&&(null!=z.value.rowData&&z.value.isDirty?v.nk.warning("请先保存当前编辑的数据"):(a&&_.data.unshift(e),z.value.rowData=e,z.value.rowCopy=JSON.parse(JSON.stringify(e)),z.value.isNew=a,(0,s.dY)(()=>{z.value.isDirty=!1,U()})))},H=e=>new Promise((a,t)=>{null==N.value?t():N.value.validate((o,l)=>{if(o){if(z.value.autoEditNext=e,z.value.autoEditNext){let e=_.data.indexOf(z.value.rowData);-1!==e&&e<_.data.length-1&&(z.value.nextRow=_.data[e+1])}let t={rowData:z.value.rowCopy,nextRow:z.value.nextRow,isNew:z.value.isNew,isDirty:z.value.isDirty};z.value.isDirty=!1,a(t)}else{let e=null;l&&Object.keys(l).forEach((a,t)=>{let o=l[a];Array.isArray(o)&&o.length>0&&(0===t&&(e=a),setTimeout(()=>{v.nk.error(o[0].message)}))}),t(new Error(e))}})}),Y=(e=!0)=>{z.value.rowData=void 0,z.value.rowCopy=void 0,z.value.autoEditNext=!1,z.value.isDirty=!1,z.value.nextRow=void 0,z.value.isNew&&e&&_.data.shift()},Z=()=>{"default"==T.value?T.value="mini":T.value="default"},ee=(e,a)=>{E("update:value",e),E("change",e,a)},ae=({checked:e})=>{let a=[];O.value&&(a=O.value.getCheckboxRecords(!0),a=a.concat(O.value.getCheckboxIndeterminateRecords(!0))),ee(a,!0),E("checkbox-select-change",a)},te=({checked:e})=>{let a=[];O.value&&(a=O.value.getCheckboxRecords(!0),a=a.concat(O.value.getCheckboxIndeterminateRecords(!0))),ee(a,!0),E("checkbox-select-change",a)},oe=e=>{let a=null;O.value&&(a=O.value.getRadioRecord()),ee(null!=a?[a]:[],!1),E("radio-select-change",a)},le=()=>{(0,s.dY)(()=>{if(O.value){if(O.value.clearRadioRow(),O.value.clearCheckboxRow(),null==_.data)return;Array.isArray(_.value)?O.value.setCheckboxRow(_.value,!0):O.value.setRadioRow(_.value)}})};(0,s.wB)(()=>_.value,()=>{le()},{deep:!0}),(0,s.wB)(()=>_.data,(e,a)=>{if(e==a)return;if(P.value){let e=[];(0,m.DS)(_.data,a=>(e.push(a),!1),"children");let a=e.filter(e=>!!P.value&&-1!=K.indexOf(e[P.value]));K=a.map(e=>e[P.value||"id"]),(0,s.dY)(()=>{O.value&&O.value.setTreeExpand(a,!0)})}let t;if(z.value.autoEditNext)if(z.value.isNew){let e=Object.keys(z.value.rowCopy).reduce((e,a)=>(e[a]=void 0,e),{});_.data.unshift(e),t=e}else null!=z.value.nextRow&&(t=(e||[]).find(e=>null==_.rowKey?e===z.value.nextRow:e[_.rowKey]===z.value.nextRow[_.rowKey])),null==t&&(t=(e||[])[0]);z.value.rowData=t,z.value.rowCopy=t?{...t}:void 0,z.value.nextRow=void 0,z.value.autoEditNext=!1},{immediate:!0,deep:!0}),(0,s.sV)(()=>{console.log("treeConfig",L)});const ie=()=>O.value;return a({getTableImpl:ie,getInlineEditConfig:$,isRowEditing:B,isTableEditing:J,clearRowValidate:U,validateRowData:j,editRow:q,saveRow:H,cancelEditRow:Y,getSearchString:G}),(e,a)=>{const t=r.S2,v=n.S2,g=i.WK,f=(0,s.g2)("Setting"),m=l.tk,w=o.US;return(0,s.uX)(),(0,s.CE)("div",x,[e.hasExtend||null!=e.customQueryOptions||e.$slots.operator?((0,s.uX)(),(0,s.Wv)(v,{key:0,type:"flex",justify:"space-between",align:"middle",class:"operator-box"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{type:"flex"},{default:(0,s.k6)(()=>[(0,s.RG)(e.$slots,"operator"),null!=e.customQueryOptions?((0,s.uX)(),(0,s.Wv)(t,{key:0,type:"primary",style:{"margin-left":"8px"},size:(0,u.R1)(S).defaultFormItemSize,plain:"",onClick:M},{default:(0,s.k6)(()=>a[3]||(a[3]=[(0,s.eW)("高级查询")])),_:1,__:[3]},8,["size"])):(0,s.Q3)("",!0)]),_:3}),e.hasExtend?((0,s.uX)(),(0,s.CE)("div",k,[e.showSearchString?((0,s.uX)(),(0,s.Wv)(g,{key:0,size:e.defaultFormItemSize,modelValue:(0,u.R1)(F),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,u.i9)(F)?F.value=e:null),style:{width:"240px"},placeholder:e.searchStringPlaceholder,clearable:"",onKeyup:(0,d.jR)(V,["enter"]),onClear:V},null,8,["size","modelValue","placeholder"])):(0,s.Q3)("",!0),e.supportGroup?((0,s.uX)(),(0,s.CE)("i",{key:1,class:(0,c.C4)((0,u.R1)(I)?"online-icon icon-unexpand-group":"online-icon icon-expand-group"),title:(0,u.R1)(I)?"收起分组":"展开分组",style:{"font-size":"20px",color:"#333333",cursor:"pointer","margin-left":"8px"},onClick:a[1]||(a[1]=e=>A())},null,10,b)):(0,s.Q3)("",!0),(0,s.Lk)("i",{class:"online-icon icon-custom-refresh",style:{"font-size":"20px",color:"#333",cursor:"pointer","margin-left":"8px"},onClick:V}),(0,s.Lk)("i",{class:"online-icon icon-table-row-height",style:{"font-size":"20px",color:"#333",cursor:"pointer","margin-left":"8px"},onClick:Z}),e.supportTableConfig?((0,s.uX)(),(0,s.Wv)(m,{key:2,style:{"font-size":"20px",color:"#333333",cursor:"pointer","margin-left":"8px"},onClick:X},{default:(0,s.k6)(()=>[(0,s.bF)(f)]),_:1})):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)]),_:3})):(0,s.Q3)("",!0),(0,s.Lk)("div",C,[(0,s.bF)(w,{class:"inline-row-form",ref_key:"inlineEditForm",ref:N,model:(0,u.R1)(z).rowCopy,rules:_.inlineRules,"show-message":!1,size:"small","label-width":"0px","label-position":"left",style:{height:"100%"},onSubmit:a[2]||(a[2]=(0,d.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[((0,s.uX)(),(0,s.Wv)((0,u.R1)(h.CP),(0,s.v6)({ref_key:"table",ref:O,border:"inner",height:"100%",data:e.data,class:(0,u.R1)(W),key:(0,u.R1)(Q)},e.$attrs,{"row-config":{...e.$attrs.rowConfig||{},isHover:!0,...e.extConfig},"edit-config":e.editConfig,"checkbox-config":{checkMethod:e.checkedMethod},"header-cell-class-name":"table-header-gray",onCheckboxChange:ae,onCheckboxAll:te,onRadioChange:oe}),{empty:(0,s.k6)(()=>[e.$slots.empty?(0,s.RG)(e.$slots,"empty",{key:0}):((0,s.uX)(),(0,s.CE)("div",R,a[4]||(a[4]=[(0,s.Lk)("img",{src:p},null,-1),(0,s.Lk)("span",null,"暂无数据",-1)])))]),default:(0,s.k6)(()=>[(0,s.RG)(e.$slots,"default")]),_:3},16,["data","class","row-config","edit-config","checkbox-config"]))]),_:3},8,["model","rules"])]),(0,s.RG)(e.$slots,"pagination",{class:"pagination-box"})])}}}),D=t(71241);const E=(0,D.A)(S,[["__scopeId","data-v-50bf3f14"]]);var _=E},71066:function(e,a,t){t.d(a,{P:function(){return r},i:function(){return s}});var o=t(81387),l=t(27007),i=t(56768),n=t(90144);const r=e=>{console.log("接收到的第三方参数",e);const a=(0,n.KR)(0),t=(0,i.EW)(()=>{let a={};try{e.thirdParamsString&&(a=JSON.parse(e.thirdParamsString))}catch(t){console.log(t),a={}}return a});console.log("thirdParams",t);const o=(o,l,i)=>{console.log("onCloseThirdDialog",l,i),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:a.value,dialogKey:e.dialogKey,path:t.value.path,rowData:l?JSON.parse(JSON.stringify(l)):void 0,data:i?JSON.parse(JSON.stringify(i)):void 0,isSuccess:o}},"*")},r=(e,t)=>{switch(e){case"setToken":t.token&&(0,l.WG)(t.token);break;case"dialogIndex":a.value=t;break;case"refreshData":break;case"message":break}},s=e=>{r(e.data.type,e.data.data)};return(0,i.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",s,!1)}),(0,i.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",s)}),{thirdParams:t,onCloseThirdDialog:o}},s=()=>{let e;const a=(0,o.lq)(),t=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==a.path.indexOf("/thirdParty/")&&((0,i.sV)(()=>{(0,l.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),t()},18e4))}),(0,i.hi)(()=>{e&&clearInterval(e)}))}}}]);