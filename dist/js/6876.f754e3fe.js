"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[1066,6876],{1579:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var o=a(25136),r=(a(97042),a(69957),a(21929)),n=(a(98421),a(65451)),i=(a(63390),a(14022)),l=(a(72343),a(76408)),u=(a(87535),a(32465),a(18888)),s=(a(3172),a(56768)),p=a(90144),d=a(45130),c=a(26695),g=a(27007),v=a(34894),f=a(99080),m=a(71066),h=a(82572);const b={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var k=(0,s.pM)({__name:"editReportPageGroup",props:{groupId:{},groupList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const t=(0,h.l5)(),a=e,{thirdParams:k,onCloseThirdDialog:I}=(0,m.P)(a),y=(0,s.EW)(()=>t.defaultFormItemSize||k.value.defaultFormItemSize?.value),R=(0,p.KR)(),w=(0,p.KR)({ReportPageGroup:{groupId:void 0,groupName:void 0,parentId:void 0,isDatasourceInit:!1}}),C={"ReportPageGroup.groupName":[{required:!0,message:"请输入分组名称",trigger:"blur"}]},P=(0,s.EW)(()=>({groupId:a.groupId||k.value.groupId,groupList:a.groupList||k.value.groupList||[]})),_=(0,s.EW)(()=>null!=P.value.groupId),T=()=>Promise.resolve({dataList:P.value.groupList}),G={loadData:T,isTree:!0,idKey:"id",parentIdKey:"parentId"},S=(0,p.Kh)({formFilter:{},formFilterCopy:{},menuBlock:{isInit:!1},parentId:{impl:(0,f.B)(G),value:[]},isInit:!1}),D=()=>{a.dialog?a.dialog.cancel():I(!1)},x=()=>{R.value.validate(e=>{if(!e)return;let t={reportPageGroupDto:{groupId:P.value.groupId,groupName:w.value.ReportPageGroup.groupName,parentId:w.value.ReportPageGroup.parentId,appId:w.value.ReportPageGroup.appId}},o=_.value?v.xr.update(t):v.xr.add(t);o.then(()=>{c.nk.success("保存成功"),a.dialog?a.dialog.submit(!0):I(!0,!0)}).catch(e=>{console.warn(e)})})},F=e=>{w.value.ReportPageGroup.parentId=Array.isArray(e)?e[e.length-1]:void 0},N=()=>{E().then(()=>{S.isInit||S.parentId.impl.onVisibleChange(!0).then(e=>{S.parentId.value=(0,g.Zi)(e,w.value.ReportPageGroup.parentId,"groupId")}).catch(e=>{console.warn(e)}),S.isInit=!0}).catch(e=>{console.warn(e)})},E=()=>new Promise((e,t)=>{if(!w.value.ReportPageGroup.isDatasourceInit&&_.value){if(null==P.value.groupId)return V(),void t();let a={groupId:P.value.groupId};v.xr.view(a).then(t=>{w.value.ReportPageGroup={...t.data,isDatasourceInit:!0},e(!0)}).catch(e=>{t(e)})}else w.value.ReportPageGroup.isDatasourceInit=!0,e(!0)}),V=()=>{w.value={ReportPageGroup:{groupId:void 0,groupName:void 0,parentId:void 0,isDatasourceInit:!1}}},W=()=>{N()};return(0,s.sV)(()=>{W()}),(e,t)=>{const a=u._m,c=r.xE,g=l.uD,v=i.WK,f=n.S2,m=r.US,h=o.S2;return(0,s.uX)(),(0,s.CE)("div",b,[(0,s.bF)(m,{ref_key:"form",ref:R,model:(0,p.R1)(w),class:"full-width-input form-box",rules:C,style:{width:"100%"},"label-width":"100px",size:(0,p.R1)(y),"label-position":"right",onSubmit:t[2]||(t[2]=(0,d.D$)(()=>{},["prevent"]))},{default:(0,s.k6)(()=>[(0,s.bF)(f,{gutter:20},{default:(0,s.k6)(()=>[(0,s.bF)(g,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(c,{label:"所属分组"},{default:(0,s.k6)(()=>[(0,s.bF)(a,{class:"input-item",modelValue:(0,p.R1)(S).parentId.value,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,p.R1)(S).parentId.value=e),disabled:(0,p.R1)(_),options:(0,p.R1)(S).parentId.impl.dropdownList,filterable:"",clearable:!0,"show-all-levels":!1,placeholder:"所属分组",props:{value:"groupId",label:"groupName",checkStrictly:!0},onVisibleChange:(0,p.R1)(S).parentId.impl.onVisibleChange,onChange:F},null,8,["modelValue","disabled","options","onVisibleChange"])]),_:1})]),_:1}),(0,s.bF)(g,{span:24},{default:(0,s.k6)(()=>[(0,s.bF)(c,{label:"分组名称",prop:"ReportPageGroup.groupName"},{default:(0,s.k6)(()=>[(0,s.bF)(v,{class:"input-item",modelValue:(0,p.R1)(w).ReportPageGroup.groupName,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,p.R1)(w).ReportPageGroup.groupName=e),clearable:!0,placeholder:"分组名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,s.bF)(f,{class:"menu-box",type:"flex",justify:"end"},{default:(0,s.k6)(()=>[(0,s.bF)(h,{size:(0,p.R1)(y),plain:!0,onClick:D},{default:(0,s.k6)(()=>t[4]||(t[4]=[(0,s.eW)(" 取消 ")])),_:1,__:[4]},8,["size"]),(0,s.bF)(h,{type:"primary",size:(0,p.R1)(y),onClick:t[3]||(t[3]=e=>x())},{default:(0,s.k6)(()=>t[5]||(t[5]=[(0,s.eW)(" 保存 ")])),_:1,__:[5]},8,["size"])]),_:1})])}}});const I=k;var y=I},3829:function(e,t,a){a.d(t,{x:function(){return i},z:function(){return n}});var o=a(47378),r=a(1211);const n=(0,o.b_)({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:r.I},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),i={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent}},6301:function(e,t,a){a.d(t,{A:function(){return c}});var o=a(60168),r=a(39578),n=function(){return r.A.Date.now()},i=n,l=a(10754),u="Expected a function",s=Math.max,p=Math.min;function d(e,t,a){var r,n,d,c,g,v,f=0,m=!1,h=!1,b=!0;if("function"!=typeof e)throw new TypeError(u);function k(t){var a=r,o=n;return r=n=void 0,f=t,c=e.apply(o,a),c}function I(e){return f=e,g=setTimeout(w,t),m?k(e):c}function y(e){var a=e-v,o=e-f,r=t-a;return h?p(r,d-o):r}function R(e){var a=e-v,o=e-f;return void 0===v||a>=t||a<0||h&&o>=d}function w(){var e=i();if(R(e))return C(e);g=setTimeout(w,y(e))}function C(e){return g=void 0,b&&r?k(e):(r=n=void 0,c)}function P(){void 0!==g&&clearTimeout(g),f=0,r=v=n=g=void 0}function _(){return void 0===g?c:C(i())}function T(){var e=i(),a=R(e);if(r=arguments,n=this,v=e,a){if(void 0===g)return I(v);if(h)return clearTimeout(g),g=setTimeout(w,t),k(v)}return void 0===g&&(g=setTimeout(w,t)),c}return t=(0,l.A)(t)||0,(0,o.A)(a)&&(m=!!a.leading,h="maxWait"in a,d=h?s((0,l.A)(a.maxWait)||0,t):d,b="trailing"in a?!!a.trailing:b),T.cancel=P,T.flush=_,T}var c=d},10754:function(e,t,a){a.d(t,{A:function(){return h}});var o=/\s/;function r(e){var t=e.length;while(t--&&o.test(e.charAt(t)));return t}var n=r,i=/^\s+/;function l(e){return e?e.slice(0,n(e)+1).replace(i,""):e}var u=l,s=a(60168),p=a(18095),d=NaN,c=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,v=/^0o[0-7]+$/i,f=parseInt;function m(e){if("number"==typeof e)return e;if((0,p.A)(e))return d;if((0,s.A)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,s.A)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=u(e);var a=g.test(e);return a||v.test(e)?f(e.slice(2),a?2:8):c.test(e)?d:+e}var h=m},12687:function(e,t,a){a.d(t,{u:function(){return h}});var o=a(56768),r=a(24232),n=a(90144),i=a(45130),l=a(91542),u=a(57477),s=a(3829),p=a(99077),d=a(37207),c=a(93513);const g=(0,o.pM)({name:"ElTag"}),v=(0,o.pM)({...g,props:s.z,emits:s.x,setup(e,{emit:t}){const a=e,s=(0,d.NV)(),p=(0,c.DU)("tag"),g=(0,o.EW)(()=>{const{type:e,hit:t,effect:o,closable:r,round:n}=a;return[p.b(),p.is("closable",r),p.m(e||"primary"),p.m(s.value),p.m(o),p.is("hit",t),p.is("round",n)]}),v=e=>{t("close",e)},f=e=>{t("click",e)},m=e=>{var t,a,o;(null==(o=null==(a=null==(t=null==e?void 0:e.component)?void 0:t.subTree)?void 0:a.component)?void 0:o.bum)&&(e.component.subTree.component.bum=null)};return(e,t)=>e.disableTransitions?((0,o.uX)(),(0,o.CE)("span",{key:0,class:(0,r.C4)((0,n.R1)(g)),style:(0,r.Tr)({backgroundColor:e.color}),onClick:f},[(0,o.Lk)("span",{class:(0,r.C4)((0,n.R1)(p).e("content"))},[(0,o.RG)(e.$slots,"default")],2),e.closable?((0,o.uX)(),(0,o.Wv)((0,n.R1)(l.tk),{key:0,class:(0,r.C4)((0,n.R1)(p).e("close")),onClick:(0,i.D$)(v,["stop"])},{default:(0,o.k6)(()=>[(0,o.bF)((0,n.R1)(u.Close))]),_:1},8,["class","onClick"])):(0,o.Q3)("v-if",!0)],6)):((0,o.uX)(),(0,o.Wv)(i.eB,{key:1,name:`${(0,n.R1)(p).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:m},{default:(0,o.k6)(()=>[(0,o.Lk)("span",{class:(0,r.C4)((0,n.R1)(g)),style:(0,r.Tr)({backgroundColor:e.color}),onClick:f},[(0,o.Lk)("span",{class:(0,r.C4)((0,n.R1)(p).e("content"))},[(0,o.RG)(e.$slots,"default")],2),e.closable?((0,o.uX)(),(0,o.Wv)((0,n.R1)(l.tk),{key:0,class:(0,r.C4)((0,n.R1)(p).e("close")),onClick:(0,i.D$)(v,["stop"])},{default:(0,o.k6)(()=>[(0,o.bF)((0,n.R1)(u.Close))]),_:1},8,["class","onClick"])):(0,o.Q3)("v-if",!0)],6)]),_:3},8,["name"]))}});var f=(0,p.A)(v,[["__file","tag.vue"]]),m=a(25376);const h=(0,m.GU)(f)},31112:function(e,t,a){a(97042)},71066:function(e,t,a){a.d(t,{P:function(){return l},i:function(){return u}});var o=a(81387),r=a(27007),n=a(56768),i=a(90144);const l=e=>{console.log("接收到的第三方参数",e);const t=(0,i.KR)(0),a=(0,n.EW)(()=>{let t={};try{e.thirdParamsString&&(t=JSON.parse(e.thirdParamsString))}catch(a){console.log(a),t={}}return t});console.log("thirdParams",a);const o=(o,r,n)=>{console.log("onCloseThirdDialog",r,n),window.parent&&window.parent.postMessage({type:"closeDialog",data:{index:t.value,dialogKey:e.dialogKey,path:a.value.path,rowData:r?JSON.parse(JSON.stringify(r)):void 0,data:n?JSON.parse(JSON.stringify(n)):void 0,isSuccess:o}},"*")},l=(e,a)=>{switch(e){case"setToken":a.token&&(0,r.WG)(a.token);break;case"dialogIndex":t.value=a;break;case"refreshData":break;case"message":break}},u=e=>{l(e.data.type,e.data.data)};return(0,n.sV)(()=>{console.log("onMounted message"),window.addEventListener("message",u,!1)}),(0,n.hi)(()=>{console.log("onUnmounted message"),window.removeEventListener("message",u)}),{thirdParams:a,onCloseThirdDialog:o}},u=()=>{let e;const t=(0,o.lq)(),a=()=>{window.parent&&window.parent.postMessage({type:"refreshToken"},"*")};-1!==t.path.indexOf("/thirdParty/")&&((0,n.sV)(()=>{(0,r.R7)()&&(e=setInterval(()=>{console.log("refreshToken thirdParty"),a()},18e4))}),(0,n.hi)(()=>{e&&clearInterval(e)}))}}}]);