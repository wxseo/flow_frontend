"use strict";(self["webpackChunkorange"]=self["webpackChunkorange"]||[]).push([[5389],{8696:function(e,a,t){t(97042),t(44332)},38840:function(e,a,t){t.d(a,{Ik:function(){return g}});var l=t(56768),r=t(24232),o=t(90144),n=t(84565),s=t(99077),d=t(93513);const i=(0,l.pM)({name:"ElCard"}),u=(0,l.pM)({...i,props:n.b,setup(e){const a=(0,d.DU)("card");return(e,t)=>((0,l.uX)(),(0,l.CE)("div",{class:(0,r.C4)([(0,o.R1)(a).b(),(0,o.R1)(a).is(`${e.shadow}-shadow`)])},[e.$slots.header||e.header?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,r.C4)([(0,o.R1)(a).e("header"),e.headerClass])},[(0,l.RG)(e.$slots,"header",{},()=>[(0,l.eW)((0,r.v_)(e.header),1)])],2)):(0,l.Q3)("v-if",!0),(0,l.Lk)("div",{class:(0,r.C4)([(0,o.R1)(a).e("body"),e.bodyClass]),style:(0,r.Tr)(e.bodyStyle)},[(0,l.RG)(e.$slots,"default")],6),e.$slots.footer||e.footer?((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,r.C4)([(0,o.R1)(a).e("footer"),e.footerClass])},[(0,l.RG)(e.$slots,"footer",{},()=>[(0,l.eW)((0,r.v_)(e.footer),1)])],2)):(0,l.Q3)("v-if",!0)],2))}});var p=(0,s.A)(u,[["__file","card.vue"]]),c=t(25376);const g=(0,c.GU)(p)},49742:function(e,a,t){t.d(a,{A:function(){return F}});var l=t(54880),r=(t(97042),t(51582),t(60713),t(24404),t(38840)),o=(t(95304),t(2403)),n=(t(63266),t(50942)),s=(t(8696),t(65451)),d=(t(63390),t(25136)),i=(t(69957),t(18111),t(61701),t(56768)),u=t(24232),p=t(45130),c=t(90144),g=t(66717),h=t(56439),m=t(57477),v=t(27007),f=t(82572);const b={class:"base-card-header"},A={class:"header-title"},k={class:"base-card-operation"},I=["title"],y={class:"module-node-menu",style:{"padding-right":"9px"}},R={class:"base-card-header"},C={class:"header-title"},w={class:"base-card-operation"},x={class:"advance-table-box"};var _=(0,i.pM)({__name:"index",props:{height:{},treePanel:{},tablePanel:{}},emits:["editGroupItem","refreshTable","deleteGroupItem","addTableItem"],setup(e,{expose:a,emit:t}){const _=t,D=e,S=(0,f.l5)(),F=(0,c.KR)(),z=(0,c.KR)(),P=(0,c.KR)([]),N=()=>{"function"===typeof D.treePanel.loadFunction&&D.treePanel.loadFunction().then(e=>{P.value=(0,v.BN)(e.map(e=>({...e})),D.treePanel.keyColumnName),null!=z.value&&(z.value=(0,v.PH)(e,z.value[D.treePanel.keyColumnName],D.treePanel.keyColumnName)),null==z.value&&(z.value=e[0]),setTimeout(()=>{F.value&&z.value&&F.value.setCurrentKey(z.value[D.treePanel.keyColumnName])},50)}).catch(e=>{console.warn(e)})},E=()=>{N()},G=e=>{_("editGroupItem",e)},T=e=>{z.value=e},L=e=>{_("deleteGroupItem",e)},B=()=>{_("addTableItem")};return a({refreshGroup:E}),(0,i.wB)(z,(e,a)=>{e!=a&&_("refreshTable",e)},{deep:!0}),(0,i.sV)(()=>{N()}),(e,a)=>{const t=d.S2,v=s.S2,f=n.qk,_=o.kA,D=r.Ik,z=l.Mb,N=l.ZO,W=l.lX;return(0,i.uX)(),(0,i.Wv)(W,{class:"advance-query-form advance-query advance-box"},{default:(0,i.k6)(()=>[(0,i.bF)(z,{width:"300px",style:{"background-color":"white"}},{default:(0,i.k6)(()=>[(0,i.bF)(D,{class:"base-card",shadow:"never",style:{height:"100%",border:"none"}},{header:(0,i.k6)(()=>[(0,i.Lk)("div",b,[(0,i.Lk)("span",A,(0,u.v_)(e.treePanel.title),1),(0,i.Lk)("div",k,[(0,i.bF)(t,{class:"advance-icon-btn",onClick:a[0]||(a[0]=e=>E()),style:{width:"40px",height:"32px",padding:"0"}},{default:(0,i.k6)(()=>a[3]||(a[3]=[(0,i.Lk)("img",{src:g,alt:"",style:{"vertical-align":"middle"}},null,-1)])),_:1,__:[3]}),e.treePanel.supportAdd?((0,i.uX)(),(0,i.Wv)(t,{key:0,class:"advance-icon-btn",style:{width:"40px",height:"32px",padding:"0"},onClick:a[1]||(a[1]=e=>G(null))},{default:(0,i.k6)(()=>a[4]||(a[4]=[(0,i.Lk)("img",{src:h,alt:"",style:{"vertical-align":"middle"}},null,-1)])),_:1,__:[4]})):(0,i.Q3)("",!0)])])]),default:(0,i.k6)(()=>[(0,i.bF)(_,{style:(0,u.Tr)({height:e.height-130+"px"}),class:"custom-scroll"},{default:(0,i.k6)(()=>[(0,i.bF)(f,{ref_key:"groupTree",ref:F,data:P.value,"node-key":e.treePanel.keyColumnName,onNodeClick:T,"highlight-current":!0,"default-expand-all":!0,"auto-expand-parent":!0,"expand-on-click-node":!1},{default:(0,i.k6)(({data:a})=>[(0,i.bF)(v,{class:"tree-node-item module-node-item",type:"flex",justify:"space-between",align:"middle"},{default:(0,i.k6)(()=>[(0,i.Lk)("span",{class:"node-text",title:a[e.treePanel.nameColumnName]},(0,u.v_)(a[e.treePanel.nameColumnName]),9,I),(0,i.Lk)("div",y,[e.treePanel.supportEdit?((0,i.uX)(),(0,i.Wv)(t,{key:0,link:"",type:"primary",onClick:(0,p.D$)(e=>G(a),["stop"]),icon:(0,c.R1)(m.Edit)},null,8,["onClick","icon"])):(0,i.Q3)("",!0),e.treePanel.supportDelete?((0,i.uX)(),(0,i.Wv)(t,{key:1,link:"",type:"danger",onClick:(0,p.D$)(e=>L(a),["stop"]),icon:(0,c.R1)(m.Delete)},null,8,["onClick","icon"])):(0,i.Q3)("",!0)])]),_:2},1024)]),_:1},8,["data","node-key"])]),_:1},8,["style"])]),_:1})]),_:1}),(0,i.bF)(N,{class:"table-panel"},{default:(0,i.k6)(()=>[(0,i.bF)(D,{class:"base-card",shadow:"never","body-style":{padding:"0px"},style:{border:"none"}},{header:(0,i.k6)(()=>[(0,i.Lk)("div",R,[(0,i.Lk)("span",C,(0,u.v_)(e.tablePanel.title),1),(0,i.Lk)("div",w,[(0,i.RG)(e.$slots,"tableFilter"),e.tablePanel.supportAdd?((0,i.uX)(),(0,i.Wv)(t,{key:0,type:"primary",style:{"margin-left":"20px"},size:(0,c.R1)(S).defaultFormItemSize,icon:(0,c.R1)(m.Plus),onClick:a[2]||(a[2]=e=>B())},{default:(0,i.k6)(()=>[(0,i.eW)((0,u.v_)(e.tablePanel.addText),1)]),_:1},8,["size","icon"])):(0,i.Q3)("",!0)])])]),default:(0,i.k6)(()=>[(0,i.Lk)("div",x,[(0,i.RG)(e.$slots,"table")])]),_:3})]),_:3}),(0,i.RG)(e.$slots,"default")]),_:3})}}}),D=t(71241);const S=(0,D.A)(_,[["__scopeId","data-v-41d1c047"]]);var F=S},56439:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAKdJREFUOE9j/P//PzMDBYARnwGNjY3Mt2/f5liyZMlXXHbgNcDU1DSKgYHB+vTp09lkGWBmZhb3798/+zNnziSPBANMTExaGRgYzNH8KsHAwCDAwMBwA03845kzZ4JBYvBYsLCw0P7//78IssI/f/64MzAw6LOwsHQhizMzM385duzYWRQDsIXySIsFbGFgZWVl/ufPH/VTp04tIislEpNJ8WYmYgwAALTpjBHjM6aDAAAAAElFTkSuQmCC"},65389:function(e,a,t){t.r(a),t.d(a,{default:function(){return I}});var l=t(70944),r=t(65451),o=(t(97042),t(63390),t(69080)),n=(t(25374),t(25136)),s=(t(69957),t(18111),t(22489),t(61701),t(56768)),d=t(90144),i=t(164),u=t(26695),p=t(27007),c=t(49742),g=t(34894),h=t(31372),m=t(60265),v=t(82572),f=t(55278),b=t(79628),A=(0,s.pM)({__name:"index",setup(e){const a=(0,v.l5)(),t=(0,s.WQ)("mainContextHeight",200),A=((0,s.WQ)("documentClientHeight",200),(0,d.KR)()),k={title:"数据集",supportAdd:!0,addText:"新建数据集"},I=(0,d.KR)([]),y=(0,d.KR)([]),R=(0,d.KR)({pageNum:1,pageSize:10}),C=(0,d.KR)(),w=()=>new Promise((e,a)=>{g.AX.list({}).then(a=>{y.value=a.data,e(a.data)}).catch(e=>{a(e)})}),x={title:"数据集分组",supportAdd:!0,supportEdit:!0,supportDelete:!0,addText:"新建分组",keyColumnName:"groupId",nameColumnName:"groupName",loadFunction:w},_=(0,s.EW)(()=>Array.isArray(y.value)?(0,p.BN)(y.value.map(e=>({...e})),"groupId"):[]),D=(0,s.EW)(()=>null==C.value?[]:I.value.filter(e=>e.groupId===C.value.groupId)),S=(0,s.EW)(()=>{let e=(R.value.pageNum-1)*R.value.pageSize;return D.value.slice(e,e+R.value.pageSize)}),F=e=>(R.value={...e.pageParam},Promise.resolve({dataList:S.value,totalCount:D.value.length})),z=()=>!0,P={loadTableData:F,verifyTableParameter:z,paged:!0},N=(0,d.Kh)((0,m.K)(P)),E=()=>{g.TR.list({}).then(e=>{I.value=e.data.dataList,N.refreshTable()}).catch(e=>{console.warn(e)})};(0,s.sV)(()=>{E()});const G=e=>{h.l.show(e?"编辑分组":"新建分组",b["default"],{area:["600px"]},{groupId:(e||{}).groupId,groupList:_.value,path:"thirdEditReportDatasetGroup"},{width:"600px",height:"300px",pathName:"/thirdParty/thirdEditReportDatasetGroup"}).then(()=>{A.value.refreshGroup()}).catch(e=>{console.warn(e)})},T=e=>{i.s.confirm("是否删除此分组？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>g.AX.delete({groupId:e.groupId})).then(()=>{u.nk.success("删除成功！"),A.value.refreshGroup()}).catch(e=>{console.warn(e)})},L=(e=null)=>{h.l.show(e?"新建数据集":"编辑数据集",f["default"],{area:["100vw","100vh"],skin:"fullscreen-dialog"},{datasetId:(e||{}).datasetId,groupList:_.value,datasetList:I.value,path:"thirdEditReportDataset"},{fullscreen:!0,pathName:"/thirdParty/thirdEditReportDataset"}).then(()=>{E()}).catch(e=>{console.warn(e),E()})},B=e=>{i.s.confirm("是否删除此数据集？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>g.TR.delete({datasetId:e.datasetId})).then(()=>{u.nk.success("删除成功！"),E()}).catch(e=>{console.warn(e)})},W=e=>{C.value=e,E(),N.refreshTable(!0,1)};return(e,i)=>{const u=(0,s.g2)("vxe-column"),p=n.S2,g=o.aQ,h=r.S2,m=l.A;return(0,s.uX)(),(0,s.Wv)(c.A,{class:"form-report-dataset",ref_key:"datasetForm",ref:A,height:(0,d.R1)(t),treePanel:x,tablePanel:k,onEditGroupItem:G,onDeleteGroupItem:T,onRefreshTable:W,onAddTableItem:i[0]||(i[0]=e=>L(null))},{table:(0,s.k6)(()=>[(0,s.bF)(m,{data:(0,d.R1)(N).dataList,size:(0,d.R1)(a).defaultFormItemSize,"header-cell-class-name":"table-header-gray",height:"auto",hasExtend:!1,"seq-config":{startIndex:((0,d.R1)(N).currentPage-1)*(0,d.R1)(N).pageSize},style:{"padding-bottom":"16px"}},{pagination:(0,s.k6)(()=>[(0,s.bF)(h,{type:"flex",justify:"end",style:{"margin-top":"16px"}},{default:(0,s.k6)(()=>[(0,s.bF)(g,{total:(0,d.R1)(N).totalCount,"current-page":(0,d.R1)(N).currentPage,"page-size":(0,d.R1)(N).pageSize,"page-sizes":[10,20,50,100],layout:"total, prev, pager, next, sizes",onCurrentChange:(0,d.R1)(N).onCurrentPageChange,onSizeChange:(0,d.R1)(N).onPageSizeChange},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])]),_:1})]),default:(0,s.k6)(()=>[(0,s.bF)(u,{title:"序号",type:"seq",width:"50px",index:(0,d.R1)(N).getTableIndex},null,8,["index"]),(0,s.bF)(u,{title:"数据集名称",field:"datasetName"}),(0,s.bF)(u,{title:"数据集类型",field:"datasetTypeDictMap.name"}),(0,s.bF)(u,{title:"数据库链接",field:"dblinkIdDictMap.name"}),(0,s.bF)(u,{title:"操作",width:"100px"},{default:(0,s.k6)(e=>[(0,s.bF)(p,{link:"",type:"primary",size:(0,d.R1)(a).defaultFormItemSize,onClick:a=>L(e.row)},{default:(0,s.k6)(()=>i[1]||(i[1]=[(0,s.eW)(" 编辑 ")])),_:2,__:[1]},1032,["size","onClick"]),(0,s.bF)(p,{link:"",type:"danger",size:(0,d.R1)(a).defaultFormItemSize,onClick:a=>B(e.row)},{default:(0,s.k6)(()=>i[2]||(i[2]=[(0,s.eW)(" 删除 ")])),_:2,__:[2]},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size","seq-config"])]),_:1},8,["height"])}}});const k=A;var I=k},66717:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAUhJREFUOE+1k69LBEEUx79vznLZYrgg2E5hZ14w2cViMvgDBINBrDaLRTD4D4hB8NdVsYjdIsjMLqzXhAsXNGxeD3SerHjL3noexx1OnZnP+7w33yGMuWjM++gLqNfrU9VqdUNE5rICRBR3Op3LOI7ffgpOAPj43isbMPMugCMAN0T0lO2LiAawAmBPRBIAi8657V8ArfW0Uqrhvd8JwzAswrXWulKpNESkDaBtrd3qazBoJhlEKfUI4HokQAZn5gsREefcZo+BMWbZe/8SRdHzIAtm3gewYK1d6gEw8x2AB2vt4SBAEASzSqkZ59xt2eCciD67vQ2bj/wZmfkMwLqIzDvnolEBNSKqee9XyxBjTKCUOkiSZK3Var13C+QGxphTAPdENAng+K8gWWtPinbFJObx7BflNE2vms3ma7m1//lMww4wO/cF492DEX93tXEAAAAASUVORK5CYII="},79628:function(e,a,t){t.r(a),t.d(a,{default:function(){return I}});var l=t(25136),r=(t(97042),t(69957),t(21929)),o=(t(98421),t(65451)),n=(t(63390),t(14022)),s=(t(72343),t(76408)),d=(t(87535),t(32465),t(18888)),i=(t(3172),t(56768)),u=t(90144),p=t(45130),c=t(26695),g=t(99080),h=t(27007),m=t(34894),v=t(71066),f=t(82572);const b={class:"form-single-fragment third-party-dlg",style:{position:"relative"}};var A=(0,i.pM)({__name:"editReportDatasetGroup",props:{groupId:{},groupList:{},dialog:{},thirdParamsString:{},dialogKey:{}},setup(e){const a=(0,f.l5)(),t=e,{thirdParams:A,onCloseThirdDialog:k}=(0,v.P)(t),I=(0,i.EW)(()=>a.defaultFormItemSize||A.value.defaultFormItemSize?.value),y=(0,u.KR)(),R={"ReportDatasetGroup.groupName":[{required:!0,message:"请输入分组名称",trigger:"blur"}]},C=(0,u.KR)({ReportDatasetGroup:{groupId:void 0,groupName:void 0,parentId:void 0,isDatasourceInit:!1}}),w=(0,i.EW)(()=>({groupId:t.groupId||A.value.groupId,groupList:t.groupList||A.value.groupList||[]})),x=(0,i.EW)(()=>!!w.value.groupId),_=()=>Promise.resolve({dataList:w.value.groupList||[]}),D={loadData:_,isTree:!0,idKey:"id",parentIdKey:"parentId"},S=(0,u.Kh)({formFilter:{},formFilterCopy:{},menuBlock:{isInit:!1},parentId:{impl:(0,g.B)(D),value:[]},isInit:!1}),F=()=>{t.dialog?t.dialog.cancel():k(!1)},z=e=>{C.value.ReportDatasetGroup.parentId=Array.isArray(e)?e[e.length-1]:void 0},P=()=>{E().then(()=>{S.isInit||S.parentId.impl.onVisibleChange(!0).then(e=>{S.parentId.value=(0,h.Zi)(e,C.value.ReportDatasetGroup.parentId,"groupId")}).catch(e=>{console.warn(e)}),S.isInit=!0}).catch(e=>{console.warn(e)})},N=()=>{y.value.validate(e=>{if(!e)return;let a={reportDatasetGroupDto:{groupId:w.value.groupId,groupName:C.value.ReportDatasetGroup.groupName,parentId:C.value.ReportDatasetGroup.parentId,appId:C.value.ReportDatasetGroup.appId}},l=x.value?m.AX.update(a):m.AX.add(a);l.then(()=>{c.nk.success("保存成功"),t.dialog?t.dialog.submit(!0):k(!0)}).catch(e=>{console.warn(e)})})},E=()=>new Promise((e,a)=>{if(!C.value.ReportDatasetGroup.isDatasourceInit&&x.value){if(null==w.value.groupId)return G(),void a();let t={groupId:w.value.groupId};m.AX.view(t).then(a=>{C.value.ReportDatasetGroup={...a.data,isDatasourceInit:!0},e(a)}).catch(e=>{a(e)})}else C.value.CourseSection&&(C.value.CourseSection.isDatasourceInit=!0),e(!0)}),G=()=>{C.value={ReportDatasetGroup:{groupId:void 0,groupName:void 0,parentId:void 0,appId:void 0,createTime:void 0,createUserId:void 0,updateTime:void 0,updateUserId:void 0,isDatasourceInit:!1}}},T=()=>{P()};return(0,i.sV)(()=>{T()}),(e,a)=>{const t=d._m,c=r.xE,g=s.uD,h=n.WK,m=o.S2,v=r.US,f=l.S2;return(0,i.uX)(),(0,i.CE)("div",b,[(0,i.bF)(v,{ref_key:"form",ref:y,model:(0,u.R1)(C),class:"full-width-input form-box",rules:R,style:{width:"100%"},"label-width":"80px",size:(0,u.R1)(I),"label-position":"right",onSubmit:a[2]||(a[2]=(0,p.D$)(()=>{},["prevent"]))},{default:(0,i.k6)(()=>[(0,i.bF)(m,{gutter:20},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:24},{default:(0,i.k6)(()=>[(0,i.bF)(c,{label:"所属分组"},{default:(0,i.k6)(()=>[(0,i.bF)(t,{class:"input-item",modelValue:(0,u.R1)(S).parentId.value,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,u.R1)(S).parentId.value=e),disabled:(0,u.R1)(x),options:(0,u.R1)(S).parentId.impl.dropdownList,filterable:"",clearable:!0,"show-all-levels":!1,placeholder:"所属分组",props:{value:"groupId",label:"groupName",checkStrictly:!0},onVisibleChange:(0,u.R1)(S).parentId.impl.onVisibleChange,onChange:z},null,8,["modelValue","disabled","options","onVisibleChange"])]),_:1})]),_:1}),(0,i.bF)(g,{span:24},{default:(0,i.k6)(()=>[(0,i.bF)(c,{label:"分组名称",prop:"ReportDatasetGroup.groupName"},{default:(0,i.k6)(()=>[(0,i.bF)(h,{class:"input-item",modelValue:(0,u.R1)(C).ReportDatasetGroup.groupName,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,u.R1)(C).ReportDatasetGroup.groupName=e),clearable:!0,placeholder:"分组名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),(0,i.bF)(m,{class:"menu-box"},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:24},{default:(0,i.k6)(()=>[(0,i.bF)(m,{class:"no-scroll flex-box",type:"flex",justify:"end"},{default:(0,i.k6)(()=>[(0,i.bF)(f,{size:(0,u.R1)(I),plain:!0,onClick:F},{default:(0,i.k6)(()=>a[3]||(a[3]=[(0,i.eW)(" 取消 ")])),_:1,__:[3]},8,["size"]),(0,i.bF)(f,{type:"primary",size:(0,u.R1)(I),onClick:N},{default:(0,i.k6)(()=>a[4]||(a[4]=[(0,i.eW)(" 保存 ")])),_:1,__:[4]},8,["size"])]),_:1})]),_:1})]),_:1})])}}});const k=A;var I=k},84565:function(e,a,t){t.d(a,{b:function(){return r}});var l=t(47378);const r=(0,l.b_)({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:(0,l.jq)([String,Object,Array]),default:""},headerClass:String,bodyClass:String,footerClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}})},95304:function(e,a,t){t(97042)}}]);